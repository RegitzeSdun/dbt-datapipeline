

============================== 2022-12-08 13:17:20.120483 | 3442fa2a-3421-45e6-9375-0eddf7914543 ==============================
[0m13:17:20.120536 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:17:20.120987 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:17:20.121109 [debug] [MainThread]: Tracking: tracking
[0m13:17:20.129722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f4f40>]}
[0m13:17:20.137816 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m13:17:20.138023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107504f40>]}
[0m13:17:20.151521 [debug] [MainThread]: Parsing macros/etc.sql
[0m13:17:20.152633 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:17:20.155835 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:17:20.165042 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:17:20.166069 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:17:20.167234 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:17:20.170519 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m13:17:20.171624 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:17:20.179064 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:17:20.179735 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:17:20.179893 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:17:20.180148 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m13:17:20.180571 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:17:20.180722 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:17:20.180950 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:17:20.181214 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:17:20.181612 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:17:20.182108 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:17:20.182312 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:17:20.182512 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:17:20.182726 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:17:20.182947 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:17:20.183191 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:17:20.183804 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:17:20.184023 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:17:20.184355 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:17:20.184605 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:17:20.185653 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:17:20.187177 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:17:20.188098 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:17:20.188777 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:17:20.195550 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:17:20.202377 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:17:20.207953 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:17:20.209831 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:17:20.210588 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:17:20.211559 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:17:20.215145 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:17:20.222181 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:17:20.222803 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:17:20.225595 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:17:20.230239 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:17:20.237820 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:17:20.240138 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:17:20.241559 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:17:20.243872 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:17:20.244389 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:17:20.245761 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:17:20.246665 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:17:20.249580 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:17:20.257613 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:17:20.258210 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:17:20.259212 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:17:20.259838 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:17:20.260208 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:17:20.260529 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:17:20.260803 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:17:20.261355 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:17:20.263513 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:17:20.267024 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:17:20.267361 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:17:20.267854 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:17:20.268241 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:17:20.268616 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:17:20.269125 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:17:20.269453 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:17:20.269867 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:17:20.270369 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:17:20.271322 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:17:20.271823 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:17:20.272259 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:17:20.272682 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:17:20.273092 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:17:20.273461 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:17:20.273887 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:17:20.274241 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:17:20.276948 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:17:20.277372 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:17:20.277740 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:17:20.278453 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:17:20.279381 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:17:20.279795 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:17:20.280391 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:17:20.280810 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:17:20.281663 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:17:20.282987 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:17:20.284142 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:17:20.290459 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:17:20.291253 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:17:20.296888 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:17:20.298683 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:17:20.301668 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:17:20.305733 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:17:20.308296 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:17:20.451580 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m13:17:20.457185 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m13:17:20.492879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m13:17:20.495439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c5210>]}
[0m13:17:20.499231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762b3a0>]}
[0m13:17:20.499435 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:17:20.499598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f4f40>]}
[0m13:17:20.500337 [info ] [MainThread]: 
[0m13:17:20.500757 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:17:20.501366 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:17:20.501515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:21.272333 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_wawa_analytics"
[0m13:17:21.272663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:22.103981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d74df0>]}
[0m13:17:22.105251 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:17:22.105676 [info ] [MainThread]: 
[0m13:17:22.116044 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:17:22.116262 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:17:22.116620 [info ] [Thread-1 (]: 1 of 2 START sql view model wawa_analytics.stg_apple_app_store__downloads ...... [RUN]
[0m13:17:22.116855 [info ] [Thread-2 (]: 2 of 2 START sql view model wawa_analytics.stg_google_play_store__downloads .... [RUN]
[0m13:17:22.117618 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:17:22.118408 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:17:22.118638 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:17:22.118818 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:17:22.118969 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:17:22.119114 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:17:22.122236 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:17:22.123506 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:17:22.124290 [debug] [Thread-1 (]: finished collecting timing info
[0m13:17:22.124421 [debug] [Thread-2 (]: finished collecting timing info
[0m13:17:22.124553 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:17:22.124680 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:17:22.146225 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:17:22.148057 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:17:22.148610 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:17:22.148733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:22.149638 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "wawa_data_warehouse", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`wawa_analytics`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:17:22.150334 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "wawa_data_warehouse", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`wawa_analytics`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:17:23.733612 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c58b1b77-dbcd-4910-867c-ee95244330db:europe-west1&page=queryresults
[0m13:17:23.752422 [debug] [Thread-1 (]: finished collecting timing info
[0m13:17:23.753398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765a320>]}
[0m13:17:23.753798 [info ] [Thread-1 (]: 1 of 2 OK created sql view model wawa_analytics.stg_apple_app_store__downloads . [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m13:17:23.754598 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3be330db-def8-456a-8b85-3f12d86e8080:europe-west1&page=queryresults
[0m13:17:23.755084 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:17:23.756498 [debug] [Thread-2 (]: finished collecting timing info
[0m13:17:23.757200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3442fa2a-3421-45e6-9375-0eddf7914543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a8550>]}
[0m13:17:23.757509 [info ] [Thread-2 (]: 2 of 2 OK created sql view model wawa_analytics.stg_google_play_store__downloads  [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m13:17:23.757833 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:17:23.759085 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:17:23.759574 [info ] [MainThread]: 
[0m13:17:23.759782 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m13:17:23.759945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:23.760035 [debug] [MainThread]: Connection 'model.my_new_project.stg_apple_app_store__downloads' was properly closed.
[0m13:17:23.760118 [debug] [MainThread]: Connection 'model.my_new_project.stg_google_play_store__downloads' was properly closed.
[0m13:17:23.769580 [info ] [MainThread]: 
[0m13:17:23.769802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:23.769978 [info ] [MainThread]: 
[0m13:17:23.770124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:17:23.770378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079968c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107994a60>]}
[0m13:17:23.770643 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 13:23:11.198252 | f00ffc52-da14-4adb-9ba8-faf4777b1513 ==============================
[0m13:23:11.198302 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:23:11.199104 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:23:11.199242 [debug] [MainThread]: Tracking: tracking
[0m13:23:11.215353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df5240>]}
[0m13:23:11.252204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:23:11.252418 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/downloads.sql
[0m13:23:11.259343 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m13:23:11.270932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m13:23:11.273900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae94730>]}
[0m13:23:11.298688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae03d60>]}
[0m13:23:11.300570 [info ] [MainThread]: Found 3 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:23:11.300717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088427a0>]}
[0m13:23:11.301464 [info ] [MainThread]: 
[0m13:23:11.301907 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:23:11.302510 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:23:11.302652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:11.972612 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_wawa_analytics"
[0m13:23:11.972865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:12.454533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108940dc0>]}
[0m13:23:12.455424 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:23:12.455691 [info ] [MainThread]: 
[0m13:23:12.458262 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:23:12.458419 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:23:12.458560 [info ] [Thread-1 (]: 1 of 3 START sql view model wawa_analytics.stg_apple_app_store__downloads ...... [RUN]
[0m13:23:12.458688 [info ] [Thread-2 (]: 2 of 3 START sql view model wawa_analytics.stg_google_play_store__downloads .... [RUN]
[0m13:23:12.459052 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:23:12.459545 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:23:12.459815 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:23:12.460104 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:23:12.460229 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:23:12.460311 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:23:12.461522 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:23:12.462659 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:23:12.463564 [debug] [Thread-1 (]: finished collecting timing info
[0m13:23:12.463667 [debug] [Thread-2 (]: finished collecting timing info
[0m13:23:12.463810 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:23:12.463927 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:23:12.485887 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:23:12.488366 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:23:12.489284 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "wawa_data_warehouse", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`wawa_analytics`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:23:12.490618 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:23:12.532874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:12.533536 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "wawa_data_warehouse", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`wawa_analytics`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:23:13.568899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ffb30555-263a-4740-bd0d-a9e0ab910bf9:europe-west1&page=queryresults
[0m13:23:13.579770 [debug] [Thread-1 (]: finished collecting timing info
[0m13:23:13.580167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af8c820>]}
[0m13:23:13.580372 [info ] [Thread-1 (]: 1 of 3 OK created sql view model wawa_analytics.stg_apple_app_store__downloads . [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m13:23:13.580621 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:23:13.614269 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:faa57eb4-11b4-41d6-a043-0938edd47725:europe-west1&page=queryresults
[0m13:23:13.615415 [debug] [Thread-2 (]: finished collecting timing info
[0m13:23:13.615766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653efe0>]}
[0m13:23:13.615955 [info ] [Thread-2 (]: 2 of 3 OK created sql view model wawa_analytics.stg_google_play_store__downloads  [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m13:23:13.616188 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:23:13.616493 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m13:23:13.616683 [info ] [Thread-1 (]: 3 of 3 START sql table model wawa_analytics.downloads .......................... [RUN]
[0m13:23:13.617081 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:23:13.617174 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m13:23:13.617255 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m13:23:13.619434 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:23:13.619877 [debug] [Thread-1 (]: finished collecting timing info
[0m13:23:13.620000 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m13:23:13.627308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:14.076023 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:23:14.076500 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "wawa_data_warehouse", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`wawa_analytics`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`wawa_analytics`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`wawa_analytics`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:23:16.878883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:865c53e7-f108-44f3-af4e-0f2fdea0618b:europe-west1&page=queryresults
[0m13:23:16.884185 [debug] [Thread-1 (]: finished collecting timing info
[0m13:23:16.885193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f00ffc52-da14-4adb-9ba8-faf4777b1513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebeaa0>]}
[0m13:23:16.885754 [info ] [Thread-1 (]: 3 of 3 OK created sql table model wawa_analytics.downloads ..................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.27s]
[0m13:23:16.886368 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m13:23:16.888181 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:23:16.888879 [info ] [MainThread]: 
[0m13:23:16.889195 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m13:23:16.889457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:16.889596 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m13:23:16.889723 [debug] [MainThread]: Connection 'model.my_new_project.stg_google_play_store__downloads' was properly closed.
[0m13:23:16.897750 [info ] [MainThread]: 
[0m13:23:16.898033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:16.898279 [info ] [MainThread]: 
[0m13:23:16.898476 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:23:16.898778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aedca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae82500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae82530>]}
[0m13:23:16.899037 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 13:48:27.830965 | 2fb97984-9a54-4569-a85e-11b31d8faf13 ==============================
[0m13:48:27.831016 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:48:27.831863 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:48:27.831972 [debug] [MainThread]: Tracking: tracking
[0m13:48:27.845278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f5120>]}
[0m13:48:27.864815 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:48:27.865030 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:27.865147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2fb97984-9a54-4569-a85e-11b31d8faf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5dc00>]}
[0m13:48:27.880076 [debug] [MainThread]: Parsing macros/etc.sql
[0m13:48:27.881126 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:48:27.884373 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:48:27.893780 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:48:27.894839 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:48:27.896008 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:48:27.899331 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m13:48:27.900455 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:48:27.907988 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:48:27.908668 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:48:27.908827 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:48:27.909107 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m13:48:27.909533 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:48:27.909676 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:48:27.909907 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:48:27.910164 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:48:27.910568 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:48:27.911068 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:48:27.911286 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:48:27.911493 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:48:27.911720 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:48:27.911929 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:48:27.912104 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:48:27.912713 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:48:27.912928 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:48:27.913245 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:48:27.913482 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:48:27.914520 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:48:27.916046 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:48:27.916974 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:48:27.917663 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:48:27.924452 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:48:27.930342 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:48:27.935683 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:48:27.937511 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:48:27.938235 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:48:27.938947 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:48:27.942251 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:48:27.949147 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:48:27.949754 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:48:27.952495 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:48:27.956953 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:48:27.964496 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:48:27.966831 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:48:27.968232 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:48:27.970534 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:48:27.971046 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:48:27.972416 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:48:27.973314 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:48:27.976364 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:48:27.984363 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:48:27.984958 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:48:27.985957 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:48:27.986583 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:48:27.986953 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:48:27.987270 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:48:27.987553 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:48:27.988098 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:48:27.990249 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:48:27.993742 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:48:27.994067 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:48:27.994560 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:48:27.994939 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:48:27.995314 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:48:27.995807 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:48:27.996123 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:48:27.996529 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:48:27.997020 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:48:27.997967 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:48:27.998466 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:48:27.998900 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:48:27.999323 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:48:27.999731 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:48:28.000095 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:48:28.000519 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:48:28.000876 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:48:28.003598 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:48:28.004017 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:48:28.004383 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:48:28.005103 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:48:28.006008 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:48:28.006416 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:48:28.007013 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:48:28.007433 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:48:28.008276 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:48:28.009590 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:48:28.010710 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:48:28.016982 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:48:28.017776 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:48:28.023358 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:48:28.025154 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:48:28.028108 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:48:28.032173 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:48:28.034740 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:48:28.180059 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m13:48:28.185544 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m13:48:28.186832 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m13:48:28.222321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m13:48:28.224869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fb97984-9a54-4569-a85e-11b31d8faf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183adba0>]}
[0m13:48:28.229599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fb97984-9a54-4569-a85e-11b31d8faf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182cc880>]}
[0m13:48:28.229801 [info ] [MainThread]: Found 3 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:48:28.229934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fb97984-9a54-4569-a85e-11b31d8faf13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f6410>]}
[0m13:48:28.230548 [info ] [MainThread]: 
[0m13:48:28.230884 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:48:28.231364 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-rsdun"
[0m13:48:28.231472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:29.216571 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
list dataset
[0m13:48:29.217572 [debug] [ThreadPool]: BigQuery adapter: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/dbt-rsdun/datasets?maxResults=10000&prettyPrint=false: Not found: Project dbt-rsdun
[0m13:48:29.219390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:29.219642 [debug] [MainThread]: Connection 'list_dbt-rsdun' was properly closed.
[0m13:48:29.219990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183af5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183ada50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183ac670>]}
[0m13:48:29.220371 [debug] [MainThread]: Flushing usage events
[0m13:48:29.717957 [error] [MainThread]: Encountered an error:
Runtime Error
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/dbt-rsdun/datasets?maxResults=10000&prettyPrint=false: Not found: Project dbt-rsdun


============================== 2022-12-08 13:48:52.616920 | b882b882-77da-4a73-91e5-66adfafaf855 ==============================
[0m13:48:52.616977 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:48:52.617541 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:48:52.617641 [debug] [MainThread]: Tracking: tracking
[0m13:48:52.625974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf1120>]}
[0m13:48:52.645822 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:48:52.646068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5da80>]}
[0m13:48:52.660568 [debug] [MainThread]: Parsing macros/etc.sql
[0m13:48:52.661689 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:48:52.665121 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:48:52.674466 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:48:52.675517 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:48:52.676685 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:48:52.679993 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m13:48:52.681106 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:48:52.688609 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:48:52.689287 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:48:52.689446 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:48:52.689703 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m13:48:52.690126 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:48:52.690275 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:48:52.690498 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:48:52.690757 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:48:52.691156 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:48:52.691647 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:48:52.691858 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:48:52.692064 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:48:52.692291 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:48:52.692501 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:48:52.692682 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:48:52.693306 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:48:52.693528 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:48:52.693851 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:48:52.694094 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:48:52.695135 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:48:52.696670 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:48:52.697592 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:48:52.698267 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:48:52.705059 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:48:52.710930 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:48:52.716292 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:48:52.718140 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:48:52.718872 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:48:52.719592 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:48:52.722956 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:48:52.729834 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:48:52.730444 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:48:52.733176 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:48:52.737603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:48:52.745141 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:48:52.747434 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:48:52.748843 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:48:52.751147 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:48:52.751654 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:48:52.753019 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:48:52.753915 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:48:52.756977 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:48:52.764981 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:48:52.765579 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:48:52.766568 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:48:52.767193 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:48:52.767559 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:48:52.767888 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:48:52.768165 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:48:52.768709 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:48:52.770879 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:48:52.774392 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:48:52.774718 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:48:52.775205 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:48:52.775585 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:48:52.775957 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:48:52.776456 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:48:52.776776 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:48:52.777185 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:48:52.777677 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:48:52.778627 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:48:52.779124 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:48:52.779555 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:48:52.779974 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:48:52.780382 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:48:52.780746 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:48:52.781181 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:48:52.781553 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:48:52.784285 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:48:52.784707 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:48:52.785076 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:48:52.785791 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:48:52.786694 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:48:52.787106 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:48:52.787697 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:48:52.788115 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:48:52.788957 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:48:52.790285 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:48:52.791408 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:48:52.797700 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:48:52.798493 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:48:52.804058 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:48:52.805839 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:48:52.808794 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:48:52.812865 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:48:52.815431 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:48:52.961155 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m13:48:52.966669 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m13:48:52.968011 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m13:48:53.004849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m13:48:53.007433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adac8e0>]}
[0m13:48:53.011680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc9810>]}
[0m13:48:53.011890 [info ] [MainThread]: Found 3 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:48:53.012033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf2410>]}
[0m13:48:53.012708 [info ] [MainThread]: 
[0m13:48:53.013083 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:48:53.013569 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:48:53.013661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:53.775285 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:48:53.775767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:54.202254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108374dc0>]}
[0m13:48:54.203467 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:48:54.203817 [info ] [MainThread]: 
[0m13:48:54.210496 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:48:54.210756 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:48:54.211195 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m13:48:54.211461 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m13:48:54.212314 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:48:54.213025 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:48:54.213244 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:48:54.213444 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:48:54.213644 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:48:54.213794 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:48:54.217030 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:48:54.221254 [debug] [Thread-2 (]: finished collecting timing info
[0m13:48:54.221486 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:48:54.245903 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:48:54.249607 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:48:54.250290 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:48:54.250413 [debug] [Thread-1 (]: finished collecting timing info
[0m13:48:54.250603 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:48:54.252340 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:48:54.253183 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:48:54.253426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:54.293200 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:48:55.557696 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:498a2b8e-8349-4c88-bb78-151edf4c0b72:europe-west1&page=queryresults
[0m13:48:55.559191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:332b68af-687b-4031-b9be-1645eddf5eac:europe-west1&page=queryresults
[0m13:48:55.578146 [debug] [Thread-2 (]: finished collecting timing info
[0m13:48:55.579364 [debug] [Thread-1 (]: finished collecting timing info
[0m13:48:55.579948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d0ca0>]}
[0m13:48:55.580355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8fa590>]}
[0m13:48:55.580733 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m13:48:55.580980 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m13:48:55.581351 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:48:55.581608 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:48:55.582451 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m13:48:55.582850 [info ] [Thread-2 (]: 3 of 3 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m13:48:55.583346 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:48:55.583467 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m13:48:55.583577 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m13:48:55.586717 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:48:55.588701 [debug] [Thread-2 (]: finished collecting timing info
[0m13:48:55.588856 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m13:48:55.596708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:48:56.053954 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:48:56.054989 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:48:58.619400 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fc4eaa51-f839-4e97-bb00-3c9811b17259:europe-west1&page=queryresults
[0m13:48:58.623216 [debug] [Thread-2 (]: finished collecting timing info
[0m13:48:58.624327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b882b882-77da-4a73-91e5-66adfafaf855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94aa40>]}
[0m13:48:58.624889 [info ] [Thread-2 (]: 3 of 3 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.04s]
[0m13:48:58.625477 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m13:48:58.627241 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:48:58.628071 [info ] [MainThread]: 
[0m13:48:58.628454 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m13:48:58.628729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:58.628863 [debug] [MainThread]: Connection 'model.my_new_project.stg_apple_app_store__downloads' was properly closed.
[0m13:48:58.628987 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m13:48:58.644755 [info ] [MainThread]: 
[0m13:48:58.645050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:58.645271 [info ] [MainThread]: 
[0m13:48:58.645454 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:48:58.645696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b939e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b938700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b938f70>]}
[0m13:48:58.645893 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:06:33.640689 | d7df88b9-ae43-4ad0-855f-fb4e38feb40b ==============================
[0m15:06:33.640730 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:06:33.641443 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:06:33.641551 [debug] [MainThread]: Tracking: tracking
[0m15:06:33.654034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287d120>]}
[0m15:06:33.690967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m15:06:33.691187 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:06:33.691318 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/schema.yml
[0m15:06:33.691427 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:06:33.691529 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_android__production_events/schema.yml
[0m15:06:33.691605 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:06:33.699081 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:06:33.704955 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:06:33.706405 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:06:33.711854 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_ios__community_viewed_article' in the 'models' section of file 'models/staging/segment_ios__production_events/schema.yml'
[0m15:06:33.722048 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m15:06:33.728199 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_slug.8035cd1030' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:06:33.728378 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_slug.aef30b956f' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:06:33.728489 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_original_timestamp.17a3cd91f0' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:06:33.728591 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_original_timestamp.048440ddbc' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:06:33.728691 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_user_id.845753e1c8' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:06:33.728790 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_user_id.cc8a746681' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:06:33.728889 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_slug.01cb357c20' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:06:33.728989 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_slug.c394d06565' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:06:33.729089 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_original_timestamp.f45027f819' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:06:33.729190 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_original_timestamp.42ba45d2f8' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:06:33.729290 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_user_id.a07ae945b5' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:06:33.729401 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_user_id.75bc497418' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:06:33.737539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m15:06:33.740768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a48100>]}
[0m15:06:33.781335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ccfbe0>]}
[0m15:06:33.781525 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:06:33.781652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610efe0>]}
[0m15:06:33.782396 [info ] [MainThread]: 
[0m15:06:33.782747 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:06:33.783322 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:06:33.783463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:34.655291 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:06:34.655852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:35.042288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110874dc0>]}
[0m15:06:35.043841 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:06:35.044288 [info ] [MainThread]: 
[0m15:06:35.050120 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:06:35.050422 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:06:35.050738 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:06:35.051023 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:06:35.051786 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:06:35.052407 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:06:35.052578 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:06:35.052945 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:06:35.053285 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:06:35.053465 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:06:35.055642 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:06:35.057201 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:06:35.059299 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:35.059470 [debug] [Thread-2 (]: finished collecting timing info
[0m15:06:35.059667 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:06:35.059832 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:06:35.086965 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:06:35.089848 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:06:35.090826 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:06:35.092196 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:06:35.131739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:35.132434 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:06:36.308260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:53011364-a62e-479d-bc41-2f5780d6fd5e:europe-west1&page=queryresults
[0m15:06:36.328183 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:36.328887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a0eb00>]}
[0m15:06:36.329243 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m15:06:36.329648 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:06:36.329819 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:06:36.330118 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:06:36.330707 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:06:36.330857 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:06:36.330994 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:06:36.332877 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:06:36.333697 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:36.333830 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:06:36.335980 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:06:36.336357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:36.337365 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;;


[0m15:06:36.381038 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e3649302-c43c-40b7-ae8e-b929daff8988:europe-west1&page=queryresults
[0m15:06:36.382059 [debug] [Thread-2 (]: finished collecting timing info
[0m15:06:36.382386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6b1f0>]}
[0m15:06:36.382552 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m15:06:36.382882 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:06:36.383170 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:06:36.383509 [info ] [Thread-2 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:06:36.383821 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:06:36.383893 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:06:36.383961 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:06:36.384834 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:06:36.385189 [debug] [Thread-2 (]: finished collecting timing info
[0m15:06:36.385274 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:06:36.386720 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:06:36.386962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:06:36.387649 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp), reading_session, category, clinic_id, user_id 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:06:36.762182 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ";" at [7:83]')
[0m15:06:36.948008 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:bf1aedb2-f0c1-4857-93a3-f86d1ff5dbca&page=queryresults
[0m15:06:36.950022 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:36.951602 [debug] [Thread-1 (]: Database Error in model stg_segment_android__community_viewed_article (models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql)
  Syntax error: Expected end of input but got ";" at [7:83]
  compiled Code at target/run/my_new_project/models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:06:36.952263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e02470>]}
[0m15:06:36.952902 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[31mERROR[0m in 0.62s]
[0m15:06:36.953493 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:06:36.953772 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m15:06:36.954332 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:06:36.955387 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:06:36.955660 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m15:06:36.955842 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m15:06:36.960615 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:06:36.963256 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:36.963550 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m15:06:36.981546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:37.142201 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW columns must be named, but column 2 has no name at [6:6]')
[0m15:06:37.499949 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:06:37.501311 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:06:38.192272 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:805c82ac-aafd-454a-b132-47bf6af3b9f1&page=queryresults
[0m15:06:38.193160 [debug] [Thread-2 (]: finished collecting timing info
[0m15:06:38.194410 [debug] [Thread-2 (]: Database Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)
  CREATE VIEW columns must be named, but column 2 has no name at [6:6]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:06:38.194854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1a5f0>]}
[0m15:06:38.195323 [error] [Thread-2 (]: 4 of 6 ERROR creating sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[31mERROR[0m in 1.81s]
[0m15:06:38.195839 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:06:38.196200 [debug] [Thread-2 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:06:38.196370 [info ] [Thread-2 (]: 6 of 6 SKIP relation dbt_rsdun.community_viewed_articles ....................... [[33mSKIP[0m]
[0m15:06:38.196654 [debug] [Thread-2 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:06:40.313873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:83eb75ba-59ba-4bdf-b2dc-fb70462493fb:europe-west1&page=queryresults
[0m15:06:40.316292 [debug] [Thread-1 (]: finished collecting timing info
[0m15:06:40.317060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7df88b9-ae43-4ad0-855f-fb4e38feb40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a69000>]}
[0m15:06:40.317472 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.36s]
[0m15:06:40.317985 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m15:06:40.319039 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:06:40.319430 [info ] [MainThread]: 
[0m15:06:40.319591 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m15:06:40.319720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:40.319787 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:06:40.319855 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:06:40.325453 [info ] [MainThread]: 
[0m15:06:40.325694 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:06:40.325851 [info ] [MainThread]: 
[0m15:06:40.325971 [error] [MainThread]: [33mDatabase Error in model stg_segment_android__community_viewed_article (models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql)[0m
[0m15:06:40.326089 [error] [MainThread]:   Syntax error: Expected end of input but got ";" at [7:83]
[0m15:06:40.326202 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:06:40.326325 [info ] [MainThread]: 
[0m15:06:40.326441 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)[0m
[0m15:06:40.326574 [error] [MainThread]:   CREATE VIEW columns must be named, but column 2 has no name at [6:6]
[0m15:06:40.326690 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:06:40.326813 [info ] [MainThread]: 
[0m15:06:40.326940 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m15:06:40.327120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a18580>]}
[0m15:06:40.327275 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:07:48.469792 | e900d1d1-e96d-40f4-a2ea-c8d5c13b9814 ==============================
[0m15:07:48.469830 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:07:48.470683 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:07:48.470819 [debug] [MainThread]: Tracking: tracking
[0m15:07:48.480220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a871600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8714e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a870eb0>]}
[0m15:07:48.516950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:48.517201 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:07:48.523656 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:07:48.536475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m15:07:48.539156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6b820>]}
[0m15:07:48.543367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f12d0>]}
[0m15:07:48.543513 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:07:48.543646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a2c50>]}
[0m15:07:48.544351 [info ] [MainThread]: 
[0m15:07:48.544658 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:07:48.545178 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:07:48.545299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:49.113424 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:07:49.113684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:49.505114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6cd90>]}
[0m15:07:49.506339 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:07:49.506865 [info ] [MainThread]: 
[0m15:07:49.510418 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:49.510548 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:07:49.510771 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:07:49.510951 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:07:49.511553 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:07:49.511952 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:07:49.512061 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:49.512177 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:07:49.512294 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:07:49.512402 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:07:49.513760 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:07:49.515010 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:07:49.515791 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:49.515943 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:07:49.516057 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:49.517076 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:49.541963 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:07:49.542571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:49.543420 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:07:49.620126 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:07:49.621115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:49.621799 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:07:50.668228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b94b8cdc-e01f-4368-b876-775eb0453a35:europe-west1&page=queryresults
[0m15:07:50.688069 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:50.688762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab33a90>]}
[0m15:07:50.689104 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m15:07:50.689493 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:50.689656 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:50.689926 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:07:50.690535 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:07:50.690680 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:50.690812 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:50.692492 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:07:50.694305 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:50.694461 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:50.696892 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:07:50.697392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:50.698554 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:07:50.743119 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dd53da10-2724-403f-8b7f-d85acc653de7:europe-west1&page=queryresults
[0m15:07:50.744161 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:50.744494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10829cac0>]}
[0m15:07:50.744652 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m15:07:50.744844 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:07:50.744931 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:50.745084 [info ] [Thread-2 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:07:50.745534 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:07:50.745755 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:50.745917 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:50.746879 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:07:50.747214 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:50.747290 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:50.748708 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:07:50.748905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:50.749547 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp), reading_session, category, clinic_id, user_id 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:07:51.599442 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW columns must be named, but column 2 has no name at [6:6]')
[0m15:07:51.790797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b07bcbf7-2dec-413d-91aa-916eb6b4d5c1:europe-west1&page=queryresults
[0m15:07:51.793716 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:51.794691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a841660>]}
[0m15:07:51.795213 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m15:07:51.795728 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:51.795960 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m15:07:51.796191 [info ] [Thread-1 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:07:51.797414 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:07:51.797656 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m15:07:51.797843 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m15:07:51.802196 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:07:51.804308 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:51.804614 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m15:07:51.819758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:52.277621 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:07:52.278823 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:07:53.020702 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:b2243c7f-71a8-4fb3-8270-76312ce4274b&page=queryresults
[0m15:07:53.021176 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:53.021669 [debug] [Thread-2 (]: Database Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)
  CREATE VIEW columns must be named, but column 2 has no name at [6:6]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:07:53.021869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa95660>]}
[0m15:07:53.022152 [error] [Thread-2 (]: 4 of 6 ERROR creating sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[31mERROR[0m in 2.28s]
[0m15:07:53.022440 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:53.022802 [debug] [Thread-2 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:07:53.022976 [info ] [Thread-2 (]: 6 of 6 SKIP relation dbt_rsdun.community_viewed_articles ....................... [[33mSKIP[0m]
[0m15:07:53.023254 [debug] [Thread-2 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:07:55.016728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0fc876b5-1cd0-49f8-b65e-47631773aebc:europe-west1&page=queryresults
[0m15:07:55.020968 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:55.022130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e900d1d1-e96d-40f4-a2ea-c8d5c13b9814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106964310>]}
[0m15:07:55.022679 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.23s]
[0m15:07:55.023176 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m15:07:55.024886 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:07:55.025569 [info ] [MainThread]: 
[0m15:07:55.025879 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m15:07:55.026157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:55.026297 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:07:55.026431 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:07:55.035880 [info ] [MainThread]: 
[0m15:07:55.036317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:55.036575 [info ] [MainThread]: 
[0m15:07:55.036765 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)[0m
[0m15:07:55.036942 [error] [MainThread]:   CREATE VIEW columns must be named, but column 2 has no name at [6:6]
[0m15:07:55.037116 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:07:55.037300 [info ] [MainThread]: 
[0m15:07:55.037478 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m15:07:55.037725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb9ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab335e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa95d50>]}
[0m15:07:55.037925 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:08:19.004126 | 5e325de1-eb0b-4a02-bed7-aff048e85f71 ==============================
[0m15:08:19.004150 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:08:19.004790 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__community_viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:08:19.004908 [debug] [MainThread]: Tracking: tracking
[0m15:08:19.017470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1d4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1ceb0>]}
[0m15:08:19.051899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:19.052045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:19.052335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:08:19.055441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e325de1-eb0b-4a02-bed7-aff048e85f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e19e70>]}
[0m15:08:19.060173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e325de1-eb0b-4a02-bed7-aff048e85f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de6a40>]}
[0m15:08:19.060390 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:08:19.060527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e325de1-eb0b-4a02-bed7-aff048e85f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cf0d0>]}
[0m15:08:19.061204 [info ] [MainThread]: 
[0m15:08:19.061537 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:08:19.061998 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:08:19.062134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:19.591841 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:08:19.592285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:19.985183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e325de1-eb0b-4a02-bed7-aff048e85f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e18dc0>]}
[0m15:08:19.987227 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:08:19.987813 [info ] [MainThread]: 
[0m15:08:19.994707 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:19.995201 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:08:19.996052 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:19.996251 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:19.996444 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:20.004066 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:20.004730 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:20.004876 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:20.029450 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:20.029831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:20.030596 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp), reading_session, category, clinic_id, user_id 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:08:20.967148 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW columns must be named, but column 2 has no name at [6:6]')
[0m15:08:22.423921 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:a884c363-e4f3-49fd-8397-936066a3f457&page=queryresults
[0m15:08:22.425910 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:22.427077 [debug] [Thread-1 (]: Database Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)
  CREATE VIEW columns must be named, but column 2 has no name at [6:6]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:08:22.427523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e325de1-eb0b-4a02-bed7-aff048e85f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec55d0>]}
[0m15:08:22.428091 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[31mERROR[0m in 2.43s]
[0m15:08:22.428677 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:22.430357 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:08:22.431081 [info ] [MainThread]: 
[0m15:08:22.431430 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m15:08:22.431740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:22.431899 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:08:22.442204 [info ] [MainThread]: 
[0m15:08:22.442548 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:22.442791 [info ] [MainThread]: 
[0m15:08:22.442992 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)[0m
[0m15:08:22.443189 [error] [MainThread]:   CREATE VIEW columns must be named, but column 2 has no name at [6:6]
[0m15:08:22.443372 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:08:22.443567 [info ] [MainThread]: 
[0m15:08:22.443903 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:08:22.444342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c2c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bef550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd99f0>]}
[0m15:08:22.444577 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:08:44.458733 | 04b1a00d-a91e-4e93-b974-749e379543d4 ==============================
[0m15:08:44.458944 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:08:44.462555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__community_viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:08:44.462710 [debug] [MainThread]: Tracking: tracking
[0m15:08:44.473768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727d120>]}
[0m15:08:44.509196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:44.509487 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:08:44.517289 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:08:44.530022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m15:08:44.532634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04b1a00d-a91e-4e93-b974-749e379543d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747f010>]}
[0m15:08:44.536731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04b1a00d-a91e-4e93-b974-749e379543d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e7a00>]}
[0m15:08:44.536864 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:08:44.536986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04b1a00d-a91e-4e93-b974-749e379543d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102502c50>]}
[0m15:08:44.537601 [info ] [MainThread]: 
[0m15:08:44.537929 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:08:44.538374 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:08:44.538487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:45.154934 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:08:45.155490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:45.484606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04b1a00d-a91e-4e93-b974-749e379543d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105274d90>]}
[0m15:08:45.485845 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:08:45.486240 [info ] [MainThread]: 
[0m15:08:45.492693 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:45.493226 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:08:45.494056 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:45.494253 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:45.494449 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:45.496680 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:45.497499 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:45.497714 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:45.561661 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:45.562067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:45.562748 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:08:46.897591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a391c693-2f7b-4133-9806-16a3bf154d6a:europe-west1&page=queryresults
[0m15:08:46.907495 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:46.907861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b1a00d-a91e-4e93-b974-749e379543d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020a4a00>]}
[0m15:08:46.908044 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m15:08:46.908262 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:46.909028 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:08:46.909291 [info ] [MainThread]: 
[0m15:08:46.909431 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m15:08:46.909553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:46.909615 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:08:46.915198 [info ] [MainThread]: 
[0m15:08:46.915424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:46.915565 [info ] [MainThread]: 
[0m15:08:46.915696 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:46.915877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d19ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105108340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e73d30>]}
[0m15:08:46.916017 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:08:51.215784 | e5fcb440-9cc0-418b-9c7e-d142ff1156c7 ==============================
[0m15:08:51.215828 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:08:51.216435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:08:51.216611 [debug] [MainThread]: Tracking: tracking
[0m15:08:51.224538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108525690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108525570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108524f40>]}
[0m15:08:51.252627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:51.252814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:51.253088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m15:08:51.256346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108725f90>]}
[0m15:08:51.261206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086eebc0>]}
[0m15:08:51.261484 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:08:51.261641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104acb0d0>]}
[0m15:08:51.262496 [info ] [MainThread]: 
[0m15:08:51.262875 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:08:51.263448 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:08:51.263542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:52.044341 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:08:52.044927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:52.466515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724d60>]}
[0m15:08:52.468022 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:08:52.468445 [info ] [MainThread]: 
[0m15:08:52.474253 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:08:52.474537 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:08:52.474874 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:08:52.475156 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:08:52.476063 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:08:52.476629 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:08:52.476789 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:08:52.476919 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:08:52.477086 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:08:52.477210 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:08:52.480721 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:08:52.488540 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:08:52.488942 [debug] [Thread-2 (]: finished collecting timing info
[0m15:08:52.489127 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:08:52.489245 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:52.510832 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:08:52.510963 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:08:52.512843 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:08:52.513123 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:52.513267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:52.514072 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:08:52.514855 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:08:53.348204 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:94dd2244-5e70-48f5-8e66-b577e550ca17:europe-west1&page=queryresults
[0m15:08:53.362067 [debug] [Thread-2 (]: finished collecting timing info
[0m15:08:53.362616 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108538a30>]}
[0m15:08:53.362878 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m15:08:53.363189 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:08:53.363325 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:08:53.363646 [info ] [Thread-2 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:08:53.364388 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:08:53.364549 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:08:53.364686 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:08:53.366417 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:08:53.366902 [debug] [Thread-2 (]: finished collecting timing info
[0m15:08:53.367056 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:08:53.369343 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:08:53.369718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:53.370744 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:08:53.585213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8ee8a978-9880-4173-ab7a-2deb1807879f:europe-west1&page=queryresults
[0m15:08:53.587821 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:53.588533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f99f0>]}
[0m15:08:53.588906 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m15:08:53.589323 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:08:53.589501 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:53.589810 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:08:53.590627 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:53.590816 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:53.590972 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:53.593032 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:53.595735 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:53.595992 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:53.645389 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:08:53.645788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:53.646508 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:08:54.365872 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:802d4cc2-a679-460f-8f12-075c41d5765c:europe-west1&page=queryresults
[0m15:08:54.368636 [debug] [Thread-2 (]: finished collecting timing info
[0m15:08:54.369493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0dd20>]}
[0m15:08:54.369994 [info ] [Thread-2 (]: 3 of 6 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:08:54.370569 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:08:54.370823 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:08:54.371236 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:08:54.371987 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:08:54.372177 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:08:54.372339 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:08:54.376737 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:08:54.378907 [debug] [Thread-2 (]: finished collecting timing info
[0m15:08:54.379080 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:08:54.387145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:54.436451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1386f9b3-7c60-4740-a9cb-ef12ef14c3ca:europe-west1&page=queryresults
[0m15:08:54.437485 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:54.437864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac9f90>]}
[0m15:08:54.438211 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m15:08:54.438537 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:08:54.438744 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:08:54.438850 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:08:54.439125 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:08:54.439201 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:08:54.439271 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:08:54.441088 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:08:54.441930 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:54.442037 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:08:54.450363 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:08:54.450713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:54.451372 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      


SELECT slug, original_timestamp, category, user_id
FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

UNION

SELECT slug, original_timestamp, category, user_id
FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
    );
  
[0m15:08:54.998461 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:08:54.999713 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:08:55.185390 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [19:1]')
[0m15:08:56.334143 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:1926aeaa-8296-4107-9057-2361076550d9&page=queryresults
[0m15:08:56.334640 [debug] [Thread-1 (]: finished collecting timing info
[0m15:08:56.335161 [debug] [Thread-1 (]: Database Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [19:1]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:08:56.335374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3c2e0>]}
[0m15:08:56.335676 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model dbt_rsdun.community_viewed_articles ...... [[31mERROR[0m in 1.90s]
[0m15:08:56.336011 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:08:57.940883 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0e73168b-32aa-48ad-af5d-8fc24187990d:europe-west1&page=queryresults
[0m15:08:57.945900 [debug] [Thread-2 (]: finished collecting timing info
[0m15:08:57.946963 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5fcb440-9cc0-418b-9c7e-d142ff1156c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108533d60>]}
[0m15:08:57.947501 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.58s]
[0m15:08:57.948100 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:08:57.949992 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:08:57.950705 [info ] [MainThread]: 
[0m15:08:57.951018 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m15:08:57.951287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:57.951424 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:08:57.951553 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:08:57.967430 [info ] [MainThread]: 
[0m15:08:57.967758 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:57.967992 [info ] [MainThread]: 
[0m15:08:57.968182 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)[0m
[0m15:08:57.968694 [error] [MainThread]:   Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [19:1]
[0m15:08:57.968894 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:08:57.969098 [info ] [MainThread]: 
[0m15:08:57.969285 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m15:08:57.969586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f54ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899a3b0>]}
[0m15:08:57.970087 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:09:41.808444 | 90f96bb3-fbfa-494f-a834-4c7859905448 ==============================
[0m15:09:41.808515 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:09:41.809318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:09:41.809412 [debug] [MainThread]: Tracking: tracking
[0m15:09:41.822497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe4f40>]}
[0m15:09:41.855728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:41.855956 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:09:41.862503 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:09:41.875247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m15:09:41.877814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e7910>]}
[0m15:09:41.881741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106192d70>]}
[0m15:09:41.881870 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:09:41.881996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10258aaa0>]}
[0m15:09:41.882728 [info ] [MainThread]: 
[0m15:09:41.883057 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:09:41.883619 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:09:41.883748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:42.420464 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:09:42.421028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:42.770022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e0df0>]}
[0m15:09:42.771161 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:09:42.771560 [info ] [MainThread]: 
[0m15:09:42.776694 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:09:42.776907 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:09:42.777316 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:09:42.777616 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:09:42.778578 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:09:42.779340 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:09:42.779565 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:09:42.779735 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:09:42.779945 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:09:42.780106 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:09:42.782235 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:09:42.784035 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:09:42.785091 [debug] [Thread-2 (]: finished collecting timing info
[0m15:09:42.785226 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:42.785377 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:09:42.785538 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:09:42.810862 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:09:42.811332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:42.849903 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:09:42.850577 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:09:42.886147 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:09:42.886797 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:09:43.975453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ba0a63aa-9c35-4318-b721-6f381cf77631:europe-west1&page=queryresults
[0m15:09:43.995538 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:43.996659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b7e80>]}
[0m15:09:43.997513 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3feed405-9210-46a4-9428-c919091d9dac:europe-west1&page=queryresults
[0m15:09:43.997918 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m15:09:43.999258 [debug] [Thread-2 (]: finished collecting timing info
[0m15:09:43.999746 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:09:44.000227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b96320>]}
[0m15:09:44.000675 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:09:44.001285 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m15:09:44.001531 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:09:44.001891 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:09:44.002364 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:09:44.002526 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:09:44.002854 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:09:44.003041 [info ] [Thread-2 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:09:44.003177 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:09:44.003593 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:09:44.005568 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:09:44.005827 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:09:44.006119 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:09:44.007498 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:09:44.007850 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:44.007991 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:09:44.008090 [debug] [Thread-2 (]: finished collecting timing info
[0m15:09:44.010300 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:09:44.010462 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:09:44.012551 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:09:44.012797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:44.013722 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:09:44.013824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:44.056628 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:09:45.166739 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3f7a8c54-b443-4ca6-b642-12efb0cf773b:europe-west1&page=queryresults
[0m15:09:45.170500 [debug] [Thread-2 (]: finished collecting timing info
[0m15:09:45.171544 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f4cd0>]}
[0m15:09:45.172060 [info ] [Thread-2 (]: 4 of 6 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m15:09:45.172544 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:09:45.172752 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:09:45.173097 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:09:45.173853 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:09:45.174052 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:09:45.174232 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:09:45.178642 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:09:45.180664 [debug] [Thread-2 (]: finished collecting timing info
[0m15:09:45.180856 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:09:45.189241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e9d8c171-be39-46ce-9ffc-0e78cc4f4d90:europe-west1&page=queryresults
[0m15:09:45.192531 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:45.193154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f69e0>]}
[0m15:09:45.193431 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m15:09:45.193907 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:09:45.195516 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:09:45.201572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:45.201739 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:09:45.202256 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:09:45.202389 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:09:45.245533 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:09:45.250596 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:09:45.250998 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:45.251124 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:09:45.259519 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:09:45.260113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:45.260820 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      


SELECT slug, original_timestamp, category, user_id
FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

UNION ALL

SELECT slug, original_timestamp, category, user_id
FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
    );
  
[0m15:09:46.111359 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:09:46.113936 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:09:48.373185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:62e16c5b-cd47-428d-ade4-7ada44c9e70f:europe-west1&page=queryresults
[0m15:09:48.376129 [debug] [Thread-1 (]: finished collecting timing info
[0m15:09:48.377089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe6410>]}
[0m15:09:48.377610 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dbt_rsdun.community_viewed_articles .......... [[32mCREATE TABLE (1.5k rows, 403.2 KB processed)[0m in 3.17s]
[0m15:09:48.378213 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:09:50.236291 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2d894ccd-30d5-473d-96b3-6942ccbff372:europe-west1&page=queryresults
[0m15:09:50.239893 [debug] [Thread-2 (]: finished collecting timing info
[0m15:09:50.240947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f96bb3-fbfa-494f-a834-4c7859905448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f67d0>]}
[0m15:09:50.241506 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 5.07s]
[0m15:09:50.242115 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:09:50.243926 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:09:50.244615 [info ] [MainThread]: 
[0m15:09:50.244939 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m15:09:50.245202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:50.245335 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:09:50.245462 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:09:50.254776 [info ] [MainThread]: 
[0m15:09:50.255010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:50.255149 [info ] [MainThread]: 
[0m15:09:50.255321 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:09:50.255625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106363310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106351fc0>]}
[0m15:09:50.255868 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:17:05.502230 | 7dea820e-2f0a-4ce6-89d5-1f540e89937a ==============================
[0m15:17:05.502270 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:17:05.503659 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:17:05.503776 [debug] [MainThread]: Tracking: tracking
[0m15:17:05.520766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af4e80>]}
[0m15:17:05.554041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:05.554274 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:17:05.562103 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:17:05.575467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m15:17:05.578303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dea820e-2f0a-4ce6-89d5-1f540e89937a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cf77f0>]}
[0m15:17:05.585159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dea820e-2f0a-4ce6-89d5-1f540e89937a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ca2c50>]}
[0m15:17:05.585404 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:17:05.585541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dea820e-2f0a-4ce6-89d5-1f540e89937a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b30d0>]}
[0m15:17:05.586218 [info ] [MainThread]: 
[0m15:17:05.586573 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:17:05.587715 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:17:05.587869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:06.763738 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:17:06.763963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:07.102338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dea820e-2f0a-4ce6-89d5-1f540e89937a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120978dc0>]}
[0m15:17:07.104006 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:17:07.104597 [info ] [MainThread]: 
[0m15:17:07.113656 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:17:07.113956 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:17:07.114435 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:17:07.114575 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:17:07.114687 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:17:07.117354 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:17:07.118289 [debug] [Thread-1 (]: finished collecting timing info
[0m15:17:07.118435 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:17:07.134496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:07.772909 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:17:07.773327 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      

SELECT event.slug, event.original_timestamp, event.category, event.user_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
)
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
    );
  
[0m15:17:08.609152 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event at [23:109]')
[0m15:17:09.788768 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:5c525d0e-bbc7-45c7-a15d-431b951c296c&page=queryresults
[0m15:17:09.790460 [debug] [Thread-1 (]: finished collecting timing info
[0m15:17:09.791819 [debug] [Thread-1 (]: Database Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)
  Unrecognized name: event at [23:109]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:17:09.792450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dea820e-2f0a-4ce6-89d5-1f540e89937a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12155a800>]}
[0m15:17:09.793060 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_rsdun.community_viewed_articles ...... [[31mERROR[0m in 2.68s]
[0m15:17:09.793663 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:17:09.795546 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:17:09.796279 [info ] [MainThread]: 
[0m15:17:09.796632 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m15:17:09.796938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:09.797072 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:17:09.807377 [info ] [MainThread]: 
[0m15:17:09.807699 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:17:09.807944 [info ] [MainThread]: 
[0m15:17:09.808150 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)[0m
[0m15:17:09.808358 [error] [MainThread]:   Unrecognized name: event at [23:109]
[0m15:17:09.808551 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:17:09.808883 [info ] [MainThread]: 
[0m15:17:09.809170 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:17:09.809430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106052650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122db7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121573430>]}
[0m15:17:09.809626 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:17:38.979684 | cbaf2ac8-7813-4c60-a4f3-3b6d4e8ddc9a ==============================
[0m15:17:38.979714 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:17:38.980338 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:17:38.980453 [debug] [MainThread]: Tracking: tracking
[0m15:17:38.987301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727d120>]}
[0m15:17:39.022166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:39.022415 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:17:39.029126 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:17:39.042089 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m15:17:39.045064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbaf2ac8-7813-4c60-a4f3-3b6d4e8ddc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f5db0>]}
[0m15:17:39.049675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbaf2ac8-7813-4c60-a4f3-3b6d4e8ddc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765f4f0>]}
[0m15:17:39.049860 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:17:39.049998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbaf2ac8-7813-4c60-a4f3-3b6d4e8ddc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b6c50>]}
[0m15:17:39.050616 [info ] [MainThread]: 
[0m15:17:39.050956 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:17:39.051440 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:17:39.051634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:40.194606 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:17:40.194985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:40.537650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbaf2ac8-7813-4c60-a4f3-3b6d4e8ddc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105374df0>]}
[0m15:17:40.538914 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:17:40.539310 [info ] [MainThread]: 
[0m15:17:40.545650 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:17:40.546126 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:17:40.546929 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:17:40.547125 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:17:40.547315 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:17:40.551630 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:17:40.552393 [debug] [Thread-1 (]: finished collecting timing info
[0m15:17:40.552566 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:17:40.569529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:41.176974 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:17:41.177371 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      

SELECT event.slug, event.original_timestamp, event.category, event.user_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
    );
  
[0m15:17:43.775113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a36069a5-2630-4101-b9f8-81f81a3704f6:europe-west1&page=queryresults
[0m15:17:43.795612 [debug] [Thread-1 (]: finished collecting timing info
[0m15:17:43.796330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbaf2ac8-7813-4c60-a4f3-3b6d4e8ddc9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2b7c0>]}
[0m15:17:43.796683 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_rsdun.community_viewed_articles .......... [[32mCREATE TABLE (1.5k rows, 498.6 KB processed)[0m in 3.25s]
[0m15:17:43.797083 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:17:43.798289 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:17:43.798775 [info ] [MainThread]: 
[0m15:17:43.799010 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m15:17:43.799214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:43.799315 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:17:43.805992 [info ] [MainThread]: 
[0m15:17:43.806234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:43.806427 [info ] [MainThread]: 
[0m15:17:43.806594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:43.806821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f56c0>]}
[0m15:17:43.806995 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:19:54.455816 | d3e7302d-f8d9-4403-9ceb-14dcd1b9123a ==============================
[0m15:19:54.455838 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:19:54.456475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:19:54.456564 [debug] [MainThread]: Tracking: tracking
[0m15:19:54.467056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efa560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef9270>]}
[0m15:19:54.500226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m15:19:54.500468 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/schema.yml
[0m15:19:54.500606 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_ios__production_events/schema.yml
[0m15:19:54.500729 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:19:54.500831 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:19:54.500927 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:19:54.508181 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:19:54.513699 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:19:54.515050 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:19:54.520330 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m15:19:54.530846 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_ios__community_viewed_article' in the 'models' section of file 'models/staging/segment_ios__production_events/schema.yml'
[0m15:19:54.537601 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_slug.01cb357c20' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:19:54.537819 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_slug.c394d06565' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:19:54.537926 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_original_timestamp.f45027f819' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:19:54.538029 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_original_timestamp.42ba45d2f8' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:19:54.538131 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_user_id.a07ae945b5' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:19:54.538229 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_user_id.75bc497418' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m15:19:54.538327 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_slug.8035cd1030' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:19:54.538428 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_slug.aef30b956f' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:19:54.538530 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_original_timestamp.17a3cd91f0' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:19:54.538628 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_original_timestamp.048440ddbc' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:19:54.538730 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_user_id.845753e1c8' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:19:54.538829 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_user_id.cc8a746681' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m15:19:54.546196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m15:19:54.549006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106186740>]}
[0m15:19:54.586798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d81210>]}
[0m15:19:54.587001 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:19:54.587133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c633a0>]}
[0m15:19:54.587846 [info ] [MainThread]: 
[0m15:19:54.588174 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:19:54.588716 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:19:54.588846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:55.565898 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:19:55.566530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:55.905172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc1ab0>]}
[0m15:19:55.906644 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:19:55.907088 [info ] [MainThread]: 
[0m15:19:55.913620 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:19:55.913849 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:19:55.914238 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:19:55.914483 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:19:55.915401 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:19:55.916449 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:19:55.916618 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:19:55.916824 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:19:55.917041 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:19:55.917198 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:19:55.918950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:19:55.920539 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:19:55.921773 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:55.921979 [debug] [Thread-2 (]: finished collecting timing info
[0m15:19:55.922132 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:19:55.922297 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:19:55.949407 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:19:55.949807 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:19:55.953261 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:19:55.954195 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:19:55.993845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:55.994595 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:19:57.341653 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c2ec88f5-b69d-489a-bc11-afda78629809:europe-west1&page=queryresults
[0m15:19:57.361429 [debug] [Thread-2 (]: finished collecting timing info
[0m15:19:57.362275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5be1a73e-e224-4bdb-8e36-5c0b9e1b307e:europe-west1&page=queryresults
[0m15:19:57.362914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f04a90>]}
[0m15:19:57.364227 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:57.364614 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:19:57.365058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec9540>]}
[0m15:19:57.365502 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:19:57.365764 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:19:57.365981 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:19:57.366658 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:19:57.366979 [info ] [Thread-2 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:19:57.367150 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:19:57.367712 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:19:57.367916 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:19:57.368275 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:19:57.368853 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:19:57.368986 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:19:57.369091 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:19:57.370779 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:19:57.370994 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:19:57.372297 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:19:57.372580 [debug] [Thread-2 (]: finished collecting timing info
[0m15:19:57.372718 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:57.372836 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:19:57.372955 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:19:57.375071 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:19:57.376856 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:19:57.377214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:19:57.377330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:57.378268 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:19:57.379119 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:19:58.326861 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column referrer which is neither grouped nor aggregated at [6:113]')
[0m15:19:58.622453 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:719e1878-363b-4aec-b484-83e95c30ddc8:europe-west1&page=queryresults
[0m15:19:58.624274 [debug] [Thread-2 (]: finished collecting timing info
[0m15:19:58.624813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106121360>]}
[0m15:19:58.625095 [info ] [Thread-2 (]: 3 of 6 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m15:19:58.625411 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:19:58.625556 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:19:58.625720 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:19:58.626905 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:19:58.627239 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:19:58.627469 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:19:58.631721 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:19:58.632689 [debug] [Thread-2 (]: finished collecting timing info
[0m15:19:58.632907 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:19:58.640504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:19:59.296006 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:19:59.298284 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:19:59.910565 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:9fa4b35b-fbc6-4649-b4e3-89a06bf40864&page=queryresults
[0m15:19:59.912122 [debug] [Thread-1 (]: finished collecting timing info
[0m15:19:59.913360 [debug] [Thread-1 (]: Database Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)
  SELECT list expression references column referrer which is neither grouped nor aggregated at [6:113]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:19:59.913948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a6620>]}
[0m15:19:59.914542 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[31mERROR[0m in 2.55s]
[0m15:19:59.915141 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:19:59.915721 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:19:59.915938 [info ] [Thread-1 (]: 6 of 6 SKIP relation dbt_rsdun.community_viewed_articles ....................... [[33mSKIP[0m]
[0m15:19:59.916403 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:20:02.020589 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e257e84f-dbd9-4e63-bbcb-87d1385e7dce:europe-west1&page=queryresults
[0m15:20:02.023615 [debug] [Thread-2 (]: finished collecting timing info
[0m15:20:02.024493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e7302d-f8d9-4403-9ceb-14dcd1b9123a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106290220>]}
[0m15:20:02.024995 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.40s]
[0m15:20:02.025572 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:20:02.027219 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:02.027892 [info ] [MainThread]: 
[0m15:20:02.028214 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m15:20:02.028473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:02.028606 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:20:02.028734 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:20:02.039268 [info ] [MainThread]: 
[0m15:20:02.039555 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:02.039765 [info ] [MainThread]: 
[0m15:20:02.039944 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)[0m
[0m15:20:02.040119 [error] [MainThread]:   SELECT list expression references column referrer which is neither grouped nor aggregated at [6:113]
[0m15:20:02.040283 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:20:02.040458 [info ] [MainThread]: 
[0m15:20:02.040633 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m15:20:02.040898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106263fd0>]}
[0m15:20:02.041118 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:20:20.530520 | c2abcc30-824f-45a1-b59a-136b5cb4c00d ==============================
[0m15:20:20.530555 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:20:20.531179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__community_viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:20:20.531279 [debug] [MainThread]: Tracking: tracking
[0m15:20:20.538132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7d180>]}
[0m15:20:20.572894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:20.573042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:20.573309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m15:20:20.576356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2abcc30-824f-45a1-b59a-136b5cb4c00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e880d0>]}
[0m15:20:20.581272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2abcc30-824f-45a1-b59a-136b5cb4c00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d03df0>]}
[0m15:20:20.581462 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:20:20.581595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2abcc30-824f-45a1-b59a-136b5cb4c00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147f40>]}
[0m15:20:20.582280 [info ] [MainThread]: 
[0m15:20:20.582600 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:20.583029 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:20:20.583142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:21.542397 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:20:21.542951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:21.966638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2abcc30-824f-45a1-b59a-136b5cb4c00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107274df0>]}
[0m15:20:21.967408 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:20:21.967707 [info ] [MainThread]: 
[0m15:20:21.970951 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:20:21.971205 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:20:21.971695 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:20:21.971825 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:20:21.971950 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:20:21.973629 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:20:21.974346 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:21.974546 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:20:21.995985 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:20:21.996441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:21.997283 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id;


[0m15:20:22.981041 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column referrer which is neither grouped nor aggregated at [6:113]')
[0m15:20:24.007587 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:c04eed88-8f68-47ee-920c-40b6add3676c&page=queryresults
[0m15:20:24.008445 [debug] [Thread-1 (]: finished collecting timing info
[0m15:20:24.009280 [debug] [Thread-1 (]: Database Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)
  SELECT list expression references column referrer which is neither grouped nor aggregated at [6:113]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:20:24.009481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2abcc30-824f-45a1-b59a-136b5cb4c00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4ad70>]}
[0m15:20:24.009784 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[31mERROR[0m in 2.04s]
[0m15:20:24.010151 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:20:24.011530 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:20:24.011896 [info ] [MainThread]: 
[0m15:20:24.012221 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m15:20:24.012410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:24.012497 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:20:24.022442 [info ] [MainThread]: 
[0m15:20:24.022798 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:24.023062 [info ] [MainThread]: 
[0m15:20:24.023294 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)[0m
[0m15:20:24.023505 [error] [MainThread]:   SELECT list expression references column referrer which is neither grouped nor aggregated at [6:113]
[0m15:20:24.023701 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:20:24.023903 [info ] [MainThread]: 
[0m15:20:24.024119 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:20:24.024443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c889a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c88760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4ecb0>]}
[0m15:20:24.024704 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:21:31.963207 | 5331f212-d36a-44c3-8fa5-86d8743388ef ==============================
[0m15:21:31.963340 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:21:31.963939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__community_viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:21:31.964027 [debug] [MainThread]: Tracking: tracking
[0m15:21:31.974735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00cf40>]}
[0m15:21:32.025067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:32.025384 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:21:32.032926 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:21:32.047994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m15:21:32.051183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5331f212-d36a-44c3-8fa5-86d8743388ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2184c0>]}
[0m15:21:32.056359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5331f212-d36a-44c3-8fa5-86d8743388ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ab340>]}
[0m15:21:32.056593 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:21:32.056736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5331f212-d36a-44c3-8fa5-86d8743388ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ab3d0>]}
[0m15:21:32.057403 [info ] [MainThread]: 
[0m15:21:32.057744 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:21:32.058189 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:21:32.058322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:33.062104 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:21:33.062704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:33.418619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5331f212-d36a-44c3-8fa5-86d8743388ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820cdc0>]}
[0m15:21:33.419476 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:21:33.419683 [info ] [MainThread]: 
[0m15:21:33.425498 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:33.425897 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:21:33.426470 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:21:33.426621 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:33.426752 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:33.474333 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:21:33.475282 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:33.475390 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:33.491728 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:21:33.492253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:33.492983 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m15:21:34.987002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ce2ec363-d6a2-407d-a68e-b143164070d4:europe-west1&page=queryresults
[0m15:21:35.005801 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:35.006443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5331f212-d36a-44c3-8fa5-86d8743388ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a260760>]}
[0m15:21:35.006820 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m15:21:35.007222 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:35.008504 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:21:35.008989 [info ] [MainThread]: 
[0m15:21:35.009217 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m15:21:35.009408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:35.009507 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__community_viewed_article' was properly closed.
[0m15:21:35.017259 [info ] [MainThread]: 
[0m15:21:35.017526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:35.017748 [info ] [MainThread]: 
[0m15:21:35.017930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:35.018186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a22fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0159c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe2530>]}
[0m15:21:35.018372 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:21:40.466452 | 4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7 ==============================
[0m15:21:40.466497 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:21:40.467030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:21:40.467124 [debug] [MainThread]: Tracking: tracking
[0m15:21:40.475817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163f6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163f75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163f5270>]}
[0m15:21:40.508744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:40.508894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:40.509168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:21:40.512206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170080d0>]}
[0m15:21:40.517050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116717eb0>]}
[0m15:21:40.517274 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:21:40.517412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116717ee0>]}
[0m15:21:40.518205 [info ] [MainThread]: 
[0m15:21:40.518544 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:21:40.519162 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:21:40.519298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:41.451030 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:21:41.451619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:41.774456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113174d30>]}
[0m15:21:41.775778 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:21:41.776187 [info ] [MainThread]: 
[0m15:21:41.787134 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:21:41.787401 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:21:41.789835 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:21:41.790144 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:21:41.790908 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:21:41.791536 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:21:41.791717 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:21:41.791862 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:21:41.792019 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:21:41.792144 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:21:41.794002 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:21:41.795307 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:21:41.795956 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:41.796098 [debug] [Thread-2 (]: finished collecting timing info
[0m15:21:41.796218 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:21:41.796333 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:21:41.818943 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:21:41.820731 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:21:41.821129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:41.821236 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:21:41.822109 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:21:41.862505 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:21:43.206791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:312d95b2-b8d7-40b1-a824-20fc5caf2659:europe-west1&page=queryresults
[0m15:21:43.225963 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:43.226582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1170abd00>]}
[0m15:21:43.226948 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:21:43.227358 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:21:43.227532 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:21:43.227818 [info ] [Thread-1 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:21:43.228405 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:21:43.228555 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:21:43.228686 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:21:43.230455 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:21:43.231217 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:43.231349 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:21:43.276717 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0fca7ecb-5d0e-4faf-9a80-8e2a25af20cd:europe-west1&page=queryresults
[0m15:21:43.278487 [debug] [Thread-2 (]: finished collecting timing info
[0m15:21:43.279584 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:21:43.279859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11772ffd0>]}
[0m15:21:43.280077 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m15:21:43.280277 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:21:43.280386 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:43.280652 [info ] [Thread-2 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:21:43.280804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:43.281155 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:21:43.281288 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:43.281884 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:43.281976 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:21:43.283772 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:21:43.319989 [debug] [Thread-2 (]: finished collecting timing info
[0m15:21:43.320102 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:43.321664 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:21:43.321981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:21:43.322702 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m15:21:44.377617 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dc26bb7f-beda-4509-bad5-09ccdc9be082:europe-west1&page=queryresults
[0m15:21:44.381349 [debug] [Thread-2 (]: finished collecting timing info
[0m15:21:44.382203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11771e710>]}
[0m15:21:44.382742 [info ] [Thread-2 (]: 4 of 6 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m15:21:44.383291 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:21:44.383526 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:21:44.383899 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:21:44.384696 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:21:44.384906 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:21:44.385079 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:21:44.389260 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:21:44.391337 [debug] [Thread-2 (]: finished collecting timing info
[0m15:21:44.391542 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:21:44.401229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:21:44.447917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:44d633b0-c9d6-423f-ab42-b95d39c65746:europe-west1&page=queryresults
[0m15:21:44.449000 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:44.449340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167c22f0>]}
[0m15:21:44.449512 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m15:21:44.449718 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:21:44.450081 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:21:44.450513 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:21:44.450830 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:21:44.450903 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:21:44.450975 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:21:44.452794 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:21:44.453530 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:44.453629 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:21:44.454602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:44.858691 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:21:44.859707 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      

SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
    );
  
[0m15:21:44.921780 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:21:44.922526 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:21:47.587018 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6ce83ba9-8bdf-4265-a84c-0d2958de1ef3:europe-west1&page=queryresults
[0m15:21:47.600480 [debug] [Thread-1 (]: finished collecting timing info
[0m15:21:47.601310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117732380>]}
[0m15:21:47.601759 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dbt_rsdun.community_viewed_articles .......... [[32mCREATE TABLE (1.5k rows, 531.9 KB processed)[0m in 3.15s]
[0m15:21:47.602196 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:21:47.687435 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a831bfe3-0bc5-4c16-b4bf-e87c3c55c8cd:europe-west1&page=queryresults
[0m15:21:47.690084 [debug] [Thread-2 (]: finished collecting timing info
[0m15:21:47.690980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b833fa9-0f1f-4ab9-82bb-f3c0c348e4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117730b20>]}
[0m15:21:47.691463 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.31s]
[0m15:21:47.692013 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:21:47.693779 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:21:47.694424 [info ] [MainThread]: 
[0m15:21:47.694712 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m15:21:47.694968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:47.695103 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:21:47.695230 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:21:47.708546 [info ] [MainThread]: 
[0m15:21:47.708877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:47.709108 [info ] [MainThread]: 
[0m15:21:47.709298 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:21:47.709586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11772ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117733460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117731120>]}
[0m15:21:47.709799 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:25:11.865937 | 20487f7f-caaf-4ae6-8e12-6d36f8578994 ==============================
[0m15:25:11.866089 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:25:11.866855 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:25:11.866958 [debug] [MainThread]: Tracking: tracking
[0m15:25:11.877108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c92410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c93460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c91120>]}
[0m15:25:11.914187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:11.914427 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:25:11.921103 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:25:11.934478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m15:25:11.937197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7f970>]}
[0m15:25:11.942249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8a680>]}
[0m15:25:11.942451 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:25:11.942586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e52770>]}
[0m15:25:11.943317 [info ] [MainThread]: 
[0m15:25:11.943648 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:25:11.944180 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:25:11.944298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:12.655171 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:25:12.655756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:13.131087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e90d90>]}
[0m15:25:13.132216 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:25:13.132640 [info ] [MainThread]: 
[0m15:25:13.138007 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:25:13.138222 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:25:13.138626 [info ] [Thread-1 (]: 1 of 6 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:25:13.138940 [info ] [Thread-2 (]: 2 of 6 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:25:13.140903 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:25:13.143556 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:25:13.143814 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:25:13.145872 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:25:13.198255 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:25:13.198513 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:25:13.198608 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:25:13.198710 [debug] [Thread-2 (]: finished collecting timing info
[0m15:25:13.199663 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:25:13.199772 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:25:13.215566 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:25:13.215850 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:13.215932 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:25:13.217303 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:25:13.217422 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:25:13.218135 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:25:13.218210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:13.254032 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:25:14.391911 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a61c718e-1bb4-4eb6-8f30-3c6b12324c0e:europe-west1&page=queryresults
[0m15:25:14.412476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:93197397-716d-4553-899f-d12fd2cd7f48:europe-west1&page=queryresults
[0m15:25:14.412871 [debug] [Thread-2 (]: finished collecting timing info
[0m15:25:14.414135 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:14.414775 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db53c0>]}
[0m15:25:14.415185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db5540>]}
[0m15:25:14.415554 [info ] [Thread-2 (]: 2 of 6 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m15:25:14.415861 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m15:25:14.416312 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:25:14.416597 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:25:14.416766 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:25:14.417043 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:25:14.417294 [info ] [Thread-2 (]: 3 of 6 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:25:14.417571 [info ] [Thread-1 (]: 4 of 6 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:25:14.418034 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:25:14.418438 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:25:14.418591 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:25:14.418738 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:25:14.418863 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:25:14.418962 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:25:14.420587 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:25:14.421854 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:25:14.423913 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:14.424076 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:25:14.424163 [debug] [Thread-2 (]: finished collecting timing info
[0m15:25:14.425625 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:25:14.426990 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:25:14.431243 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:25:14.431426 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:14.432234 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:25:14.472502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:14.473548 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m15:25:15.540586 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9c7c2e6a-18bd-45af-b64e-92de1ab6ce61:europe-west1&page=queryresults
[0m15:25:15.544420 [debug] [Thread-2 (]: finished collecting timing info
[0m15:25:15.545290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe0070>]}
[0m15:25:15.545747 [info ] [Thread-2 (]: 3 of 6 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m15:25:15.546229 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:25:15.546458 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:25:15.546801 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:25:15.547619 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:25:15.547820 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:25:15.547998 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:25:15.552300 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:25:15.554339 [debug] [Thread-2 (]: finished collecting timing info
[0m15:25:15.554564 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:25:15.564882 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:15.612140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dab44743-9cfb-405d-9171-d05113cc75cf:europe-west1&page=queryresults
[0m15:25:15.613065 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:15.613364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db5990>]}
[0m15:25:15.613576 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m15:25:15.613902 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:25:15.614207 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:25:15.614346 [info ] [Thread-1 (]: 6 of 6 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:25:15.614664 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:25:15.614750 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:25:15.614822 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:25:15.616820 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:25:15.619780 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:15.619911 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:25:15.621005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:16.000978 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:25:16.002010 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:25:16.010664 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:25:16.011108 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      

SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, event.clinic_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
    );
  
[0m15:25:16.686908 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name clinic_id not found inside event at [13:99]')
[0m15:25:17.786767 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:12fc7e4f-eccc-431d-8e51-636afc654a4b&page=queryresults
[0m15:25:17.788726 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:17.790270 [debug] [Thread-1 (]: Database Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)
  Name clinic_id not found inside event at [13:99]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:25:17.790924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e10a00>]}
[0m15:25:17.791598 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model dbt_rsdun.community_viewed_articles ...... [[31mERROR[0m in 2.18s]
[0m15:25:17.792395 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:25:19.697365 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d49c08e7-ebf4-498c-8abf-3e16f2ae1ff5:europe-west1&page=queryresults
[0m15:25:19.702657 [debug] [Thread-2 (]: finished collecting timing info
[0m15:25:19.703739 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20487f7f-caaf-4ae6-8e12-6d36f8578994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684dba0>]}
[0m15:25:19.704260 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 4.16s]
[0m15:25:19.704839 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:25:19.706607 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:25:19.707345 [info ] [MainThread]: 
[0m15:25:19.707661 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m15:25:19.707928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:19.708066 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:25:19.708205 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:25:19.732797 [info ] [MainThread]: 
[0m15:25:19.733220 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:19.733444 [info ] [MainThread]: 
[0m15:25:19.733618 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)[0m
[0m15:25:19.733782 [error] [MainThread]:   Name clinic_id not found inside event at [13:99]
[0m15:25:19.733930 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:25:19.734093 [info ] [MainThread]: 
[0m15:25:19.734250 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m15:25:19.734471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043545b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d59ab0>]}
[0m15:25:19.734656 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:25:42.134095 | fdaed56b-5d9c-410a-93bb-83967371d394 ==============================
[0m15:25:42.134139 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:25:42.136053 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:25:42.136190 [debug] [MainThread]: Tracking: tracking
[0m15:25:42.146406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a700a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a700bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a700c70>]}
[0m15:25:42.180119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:42.180268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:42.180537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m15:25:42.183636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdaed56b-5d9c-410a-93bb-83967371d394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9080d0>]}
[0m15:25:42.189773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdaed56b-5d9c-410a-93bb-83967371d394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a803700>]}
[0m15:25:42.189992 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:25:42.190135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdaed56b-5d9c-410a-93bb-83967371d394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063afbe0>]}
[0m15:25:42.190795 [info ] [MainThread]: 
[0m15:25:42.191150 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:25:42.191609 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:25:42.191748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:43.255967 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:25:43.256553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:43.640713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdaed56b-5d9c-410a-93bb-83967371d394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f0dc0>]}
[0m15:25:43.641466 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:25:43.641753 [info ] [MainThread]: 
[0m15:25:43.650398 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:25:43.650696 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:25:43.651270 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:25:43.651407 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:25:43.651533 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:25:43.656219 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:25:43.656664 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:43.656792 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:25:43.668054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:44.028353 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:25:44.029118 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      

SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, event.clinic_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
    );
  
[0m15:25:44.810658 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name clinic_id not found inside event at [13:99]')
[0m15:25:46.097904 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:a05d20da-8f41-4e02-a4b3-9d4687052899&page=queryresults
[0m15:25:46.099323 [debug] [Thread-1 (]: finished collecting timing info
[0m15:25:46.101026 [debug] [Thread-1 (]: Database Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)
  Name clinic_id not found inside event at [13:99]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:25:46.101628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdaed56b-5d9c-410a-93bb-83967371d394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c6aa0>]}
[0m15:25:46.102425 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_rsdun.community_viewed_articles ...... [[31mERROR[0m in 2.45s]
[0m15:25:46.103227 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:25:46.105202 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:25:46.105874 [info ] [MainThread]: 
[0m15:25:46.106176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m15:25:46.106438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:46.106573 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:25:46.117787 [info ] [MainThread]: 
[0m15:25:46.118139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:46.118385 [info ] [MainThread]: 
[0m15:25:46.118595 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles (models/marts/community_viewed_articles.sql)[0m
[0m15:25:46.118800 [error] [MainThread]:   Name clinic_id not found inside event at [13:99]
[0m15:25:46.118993 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles.sql
[0m15:25:46.119188 [info ] [MainThread]: 
[0m15:25:46.119388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:46.119679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a801f30>]}
[0m15:25:46.119919 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:26:33.482500 | 3ed4ed30-0292-4635-abe1-79ad5396cd7f ==============================
[0m15:26:33.482527 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:26:33.483263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:26:33.483376 [debug] [MainThread]: Tracking: tracking
[0m15:26:33.493975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640d3c0>]}
[0m15:26:33.530106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:33.530378 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:26:33.538091 [debug] [MainThread]: 1699: static parser successfully parsed marts/community_viewed_articles.sql
[0m15:26:33.551433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m15:26:33.554093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ed4ed30-0292-4635-abe1-79ad5396cd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661c040>]}
[0m15:26:33.559240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ed4ed30-0292-4635-abe1-79ad5396cd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104506890>]}
[0m15:26:33.559412 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:26:33.559540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ed4ed30-0292-4635-abe1-79ad5396cd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065caad0>]}
[0m15:26:33.560180 [info ] [MainThread]: 
[0m15:26:33.560505 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:26:33.561041 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:26:33.561155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:34.780406 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:26:34.780871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:35.228701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ed4ed30-0292-4635-abe1-79ad5396cd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640d2a0>]}
[0m15:26:35.230026 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:26:35.230446 [info ] [MainThread]: 
[0m15:26:35.236942 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles
[0m15:26:35.237403 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_rsdun.community_viewed_articles ............... [RUN]
[0m15:26:35.238186 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles"
[0m15:26:35.238383 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles
[0m15:26:35.238578 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles
[0m15:26:35.291985 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles"
[0m15:26:35.293243 [debug] [Thread-1 (]: finished collecting timing info
[0m15:26:35.293352 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles
[0m15:26:35.301217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:35.704012 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles"
[0m15:26:35.704902 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles`
    
    
    OPTIONS()
    as (
      

SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, event.clinic_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
    );
  
[0m15:26:38.168056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fb65e3f1-aa6e-465b-8be7-362140e6db94:europe-west1&page=queryresults
[0m15:26:38.189263 [debug] [Thread-1 (]: finished collecting timing info
[0m15:26:38.190005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ed4ed30-0292-4635-abe1-79ad5396cd7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106663cd0>]}
[0m15:26:38.190383 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_rsdun.community_viewed_articles .......... [[32mCREATE TABLE (1.5k rows, 531.9 KB processed)[0m in 2.95s]
[0m15:26:38.190769 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles
[0m15:26:38.192105 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:26:38.192560 [info ] [MainThread]: 
[0m15:26:38.192781 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m15:26:38.192973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:38.193079 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles' was properly closed.
[0m15:26:38.200649 [info ] [MainThread]: 
[0m15:26:38.200900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:38.201098 [info ] [MainThread]: 
[0m15:26:38.201261 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:38.201484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065db940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066311b0>]}
[0m15:26:38.201671 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:39:58.321965 | 47cd7c93-5b81-4011-be35-5d1e0bcb59a1 ==============================
[0m15:39:58.322086 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:39:58.322814 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:58.322921 [debug] [MainThread]: Tracking: tracking
[0m15:39:58.333084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086425c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108643610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086412d0>]}
[0m15:39:58.367539 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:39:58.367744 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:39:58.367820 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:39:58.373933 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:39:58.375731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108828490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885b340>]}
[0m15:39:58.375873 [debug] [MainThread]: Flushing usage events
[0m15:39:58.935720 [error] [MainThread]: Encountered an error:
keyword argument repeated: materialized (<template>, line 15)
[0m15:39:58.942291 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/main.py", line 135, in main
    results, succeeded = handle_and_check(args)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/main.py", line 198, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/main.py", line 245, in run_from_args
    results = task.run()
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/task/runnable.py", line 453, in run
    self._runtime_initialize()
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/task/runnable.py", line 161, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/task/runnable.py", line 94, in _runtime_initialize
    self.load_manifest()
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 221, in get_full_manifest
    manifest = loader.load()
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 351, in load
    self.parse_project(
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 479, in parse_project
    parser.parse_file(block)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/base.py", line 414, in parse_file
    self.parse_node(file_block)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/base.py", line 388, in parse_node
    self.render_update(node, config)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/models.py", line 337, in render_update
    super().render_update(node, config)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/base.py", line 363, in render_update
    context = self.render_with_context(node, config)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/parser/base.py", line 242, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/clients/jinja.py", line 580, in get_rendered
    template = get_template(
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/clients/jinja.py", line 537, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/jinja2/environment.py", line 766, in compile
    return self._compile(source, filename)
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/dbt/clients/jinja.py", line 103, in _compile
    return super()._compile(source, filename)  # type: ignore
  File "/Users/regitzesdun/Repos_wawa/wawa-dbt/.dbtenv/lib/python3.10/site-packages/jinja2/environment.py", line 704, in _compile
    return compile(source, filename, "exec")  # type: ignore
  File "<template>", line 15
SyntaxError: keyword argument repeated: materialized



============================== 2022-12-08 15:40:28.334343 | f5f2d76b-a685-44d9-8b3b-9f23d07d91f3 ==============================
[0m15:40:28.334389 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:40:28.335174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:40:28.335404 [debug] [MainThread]: Tracking: tracking
[0m15:40:28.344307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12507d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12507d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12507cf40>]}
[0m15:40:28.385348 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:40:28.385575 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:40:28.385656 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/marts/community_viewed_articles.sql
[0m15:40:28.391881 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:40:28.400993 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:40:28.412134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:40:28.414937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f2d76b-a685-44d9-8b3b-9f23d07d91f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125406d10>]}
[0m15:40:28.419718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5f2d76b-a685-44d9-8b3b-9f23d07d91f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253c3010>]}
[0m15:40:28.419969 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:40:28.420133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f2d76b-a685-44d9-8b3b-9f23d07d91f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b30d0>]}
[0m15:40:28.420456 [warn ] [MainThread]: The selection criterion 'community_viewed_articles' does not match any nodes
[0m15:40:28.421006 [info ] [MainThread]: 
[0m15:40:28.421146 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m15:40:28.461622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122656b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e21270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124fafb80>]}
[0m15:40:28.461877 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:40:54.351201 | 6c2a5215-bc0d-487b-9666-387442f1a5da ==============================
[0m15:40:54.351226 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:40:54.351819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles_backfill_fall_2022'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:40:54.351913 [debug] [MainThread]: Tracking: tracking
[0m15:40:54.363145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d7b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d794b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d79390>]}
[0m15:40:54.398591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:54.398732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:54.398994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:40:54.402001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2a5215-bc0d-487b-9666-387442f1a5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f900d0>]}
[0m15:40:54.406384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2a5215-bc0d-487b-9666-387442f1a5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f640a0>]}
[0m15:40:54.406526 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:40:54.406660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2a5215-bc0d-487b-9666-387442f1a5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f64040>]}
[0m15:40:54.407311 [info ] [MainThread]: 
[0m15:40:54.407654 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:40:54.408090 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:40:54.408180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:55.148284 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:40:55.148847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:55.490514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2a5215-bc0d-487b-9666-387442f1a5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e78df0>]}
[0m15:40:55.491693 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:40:55.492098 [info ] [MainThread]: 
[0m15:40:55.502747 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:40:55.503124 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [RUN]
[0m15:40:55.503808 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m15:40:55.503987 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:40:55.504157 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:40:55.512874 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m15:40:55.513518 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:55.513657 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:40:55.551321 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m15:40:55.551718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:55.552455 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles_backfill_fall_2022"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022`
    
    
    OPTIONS()
    as (
      

"""
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
"""

SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, event.clinic_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug


    );
  
[0m15:40:56.176628 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got string literal """\\n\'Community | Viewed article\' events from 2...""" at [13:1]')
[0m15:40:57.066056 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:19f06983-2b29-43bd-858f-52af5ed2ae45&page=queryresults
[0m15:40:57.067384 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:57.068403 [debug] [Thread-1 (]: Database Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got string literal """\n'Community | Viewed article' events from 2...""" at [13:1]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:40:57.068666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2a5215-bc0d-487b-9666-387442f1a5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114057790>]}
[0m15:40:57.068954 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [[31mERROR[0m in 1.57s]
[0m15:40:57.069281 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:40:57.070215 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:40:57.070592 [info ] [MainThread]: 
[0m15:40:57.070781 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m15:40:57.070954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:57.071070 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles_backfill_fall_2022' was properly closed.
[0m15:40:57.081266 [info ] [MainThread]: 
[0m15:40:57.081560 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:40:57.081776 [info ] [MainThread]: 
[0m15:40:57.081954 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)[0m
[0m15:40:57.082132 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got string literal """\n'Community | Viewed article' events from 2...""" at [13:1]
[0m15:40:57.082305 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:40:57.082475 [info ] [MainThread]: 
[0m15:40:57.082648 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:40:57.082904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d78fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d8c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f4a0b0>]}
[0m15:40:57.083122 [debug] [MainThread]: Flushing usage events


============================== 2022-12-08 15:41:34.147394 | ace41bc2-6b79-48c8-8b4e-5e253435f0e6 ==============================
[0m15:41:34.147432 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:41:34.148336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles_backfill_fall_2022'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:41:34.148461 [debug] [MainThread]: Tracking: tracking
[0m15:41:34.163411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaf51e0>]}
[0m15:41:34.198506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:34.198757 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:41:34.204886 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:41:34.212946 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/community_viewed_articles_backfill_fall_2022.sql
[0m15:41:34.221258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:41:34.223858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace41bc2-6b79-48c8-8b4e-5e253435f0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acf3d90>]}
[0m15:41:34.228837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace41bc2-6b79-48c8-8b4e-5e253435f0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acd3ee0>]}
[0m15:41:34.229025 [info ] [MainThread]: Found 6 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:41:34.229153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace41bc2-6b79-48c8-8b4e-5e253435f0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acb28f0>]}
[0m15:41:34.229774 [info ] [MainThread]: 
[0m15:41:34.230103 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:41:34.230574 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:41:34.230712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:34.883735 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:41:34.884289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:35.242499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace41bc2-6b79-48c8-8b4e-5e253435f0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118078d60>]}
[0m15:41:35.243752 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:41:35.244415 [info ] [MainThread]: 
[0m15:41:35.297723 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:41:35.297935 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [RUN]
[0m15:41:35.298330 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m15:41:35.298433 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:41:35.298525 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:41:35.300804 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m15:41:35.301352 [debug] [Thread-1 (]: finished collecting timing info
[0m15:41:35.301451 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:41:35.330927 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m15:41:35.331314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:35.332005 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles_backfill_fall_2022"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/

SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, event.clinic_id, metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug


    );
  
[0m15:41:38.501410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:82543154-1c0c-41b9-a541-d80f68756a52:europe-west1&page=queryresults
[0m15:41:38.518473 [debug] [Thread-1 (]: finished collecting timing info
[0m15:41:38.518991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace41bc2-6b79-48c8-8b4e-5e253435f0e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaff1f0>]}
[0m15:41:38.519236 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [[32mCREATE TABLE (1.5k rows, 531.9 KB processed)[0m in 3.22s]
[0m15:41:38.519517 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m15:41:38.520544 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:41:38.520919 [info ] [MainThread]: 
[0m15:41:38.521106 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m15:41:38.521259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:38.521338 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles_backfill_fall_2022' was properly closed.
[0m15:41:38.530393 [info ] [MainThread]: 
[0m15:41:38.530626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:38.530813 [info ] [MainThread]: 
[0m15:41:38.530982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:41:38.531208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab007f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab03e80>]}
[0m15:41:38.531381 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 09:17:48.327127 | 82e12087-d664-4396-aa20-24e76531b04f ==============================
[0m09:17:48.327160 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:17:48.327836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles_backfill_fall_2022'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:17:48.327949 [debug] [MainThread]: Tracking: tracking
[0m09:17:48.345839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7d120>]}
[0m09:17:48.380998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:17:48.381210 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m09:17:48.381336 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:17:48.388653 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m09:17:48.394182 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:17:48.398138 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:17:48.407316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m09:17:48.409940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82e12087-d664-4396-aa20-24e76531b04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7ff10>]}
[0m09:17:48.415371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82e12087-d664-4396-aa20-24e76531b04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5bdf0>]}
[0m09:17:48.415575 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:17:48.415712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e12087-d664-4396-aa20-24e76531b04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3a5c0>]}
[0m09:17:48.416357 [info ] [MainThread]: 
[0m09:17:48.416695 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:17:48.417140 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:17:48.417245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:17:49.080858 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:17:49.081406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:17:49.682173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82e12087-d664-4396-aa20-24e76531b04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c78e20>]}
[0m09:17:49.683395 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:17:49.683795 [info ] [MainThread]: 
[0m09:17:49.744509 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:17:49.744707 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [RUN]
[0m09:17:49.745058 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:17:49.745138 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:17:49.745219 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:17:49.748485 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:17:49.749626 [debug] [Thread-1 (]: finished collecting timing info
[0m09:17:49.749728 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:17:49.767016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:17:50.133594 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:17:50.134225 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/

with community_viewed_article as (
    SELECT event.slug, event.original_timestamp, event.category, event.user_id, event.referrer, event.clinic_id, metadata.id as article_id
    FROM (
        SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
        FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

        UNION ALL

        SELECT slug, original_timestamp, category, user_id, referrer, NULL
        FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
    ) as event
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug
),


UPDATE community_viewed_article
SET referrer = 'home'
where referrer = 'Personal assistant',

UPDATE community_viewed_article
SET referrer = 'Community'
where referrer = 'community',

select * from community_viewed_article



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m09:17:50.337782 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got identifier "community_viewed_article" at [32:8]')
[0m09:17:50.857256 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:881b2df1-9024-442b-89ff-5f2062df1166&page=queryresults
[0m09:17:50.858298 [debug] [Thread-1 (]: finished collecting timing info
[0m09:17:50.859221 [debug] [Thread-1 (]: Database Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)
  Syntax error: Expected keyword AS but got identifier "community_viewed_article" at [32:8]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:17:50.859599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82e12087-d664-4396-aa20-24e76531b04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e79870>]}
[0m09:17:50.859881 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [[31mERROR[0m in 1.11s]
[0m09:17:50.860146 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:17:50.861008 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:17:50.861364 [info ] [MainThread]: 
[0m09:17:50.861534 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m09:17:50.861677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:17:50.861754 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles_backfill_fall_2022' was properly closed.
[0m09:17:50.869488 [info ] [MainThread]: 
[0m09:17:50.869793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:17:50.870062 [info ] [MainThread]: 
[0m09:17:50.870259 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)[0m
[0m09:17:50.870400 [error] [MainThread]:   Syntax error: Expected keyword AS but got identifier "community_viewed_article" at [32:8]
[0m09:17:50.870532 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:17:50.870669 [info ] [MainThread]: 
[0m09:17:50.870811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:17:50.871009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4dcc0>]}
[0m09:17:50.871162 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 09:22:29.930141 | d0ded396-ea16-4131-bb40-b3507ffbf632 ==============================
[0m09:22:29.930177 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:22:29.931421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles_backfill_fall_2022'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:22:29.931554 [debug] [MainThread]: Tracking: tracking
[0m09:22:29.949991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105f1630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105f1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105f0ee0>]}
[0m09:22:29.984183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:22:29.984417 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:22:29.991428 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:22:29.999498 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:22:30.007791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m09:22:30.010398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ded396-ea16-4131-bb40-b3507ffbf632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110900d60>]}
[0m09:22:30.016082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ded396-ea16-4131-bb40-b3507ffbf632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11088b7c0>]}
[0m09:22:30.016262 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:22:30.016389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ded396-ea16-4131-bb40-b3507ffbf632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bfeb60>]}
[0m09:22:30.017039 [info ] [MainThread]: 
[0m09:22:30.017381 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:22:30.018015 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:22:30.018156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:31.030253 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:22:31.030807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:31.481819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ded396-ea16-4131-bb40-b3507ffbf632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107378d90>]}
[0m09:22:31.483187 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:22:31.483598 [info ] [MainThread]: 
[0m09:22:31.542521 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:22:31.542732 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [RUN]
[0m09:22:31.543116 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:22:31.543203 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:22:31.543290 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:22:31.546809 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:22:31.548079 [debug] [Thread-1 (]: finished collecting timing info
[0m09:22:31.548175 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:22:31.565998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:31.960417 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:22:31.961216 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN return 'home'
        WHEN event.referrer = 'Community' THEN return 'community'
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m09:22:32.153105 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Expected keyword ELSE or keyword END but got string literal 'home' at [24:64]")
[0m09:22:32.997142 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:895747e7-0c58-4308-950c-a43f36cc90b5&page=queryresults
[0m09:22:32.998648 [debug] [Thread-1 (]: finished collecting timing info
[0m09:22:32.999728 [debug] [Thread-1 (]: Database Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)
  Syntax error: Expected keyword ELSE or keyword END but got string literal 'home' at [24:64]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:22:33.000120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ded396-ea16-4131-bb40-b3507ffbf632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0f400>]}
[0m09:22:33.000691 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [[31mERROR[0m in 1.46s]
[0m09:22:33.001251 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:22:33.003262 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:22:33.003877 [info ] [MainThread]: 
[0m09:22:33.004176 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m09:22:33.004432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:33.004567 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles_backfill_fall_2022' was properly closed.
[0m09:22:33.018812 [info ] [MainThread]: 
[0m09:22:33.019102 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:22:33.019303 [info ] [MainThread]: 
[0m09:22:33.019478 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)[0m
[0m09:22:33.019653 [error] [MainThread]:   Syntax error: Expected keyword ELSE or keyword END but got string literal 'home' at [24:64]
[0m09:22:33.019821 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:22:33.019997 [info ] [MainThread]: 
[0m09:22:33.020169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:22:33.020421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106008b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110900970>]}
[0m09:22:33.020624 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 09:23:48.862437 | d6bd8d4d-2aa9-4f73-840b-5ea51b59f048 ==============================
[0m09:23:48.862476 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:23:48.864758 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles_backfill_fall_2022'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:23:48.865394 [debug] [MainThread]: Tracking: tracking
[0m09:23:48.878607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f6620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f5330>]}
[0m09:23:48.918557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:48.918819 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:23:48.925407 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:23:48.934096 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:23:48.942829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m09:23:48.945411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6bd8d4d-2aa9-4f73-840b-5ea51b59f048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109302d10>]}
[0m09:23:48.950299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6bd8d4d-2aa9-4f73-840b-5ea51b59f048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b2c50>]}
[0m09:23:48.950460 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:23:48.950597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd8d4d-2aa9-4f73-840b-5ea51b59f048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b2c20>]}
[0m09:23:48.951226 [info ] [MainThread]: 
[0m09:23:48.951551 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:23:48.952002 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:23:48.952111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:49.537153 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:23:49.537706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:49.928693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd8d4d-2aa9-4f73-840b-5ea51b59f048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f78d60>]}
[0m09:23:49.929952 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:23:49.930301 [info ] [MainThread]: 
[0m09:23:49.991984 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:23:49.992174 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [RUN]
[0m09:23:49.992516 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:23:49.992594 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:23:49.992677 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:23:49.995906 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:23:49.996794 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:49.996899 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:23:50.013879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:50.605403 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:23:50.606068 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN return 'home'
        WHEN event.referrer = 'Community' THEN return 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m09:23:50.854158 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Expected keyword ELSE or keyword END but got string literal 'home' at [24:64]")
[0m09:23:51.771668 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:97354384-039f-4645-8ae6-f81db094b62d&page=queryresults
[0m09:23:51.773655 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:51.774700 [debug] [Thread-1 (]: Database Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)
  Syntax error: Expected keyword ELSE or keyword END but got string literal 'home' at [24:64]
  compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:23:51.775136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd8d4d-2aa9-4f73-840b-5ea51b59f048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109423130>]}
[0m09:23:51.775745 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [[31mERROR[0m in 1.78s]
[0m09:23:51.776351 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:23:51.778049 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:23:51.778709 [info ] [MainThread]: 
[0m09:23:51.779019 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m09:23:51.779285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:51.779422 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles_backfill_fall_2022' was properly closed.
[0m09:23:51.793085 [info ] [MainThread]: 
[0m09:23:51.793396 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:51.793611 [info ] [MainThread]: 
[0m09:23:51.793787 [error] [MainThread]: [33mDatabase Error in model community_viewed_articles_backfill_fall_2022 (models/marts/community_viewed_articles_backfill_fall_2022.sql)[0m
[0m09:23:51.793968 [error] [MainThread]:   Syntax error: Expected keyword ELSE or keyword END but got string literal 'home' at [24:64]
[0m09:23:51.794133 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:23:51.794314 [info ] [MainThread]: 
[0m09:23:51.794499 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:23:51.794814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e423b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e71690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c4730>]}
[0m09:23:51.795065 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 09:24:31.813870 | 26513089-34d7-4066-85e9-710b6bb6753f ==============================
[0m09:24:31.813899 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:24:31.814588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['community_viewed_articles_backfill_fall_2022'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:24:31.814688 [debug] [MainThread]: Tracking: tracking
[0m09:24:31.823448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cee590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cef5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ced2a0>]}
[0m09:24:31.856931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:31.857179 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:24:31.864352 [debug] [MainThread]: 1603: static parser failed on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:24:31.872545 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:24:31.880964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m09:24:31.883525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26513089-34d7-4066-85e9-710b6bb6753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efabc0>]}
[0m09:24:31.888351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26513089-34d7-4066-85e9-710b6bb6753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaabc0>]}
[0m09:24:31.888539 [info ] [MainThread]: Found 7 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:24:31.888673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26513089-34d7-4066-85e9-710b6bb6753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaab90>]}
[0m09:24:31.889302 [info ] [MainThread]: 
[0m09:24:31.889627 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:24:31.890066 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:24:31.890152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:32.532627 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:24:32.533122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:32.961141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26513089-34d7-4066-85e9-710b6bb6753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cdb70>]}
[0m09:24:32.962535 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:24:32.962954 [info ] [MainThread]: 
[0m09:24:33.033575 [debug] [Thread-1 (]: Began running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:24:33.033751 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [RUN]
[0m09:24:33.034084 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:24:33.034160 [debug] [Thread-1 (]: Began compiling node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:24:33.034237 [debug] [Thread-1 (]: Compiling model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:24:33.037370 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:24:33.038119 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:33.038215 [debug] [Thread-1 (]: Began executing node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:24:33.054604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:33.616199 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.community_viewed_articles_backfill_fall_2022"
[0m09:24:33.617153 [debug] [Thread-1 (]: On model.my_new_project.community_viewed_articles_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.community_viewed_articles_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`community_viewed_articles_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m09:24:37.299395 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:36a6defa-a908-4ad4-8ce9-68f1e7ddaa49:europe-west1&page=queryresults
[0m09:24:37.313871 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:37.314579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26513089-34d7-4066-85e9-710b6bb6753f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cefeb0>]}
[0m09:24:37.314951 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_rsdun.community_viewed_articles_backfill_fall_2022  [[32mMERGE (28.0 rows, 550.8 KB processed)[0m in 4.28s]
[0m09:24:37.315324 [debug] [Thread-1 (]: Finished running node model.my_new_project.community_viewed_articles_backfill_fall_2022
[0m09:24:37.316625 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:24:37.317031 [info ] [MainThread]: 
[0m09:24:37.317237 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m09:24:37.317410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:37.317499 [debug] [MainThread]: Connection 'model.my_new_project.community_viewed_articles_backfill_fall_2022' was properly closed.
[0m09:24:37.326747 [info ] [MainThread]: 
[0m09:24:37.326976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:37.327155 [info ] [MainThread]: 
[0m09:24:37.327305 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:24:37.327520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de6560>]}
[0m09:24:37.327695 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 09:29:52.096440 | 6afa7f91-47bf-48fe-b961-96d9aa6893ce ==============================
[0m09:29:52.096469 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:29:52.099629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:29:52.099829 [debug] [MainThread]: Tracking: tracking
[0m09:29:52.110465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108483220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049df910>]}
[0m09:29:52.144660 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m09:29:52.144863 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/articles_viewed_backfill_2022.sql
[0m09:29:52.144955 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/articles_viewed_backfill_fall_2022.sql
[0m09:29:52.145040 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:29:52.145102 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/marts/community_viewed_articles_backfill_fall_2022.sql
[0m09:29:52.145202 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m09:29:52.152055 [debug] [MainThread]: 1603: static parser failed on marts/articles_viewed_backfill_2022.sql
[0m09:29:52.160219 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_viewed_backfill_2022.sql
[0m09:29:52.160800 [debug] [MainThread]: 1603: static parser failed on marts/articles_viewed_backfill_fall_2022.sql
[0m09:29:52.163321 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_viewed_backfill_fall_2022.sql
[0m09:29:52.164469 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:29:52.165632 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m09:29:52.175013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m09:29:52.177637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872a6e0>]}
[0m09:29:52.182847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863ebc0>]}
[0m09:29:52.183026 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m09:29:52.183153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863ec80>]}
[0m09:29:52.183958 [info ] [MainThread]: 
[0m09:29:52.184325 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:29:52.184945 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:29:52.185084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:52.965556 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:29:52.966091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:29:53.454205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107077eb0>]}
[0m09:29:53.455761 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:29:53.456201 [info ] [MainThread]: 
[0m09:29:53.462948 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:29:53.463194 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:29:53.463626 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m09:29:53.464043 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m09:29:53.464884 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:29:53.465628 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:29:53.465989 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:29:53.466362 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:29:53.466646 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:29:53.466862 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:29:53.468999 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:29:53.470489 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:29:53.471763 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:53.471894 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:53.472069 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:29:53.472228 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:29:53.495488 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:29:53.497564 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:29:53.497969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:53.498093 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:29:53.498950 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:29:53.500005 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:29:54.662178 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1b6afb03-cffa-4b5b-a6ab-43e3a4b4cf18:europe-west1&page=queryresults
[0m09:29:54.686466 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:54.687899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:16da8689-ae14-4cbc-9334-c7de0dc87076:europe-west1&page=queryresults
[0m09:29:54.688572 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5c610>]}
[0m09:29:54.689765 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:54.690101 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m09:29:54.690503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867c3d0>]}
[0m09:29:54.690912 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:29:54.691135 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m09:29:54.691325 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:29:54.691759 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:29:54.691988 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m09:29:54.692150 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:29:54.692725 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:29:54.692890 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m09:29:54.693011 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:29:54.693484 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:29:54.693640 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:29:54.693755 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:29:54.695265 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:29:54.695430 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:29:54.696684 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:29:54.697168 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:54.697279 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:54.697369 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:29:54.697470 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:29:54.699541 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:29:54.701357 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:29:54.701812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:29:54.701939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:54.702933 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  JSON_VALUE(properties,'$.referrer') as referrer,
  JSON_VALUE(properties,'$.reading_session') as reading_session,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as time,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Community | Viewed article');


[0m09:29:54.744984 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  JSON_VALUE(properties,'$.Referrer') as referrer,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as time,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m09:29:55.697437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:51f58eed-8af0-47cf-b228-f95f29ae2fbe:europe-west1&page=queryresults
[0m09:29:55.700858 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:55.701780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868ba90>]}
[0m09:29:55.702216 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m09:29:55.703076 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:29:55.703371 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:29:55.703705 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:29:55.704813 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:29:55.705216 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:29:55.705493 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:29:55.708040 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:29:55.710460 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:55.710769 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:29:55.713876 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:29:55.714861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:55.716112 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m09:29:55.814161 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7e339a4b-a4c1-4cba-a132-dbe6d8daf858:europe-west1&page=queryresults
[0m09:29:55.815113 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:55.815471 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d34c0>]}
[0m09:29:55.815674 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m09:29:55.815914 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:29:55.816025 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:29:55.816151 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:29:55.816599 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:29:55.816721 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:29:55.816817 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:29:55.821832 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:29:55.822200 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:55.822294 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:29:55.826076 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:29:55.826392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:29:55.827126 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m09:29:56.704233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:db3ac8fc-a27b-4ba0-ac85-560b34526a22:europe-west1&page=queryresults
[0m09:29:56.707131 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:56.707898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869dc00>]}
[0m09:29:56.708357 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m09:29:56.708868 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:29:56.709092 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:29:56.709433 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m09:29:56.710200 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:29:56.710402 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:29:56.710576 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:29:56.717347 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:29:56.718082 [debug] [Thread-2 (]: finished collecting timing info
[0m09:29:56.718252 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:29:56.729103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:29:56.986519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8513f509-0aab-453c-900a-d4275fda574a:europe-west1&page=queryresults
[0m09:29:56.989559 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:56.990315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d1960>]}
[0m09:29:56.990750 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m09:29:56.991230 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:29:56.991708 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_2022
[0m09:29:56.992037 [info ] [Thread-1 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_2022 ..... [RUN]
[0m09:29:56.992761 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_2022"
[0m09:29:56.992955 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_2022
[0m09:29:56.993131 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_2022
[0m09:29:56.997967 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_2022"
[0m09:29:56.999441 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:56.999617 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_2022
[0m09:29:57.032637 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_2022"
[0m09:29:57.033022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:57.033814 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_2022"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_2022`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m09:29:57.213806 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:29:57.215451 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:29:59.731728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9ef6559a-abb7-4e95-ad2d-d4599ec63397:europe-west1&page=queryresults
[0m09:29:59.735770 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:59.736720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087eabc0>]}
[0m09:29:59.737265 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_2022  [[32mCREATE TABLE (1.5k rows, 539.4 KB processed)[0m in 2.74s]
[0m09:29:59.737803 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_2022
[0m09:29:59.738031 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m09:29:59.738453 [info ] [Thread-1 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m09:29:59.739237 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m09:29:59.739432 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m09:29:59.739619 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m09:29:59.749332 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m09:29:59.750002 [debug] [Thread-1 (]: finished collecting timing info
[0m09:29:59.750179 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m09:29:59.755289 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m09:29:59.755821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:29:59.757144 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m09:30:00.125173 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0057073c-335a-4b90-ac4b-4a45a47b0fba:europe-west1&page=queryresults
[0m09:30:00.127133 [debug] [Thread-2 (]: finished collecting timing info
[0m09:30:00.127752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e9300>]}
[0m09:30:00.128126 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.0 KB processed)[0m in 3.42s]
[0m09:30:00.128528 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:30:03.266085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fd60531f-d8bd-4701-9f55-28e4f5898fd5:europe-west1&page=queryresults
[0m09:30:03.273192 [debug] [Thread-1 (]: finished collecting timing info
[0m09:30:03.274242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6afa7f91-47bf-48fe-b961-96d9aa6893ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086894e0>]}
[0m09:30:03.274813 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mCREATE TABLE (1.5k rows, 539.4 KB processed)[0m in 3.54s]
[0m09:30:03.275409 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m09:30:03.277346 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:30:03.278182 [info ] [MainThread]: 
[0m09:30:03.278521 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 11.09 seconds (11.09s).
[0m09:30:03.278798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:03.278936 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m09:30:03.279068 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:30:03.289770 [info ] [MainThread]: 
[0m09:30:03.290084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:30:03.290325 [info ] [MainThread]: 
[0m09:30:03.290511 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m09:30:03.290818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108804af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fc970>]}
[0m09:30:03.291036 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 12:13:01.237261 | c5a8fd03-c855-42ea-a4d7-41e0f6647eb9 ==============================
[0m12:13:01.237305 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:13:01.238142 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:13:01.238264 [debug] [MainThread]: Tracking: tracking
[0m12:13:01.251008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118af77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b1bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118af5390>]}
[0m12:13:01.288604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:13:01.288878 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:13:01.288994 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:13:01.296262 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:13:01.301699 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:13:01.311108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m12:13:01.313778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf4eb0>]}
[0m12:13:01.318638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d66b00>]}
[0m12:13:01.318833 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:13:01.318962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11897d1b0>]}
[0m12:13:01.319745 [info ] [MainThread]: 
[0m12:13:01.320072 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:13:01.320669 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:13:01.320810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:01.969722 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:13:01.970263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:02.368798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118af4d00>]}
[0m12:13:02.369501 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:13:02.369699 [info ] [MainThread]: 
[0m12:13:02.418220 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:13:02.419636 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:13:02.419876 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m12:13:02.420011 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m12:13:02.420384 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:13:02.420685 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:13:02.420864 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:13:02.421167 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:13:02.421278 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:13:02.421362 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:13:02.422424 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:13:02.423259 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:13:02.424467 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:02.424607 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:02.424699 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:13:02.424791 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:13:02.441027 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:13:02.442504 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:13:02.442799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:02.443485 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:13:02.479095 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:13:02.479684 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:13:03.825319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b515b31a-c407-47a5-b354-ff34dc9fd82f:europe-west1&page=queryresults
[0m12:13:03.826021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:749d6358-55d3-448a-a6c9-1a76011c9d3a:europe-west1&page=queryresults
[0m12:13:03.836941 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:03.837846 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:03.838196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dd59c0>]}
[0m12:13:03.838473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32950>]}
[0m12:13:03.838713 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m12:13:03.838857 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m12:13:03.839097 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:13:03.839283 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:13:03.839396 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:13:03.839569 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:13:03.839804 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m12:13:03.839929 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m12:13:03.840261 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:13:03.840930 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:13:03.841058 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:13:03.841180 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:13:03.841280 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:13:03.841364 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:13:03.842458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:13:03.846936 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:03.848317 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:13:03.848485 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:13:03.852735 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:13:03.852972 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:03.853096 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:13:03.853202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:03.855078 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:13:03.856033 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os, original_timestamp;


[0m12:13:03.897552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:03.898566 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  JSON_VALUE(properties,'$.Referrer') as referrer,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:13:04.701570 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column original_timestamp contains an aggregation function, which is not allowed in GROUP BY at [19:93]')
[0m12:13:05.116985 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7c0cd306-bfd5-43b3-8281-734f27fa94f1:europe-west1&page=queryresults
[0m12:13:05.119872 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:05.120831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f4aef0>]}
[0m12:13:05.121388 [info ] [Thread-2 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m12:13:05.122005 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:13:05.122247 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:13:05.122886 [info ] [Thread-2 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:13:05.123861 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:13:05.124063 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:13:05.124244 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:13:05.126529 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:13:05.135532 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:05.135791 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:13:05.138863 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:13:05.139563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:05.140498 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:13:06.002159 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:c2a55071-6c28-4643-b4e0-dcb24ad196d6&page=queryresults
[0m12:13:06.003077 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:06.003983 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__community_viewed_article (models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql)
  Column original_timestamp contains an aggregation function, which is not allowed in GROUP BY at [19:93]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:13:06.004453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dfab60>]}
[0m12:13:06.005284 [error] [Thread-1 (]: 3 of 9 ERROR creating sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[31mERROR[0m in 2.16s]
[0m12:13:06.005873 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:13:06.006209 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:13:06.007231 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:13:06.008093 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:13:06.008539 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:13:06.008849 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:13:06.011342 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:13:06.012622 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:06.012851 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:13:06.016020 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:13:06.016529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:06.017880 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:13:06.267068 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d219ae0e-4df7-432b-83ae-5dc15bf9dccd:europe-west1&page=queryresults
[0m12:13:06.269767 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:06.270543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32800>]}
[0m12:13:06.271203 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m12:13:06.271677 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:13:06.271891 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:13:06.272227 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m12:13:06.272976 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:13:06.273166 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:13:06.273451 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:13:06.286308 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:13:06.287521 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:06.287710 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:13:06.299964 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:06.739067 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:13:06.742029 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:13:07.217393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0b8f28ff-ad21-408b-b218-d6a2b3e67c20:europe-west1&page=queryresults
[0m12:13:07.221155 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:07.222071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f75b70>]}
[0m12:13:07.222492 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m12:13:07.222981 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:13:07.223446 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_2022
[0m12:13:07.223673 [info ] [Thread-1 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_2022 ..... [RUN]
[0m12:13:07.224294 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_2022"
[0m12:13:07.224458 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_2022
[0m12:13:07.224615 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_2022
[0m12:13:07.236154 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_2022"
[0m12:13:07.236940 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:07.237117 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_2022
[0m12:13:07.260149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:07.838417 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_2022"
[0m12:13:07.839318 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:13:09.838275 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9c7ae9d4-3b29-4079-8259-022c9dcea9cc:europe-west1&page=queryresults
[0m12:13:09.841795 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:09.842789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1ca60>]}
[0m12:13:09.843307 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.1 KB processed)[0m in 3.57s]
[0m12:13:09.843896 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:13:09.844119 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:13:09.844792 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:13:09.845758 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:13:09.845961 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:13:09.846136 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:13:09.851624 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:13:09.852718 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:09.853003 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:13:09.860195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:13:10.370008 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:13:10.371267 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:13:10.993432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b02efdab-194d-49ad-9d85-06ccf4bd0268:europe-west1&page=queryresults
[0m12:13:10.995604 [debug] [Thread-1 (]: finished collecting timing info
[0m12:13:10.996334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf4dc0>]}
[0m12:13:10.996738 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 3.77s]
[0m12:13:10.997188 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_2022
[0m12:13:12.739782 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b479c9d9-f61b-49e8-a52f-c586e0a5f608:europe-west1&page=queryresults
[0m12:13:12.742731 [debug] [Thread-2 (]: finished collecting timing info
[0m12:13:12.743761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5a8fd03-c855-42ea-a4d7-41e0f6647eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf79a0>]}
[0m12:13:12.744299 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 2.90s]
[0m12:13:12.744854 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:13:12.746551 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:13:12.747179 [info ] [MainThread]: 
[0m12:13:12.747472 [info ] [MainThread]: Finished running 6 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 11.43 seconds (11.43s).
[0m12:13:12.747729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:12.747864 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_2022' was properly closed.
[0m12:13:12.747998 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:13:12.763390 [info ] [MainThread]: 
[0m12:13:12.763760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:12.763980 [info ] [MainThread]: 
[0m12:13:12.764162 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__community_viewed_article (models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql)[0m
[0m12:13:12.764346 [error] [MainThread]:   Column original_timestamp contains an aggregation function, which is not allowed in GROUP BY at [19:93]
[0m12:13:12.764522 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:13:12.764712 [info ] [MainThread]: 
[0m12:13:12.764900 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m12:13:12.765195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d4a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cf66e0>]}
[0m12:13:12.765446 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 12:14:15.726410 | 8c4d0052-4095-4ad6-8a24-2f10c833d7d0 ==============================
[0m12:14:15.726484 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:14:15.727497 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__community_viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:14:15.727604 [debug] [MainThread]: Tracking: tracking
[0m12:14:15.744606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c76410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c77460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c75120>]}
[0m12:14:15.780202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:15.780468 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:14:15.787652 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:14:15.801056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:14:15.803717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4d0052-4095-4ad6-8a24-2f10c833d7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e904f0>]}
[0m12:14:15.808174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c4d0052-4095-4ad6-8a24-2f10c833d7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111776650>]}
[0m12:14:15.808330 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:14:15.808463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4d0052-4095-4ad6-8a24-2f10c833d7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e429e0>]}
[0m12:14:15.809104 [info ] [MainThread]: 
[0m12:14:15.809424 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:14:15.809870 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:14:15.810002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:16.436215 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:14:16.436429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:16.737523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4d0052-4095-4ad6-8a24-2f10c833d7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c764a0>]}
[0m12:14:16.738867 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:14:16.739290 [info ] [MainThread]: 
[0m12:14:16.745802 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:14:16.746272 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m12:14:16.747055 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:14:16.747252 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:14:16.747445 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:14:16.804285 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:14:16.806759 [debug] [Thread-1 (]: finished collecting timing info
[0m12:14:16.806872 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:14:16.822114 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:14:16.822652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:16.823308 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:14:17.742577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:eb1ee102-da21-42c5-8790-d5f9e1fe702d:europe-west1&page=queryresults
[0m12:14:17.760197 [debug] [Thread-1 (]: finished collecting timing info
[0m12:14:17.760861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4d0052-4095-4ad6-8a24-2f10c833d7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117756c0>]}
[0m12:14:17.761202 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m12:14:17.761609 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:14:17.762830 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:14:17.763305 [info ] [MainThread]: 
[0m12:14:17.763552 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m12:14:17.763749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:17.763851 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__community_viewed_article' was properly closed.
[0m12:14:17.771513 [info ] [MainThread]: 
[0m12:14:17.771762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:17.771951 [info ] [MainThread]: 
[0m12:14:17.772115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:17.772339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b08970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e531c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e91e10>]}
[0m12:14:17.772512 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 12:15:27.363322 | c7399ec2-c2fa-404f-b3dd-8b7cd1f6ee51 ==============================
[0m12:15:27.363364 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:15:27.364802 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:15:27.364938 [debug] [MainThread]: Tracking: tracking
[0m12:15:27.381982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c13c0>]}
[0m12:15:27.419715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:15:27.419953 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:15:27.420069 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:15:27.427178 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:15:27.432711 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m12:15:27.441993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m12:15:27.444577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7399ec2-c2fa-404f-b3dd-8b7cd1f6ee51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc0e50>]}
[0m12:15:27.449353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7399ec2-c2fa-404f-b3dd-8b7cd1f6ee51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b87400>]}
[0m12:15:27.449548 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:15:27.449682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7399ec2-c2fa-404f-b3dd-8b7cd1f6ee51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559cd30>]}
[0m12:15:27.450334 [info ] [MainThread]: 
[0m12:15:27.450662 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:15:27.451129 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:15:27.451262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:28.195612 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:15:28.196188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:28.515936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7399ec2-c2fa-404f-b3dd-8b7cd1f6ee51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c12a0>]}
[0m12:15:28.517122 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:15:28.517523 [info ] [MainThread]: 
[0m12:15:28.528107 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:28.528603 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m12:15:28.578255 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:15:28.578469 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:28.578562 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:28.579554 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:15:28.580071 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:28.580181 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:28.595624 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:15:28.595942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:28.596658 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, user_id, category, os;


[0m12:15:29.459683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1c9c0cc0-8e76-4f39-91f9-981566cc9655:europe-west1&page=queryresults
[0m12:15:29.480522 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:29.481284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7399ec2-c2fa-404f-b3dd-8b7cd1f6ee51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baa500>]}
[0m12:15:29.481642 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m12:15:29.482047 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:29.483354 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:15:29.483877 [info ] [MainThread]: 
[0m12:15:29.484108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m12:15:29.484299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:29.484403 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__viewed_article' was properly closed.
[0m12:15:29.491309 [info ] [MainThread]: 
[0m12:15:29.491556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:29.491745 [info ] [MainThread]: 
[0m12:15:29.491912 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:29.492126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b971f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5b8b0>]}
[0m12:15:29.492291 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 12:42:15.919316 | a55ac565-9c61-48ab-8e94-5cef32ce12ef ==============================
[0m12:42:15.919358 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:42:15.920218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:42:15.920331 [debug] [MainThread]: Tracking: tracking
[0m12:42:15.931831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb795d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb79450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb790f0>]}
[0m12:42:15.966454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:15.966711 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:42:15.972883 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:42:15.986557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m12:42:15.989201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf08f40>]}
[0m12:42:15.993530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10becb9d0>]}
[0m12:42:15.993674 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:42:15.993800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621eaa0>]}
[0m12:42:15.994566 [info ] [MainThread]: 
[0m12:42:15.994878 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:42:15.995487 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:42:15.995607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:16.610923 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:42:16.612362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:17.131178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109374df0>]}
[0m12:42:17.133005 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:42:17.133923 [info ] [MainThread]: 
[0m12:42:17.142558 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:42:17.145700 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:42:17.146225 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m12:42:17.146594 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m12:42:17.147706 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:42:17.148861 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:42:17.149430 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:42:17.149742 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:42:17.149971 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:42:17.150173 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:42:17.198121 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:42:17.201258 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:42:17.201859 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:17.201994 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:42:17.202066 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:17.221001 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:42:17.221164 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:42:17.222803 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:42:17.223047 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:17.223141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:17.223831 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:42:17.259697 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:42:18.352787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:487d2eb0-b779-4232-bbdb-09de662805a0:europe-west1&page=queryresults
[0m12:42:18.377112 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3a4035d8-092a-4696-aa3d-d0f0f6302254:europe-west1&page=queryresults
[0m12:42:18.378520 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:18.379324 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:18.379692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf0b220>]}
[0m12:42:18.379935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf08cd0>]}
[0m12:42:18.380127 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m12:42:18.380271 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m12:42:18.380480 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:42:18.380637 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:42:18.380727 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:42:18.380865 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:42:18.381024 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m12:42:18.381136 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m12:42:18.381555 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:42:18.381815 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:42:18.381895 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:42:18.381959 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:42:18.382032 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:42:18.382094 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:42:18.383099 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:42:18.383827 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:42:18.384602 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:18.384902 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:42:18.384992 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:18.386654 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:42:18.386770 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:42:18.388766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:18.394250 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:42:18.394377 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:42:18.431954 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:42:18.432889 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, user_id, category, os;


[0m12:42:19.340213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:98fd829a-e27c-4191-890d-d275473ae785:europe-west1&page=queryresults
[0m12:42:19.341187 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:19.342202 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:194b56b0-1456-46ae-992e-0dd17a6b124a:europe-west1&page=queryresults
[0m12:42:19.342559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0456c0>]}
[0m12:42:19.343337 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:19.343530 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m12:42:19.343803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c036650>]}
[0m12:42:19.344171 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:42:19.344340 [info ] [Thread-2 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m12:42:19.344476 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:42:19.344847 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:42:19.344985 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:42:19.345087 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:42:19.345587 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:42:19.345749 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:42:19.345842 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:42:19.349973 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:42:19.350163 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:42:19.350245 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:42:19.351365 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:42:19.351519 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:42:19.353005 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:42:19.353401 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:19.353492 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:42:19.355017 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:42:19.355177 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:19.355274 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:42:19.356683 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:42:19.356780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:19.357536 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:42:19.395600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:42:19.396952 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:42:20.397417 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d7a669d0-4213-43cf-8d2d-9951f9f6e7e7:europe-west1&page=queryresults
[0m12:42:20.401483 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:20.402561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0577c0>]}
[0m12:42:20.403102 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m12:42:20.403704 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:42:20.403957 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:42:20.404242 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m12:42:20.405244 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:42:20.405475 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:42:20.405669 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:42:20.414710 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:42:20.416327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8e336e43-9329-4454-851e-dc40a3ecc34e:europe-west1&page=queryresults
[0m12:42:20.417729 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:20.418213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb79f30>]}
[0m12:42:20.418552 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m12:42:20.418701 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:20.419076 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:42:20.419190 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:42:20.427733 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_2022
[0m12:42:20.430192 [info ] [Thread-1 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_2022 ..... [RUN]
[0m12:42:20.432116 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_2022"
[0m12:42:20.434488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:42:20.434605 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_2022
[0m12:42:20.434769 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_2022
[0m12:42:20.484500 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_2022"
[0m12:42:20.485158 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:20.485248 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_2022
[0m12:42:20.499921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:20.888631 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:42:20.889547 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:42:20.963787 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_2022"
[0m12:42:20.964242 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:42:24.013132 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:41715ea8-0fcd-4bb6-8212-7a0269e2c34f:europe-west1&page=queryresults
[0m12:42:24.017072 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:24.018424 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109276c50>]}
[0m12:42:24.019165 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.1 KB processed)[0m in 3.61s]
[0m12:42:24.019879 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:42:24.020146 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:42:24.020549 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:42:24.021437 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:42:24.021668 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:42:24.021872 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:42:24.027270 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:42:24.028076 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:24.028237 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:42:24.031008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:42:24.120430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:60532617-ad73-4073-bd0d-28e666a63d8e:europe-west1&page=queryresults
[0m12:42:24.121338 [debug] [Thread-1 (]: finished collecting timing info
[0m12:42:24.121689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfd2e90>]}
[0m12:42:24.121890 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 3.69s]
[0m12:42:24.122120 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_2022
[0m12:42:24.550463 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:42:24.551845 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:42:27.097235 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7b567fd2-8030-4b8b-b177-7729de6e5aee:europe-west1&page=queryresults
[0m12:42:27.099680 [debug] [Thread-2 (]: finished collecting timing info
[0m12:42:27.100589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55ac565-9c61-48ab-8e94-5cef32ce12ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beda950>]}
[0m12:42:27.101145 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 3.08s]
[0m12:42:27.101730 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:42:27.103708 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:42:27.104529 [info ] [MainThread]: 
[0m12:42:27.104870 [info ] [MainThread]: Finished running 6 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 11.11 seconds (11.11s).
[0m12:42:27.105139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:27.105274 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_2022' was properly closed.
[0m12:42:27.105402 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:42:27.129659 [info ] [MainThread]: 
[0m12:42:27.129908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:27.130108 [info ] [MainThread]: 
[0m12:42:27.130259 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:42:27.130520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109374df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf287c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2b850>]}
[0m12:42:27.130724 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 13:04:54.050601 | a1bd4588-b5d5-421a-9005-b25f969eed31 ==============================
[0m13:04:54.050660 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:04:54.051331 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:04:54.051425 [debug] [MainThread]: Tracking: tracking
[0m13:04:54.066406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c57a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c57b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c579180>]}
[0m13:04:54.104156 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m13:04:54.104401 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/articles_evidence.sql
[0m13:04:54.104480 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/marts/articles_viewed_backfill_2022.sql
[0m13:04:54.104596 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:04:54.110976 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m13:04:54.119377 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m13:04:54.120197 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:04:54.130150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m13:04:54.132785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c902ad0>]}
[0m13:04:54.138597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c8baec0>]}
[0m13:04:54.138769 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:04:54.138896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c8baf80>]}
[0m13:04:54.139701 [info ] [MainThread]: 
[0m13:04:54.140038 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:04:54.140683 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:04:54.140824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:54.918608 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:04:54.919209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:55.341016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ed030>]}
[0m13:04:55.341450 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:04:55.341597 [info ] [MainThread]: 
[0m13:04:55.344692 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:04:55.344791 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:04:55.344972 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m13:04:55.345096 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m13:04:55.345479 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:04:55.345773 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:04:55.345864 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:04:55.345943 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:04:55.346116 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:04:55.346189 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:04:55.347202 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:04:55.348049 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:04:55.348814 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:55.348900 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:55.348986 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:04:55.349068 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:04:55.365132 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:04:55.366821 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:04:55.367184 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:55.367903 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:04:55.403984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:55.405153 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:04:56.207062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ef867598-a767-4f49-8890-40eda9541649:europe-west1&page=queryresults
[0m13:04:56.226181 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:56.226804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c91ac50>]}
[0m13:04:56.227184 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m13:04:56.227622 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:04:56.227797 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:04:56.228071 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m13:04:56.228663 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:04:56.228812 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:04:56.228950 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:04:56.234359 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:04:56.234931 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:56.235047 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:04:56.238757 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:04:56.239503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:56.240454 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m13:04:56.618296 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3a667de7-7c68-4447-be60-c096f0e8a73d:europe-west1&page=queryresults
[0m13:04:56.620329 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:56.620844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c584790>]}
[0m13:04:56.621091 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m13:04:56.621382 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:04:56.621506 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:04:56.621647 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m13:04:56.622410 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:04:56.622539 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m13:04:56.622638 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m13:04:56.624640 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:04:56.625178 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:56.625351 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m13:04:56.628287 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:04:56.628671 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:56.629913 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.Os') as os,
  JSON_VALUE(properties,'$.clinic_id') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, user_id, category, os;


[0m13:04:57.320297 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name os in GROUP BY clause is ambiguous; it may refer to multiple columns in the SELECT-list at [24:89]')
[0m13:04:57.406735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:41ff45f7-197e-475a-bcfc-acd17913bb47:europe-west1&page=queryresults
[0m13:04:57.409624 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:57.410548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c585ba0>]}
[0m13:04:57.411058 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m13:04:57.411638 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:04:57.411895 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:04:57.412307 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m13:04:57.413177 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:04:57.413368 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:04:57.413548 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m13:04:57.415872 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:04:57.418366 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:57.418574 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:04:57.421711 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:04:57.422637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:57.424097 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m13:04:58.074033 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:fc9cbedf-7570-48d4-9209-a5eb0f8f7cb5&page=queryresults
[0m13:04:58.075994 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:58.077465 [debug] [Thread-2 (]: Database Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)
  Name os in GROUP BY clause is ambiguous; it may refer to multiple columns in the SELECT-list at [24:89]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:04:58.078046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca1b0a0>]}
[0m13:04:58.078766 [error] [Thread-2 (]: 4 of 9 ERROR creating sql view model dbt_rsdun.stg_mixpanel__viewed_article .... [[31mERROR[0m in 1.46s]
[0m13:04:58.079543 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:04:58.079821 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:04:58.080391 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m13:04:58.081426 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:04:58.081651 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:04:58.081869 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:04:58.084285 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:04:58.085101 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:58.085278 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:04:58.095963 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:04:58.096522 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:58.097680 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m13:04:58.385946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1699737b-c3a5-4cd3-aa6a-d965eafd7bf5:europe-west1&page=queryresults
[0m13:04:58.389308 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:58.390267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca77b80>]}
[0m13:04:58.390761 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m13:04:58.391327 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:04:58.391580 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m13:04:58.391958 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m13:04:58.392745 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:04:58.392936 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m13:04:58.393106 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m13:04:58.401702 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:04:58.402276 [debug] [Thread-1 (]: finished collecting timing info
[0m13:04:58.402431 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m13:04:58.412281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:58.856203 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:13440515-a3bb-451e-b0d9-cfd6577c2dfd:europe-west1&page=queryresults
[0m13:04:58.860040 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:58.861045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca9d7b0>]}
[0m13:04:58.861556 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m13:04:58.862138 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:04:58.862862 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m13:04:58.863262 [info ] [Thread-2 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m13:04:58.864146 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m13:04:58.864358 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m13:04:58.864533 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m13:04:58.870323 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m13:04:58.871215 [debug] [Thread-2 (]: finished collecting timing info
[0m13:04:58.871401 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m13:04:58.906708 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m13:04:58.907394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:58.908224 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/
with StartDate as (
  SELECT CAST(CAST(min(start_time) AS STRING FORMAT 'YYYY-MM-DD') AS DATE) as start_date
  FROM `wawa-83630.raw_revenuecat__transactions.transactions`),



SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m13:04:58.947838 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:04:58.948359 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:04:59.353505 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]')
[0m13:05:00.389278 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:24df8e65-796c-420a-aec9-ddfa649e32ef&page=queryresults
[0m13:05:00.391085 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:00.392126 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m13:05:00.392533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c8d9780>]}
[0m13:05:00.393090 [error] [Thread-2 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.53s]
[0m13:05:00.393668 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m13:05:00.393933 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:00.394440 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m13:05:00.395226 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:05:00.395432 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:00.395613 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:00.401017 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:05:00.403574 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:00.403791 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:00.413031 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:05:00.951306 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:05:00.951973 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m13:05:01.573978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:09a8f957-3510-4742-8259-be6cea1917ec:europe-west1&page=queryresults
[0m13:05:01.576543 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:01.577334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca7ff10>]}
[0m13:05:01.577773 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.1 KB processed)[0m in 3.18s]
[0m13:05:01.578283 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m13:05:04.089514 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:36617ab9-69a1-482c-b6ea-f5ce91f902ee:europe-west1&page=queryresults
[0m13:05:04.093361 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:04.094295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1bd4588-b5d5-421a-9005-b25f969eed31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca7e950>]}
[0m13:05:04.094829 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 3.70s]
[0m13:05:04.095388 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:04.097101 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:05:04.097765 [info ] [MainThread]: 
[0m13:05:04.098074 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m13:05:04.098330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:04.098465 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m13:05:04.098595 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m13:05:04.108852 [info ] [MainThread]: 
[0m13:05:04.109109 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:05:04.109314 [info ] [MainThread]: 
[0m13:05:04.109490 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)[0m
[0m13:05:04.109663 [error] [MainThread]:   Name os in GROUP BY clause is ambiguous; it may refer to multiple columns in the SELECT-list at [24:89]
[0m13:05:04.109829 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:05:04.109992 [info ] [MainThread]: 
[0m13:05:04.110153 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m13:05:04.110318 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]
[0m13:05:04.110477 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m13:05:04.110656 [info ] [MainThread]: 
[0m13:05:04.110828 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m13:05:04.111071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c8baf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b158610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c585e10>]}
[0m13:05:04.111261 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 13:05:27.292259 | 2273e12c-7710-4aac-805b-27dd239d7493 ==============================
[0m13:05:27.292395 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:05:27.293505 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:05:27.293623 [debug] [MainThread]: Tracking: tracking
[0m13:05:27.302590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c63010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021bcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021bf910>]}
[0m13:05:27.337154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:27.337405 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:05:27.343892 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:05:27.357530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m13:05:27.360450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9e1a0>]}
[0m13:05:27.365439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de3040>]}
[0m13:05:27.365642 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:05:27.365787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10223c610>]}
[0m13:05:27.366577 [info ] [MainThread]: 
[0m13:05:27.366923 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:05:27.367557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:05:27.367696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:27.990413 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:05:27.990825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:28.506764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5cd60>]}
[0m13:05:28.508100 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:05:28.508519 [info ] [MainThread]: 
[0m13:05:28.515710 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:05:28.518136 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:05:28.518820 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m13:05:28.519395 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m13:05:28.520470 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:05:28.521274 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:05:28.521466 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:05:28.521753 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:05:28.521986 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:05:28.522147 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:05:28.564413 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:05:28.566809 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:05:28.567101 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:28.567218 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:05:28.573218 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:28.583895 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:05:28.584039 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:05:28.585534 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:05:28.585750 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:05:28.585831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:28.586512 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:05:28.587057 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:05:29.577226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ffe0c339-acbe-4a0b-abc8-57d677f7e506:europe-west1&page=queryresults
[0m13:05:29.597127 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:29.597838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e482e0>]}
[0m13:05:29.598207 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m13:05:29.598631 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:05:29.598809 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:05:29.599088 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m13:05:29.599671 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:05:29.599820 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:05:29.599956 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:05:29.601727 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:05:29.602324 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:29.602457 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:05:29.604854 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:05:29.605168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:29.606296 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m13:05:29.651692 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1840d14b-6f32-4223-a784-3cae0adcadd9:europe-west1&page=queryresults
[0m13:05:29.652741 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:29.653063 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6c250>]}
[0m13:05:29.653224 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m13:05:29.653417 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:05:29.653503 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:05:29.653664 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m13:05:29.654202 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:05:29.654421 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m13:05:29.654503 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m13:05:29.655475 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:05:29.655821 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:29.658625 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m13:05:29.661614 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:05:29.661860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:05:29.662497 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.Os') as os,
  JSON_VALUE(properties,'$.clinic_id') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m13:05:30.299998 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: clinic_id at [24:70]')
[0m13:05:30.580744 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c4787453-0047-48d4-afe3-05808800cddd:europe-west1&page=queryresults
[0m13:05:30.583576 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:30.584359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e364d0>]}
[0m13:05:30.584814 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m13:05:30.585308 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:05:30.585520 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:05:30.585869 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m13:05:30.586687 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:05:30.586878 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:05:30.587052 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m13:05:30.589403 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:05:30.590233 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:30.590423 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:05:30.593476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:05:30.593943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:30.595212 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m13:05:31.227468 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:3e801664-4312-4cc1-8222-a374cbb70218&page=queryresults
[0m13:05:31.227854 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:31.228267 [debug] [Thread-2 (]: Database Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)
  Unrecognized name: clinic_id at [24:70]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:05:31.228437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e364a0>]}
[0m13:05:31.228670 [error] [Thread-2 (]: 4 of 9 ERROR creating sql view model dbt_rsdun.stg_mixpanel__viewed_article .... [[31mERROR[0m in 1.57s]
[0m13:05:31.228940 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:05:31.229081 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:05:31.229216 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m13:05:31.229857 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:05:31.229992 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:05:31.230095 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:05:31.231309 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:05:31.231653 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:31.231765 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:05:31.233574 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:05:31.233824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:05:31.234625 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m13:05:31.378356 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e8402cc7-a068-4bf5-b451-1baa536c016c:europe-west1&page=queryresults
[0m13:05:31.379595 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:31.379986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faa6e0>]}
[0m13:05:31.380228 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m13:05:31.380484 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:05:31.380603 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m13:05:31.380729 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m13:05:31.381096 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:05:31.381191 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m13:05:31.381331 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m13:05:31.383847 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:05:31.384281 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:31.384395 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m13:05:31.395366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:31.858826 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:05:31.859831 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:05:32.282997 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bf27ccc2-3f58-4567-96f6-ce1e90eff75c:europe-west1&page=queryresults
[0m13:05:32.285413 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:32.286020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9dde0>]}
[0m13:05:32.286311 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m13:05:32.286676 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:05:32.287128 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m13:05:32.288088 [info ] [Thread-2 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m13:05:32.288992 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m13:05:32.289183 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m13:05:32.289304 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m13:05:32.295723 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m13:05:32.296231 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:32.296348 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m13:05:32.317479 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m13:05:32.317867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:05:32.318625 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/
with StartDate as (
  SELECT CAST(CAST(min(start_time) AS STRING FORMAT 'YYYY-MM-DD') AS DATE) as start_date
  FROM `wawa-83630.raw_revenuecat__transactions.transactions`),



SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m13:05:32.827210 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]')
[0m13:05:33.361582 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:c0bf08bc-cb35-4abf-92e2-2083e90f080a&page=queryresults
[0m13:05:33.362652 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:33.363766 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m13:05:33.364216 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601fd00>]}
[0m13:05:33.364596 [error] [Thread-2 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.08s]
[0m13:05:33.364983 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m13:05:33.365161 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:33.365340 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m13:05:33.366057 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:05:33.366206 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:33.366323 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:33.371702 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:05:33.372208 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:33.372332 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:33.375579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:05:33.820634 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:05:33.821665 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m13:05:34.563079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:63705373-d7ec-4114-b637-06d0f58d5d43:europe-west1&page=queryresults
[0m13:05:34.566470 [debug] [Thread-1 (]: finished collecting timing info
[0m13:05:34.567418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7460>]}
[0m13:05:34.567902 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (339.0 rows, 44.1 KB processed)[0m in 3.19s]
[0m13:05:34.568448 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m13:05:36.118381 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:615c111b-ea69-455d-98be-f335f2f8dd57:europe-west1&page=queryresults
[0m13:05:36.119408 [debug] [Thread-2 (]: finished collecting timing info
[0m13:05:36.119781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2273e12c-7710-4aac-805b-27dd239d7493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d5ac20>]}
[0m13:05:36.119988 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 2.75s]
[0m13:05:36.120229 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:05:36.121214 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:05:36.125397 [info ] [MainThread]: 
[0m13:05:36.125606 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 8.76 seconds (8.76s).
[0m13:05:36.125747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:36.125819 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m13:05:36.125893 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m13:05:36.137501 [info ] [MainThread]: 
[0m13:05:36.137703 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:05:36.137842 [info ] [MainThread]: 
[0m13:05:36.137952 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)[0m
[0m13:05:36.138063 [error] [MainThread]:   Unrecognized name: clinic_id at [24:70]
[0m13:05:36.138168 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:05:36.138270 [info ] [MainThread]: 
[0m13:05:36.138371 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m13:05:36.138473 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]
[0m13:05:36.138574 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m13:05:36.138685 [info ] [MainThread]: 
[0m13:05:36.138793 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m13:05:36.138965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10198f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c69ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6b8b0>]}
[0m13:05:36.139106 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 13:16:16.141676 | c76d7d6d-a205-4ebe-9abd-87475bfe8795 ==============================
[0m13:16:16.141718 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:16:16.142514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:16:16.142607 [debug] [MainThread]: Tracking: tracking
[0m13:16:16.152580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108529120>]}
[0m13:16:16.189367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:16.189654 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:16:16.197504 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m13:16:16.211326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m13:16:16.213965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108765f30>]}
[0m13:16:16.218455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aae30>]}
[0m13:16:16.218608 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:16:16.218738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445ac50>]}
[0m13:16:16.219467 [info ] [MainThread]: 
[0m13:16:16.219771 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:16:16.220369 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:16:16.220494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:16.925242 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:16:16.925849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:17.494485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724dc0>]}
[0m13:16:17.495796 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:16:17.496235 [info ] [MainThread]: 
[0m13:16:17.502754 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:16:17.502957 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:16:17.505608 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m13:16:17.506070 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m13:16:17.507093 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:16:17.507760 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:16:17.507917 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:16:17.508127 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:16:17.508324 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:16:17.508521 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:16:17.552925 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:16:17.554844 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:16:17.555386 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:17.555485 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:16:17.572850 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:16:17.573059 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:17.573163 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:16:17.574611 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:16:17.574801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:16:17.575496 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:16:17.575590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:17.611829 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:16:18.396355 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6c2cb971-b835-4145-ab94-2c4049041e74:europe-west1&page=queryresults
[0m13:16:18.415420 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:18.416019 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088072e0>]}
[0m13:16:18.416366 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m13:16:18.416764 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:16:18.416925 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:16:18.417189 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m13:16:18.417771 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:16:18.417919 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:16:18.418048 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:16:18.419797 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:16:18.420415 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:18.420552 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:16:18.423017 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:16:18.423403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:16:18.424409 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m13:16:18.655940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9b2752ab-82ef-4141-bd53-b78fcd1836b2:europe-west1&page=queryresults
[0m13:16:18.657896 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:18.658442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fa4d0>]}
[0m13:16:18.658767 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m13:16:18.659136 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:16:18.659302 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:16:18.659569 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m13:16:18.660150 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:16:18.660291 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m13:16:18.660410 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m13:16:18.666893 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:16:18.667341 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:18.667459 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m13:16:18.672226 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:16:18.672583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.673463 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m13:16:19.440069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:46a2f8c5-3b2f-485f-9098-089b6180e9ae:europe-west1&page=queryresults
[0m13:16:19.442407 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:19.442829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f99c0>]}
[0m13:16:19.443024 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m13:16:19.443244 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:16:19.443344 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:16:19.443442 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m13:16:19.443727 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:16:19.443949 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:16:19.444309 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m13:16:19.446983 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:16:19.448214 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:19.448350 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:16:19.450018 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:16:19.450528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:19.451218 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m13:16:19.493518 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e367abec-0cf7-4a5f-85fc-2d75c32ad092:europe-west1&page=queryresults
[0m13:16:19.494508 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:19.494852 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108755c00>]}
[0m13:16:19.495018 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m13:16:19.495229 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:16:19.495325 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:16:19.495538 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m13:16:19.496012 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:16:19.496191 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:16:19.496570 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:16:19.497652 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:16:19.498430 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:19.498541 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:16:19.500153 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:16:19.500840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:16:19.501768 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m13:16:20.343386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:83f37df0-aaee-44f4-9977-be638410444f:europe-west1&page=queryresults
[0m13:16:20.346025 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:20.346721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108765540>]}
[0m13:16:20.347074 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m13:16:20.347484 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:16:20.347683 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m13:16:20.347979 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m13:16:20.348958 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:16:20.349144 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m13:16:20.349297 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m13:16:20.352874 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:16:20.354650 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:20.354841 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m13:16:20.370506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:20.522684 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:90653cae-7402-4880-9351-4fa7495464a7:europe-west1&page=queryresults
[0m13:16:20.523904 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:20.524289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724dc0>]}
[0m13:16:20.524512 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:16:20.524878 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:16:20.525171 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m13:16:20.525324 [info ] [Thread-2 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m13:16:20.525723 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m13:16:20.525827 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m13:16:20.525919 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m13:16:20.533166 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m13:16:20.534690 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:20.534820 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m13:16:20.560754 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m13:16:20.561174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:16:20.561924 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/
with StartDate as (
  SELECT CAST(CAST(min(start_time) AS STRING FORMAT 'YYYY-MM-DD') AS DATE) as start_date
  FROM `wawa-83630.raw_revenuecat__transactions.transactions`),



SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m13:16:20.798622 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:16:20.799513 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:16:20.992422 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]')
[0m13:16:22.043725 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:66eed835-f024-42ba-8633-eada7f7a9687&page=queryresults
[0m13:16:22.045410 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:22.046413 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m13:16:22.046780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a8d30>]}
[0m13:16:22.047269 [error] [Thread-2 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.52s]
[0m13:16:22.047747 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m13:16:22.047984 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:16:22.048216 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m13:16:22.049110 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:16:22.049356 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:16:22.049556 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:16:22.054902 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:16:22.055598 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:22.055770 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:16:22.058630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:16:22.748409 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:16:22.748877 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m13:16:23.582481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ff0c04c7-075d-4aa8-a04c-bf901cb18011:europe-west1&page=queryresults
[0m13:16:23.585201 [debug] [Thread-1 (]: finished collecting timing info
[0m13:16:23.586043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852a4a0>]}
[0m13:16:23.586559 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (340.0 rows, 44.4 KB processed)[0m in 3.24s]
[0m13:16:23.587132 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m13:16:25.679776 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d399d060-270f-4fb3-bd53-4b83ea98daf4:europe-west1&page=queryresults
[0m13:16:25.682153 [debug] [Thread-2 (]: finished collecting timing info
[0m13:16:25.683057 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c76d7d6d-a205-4ebe-9abd-87475bfe8795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108806fb0>]}
[0m13:16:25.683576 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 3.63s]
[0m13:16:25.684158 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:16:25.685972 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:16:25.686671 [info ] [MainThread]: 
[0m13:16:25.687000 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m13:16:25.687263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:25.687405 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m13:16:25.687535 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m13:16:25.709301 [info ] [MainThread]: 
[0m13:16:25.709630 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:16:25.709819 [info ] [MainThread]: 
[0m13:16:25.709967 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m13:16:25.710112 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [23:1]
[0m13:16:25.710241 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m13:16:25.710384 [info ] [MainThread]: 
[0m13:16:25.710529 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:16:25.710739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108532a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108532c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888ea10>]}
[0m13:16:25.710910 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 13:19:34.148144 | 27b7fe11-138d-4153-8ec4-f0adaca76985 ==============================
[0m13:19:34.148202 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:19:34.148938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:19:34.149046 [debug] [MainThread]: Tracking: tracking
[0m13:19:34.159593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174f5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174f5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174f4f40>]}
[0m13:19:34.197804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:34.198071 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m13:19:34.205406 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m13:19:34.206968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178d9420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11791bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11791bd60>]}
[0m13:19:34.207110 [debug] [MainThread]: Flushing usage events
[0m13:19:34.795598 [error] [MainThread]: Encountered an error:
Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  unexpected char '`' at 278
    line 10
      SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM {{ref(`stg_segment_ios__community_viewed_article`)}} as segment


============================== 2022-12-09 13:20:02.041689 | b30aebe2-b94d-428a-b2c9-b0565a7ee060 ==============================
[0m13:20:02.041729 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:20:02.042357 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:20:02.042480 [debug] [MainThread]: Tracking: tracking
[0m13:20:02.051735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4bfd0>]}
[0m13:20:02.088752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:02.089042 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m13:20:02.095314 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m13:20:02.103540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m13:20:02.112108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m13:20:02.114673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af14b0>]}
[0m13:20:02.119039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a773d0>]}
[0m13:20:02.119176 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:20:02.119303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4bfd0>]}
[0m13:20:02.120040 [info ] [MainThread]: 
[0m13:20:02.120343 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:20:02.120984 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:20:02.121124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:02.742130 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:20:02.742554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:03.201010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d49a0>]}
[0m13:20:03.201437 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:20:03.201577 [info ] [MainThread]: 
[0m13:20:03.204719 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:20:03.204823 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:20:03.205070 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m13:20:03.205284 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m13:20:03.205648 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:20:03.206070 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:20:03.206157 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:20:03.206298 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:20:03.206453 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:20:03.206648 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:20:03.207642 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:20:03.208541 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:20:03.209282 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:03.209425 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:03.209537 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:20:03.209642 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:20:03.229407 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:20:03.230557 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:20:03.230955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:03.231084 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:20:03.231835 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:20:03.232452 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:20:04.044810 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a1d03129-f8a8-4d4d-bb66-fcecf5fabdc0:europe-west1&page=queryresults
[0m13:20:04.066073 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:04.066705 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac65f0>]}
[0m13:20:04.067050 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m13:20:04.067465 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:20:04.068633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:88d612d0-d2a5-4155-96e1-fbfd4caf39c6:europe-west1&page=queryresults
[0m13:20:04.068873 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:20:04.069978 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:04.070194 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m13:20:04.070571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d77160>]}
[0m13:20:04.071046 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:20:04.071319 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m13:20:04.071449 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:20:04.071720 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:20:04.071840 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:20:04.072013 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:20:04.073521 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:20:04.073787 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m13:20:04.075912 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:20:04.076186 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m13:20:04.076342 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m13:20:04.076459 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:04.077758 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:20:04.077906 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:20:04.080171 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:20:04.080473 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:04.080609 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m13:20:04.082569 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:20:04.082702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:04.083707 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m13:20:04.083911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:04.126988 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m13:20:04.951848 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5b482061-5c21-40bc-9654-b0be98a8f43a:europe-west1&page=queryresults
[0m13:20:04.954115 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:04.955756 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d771c0>]}
[0m13:20:04.956333 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m13:20:04.956945 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:20:04.957110 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:20:04.957494 [info ] [Thread-2 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m13:20:04.958274 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:20:04.958472 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:20:04.958603 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m13:20:04.960528 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:20:04.964062 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:04.964770 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:20:04.968107 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:20:04.968856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:04.969849 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m13:20:05.056991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:598ff449-77fc-40b1-8d41-9649d2cdd5ac:europe-west1&page=queryresults
[0m13:20:05.057957 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:05.058285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af19f0>]}
[0m13:20:05.058463 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m13:20:05.058667 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:20:05.058773 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:20:05.058877 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m13:20:05.059188 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:20:05.059329 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:20:05.059449 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:20:05.060464 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:20:05.061120 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:05.061270 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:20:05.066318 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:20:05.066623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.067358 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m13:20:06.023580 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:70537d39-8dfe-4a2f-b97a-42dbdac4c71b:europe-west1&page=queryresults
[0m13:20:06.026567 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:06.027069 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb5780>]}
[0m13:20:06.027328 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m13:20:06.027624 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:20:06.027765 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m13:20:06.027921 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m13:20:06.028500 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:20:06.028634 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m13:20:06.028744 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m13:20:06.031371 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:20:06.032265 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:06.032390 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m13:20:06.041029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:06.099657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:45725189-aa5c-4076-83eb-b7ad5aee811e:europe-west1&page=queryresults
[0m13:20:06.100577 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:06.100869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c96410>]}
[0m13:20:06.101041 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m13:20:06.101236 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:20:06.101441 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m13:20:06.101555 [info ] [Thread-1 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m13:20:06.101840 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m13:20:06.101913 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m13:20:06.101982 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m13:20:06.104289 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m13:20:06.105734 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:06.105845 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m13:20:06.131382 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m13:20:06.131865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:06.132604 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)


    );
  
[0m13:20:06.534874 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:20:06.535428 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:20:09.325033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:320bff3b-8f07-4eb0-ad33-de1a44dd890d:europe-west1&page=queryresults
[0m13:20:09.326840 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:09.327275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111caae60>]}
[0m13:20:09.327526 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (340.0 rows, 44.4 KB processed)[0m in 3.30s]
[0m13:20:09.327822 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m13:20:09.327961 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:20:09.328166 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m13:20:09.328582 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:20:09.328692 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:20:09.329009 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:20:09.338566 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:20:09.338982 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:09.339100 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:20:09.343758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:09.417265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:218a09f4-3040-43e1-861b-6fd9a0c68961:europe-west1&page=queryresults
[0m13:20:09.418192 [debug] [Thread-1 (]: finished collecting timing info
[0m13:20:09.418545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111beb670>]}
[0m13:20:09.418753 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mCREATE TABLE (16.1k rows, 35.8 MB processed)[0m in 3.32s]
[0m13:20:09.418987 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m13:20:09.748216 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:20:09.749094 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m13:20:12.635591 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d9e5435b-fffe-4092-a605-87352a2d7d56:europe-west1&page=queryresults
[0m13:20:12.638020 [debug] [Thread-2 (]: finished collecting timing info
[0m13:20:12.638823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30aebe2-b94d-428a-b2c9-b0565a7ee060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2b400>]}
[0m13:20:12.639280 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 551.0 KB processed)[0m in 3.31s]
[0m13:20:12.639816 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:20:12.641564 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:20:12.642257 [info ] [MainThread]: 
[0m13:20:12.642584 [info ] [MainThread]: Finished running 6 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 10.52 seconds (10.52s).
[0m13:20:12.642849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:12.642986 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m13:20:12.643117 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m13:20:12.654695 [info ] [MainThread]: 
[0m13:20:12.654982 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:12.655217 [info ] [MainThread]: 
[0m13:20:12.655401 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:20:12.655669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b2020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a90070>]}
[0m13:20:12.655874 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 14:44:57.909056 | dc80e9cb-7134-4d7f-b5fc-4221a476b130 ==============================
[0m14:44:57.909095 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:44:57.909879 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:44:57.909992 [debug] [MainThread]: Tracking: tracking
[0m14:44:57.922170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102748df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10274b910>]}
[0m14:44:57.957316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:57.957697 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:44:57.965239 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:44:57.982057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m14:44:57.985078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106410850>]}
[0m14:44:57.989755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636f400>]}
[0m14:44:57.989913 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:44:57.990044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027c8610>]}
[0m14:44:57.990815 [info ] [MainThread]: 
[0m14:44:57.991126 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:44:57.991742 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:44:57.991866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:58.735270 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:44:58.735863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:59.124293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e8d60>]}
[0m14:44:59.125600 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:44:59.126009 [info ] [MainThread]: 
[0m14:44:59.132978 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:44:59.133202 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:44:59.136190 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m14:44:59.136525 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m14:44:59.137226 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:44:59.137998 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:44:59.138437 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:44:59.138586 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:44:59.138752 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:44:59.138879 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:44:59.181415 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:44:59.184034 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:44:59.184292 [debug] [Thread-2 (]: finished collecting timing info
[0m14:44:59.184372 [debug] [Thread-1 (]: finished collecting timing info
[0m14:44:59.184462 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:44:59.184541 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:44:59.201468 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:44:59.202950 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:44:59.203309 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:59.203421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:59.204083 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:44:59.204648 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:45:00.001257 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:91a16d47-4b49-411e-91f8-cc63fc473e79:europe-west1&page=queryresults
[0m14:45:00.020640 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:00.021277 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f84f0>]}
[0m14:45:00.021603 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m14:45:00.021991 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:45:00.022163 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:45:00.022334 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m14:45:00.022807 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:45:00.023016 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:45:00.023184 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:45:00.024742 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:45:00.026554 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:00.026702 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:45:00.029135 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:45:00.029551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:00.030531 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:45:00.293172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:df721fb6-4e3a-40f2-b75e-7a4525aff204:europe-west1&page=queryresults
[0m14:45:00.295484 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:00.296206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8700>]}
[0m14:45:00.296636 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m14:45:00.297136 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:45:00.297348 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:45:00.297702 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m14:45:00.299031 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:45:00.299226 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:45:00.299369 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:45:00.307390 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:45:00.307895 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:00.308043 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:45:00.313043 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:45:00.313459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:00.314466 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  ARRAY_AGG(JSON_VALUE(properties,'$.insert_id')) as event_id_array,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m14:45:01.106337 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:780ba1ec-030d-4277-8c93-b3cbde43c28a:europe-west1&page=queryresults
[0m14:45:01.109795 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:01.110635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106427ca0>]}
[0m14:45:01.111097 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m14:45:01.111627 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:45:01.112103 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:45:01.112507 [info ] [Thread-2 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:45:01.113435 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:45:01.113651 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:45:01.113841 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:45:01.116355 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:45:01.118752 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:01.118957 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:45:01.122103 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:45:01.122830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:01.123920 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:45:01.317826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5d2704d4-eb60-45f1-a033-53e7ead344ae:europe-west1&page=queryresults
[0m14:45:01.319418 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:01.319918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064255a0>]}
[0m14:45:01.320207 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m14:45:01.320542 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:45:01.320698 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:45:01.320963 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:45:01.321535 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:45:01.321675 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:45:01.321799 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:45:01.323352 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:45:01.324966 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:01.325095 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:45:01.327354 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:45:01.327767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:01.328762 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:45:01.976613 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a4da0a1d-71a1-4d61-845d-4d81a9f32c83:europe-west1&page=queryresults
[0m14:45:01.980469 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:01.981517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106539ab0>]}
[0m14:45:01.982028 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m14:45:01.982628 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:45:01.982902 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m14:45:01.983297 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m14:45:01.984208 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:45:01.984409 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m14:45:01.984583 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m14:45:01.989289 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:45:01.991529 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:01.991702 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m14:45:02.002039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:02.386194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e0bad3d8-0123-4e28-85e5-cc72b373cbfa:europe-west1&page=queryresults
[0m14:45:02.397343 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:02.398139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a5750>]}
[0m14:45:02.398560 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m14:45:02.399041 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:45:02.399480 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m14:45:02.399688 [info ] [Thread-1 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m14:45:02.400246 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:45:02.400395 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:45:02.400539 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m14:45:02.413152 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:45:02.413945 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:02.414097 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m14:45:02.434718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:02.482283 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:45:02.482673 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:45:02.946218 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:45:02.946989 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m14:45:03.367693 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [25:3]')
[0m14:45:05.021066 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:795f25f3-78ea-43f0-a119-828df071c71e:europe-west1&page=queryresults
[0m14:45:05.025290 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:05.026271 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8640>]}
[0m14:45:05.026707 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (340.0 rows, 44.4 KB processed)[0m in 3.04s]
[0m14:45:05.027212 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m14:45:05.027431 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:45:05.027776 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m14:45:05.028547 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:45:05.028738 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:45:05.028910 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:45:05.034127 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:45:05.034827 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:05.034989 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:45:05.037846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:05.087377 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:a4bc9544-23e8-401a-ab08-00102ccfc26c&page=queryresults
[0m14:45:05.087695 [debug] [Thread-1 (]: finished collecting timing info
[0m14:45:05.088007 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [25:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m14:45:05.088128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ec220>]}
[0m14:45:05.088301 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 2.69s]
[0m14:45:05.088537 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m14:45:05.417759 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:45:05.418863 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m14:45:08.896519 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ba8562db-ccdd-4540-8a2a-22c4803c6d87:europe-west1&page=queryresults
[0m14:45:08.899329 [debug] [Thread-2 (]: finished collecting timing info
[0m14:45:08.899998 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc80e9cb-7134-4d7f-b5fc-4221a476b130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065446a0>]}
[0m14:45:08.900402 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (13.0 rows, 554.3 KB processed)[0m in 3.87s]
[0m14:45:08.900853 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:45:08.902236 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:45:08.902745 [info ] [MainThread]: 
[0m14:45:08.902972 [info ] [MainThread]: Finished running 6 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 10.91 seconds (10.91s).
[0m14:45:08.903160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:08.903261 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:45:08.903357 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m14:45:08.918507 [info ] [MainThread]: 
[0m14:45:08.918766 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:45:08.918952 [info ] [MainThread]: 
[0m14:45:08.919111 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m14:45:08.919272 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [25:3]
[0m14:45:08.919419 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m14:45:08.919580 [info ] [MainThread]: 
[0m14:45:08.919739 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:45:08.919965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106152470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061535e0>]}
[0m14:45:08.920142 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 14:50:24.353398 | 9ef9d55d-734d-47eb-9377-e33d9569d29d ==============================
[0m14:50:24.353434 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:50:24.354186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:50:24.354288 [debug] [MainThread]: Tracking: tracking
[0m14:50:24.369069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e21450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e21390>]}
[0m14:50:24.405627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:24.405867 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:50:24.412130 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:50:24.425858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m14:50:24.428540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a034f10>]}
[0m14:50:24.433205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fbb9d0>]}
[0m14:50:24.433384 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:50:24.433519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c6aa0>]}
[0m14:50:24.434315 [info ] [MainThread]: 
[0m14:50:24.434653 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:50:24.435406 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:50:24.435615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:25.178180 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:50:25.178751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:25.562835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e302b0>]}
[0m14:50:25.563441 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:50:25.563686 [info ] [MainThread]: 
[0m14:50:25.567089 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:25.567234 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:50:25.568773 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m14:50:25.568946 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m14:50:25.569489 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:50:25.570146 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:50:25.570334 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:25.570455 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:50:25.570602 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:50:25.570717 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:50:25.609490 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:50:25.612192 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:50:25.612397 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:25.612499 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:50:25.612570 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:25.628627 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:50:25.628779 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:25.630269 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:50:25.630536 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:25.631186 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:50:25.666468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:25.667173 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:50:26.512233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:481fa8b5-a997-42f6-b118-dbe3d8935ae0:europe-west1&page=queryresults
[0m14:50:26.523129 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:26.523793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7373b825-e55e-4d99-a165-69167af2df48:europe-west1&page=queryresults
[0m14:50:26.524123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a035300>]}
[0m14:50:26.525010 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:26.525301 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m14:50:26.525637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a020b80>]}
[0m14:50:26.525863 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:26.526009 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:50:26.526117 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:26.526436 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:50:26.526621 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m14:50:26.526785 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:26.527204 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:50:26.527449 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m14:50:26.527552 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:26.527868 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:50:26.528011 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:26.528100 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:26.529177 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:50:26.529273 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:26.530143 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:50:26.530380 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:26.530472 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:26.530540 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:26.532296 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:50:26.532496 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:26.535666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:26.536664 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:50:26.540757 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:50:26.579985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:26.580761 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  ARRAY_AGG(JSON_VALUE(properties,'$.insert_id') ignore nulls) as event_id_array,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m14:50:27.385051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dda54d0c-a396-4354-adc5-cab318221751:europe-west1&page=queryresults
[0m14:50:27.388328 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:27.389213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17d7e0>]}
[0m14:50:27.389739 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m14:50:27.390315 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:27.390534 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:27.390903 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:50:27.391663 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:50:27.391859 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:27.392045 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:27.394338 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:50:27.395908 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:27.396159 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:27.399337 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:50:27.400197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:27.401583 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:50:27.566896 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:10e34077-8cc3-45dd-a1de-d71789aa8a56:europe-west1&page=queryresults
[0m14:50:27.568106 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:27.568481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a005990>]}
[0m14:50:27.568698 [info ] [Thread-2 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m14:50:27.568952 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:27.569069 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:27.569256 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:50:27.569613 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:50:27.569724 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:27.569813 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:27.571018 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:50:27.571354 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:27.571456 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:27.573322 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:50:27.573624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:27.574417 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:50:28.419195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7eea6c20-dd42-4466-b8b1-fe0a0b083553:europe-west1&page=queryresults
[0m14:50:28.422048 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:28.422936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a164190>]}
[0m14:50:28.424758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b8f66e39-90bf-429c-99cf-e847c61013b7:europe-west1&page=queryresults
[0m14:50:28.425159 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m14:50:28.426830 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:28.427310 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:28.427865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df3580>]}
[0m14:50:28.428101 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m14:50:28.428527 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m14:50:28.428929 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m14:50:28.429313 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:28.429950 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:50:28.430431 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m14:50:28.430584 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m14:50:28.430733 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m14:50:28.430964 [info ] [Thread-2 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m14:50:28.435109 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:50:28.435836 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:50:28.436150 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:50:28.436310 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m14:50:28.444570 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:50:28.444887 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:28.445062 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m14:50:28.447544 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:28.448912 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m14:50:28.467905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:28.518518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:29.164704 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:50:29.166931 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:50:29.218024 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:50:29.218551 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m14:50:29.960258 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [25:3]')
[0m14:50:31.052942 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:9abf23bf-5c77-4153-95cc-79789ec05f4c&page=queryresults
[0m14:50:31.054471 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:31.055686 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [25:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m14:50:31.056455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1954b0>]}
[0m14:50:31.057079 [error] [Thread-2 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 2.62s]
[0m14:50:31.057677 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m14:50:31.057952 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:50:31.058528 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m14:50:31.059728 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:50:31.060002 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:50:31.060216 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:50:31.066110 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:50:31.068695 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:31.068973 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:50:31.071925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:31.551990 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:50:31.553431 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m14:50:31.987960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b27aa360-09d1-4a70-8bf5-8998fedf7b51:europe-west1&page=queryresults
[0m14:50:31.991935 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:31.993010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c0490>]}
[0m14:50:31.993568 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (340.0 rows, 44.4 KB processed)[0m in 3.56s]
[0m14:50:31.994154 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m14:50:34.084881 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23eca790-9353-4149-af4d-fd447a7e21f8:europe-west1&page=queryresults
[0m14:50:34.088296 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:34.089239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef9d55d-734d-47eb-9377-e33d9569d29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e20fd0>]}
[0m14:50:34.089720 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 554.4 KB processed)[0m in 3.03s]
[0m14:50:34.090205 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:50:34.091886 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:50:34.092569 [info ] [MainThread]: 
[0m14:50:34.092883 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m14:50:34.093137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:34.093274 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m14:50:34.093404 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m14:50:34.103678 [info ] [MainThread]: 
[0m14:50:34.103955 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:34.104157 [info ] [MainThread]: 
[0m14:50:34.104334 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m14:50:34.104517 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [25:3]
[0m14:50:34.104681 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m14:50:34.104861 [info ] [MainThread]: 
[0m14:50:34.105032 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:50:34.105277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a05bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb9cf0>]}
[0m14:50:34.105471 [debug] [MainThread]: Flushing usage events


============================== 2022-12-09 14:57:03.206548 | 194f2447-41b3-4eb4-b772-74d7ce4c56e9 ==============================
[0m14:57:03.206595 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:57:03.207437 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:57:03.207541 [debug] [MainThread]: Tracking: tracking
[0m14:57:03.218134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b45e0>]}
[0m14:57:03.256207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:03.256501 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:57:03.264305 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:57:03.278417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m14:57:03.281122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab901c0>]}
[0m14:57:03.285610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2a590>]}
[0m14:57:03.285753 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:57:03.285881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106667be0>]}
[0m14:57:03.286678 [info ] [MainThread]: 
[0m14:57:03.287000 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:57:03.287594 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:57:03.287731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:04.066098 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:57:04.066604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:04.364241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4d30>]}
[0m14:57:04.364961 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:57:04.365160 [info ] [MainThread]: 
[0m14:57:04.369890 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:57:04.370203 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:57:04.371912 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m14:57:04.372413 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m14:57:04.373119 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:57:04.373668 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:57:04.373777 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:57:04.373868 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:57:04.373972 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:57:04.374053 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:57:04.417429 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:57:04.419824 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:57:04.420091 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:04.420168 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:04.420270 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:57:04.420351 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:57:04.438194 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:57:04.439735 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:57:04.440079 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:57:04.440173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:04.440904 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:57:04.441464 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:57:05.393985 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0007c9d2-0cdd-4469-a062-944ac548c6ce:europe-west1&page=queryresults
[0m14:57:05.411069 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:05.411608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b4700>]}
[0m14:57:05.411844 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m14:57:05.412122 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:57:05.412246 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:57:05.412382 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m14:57:05.412859 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:57:05.412963 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:57:05.413057 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:57:05.414297 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:57:05.415427 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9a97240c-767b-4523-9887-0cb3d9d7d5f9:europe-west1&page=queryresults
[0m14:57:05.416524 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:05.417025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2bc40>]}
[0m14:57:05.417161 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:05.417443 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m14:57:05.417593 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:57:05.417866 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:57:05.420110 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:57:05.420332 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:57:05.420846 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m14:57:05.421393 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:57:05.421571 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:57:05.421714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:05.421854 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:57:05.422760 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:57:05.423887 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:57:05.465590 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:05.465708 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:57:05.472248 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:57:05.472557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:05.473235 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  ARRAY_AGG(JSON_VALUE(properties,'$."$insert_id"') ignore nulls) as event_id_array,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m14:57:06.465967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:11ee7a04-1459-4a78-b5b4-07b061dff6ab:europe-west1&page=queryresults
[0m14:57:06.467789 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7eab7a69-e1ff-4830-bedd-0ef20d3d3077:europe-west1&page=queryresults
[0m14:57:06.470152 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:06.472104 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:06.472812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a35510>]}
[0m14:57:06.473272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae34580>]}
[0m14:57:06.473715 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m14:57:06.474008 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m14:57:06.474418 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:57:06.474719 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:57:06.474908 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:57:06.475121 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:57:06.475557 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:57:06.475764 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:57:06.476360 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:57:06.476896 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:57:06.477220 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:57:06.477471 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:57:06.477658 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:57:06.477799 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:57:06.479670 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:57:06.481055 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:57:06.483572 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:06.483759 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:57:06.483881 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:06.486583 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:57:06.486788 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:57:06.489033 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:57:06.489370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:06.489506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:06.490533 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:57:06.535035 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:57:07.421350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c84656cf-5165-4254-92cf-c656faad0460:europe-west1&page=queryresults
[0m14:57:07.422682 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:07.423102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b51e0>]}
[0m14:57:07.423337 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m14:57:07.423618 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:57:07.423745 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m14:57:07.423878 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m14:57:07.424341 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:57:07.424445 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m14:57:07.424544 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m14:57:07.427176 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:57:07.428581 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:07.428715 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m14:57:07.437510 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0d376a55-1b31-4ba1-af88-e4f5f0956509:europe-west1&page=queryresults
[0m14:57:07.439771 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:07.442029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:07.442355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab6e320>]}
[0m14:57:07.442600 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m14:57:07.442866 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:57:07.483672 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m14:57:07.483889 [info ] [Thread-2 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m14:57:07.484231 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:57:07.484307 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:57:07.484381 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m14:57:07.491089 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:57:07.492621 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:07.492712 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m14:57:07.507668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:07.893740 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:57:07.911285 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:57:07.911713 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:57:07.911837 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m14:57:08.277521 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [25:3]')
[0m14:57:08.915250 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:9e68ce33-60d7-458b-abd1-b424ac6d3365&page=queryresults
[0m14:57:08.917110 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:08.918489 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [25:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m14:57:08.919207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae702b0>]}
[0m14:57:08.919875 [error] [Thread-2 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.44s]
[0m14:57:08.920475 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m14:57:08.920743 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:57:08.921046 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m14:57:08.922223 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:57:08.922493 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:57:08.922688 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:57:08.928218 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:57:08.930394 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:08.930601 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:57:08.933575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:09.310882 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:57:09.313412 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m14:57:10.233459 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6132a2e0-c195-4ce3-9257-77c12c35c382:europe-west1&page=queryresults
[0m14:57:10.236141 [debug] [Thread-1 (]: finished collecting timing info
[0m14:57:10.236979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab871c0>]}
[0m14:57:10.237494 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (340.0 rows, 44.4 KB processed)[0m in 2.81s]
[0m14:57:10.238019 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m14:57:11.611318 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:296e1bc9-5d95-43dc-bda2-6ff67ccbb39a:europe-west1&page=queryresults
[0m14:57:11.613780 [debug] [Thread-2 (]: finished collecting timing info
[0m14:57:11.614674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f2447-41b3-4eb4-b772-74d7ce4c56e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae73b20>]}
[0m14:57:11.615183 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (6.0 rows, 555.8 KB processed)[0m in 2.69s]
[0m14:57:11.615776 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:57:11.617581 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:57:11.618291 [info ] [MainThread]: 
[0m14:57:11.618618 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m14:57:11.618883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:11.619020 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m14:57:11.619151 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m14:57:11.641623 [info ] [MainThread]: 
[0m14:57:11.641869 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:11.642051 [info ] [MainThread]: 
[0m14:57:11.642208 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m14:57:11.642363 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [25:3]
[0m14:57:11.642509 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m14:57:11.642670 [info ] [MainThread]: 
[0m14:57:11.642823 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:57:11.643036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab6e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae4ac20>]}
[0m14:57:11.643211 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 08:48:00.139540 | 0b3c86bd-4492-4263-886d-9f4999e800b7 ==============================
[0m08:48:00.139629 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:48:00.143555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:48:00.143709 [debug] [MainThread]: Tracking: tracking
[0m08:48:00.158436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297cf40>]}
[0m08:48:00.198630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:48:00.198785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:48:00.199101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m08:48:00.202274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0c1f0>]}
[0m08:48:00.207899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8dc0>]}
[0m08:48:00.208104 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:48:00.208234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b30d0>]}
[0m08:48:00.209045 [info ] [MainThread]: 
[0m08:48:00.209369 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:48:00.210015 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:48:00.210166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:48:00.826690 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:48:00.827242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:48:01.171042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd82e0>]}
[0m08:48:01.172043 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:48:01.172367 [info ] [MainThread]: 
[0m08:48:01.179057 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:48:01.179239 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:48:01.179584 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m08:48:01.179836 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m08:48:01.180560 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:48:01.181141 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:48:01.181469 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:48:01.181765 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:48:01.181983 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:48:01.182127 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:48:01.184368 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:48:01.185915 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:48:01.187788 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:01.187922 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:01.188087 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:48:01.188234 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:48:01.211142 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:48:01.213031 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:48:01.213667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:01.213838 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:48:01.214609 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:48:01.216038 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:48:02.808843 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a34010f8-cb33-40ad-b804-fc3ae6988346:europe-west1&page=queryresults
[0m08:48:02.820955 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:02.821351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8b20>]}
[0m08:48:02.821581 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m08:48:02.821847 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:48:02.821968 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:48:02.822167 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m08:48:02.822599 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:48:02.822706 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:48:02.822800 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:48:02.823956 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:48:02.825975 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:02.826112 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:48:02.866717 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:48:02.867145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:48:02.867817 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:48:04.531720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:07fbe450-ff4b-44db-83fc-600d661e60cc:europe-west1&page=queryresults
[0m08:48:04.535725 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:04.536732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd89a0>]}
[0m08:48:04.537245 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 3.36s]
[0m08:48:04.537811 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:48:04.538064 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:48:04.538336 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m08:48:04.539522 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:48:04.539736 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:48:04.539905 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:48:04.544372 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:48:04.545179 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:04.545358 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:48:04.548343 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:48:04.548953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:04.550385 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  ARRAY_AGG(JSON_VALUE(properties,'$."$insert_id"') ignore nulls) as event_id_array,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m08:48:04.600138 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4fbb34cd-0b6c-42b9-9cbe-de8a64b71b8f:europe-west1&page=queryresults
[0m08:48:04.601378 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:04.601724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107074dc0>]}
[0m08:48:04.601893 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m08:48:04.602091 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:48:04.602181 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:48:04.602279 [info ] [Thread-2 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:48:04.602667 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:48:04.602810 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:48:04.603142 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:48:04.604089 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:48:04.605767 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:04.605867 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:48:04.607448 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:48:04.607856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:48:04.608574 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m08:48:05.259098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cd3a7110-bb6c-4600-9a6a-78126ec8c57e:europe-west1&page=queryresults
[0m08:48:05.261960 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:05.262505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9bbe0>]}
[0m08:48:05.262774 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m08:48:05.263059 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:48:05.263193 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:48:05.263416 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:48:05.263907 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:48:05.264028 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:48:05.264133 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:48:05.266152 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:48:05.266830 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:05.267008 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:48:05.270126 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:48:05.270632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:05.272138 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m08:48:05.427636 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:71819a00-d9ee-4d6f-8d32-e059770adf85:europe-west1&page=queryresults
[0m08:48:05.429125 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:05.429545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11453cee0>]}
[0m08:48:05.429785 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m08:48:05.430059 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:48:05.430248 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:48:05.430646 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m08:48:05.431193 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:48:05.431313 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:48:05.431421 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:48:05.438792 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:48:05.439168 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:05.439276 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:48:05.450185 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:48:05.846010 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:48:05.848398 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:48:05.996636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b0a76ce2-bea7-4b1d-a488-1ecb89d0a397:europe-west1&page=queryresults
[0m08:48:06.000172 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:06.001145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ccb4c0>]}
[0m08:48:06.001634 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m08:48:06.002182 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:48:06.002748 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m08:48:06.003127 [info ] [Thread-1 (]: 8 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m08:48:06.003962 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:48:06.004177 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:48:06.004370 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m08:48:06.015777 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:48:06.017877 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:06.018033 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m08:48:06.041146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:06.404761 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:48:06.407024 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:48:06.732761 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [25:3]')
[0m08:48:07.697552 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:66d67deb-b67c-4bdf-9067-9b1110f63d48&page=queryresults
[0m08:48:07.698374 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:07.699083 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [25:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m08:48:07.699385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145b52a0>]}
[0m08:48:07.699826 [error] [Thread-1 (]: 8 of 9 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.70s]
[0m08:48:07.700266 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m08:48:07.700482 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:48:07.700865 [info ] [Thread-1 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m08:48:07.701636 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m08:48:07.701840 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:48:07.702031 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:48:07.706940 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m08:48:07.707787 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:07.707968 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:48:07.714053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:48:08.055503 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m08:48:08.056145 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m08:48:08.484585 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:97b79965-35c9-4a03-8a19-be6b525df356:europe-west1&page=queryresults
[0m08:48:08.487306 [debug] [Thread-2 (]: finished collecting timing info
[0m08:48:08.487777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ccb610>]}
[0m08:48:08.488005 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.06s]
[0m08:48:08.488257 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:48:10.926554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:10143182-76ee-4ed8-8b7d-3b7643afe848:europe-west1&page=queryresults
[0m08:48:10.929247 [debug] [Thread-1 (]: finished collecting timing info
[0m08:48:10.930156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3c86bd-4492-4263-886d-9f4999e800b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ccbcd0>]}
[0m08:48:10.930654 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (9.0 rows, 560.0 KB processed)[0m in 3.23s]
[0m08:48:10.931214 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:48:10.933168 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:48:10.933965 [info ] [MainThread]: 
[0m08:48:10.934291 [info ] [MainThread]: Finished running 6 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m08:48:10.934554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:48:10.934690 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m08:48:10.934821 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m08:48:10.945723 [info ] [MainThread]: 
[0m08:48:10.946007 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:48:10.946141 [info ] [MainThread]: 
[0m08:48:10.946246 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m08:48:10.946352 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [25:3]
[0m08:48:10.946450 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m08:48:10.946559 [info ] [MainThread]: 
[0m08:48:10.946674 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m08:48:10.946971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145b8c70>]}
[0m08:48:10.947195 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 08:49:48.241528 | bf202ea2-7a4a-479d-9d97-6f7634cf4f6b ==============================
[0m08:49:48.241580 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:49:48.242502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:49:48.242639 [debug] [MainThread]: Tracking: tracking
[0m08:49:48.265118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d39330>]}
[0m08:49:48.310360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:49:48.310621 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/mixpanel/stg_mixpanel_non_aggregated_viewed_article.sql
[0m08:49:48.318996 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel_non_aggregated_viewed_article.sql
[0m08:49:48.334731 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m08:49:48.337563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f48d90>]}
[0m08:49:48.342842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d41330>]}
[0m08:49:48.343057 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m08:49:48.343208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e2e650>]}
[0m08:49:48.344067 [info ] [MainThread]: 
[0m08:49:48.344397 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:49:48.345087 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:49:48.345235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:48.799921 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:49:48.800430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:49.154407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f34d90>]}
[0m08:49:49.155367 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:49:49.155729 [info ] [MainThread]: 
[0m08:49:49.160044 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:49:49.161348 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:49:49.161866 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:49:49.162201 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:49:49.162346 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:49:49.162437 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:49:49.162603 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:49:49.203469 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:49:49.203607 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:49:49.205624 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:49:49.205735 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:49:49.207886 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:49:49.208127 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:49.208230 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:49:49.225462 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:49:49.225689 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:49.225805 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:49:49.227376 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:49:49.227558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:49.228285 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:49:49.228384 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:49:49.229085 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:49:49.928223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c3f74a4c-cf08-46e4-b7d3-7b2b56e5e5c8:europe-west1&page=queryresults
[0m08:49:49.947412 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:49.948032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4a170>]}
[0m08:49:49.948379 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m08:49:49.948780 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:49:49.948947 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:49:49.949217 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m08:49:49.949787 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:49:49.949935 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:49:49.950071 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:49:49.951833 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:49:49.954651 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:49.954845 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:49:49.957301 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:49:49.957746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:49.958799 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:49:50.096317 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2cb80d1b-60d3-4e11-a12b-89c4a5e79671:europe-west1&page=queryresults
[0m08:49:50.100127 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:50.100660 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106096fe0>]}
[0m08:49:50.100892 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m08:49:50.101166 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:49:50.101284 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:49:50.101550 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m08:49:50.102021 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:49:50.102139 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:49:50.102237 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:49:50.105781 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:49:50.106182 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:50.106282 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:49:50.108149 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:49:50.108526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:49:50.109364 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  ARRAY_AGG(JSON_VALUE(properties,'$."$insert_id"') ignore nulls) as event_id_array,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
GROUP BY JSON_VALUE(properties,'$.Reading session'), referrer, slug, clinic_id, user_id, category, os;


[0m08:49:50.635701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:36068558-2b1e-4fba-8f54-a84aab93c7ef:europe-west1&page=queryresults
[0m08:49:50.641721 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:50.642728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1e3b0>]}
[0m08:49:50.643277 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m08:49:50.643877 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:49:50.644142 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel_non_aggregated_viewed_article
[0m08:49:50.644445 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_mixpanel_non_aggregated_viewed_article  [RUN]
[0m08:49:50.645795 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel_non_aggregated_viewed_article"
[0m08:49:50.646095 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel_non_aggregated_viewed_article
[0m08:49:50.646288 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel_non_aggregated_viewed_article
[0m08:49:50.648754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel_non_aggregated_viewed_article"
[0m08:49:50.649909 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:50.650199 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel_non_aggregated_viewed_article
[0m08:49:50.653847 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel_non_aggregated_viewed_article"
[0m08:49:50.654684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:50.656164 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel_non_aggregated_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel_non_aggregated_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel_non_aggregated_viewed_article`
  OPTIONS()
  as SELECT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m08:49:51.027949 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ecb9b5cf-6510-42e3-9244-9e77f3bee1a4:europe-west1&page=queryresults
[0m08:49:51.030891 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:51.031803 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e2c310>]}
[0m08:49:51.032307 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m08:49:51.032887 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:49:51.033148 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:49:51.033548 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:49:51.034310 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:49:51.034505 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:49:51.034680 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:49:51.037156 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:49:51.038903 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:51.039138 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:49:51.042370 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:49:51.043037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:49:51.043761 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m08:49:51.406028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3f8bf17b-8159-41ed-9448-cc7dcf0c166f:europe-west1&page=queryresults
[0m08:49:51.409253 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:51.410190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f48070>]}
[0m08:49:51.410685 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_mixpanel_non_aggregated_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m08:49:51.411217 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel_non_aggregated_viewed_article
[0m08:49:51.411467 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:49:51.411896 [info ] [Thread-1 (]: 7 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:49:51.412785 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:49:51.413005 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:49:51.413205 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:49:51.415299 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:49:51.415883 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:51.416076 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:49:51.426004 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:49:51.426646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:51.427871 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m08:49:51.969576 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:95c0268c-3f82-43ef-b5b0-e82b63974952:europe-west1&page=queryresults
[0m08:49:51.972697 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:51.973603 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610a620>]}
[0m08:49:51.974133 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m08:49:51.974718 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:49:51.974978 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:49:51.975369 [info ] [Thread-2 (]: 8 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m08:49:51.976114 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:49:51.976295 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:49:51.976467 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:49:51.980874 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:49:51.981957 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:51.982188 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:49:51.993151 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:49:52.359460 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:49:52.360574 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d9b09c28-271b-4d36-8630-484e627f4a89:europe-west1&page=queryresults
[0m08:49:52.362341 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:52.362946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0f6a0>]}
[0m08:49:52.363318 [info ] [Thread-1 (]: 7 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m08:49:52.363516 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:49:52.363879 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:49:52.365083 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m08:49:52.365294 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_evidence ................ [RUN]
[0m08:49:52.365832 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:49:52.365968 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:49:52.366095 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m08:49:52.373627 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:49:52.374871 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:52.375010 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m08:49:52.394709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:52.756684 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:49:52.757246 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:49:53.023754 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [25:3]')
[0m08:49:54.080690 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:6d249950-1b3e-41ea-9958-f71750493420&page=queryresults
[0m08:49:54.082209 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:54.083161 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [25:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m08:49:54.083538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060be200>]}
[0m08:49:54.084078 [error] [Thread-1 (]: 9 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ....... [[31mERROR[0m in 1.72s]
[0m08:49:54.084651 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m08:49:54.084921 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:49:54.085479 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m08:49:54.086387 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m08:49:54.086623 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:49:54.086835 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:49:54.099161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m08:49:54.099888 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:54.100038 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:49:54.106323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:54.450369 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m08:49:54.451170 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m08:49:55.235617 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bc5eda4a-b5a9-49ce-9562-7ef8c32d2600:europe-west1&page=queryresults
[0m08:49:55.237287 [debug] [Thread-2 (]: finished collecting timing info
[0m08:49:55.237665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d44190>]}
[0m08:49:55.237870 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.26s]
[0m08:49:55.238141 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:49:56.660708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ebac0c6f-3cf7-4f46-a48b-3d5663c1f614:europe-west1&page=queryresults
[0m08:49:56.664142 [debug] [Thread-1 (]: finished collecting timing info
[0m08:49:56.666011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf202ea2-7a4a-479d-9d97-6f7634cf4f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608c6a0>]}
[0m08:49:56.666898 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.58s]
[0m08:49:56.667527 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m08:49:56.681672 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:49:56.682197 [info ] [MainThread]: 
[0m08:49:56.682402 [info ] [MainThread]: Finished running 7 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m08:49:56.682560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:56.682639 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m08:49:56.682715 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m08:49:56.693841 [info ] [MainThread]: 
[0m08:49:56.694056 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:49:56.694203 [info ] [MainThread]: 
[0m08:49:56.694326 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m08:49:56.694448 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [25:3]
[0m08:49:56.694566 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m08:49:56.694786 [info ] [MainThread]: 
[0m08:49:56.695054 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m08:49:56.695331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d44280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d44160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1f9d0>]}
[0m08:49:56.695536 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:30:58.563875 | f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5 ==============================
[0m10:30:58.563903 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:30:58.564596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:30:58.564716 [debug] [MainThread]: Tracking: tracking
[0m10:30:58.582748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116f5120>]}
[0m10:30:58.622878 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m10:30:58.623147 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:30:58.623225 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/staging/mixpanel/stg_mixpanel_non_aggregated_viewed_article.sql
[0m10:30:58.623337 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m10:30:58.623437 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m10:30:58.629980 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:30:58.635629 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m10:30:58.636919 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m10:30:58.640879 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m10:30:58.650123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m10:30:58.652898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11191a2c0>]}
[0m10:30:58.657657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118bf1c0>]}
[0m10:30:58.657836 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:30:58.657966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104132c50>]}
[0m10:30:58.658877 [info ] [MainThread]: 
[0m10:30:58.659254 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:30:58.659949 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:30:58.660105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:59.465830 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:30:59.466420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:59.944216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fcd90>]}
[0m10:30:59.944568 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:30:59.944699 [info ] [MainThread]: 
[0m10:30:59.947664 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:30:59.947797 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:30:59.947926 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:30:59.948049 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:30:59.948375 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:30:59.948844 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:30:59.948960 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:30:59.949062 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:30:59.949148 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:30:59.949222 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:30:59.950236 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:30:59.951080 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:30:59.951902 [debug] [Thread-2 (]: finished collecting timing info
[0m10:30:59.951983 [debug] [Thread-1 (]: finished collecting timing info
[0m10:30:59.952072 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:30:59.952154 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:30:59.967056 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:30:59.968634 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:30:59.968968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:59.969073 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:30:59.969709 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:31:00.005544 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:31:00.804643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4bd578b9-0e93-45d7-bdc5-12e251093d4c:europe-west1&page=queryresults
[0m10:31:00.822266 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:00.823043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119e9c30>]}
[0m10:31:00.823423 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m10:31:00.823844 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:31:00.824022 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:00.824348 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m10:31:00.824992 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:31:00.825149 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:00.825305 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:00.831180 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:31:00.831834 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:00.831953 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:00.836553 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:31:00.837152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:00.838208 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m10:31:00.903562 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bfcf681b-589c-4ac6-bff0-8fd96f46d85b:europe-west1&page=queryresults
[0m10:31:00.904555 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:00.904861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119e21a0>]}
[0m10:31:00.905039 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m10:31:00.905250 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:31:00.905342 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:00.905450 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m10:31:00.905965 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:31:00.906172 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:00.906323 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:00.907472 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:31:00.907818 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:00.907907 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:00.909498 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:31:00.909758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:00.910483 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m10:31:01.669744 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f38dc63f-0836-444e-ac7d-fd91467e5f0d:europe-west1&page=queryresults
[0m10:31:01.672673 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:01.673506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116fffd0>]}
[0m10:31:01.673982 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m10:31:01.674502 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:01.674735 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:01.675133 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:31:01.675898 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:31:01.676214 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:01.676403 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:01.678479 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:31:01.680475 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:01.680654 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:01.683882 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:31:01.684630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:01.685897 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m10:31:01.835618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:81a48758-7c1d-49e6-ab8c-99ca84b2c59a:europe-west1&page=queryresults
[0m10:31:01.837072 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:01.837538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116fc6d0>]}
[0m10:31:01.837805 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m10:31:01.838101 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:01.838238 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:01.838458 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:31:01.838957 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:31:01.839077 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:01.839190 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:01.840607 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:31:01.841008 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:01.841128 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:01.847564 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:31:01.847963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:01.848879 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m10:31:02.613014 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:836b6017-f38a-4443-b91c-89452d2bbf2b:europe-west1&page=queryresults
[0m10:31:02.614874 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:02.615367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa2b30>]}
[0m10:31:02.615638 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m10:31:02.615961 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:02.616108 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m10:31:02.616561 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m10:31:02.617522 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:31:02.617731 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m10:31:02.617921 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m10:31:02.624565 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:31:02.626459 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:02.626670 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m10:31:02.634688 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:02.903585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7e634b50-625e-4f35-b5d3-99d1e0fabeba:europe-west1&page=queryresults
[0m10:31:02.905118 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:02.905605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ffd00>]}
[0m10:31:02.905884 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m10:31:02.906205 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:02.906336 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:02.906476 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m10:31:02.906890 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:31:02.907124 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:02.907412 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:02.909962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:31:02.910501 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:02.910627 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:02.912804 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:31:02.913217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:02.914187 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, event_id, user_id, category, os, clinic_id, max(original_timestamp),
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:31:03.041830 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:31:03.042309 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:31:03.761467 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reading_session at [9:10]')
[0m10:31:04.711105 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:e9ffcb44-34c5-4160-b8b6-b136fb4d9ed5&page=queryresults
[0m10:31:04.712566 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:04.713807 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  Unrecognized name: reading_session at [9:10]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:31:04.714485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111adc430>]}
[0m10:31:04.715297 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 1.81s]
[0m10:31:04.715963 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:04.716239 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:31:04.717140 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m10:31:04.718340 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:31:04.718583 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:31:04.718792 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:31:04.726592 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:31:04.727940 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:04.728204 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:31:04.757095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:05.121936 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:31:05.122871 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m10:31:05.396183 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:03ff4b70-759d-4f1f-b4cc-8f3f1e2ddd42:europe-west1&page=queryresults
[0m10:31:05.397878 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:05.398434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116feb60>]}
[0m10:31:05.398772 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.78s]
[0m10:31:05.399126 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m10:31:05.399287 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m10:31:05.399500 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m10:31:05.399756 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m10:31:07.596545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6173fd70-81e9-4c04-b42d-1018a28aaef4:europe-west1&page=queryresults
[0m10:31:07.598993 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:07.599891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48bf8fb-a7b5-4347-83e7-4a9bc9074bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af4130>]}
[0m10:31:07.600424 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.88s]
[0m10:31:07.600964 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:31:07.602726 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:31:07.603444 [info ] [MainThread]: 
[0m10:31:07.603772 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.94 seconds (8.94s).
[0m10:31:07.604035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:07.604175 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m10:31:07.604308 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m10:31:07.615292 [info ] [MainThread]: 
[0m10:31:07.615601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:31:07.615817 [info ] [MainThread]: 
[0m10:31:07.615998 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m10:31:07.616179 [error] [MainThread]:   Unrecognized name: reading_session at [9:10]
[0m10:31:07.616345 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:31:07.616528 [info ] [MainThread]: 
[0m10:31:07.616703 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m10:31:07.616954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e73d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e37520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ff9a0>]}
[0m10:31:07.617162 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:35:19.717762 | 04216949-f581-4e81-bb8a-e50682176d12 ==============================
[0m10:35:19.717830 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:35:19.718710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__agg_viewed_article.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:35:19.718869 [debug] [MainThread]: Tracking: tracking
[0m10:35:19.737609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637d120>]}
[0m10:35:19.778491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:19.778650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:19.778950 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m10:35:19.782004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04216949-f581-4e81-bb8a-e50682176d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670c0d0>]}
[0m10:35:19.786458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04216949-f581-4e81-bb8a-e50682176d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc820>]}
[0m10:35:19.786594 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:35:19.786721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04216949-f581-4e81-bb8a-e50682176d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc850>]}
[0m10:35:19.787412 [info ] [MainThread]: 
[0m10:35:19.787724 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:35:19.788225 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:35:19.788363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:20.417399 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:35:20.417819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:20.711842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04216949-f581-4e81-bb8a-e50682176d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637d000>]}
[0m10:35:20.713517 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:35:20.714004 [info ] [MainThread]: 
[0m10:35:20.724381 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:35:20.724830 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m10:35:20.727643 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:35:20.727871 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:35:20.728022 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:35:20.731169 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:35:20.732038 [debug] [Thread-1 (]: finished collecting timing info
[0m10:35:20.732185 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:35:20.754284 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:35:20.754762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:20.755581 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, event_id, user_id, category, os, clinic_id, max(original_timestamp),
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:35:21.623758 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reading_session at [9:10]')
[0m10:35:22.410194 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:ee255fa5-503b-4c72-996e-a669b1188fb5&page=queryresults
[0m10:35:22.411838 [debug] [Thread-1 (]: finished collecting timing info
[0m10:35:22.413156 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  Unrecognized name: reading_session at [9:10]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:35:22.413644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04216949-f581-4e81-bb8a-e50682176d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c0a30>]}
[0m10:35:22.414209 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 1.69s]
[0m10:35:22.414790 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:35:22.416675 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:35:22.417503 [info ] [MainThread]: 
[0m10:35:22.417873 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m10:35:22.418141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:22.418277 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m10:35:22.428501 [info ] [MainThread]: 
[0m10:35:22.428852 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:35:22.429104 [info ] [MainThread]: 
[0m10:35:22.429314 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m10:35:22.429520 [error] [MainThread]:   Unrecognized name: reading_session at [9:10]
[0m10:35:22.429702 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:35:22.429872 [info ] [MainThread]: 
[0m10:35:22.430048 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:35:22.430313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670e590>]}
[0m10:35:22.430520 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:36:05.327588 | 2d410b6e-7ae6-4b69-91cc-d1e558bc37c1 ==============================
[0m10:36:05.327639 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:36:05.328483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__agg_viewed_article.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:36:05.328593 [debug] [MainThread]: Tracking: tracking
[0m10:36:05.339138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106442590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064435e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064412a0>]}
[0m10:36:05.378118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:36:05.378380 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m10:36:05.385947 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m10:36:05.400037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m10:36:05.402729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d410b6e-7ae6-4b69-91cc-d1e558bc37c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665bd00>]}
[0m10:36:05.407074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d410b6e-7ae6-4b69-91cc-d1e558bc37c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660b2e0>]}
[0m10:36:05.407208 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:36:05.407334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d410b6e-7ae6-4b69-91cc-d1e558bc37c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102373bb0>]}
[0m10:36:05.407978 [info ] [MainThread]: 
[0m10:36:05.408288 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:05.408741 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:36:05.408877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:05.871159 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:36:05.871647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:06.275577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d410b6e-7ae6-4b69-91cc-d1e558bc37c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463cdc0>]}
[0m10:36:06.278542 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:36:06.278981 [info ] [MainThread]: 
[0m10:36:06.284535 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:06.284956 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m10:36:06.289856 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:06.290078 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:06.290257 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:06.342755 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:06.344280 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:06.344373 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:06.360325 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:06.360617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:06.361281 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, event_id, user_id, category, os, clinic_id, max(original_timestamp),
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:36:07.146028 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reading_session at [9:10]')
[0m10:36:08.807114 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:6f170b2f-8b5f-4f7d-8ad1-cca0c7023bcf&page=queryresults
[0m10:36:08.808375 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:08.809379 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  Unrecognized name: reading_session at [9:10]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:08.809792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d410b6e-7ae6-4b69-91cc-d1e558bc37c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106734640>]}
[0m10:36:08.810356 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 2.52s]
[0m10:36:08.810921 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:08.812769 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:08.813436 [info ] [MainThread]: 
[0m10:36:08.813742 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m10:36:08.813991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:08.814131 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m10:36:08.823666 [info ] [MainThread]: 
[0m10:36:08.823955 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:36:08.824190 [info ] [MainThread]: 
[0m10:36:08.824394 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m10:36:08.824592 [error] [MainThread]:   Unrecognized name: reading_session at [9:10]
[0m10:36:08.824787 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:08.824981 [info ] [MainThread]: 
[0m10:36:08.825182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:36:08.825455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045068c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106410040>]}
[0m10:36:08.825651 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:36:16.201203 | 3b8b8641-d27d-4fb1-8608-4c3132079699 ==============================
[0m10:36:16.201229 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:36:16.201664 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__viewed_article.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:36:16.201751 [debug] [MainThread]: Tracking: tracking
[0m10:36:16.210083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff5120>]}
[0m10:36:16.245041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:36:16.245195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:36:16.245495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m10:36:16.248517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b8b8641-d27d-4fb1-8608-4c3132079699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0c0d0>]}
[0m10:36:16.253033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b8b8641-d27d-4fb1-8608-4c3132079699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adcc70>]}
[0m10:36:16.253175 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:36:16.253313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8b8641-d27d-4fb1-8608-4c3132079699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adcca0>]}
[0m10:36:16.253976 [info ] [MainThread]: 
[0m10:36:16.254308 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:16.254769 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:36:16.254902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:16.723929 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:36:16.724473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:17.354477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8b8641-d27d-4fb1-8608-4c3132079699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f927d0>]}
[0m10:36:17.355715 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:36:17.356068 [info ] [MainThread]: 
[0m10:36:17.365347 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:36:17.365722 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m10:36:17.367959 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:36:17.368128 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:36:17.368286 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:36:17.370184 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:36:17.370759 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:17.370896 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:36:17.392874 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:36:17.393319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:17.394205 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m10:36:18.237760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e44a9be2-a659-4362-98f1-d1d94473cae9:europe-west1&page=queryresults
[0m10:36:18.256890 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:18.257506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b8b8641-d27d-4fb1-8608-4c3132079699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0e2f0>]}
[0m10:36:18.257885 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m10:36:18.258297 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:36:18.259838 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:18.260521 [info ] [MainThread]: 
[0m10:36:18.260770 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m10:36:18.260974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:18.261074 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__viewed_article' was properly closed.
[0m10:36:18.268473 [info ] [MainThread]: 
[0m10:36:18.268693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:18.268881 [info ] [MainThread]: 
[0m10:36:18.269038 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:18.269274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107acaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0ea10>]}
[0m10:36:18.269441 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:36:22.406745 | 204303cc-f55b-499e-8687-b2d57c5d28f6 ==============================
[0m10:36:22.406787 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:36:22.408473 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__agg_viewed_article.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:36:22.410037 [debug] [MainThread]: Tracking: tracking
[0m10:36:22.420767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1ce20>]}
[0m10:36:22.460993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:36:22.461144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:36:22.461471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m10:36:22.464666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '204303cc-f55b-499e-8687-b2d57c5d28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106034490>]}
[0m10:36:22.469588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '204303cc-f55b-499e-8687-b2d57c5d28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060050c0>]}
[0m10:36:22.469772 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:36:22.469902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '204303cc-f55b-499e-8687-b2d57c5d28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023ceaa0>]}
[0m10:36:22.470623 [info ] [MainThread]: 
[0m10:36:22.470984 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:22.471427 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:36:22.471545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:23.020905 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:36:23.021495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:23.540222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '204303cc-f55b-499e-8687-b2d57c5d28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104018df0>]}
[0m10:36:23.541486 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:36:23.541887 [info ] [MainThread]: 
[0m10:36:23.550739 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:23.551104 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m10:36:23.553166 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:23.553321 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:23.553441 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:23.556043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:23.556456 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:23.556572 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:23.579463 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:23.579924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:23.580903 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, event_id, user_id, category, os, clinic_id, max(original_timestamp),
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:36:24.430607 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column event_id which is neither grouped nor aggregated at [7:19]')
[0m10:36:25.566703 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:0685c6b5-162f-402b-abb5-e948ff5997ee&page=queryresults
[0m10:36:25.567654 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:25.568707 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  SELECT list expression references column event_id which is neither grouped nor aggregated at [7:19]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:25.569216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '204303cc-f55b-499e-8687-b2d57c5d28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ecd30>]}
[0m10:36:25.569699 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 2.02s]
[0m10:36:25.570233 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:25.571871 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:25.572641 [info ] [MainThread]: 
[0m10:36:25.573006 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m10:36:25.573326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:25.573491 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m10:36:25.585359 [info ] [MainThread]: 
[0m10:36:25.585692 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:36:25.585943 [info ] [MainThread]: 
[0m10:36:25.586153 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m10:36:25.586344 [error] [MainThread]:   SELECT list expression references column event_id which is neither grouped nor aggregated at [7:19]
[0m10:36:25.586487 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:25.586614 [info ] [MainThread]: 
[0m10:36:25.586745 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:36:25.586997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ded840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106036a70>]}
[0m10:36:25.587211 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:36:54.365426 | c1988d87-60ed-45fa-a439-1423df37f130 ==============================
[0m10:36:54.365527 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:36:54.366667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__agg_viewed_article.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:36:54.366791 [debug] [MainThread]: Tracking: tracking
[0m10:36:54.377814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97cf40>]}
[0m10:36:54.414011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:36:54.414290 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:54.420677 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:54.434196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m10:36:54.437110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1988d87-60ed-45fa-a439-1423df37f130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8c220>]}
[0m10:36:54.441721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1988d87-60ed-45fa-a439-1423df37f130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb53f10>]}
[0m10:36:54.441872 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:36:54.441999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1988d87-60ed-45fa-a439-1423df37f130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717f0d0>]}
[0m10:36:54.442634 [info ] [MainThread]: 
[0m10:36:54.442931 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:54.444113 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:36:54.444319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:55.098146 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:36:55.098716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:55.503563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1988d87-60ed-45fa-a439-1423df37f130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97cf40>]}
[0m10:36:55.504847 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:36:55.505244 [info ] [MainThread]: 
[0m10:36:55.511722 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:55.512184 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m10:36:55.516996 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:55.517221 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:55.517387 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:55.564345 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:55.564929 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:55.565032 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:55.581187 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:36:55.581464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:55.582122 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp),
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:36:56.355717 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW columns must be named, but column 7 has no name at [6:6]')
[0m10:36:57.796342 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:d577355a-f527-4475-9697-2801b5470f54&page=queryresults
[0m10:36:57.798228 [debug] [Thread-1 (]: finished collecting timing info
[0m10:36:57.799571 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  CREATE VIEW columns must be named, but column 7 has no name at [6:6]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:57.800011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1988d87-60ed-45fa-a439-1423df37f130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6fc40>]}
[0m10:36:57.800601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 2.29s]
[0m10:36:57.801184 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:36:57.803131 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:36:57.803860 [info ] [MainThread]: 
[0m10:36:57.804169 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m10:36:57.804433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:57.804566 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m10:36:57.814164 [info ] [MainThread]: 
[0m10:36:57.814471 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:36:57.814706 [info ] [MainThread]: 
[0m10:36:57.814911 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m10:36:57.815110 [error] [MainThread]:   CREATE VIEW columns must be named, but column 7 has no name at [6:6]
[0m10:36:57.815299 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:36:57.815492 [info ] [MainThread]: 
[0m10:36:57.815664 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:36:57.815912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb1b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8fbb0>]}
[0m10:36:57.816109 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:37:14.635603 | 16a47124-5309-4232-b1fd-288341168dbe ==============================
[0m10:37:14.635646 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:37:14.637864 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_mixpanel__agg_viewed_article.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:37:14.638127 [debug] [MainThread]: Tracking: tracking
[0m10:37:14.649136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c37340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c35510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c353f0>]}
[0m10:37:14.686394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:37:14.686675 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:37:14.694397 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m10:37:14.707936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m10:37:14.710582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16a47124-5309-4232-b1fd-288341168dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e44220>]}
[0m10:37:14.714980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16a47124-5309-4232-b1fd-288341168dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827700>]}
[0m10:37:14.715123 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:37:14.715248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a47124-5309-4232-b1fd-288341168dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab9150>]}
[0m10:37:14.715895 [info ] [MainThread]: 
[0m10:37:14.716208 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:37:14.716617 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:37:14.716717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:15.251161 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:37:15.251690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:15.787731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a47124-5309-4232-b1fd-288341168dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd3b80>]}
[0m10:37:15.789249 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:37:15.789687 [info ] [MainThread]: 
[0m10:37:15.796152 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:15.796620 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m10:37:15.801655 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:37:15.801920 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:15.802077 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:15.847978 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:37:15.848576 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:15.848671 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:15.864991 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:37:15.865261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:15.865924 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:37:16.781187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8e3b4421-b2f4-4652-8420-1e70e1537b04:europe-west1&page=queryresults
[0m10:37:16.799040 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:16.799798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a47124-5309-4232-b1fd-288341168dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c466b0>]}
[0m10:37:16.800176 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article .... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m10:37:16.800576 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:16.801996 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:37:16.802439 [info ] [MainThread]: 
[0m10:37:16.802650 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m10:37:16.802838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:16.802939 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m10:37:16.810501 [info ] [MainThread]: 
[0m10:37:16.810790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:16.810990 [info ] [MainThread]: 
[0m10:37:16.811156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:37:16.811403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4c580>]}
[0m10:37:16.811588 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:37:23.113828 | 129d5e42-22a5-4f6f-b003-8ed175b02653 ==============================
[0m10:37:23.113865 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:37:23.114293 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:37:23.114380 [debug] [MainThread]: Tracking: tracking
[0m10:37:23.131312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cef1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cef1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cef0f40>]}
[0m10:37:23.165956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:23.166101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:23.166407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m10:37:23.169444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20c640>]}
[0m10:37:23.174276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d9270>]}
[0m10:37:23.174472 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:37:23.174608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106672b60>]}
[0m10:37:23.175419 [info ] [MainThread]: 
[0m10:37:23.175739 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:37:23.176403 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:37:23.176545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:23.771750 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:37:23.773753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:24.270038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1d8d00>]}
[0m10:37:24.270920 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:37:24.271251 [info ] [MainThread]: 
[0m10:37:24.279029 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:37:24.279242 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:37:24.279632 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:37:24.279903 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:37:24.280737 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:37:24.281718 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:37:24.281925 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:37:24.282056 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:37:24.282208 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:37:24.282322 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:37:24.284084 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:37:24.285429 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:37:24.286360 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:24.286548 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:24.286683 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:37:24.286818 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:37:24.306939 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:37:24.308767 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:37:24.309206 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:37:24.309353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:24.310163 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:37:24.350787 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:37:25.190443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8f019d96-986a-4f6b-9800-1bc01ebb6eae:europe-west1&page=queryresults
[0m10:37:25.211190 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:25.211846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b1c90>]}
[0m10:37:25.212220 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m10:37:25.212698 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:37:25.213260 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:37:25.213735 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m10:37:25.214370 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:37:25.214532 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:37:25.214672 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:37:25.216425 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:37:25.217975 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:25.218117 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:37:25.261896 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:37:25.262241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:25.262935 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m10:37:25.311748 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:24c707f0-e2e7-4c6f-a430-999d0986d778:europe-west1&page=queryresults
[0m10:37:25.312621 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:25.312905 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce906d0>]}
[0m10:37:25.313067 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m10:37:25.313262 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:37:25.313351 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:37:25.313495 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m10:37:25.313867 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:37:25.313951 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:37:25.314019 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:37:25.315833 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:37:25.316119 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:25.316200 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:37:25.317677 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:37:25.317926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:25.318584 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m10:37:26.160924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a65b510e-9d94-4d94-9b04-04053e088e21:europe-west1&page=queryresults
[0m10:37:26.163541 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:26.164518 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4d57d745-a929-41f7-982c-b340ea4a4e0f:europe-west1&page=queryresults
[0m10:37:26.165154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1cbdc0>]}
[0m10:37:26.166659 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:26.167047 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m10:37:26.167578 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e332590>]}
[0m10:37:26.168012 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:37:26.168392 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m10:37:26.168679 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:37:26.169199 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:37:26.169470 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:37:26.169923 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:37:26.170981 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:37:26.171459 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:37:26.171665 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:37:26.172259 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:37:26.172520 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:37:26.172760 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:37:26.174976 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:37:26.175181 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:37:26.177174 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:37:26.178195 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:26.178338 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:37:26.178438 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:26.181162 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:37:26.181335 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:37:26.183768 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:37:26.184123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:26.184330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:26.185431 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m10:37:26.230598 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m10:37:26.942690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:54bd80c0-b8c2-4b97-a8cb-a15ea5d0c114:europe-west1&page=queryresults
[0m10:37:26.946075 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:26.946937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1cbb50>]}
[0m10:37:26.947473 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m10:37:26.948038 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:37:26.948287 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m10:37:26.948662 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m10:37:26.949355 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:37:26.949537 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m10:37:26.949704 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m10:37:26.962303 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:37:26.964351 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:26.964536 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m10:37:26.976040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:27.021073 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b53c2ecf-e0bd-4a01-bac6-ab539f975780:europe-west1&page=queryresults
[0m10:37:27.021900 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:27.022219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e342500>]}
[0m10:37:27.022514 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m10:37:27.022727 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:37:27.022930 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:27.023033 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m10:37:27.023360 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:37:27.023439 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:27.023544 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:27.024997 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:37:27.025341 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:27.025424 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:27.026944 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:37:27.027199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:27.027823 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:37:27.586049 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:37:27.587060 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:37:27.866756 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3099d781-0923-4707-b495-b83c729109f3:europe-west1&page=queryresults
[0m10:37:27.869324 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:27.870133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20ca60>]}
[0m10:37:27.870604 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m10:37:27.871149 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:37:27.871403 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:37:27.871810 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m10:37:27.872739 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:37:27.872959 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:37:27.873140 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:37:27.883993 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:37:27.884562 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:27.884724 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:37:27.907685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:28.442160 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:37:28.442742 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m10:37:30.320668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d5f8baa5-2c6e-4f61-95c1-da316665cc20:europe-west1&page=queryresults
[0m10:37:30.324309 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:30.325215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e33e3b0>]}
[0m10:37:30.325729 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.38s]
[0m10:37:30.326302 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m10:37:30.326567 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:37:30.326937 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m10:37:30.327716 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:37:30.327914 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:37:30.328091 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:37:30.335803 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:37:30.337661 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:30.337840 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:37:30.340521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:30.717403 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6dcc657c-0f31-451c-afd6-0497b1f7f3c7:europe-west1&page=queryresults
[0m10:37:30.720946 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:37:30.722946 [debug] [Thread-2 (]: finished collecting timing info
[0m10:37:30.724012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1fd330>]}
[0m10:37:30.724538 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.85s]
[0m10:37:30.725046 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:37:30.725409 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
UNION ALL
SELECT slug, original_timestamp, category, clinic_id, user_id, referrer FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
WHERE mixpanel.original_timestamp < (select start_date From StartDate)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:37:31.038072 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [25:3]')
[0m10:37:31.960008 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:a1405f6b-2bee-4c73-9b87-b542d4a2d2c6&page=queryresults
[0m10:37:31.961072 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.961991 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [25:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:37:31.962346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '129d5e42-22a5-4f6f-b003-8ed175b02653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2951e0>]}
[0m10:37:31.962870 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.63s]
[0m10:37:31.963399 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:37:31.965241 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:37:31.965973 [info ] [MainThread]: 
[0m10:37:31.966288 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m10:37:31.966551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:31.966687 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:37:31.966823 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m10:37:31.977862 [info ] [MainThread]: 
[0m10:37:31.978139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:37:31.978372 [info ] [MainThread]: 
[0m10:37:31.978580 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m10:37:31.978784 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [25:3]
[0m10:37:31.978976 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:37:31.979166 [info ] [MainThread]: 
[0m10:37:31.979342 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m10:37:31.979584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1731c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce593c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1fee00>]}
[0m10:37:31.979771 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:38:36.915597 | b7a94290-ce00-4d95-8d6e-c9be6521f3f9 ==============================
[0m10:38:36.915634 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:38:36.916480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:38:36.916589 [debug] [MainThread]: Tracking: tracking
[0m10:38:36.927554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df5210>]}
[0m10:38:36.962838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:36.963076 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m10:38:36.969263 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m10:38:36.977645 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m10:38:36.987050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m10:38:36.989832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d64220>]}
[0m10:38:36.994277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc73d0>]}
[0m10:38:36.994441 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:38:36.994566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102006c50>]}
[0m10:38:36.995297 [info ] [MainThread]: 
[0m10:38:36.995731 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:38:36.996476 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:38:36.996609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:37.731762 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:38:37.732007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:38.157392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10267b760>]}
[0m10:38:38.157763 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:38:38.157903 [info ] [MainThread]: 
[0m10:38:38.161010 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:38:38.161108 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:38:38.161277 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:38:38.161397 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:38:38.161766 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:38:38.162059 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:38:38.162144 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:38:38.162219 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:38:38.162300 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:38:38.162476 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:38:38.163476 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:38:38.164441 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:38:38.164966 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:38.165031 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:38.165127 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:38:38.165216 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:38:38.180724 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:38:38.182226 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:38:38.182511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:38.182613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:38:38.183309 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:38:38.219909 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:38:38.964778 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e1430feb-1165-4029-a08c-6add826e82ed:europe-west1&page=queryresults
[0m10:38:38.981446 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:38.982203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:15910d06-5d4a-4c78-bdc8-24c66be45dee:europe-west1&page=queryresults
[0m10:38:38.982767 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2fa90>]}
[0m10:38:38.983981 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:38.984307 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m10:38:38.984708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2a110>]}
[0m10:38:38.985098 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m10:38:38.985327 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:38:38.985585 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:38:38.985755 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:38:38.985980 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:38:38.986271 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m10:38:38.986423 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m10:38:38.986860 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:38:38.987270 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:38:38.987385 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:38:38.987489 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:38:38.987596 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:38:38.987695 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:38:38.989806 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:38:38.994024 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:38:38.994246 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:38.994390 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:38:38.998748 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:38:38.998843 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:38.999002 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:38:39.000722 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:38:39.000897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:39.001702 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m10:38:39.001892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:38:39.042915 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m10:38:39.891809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1d9e9652-89d4-43a7-9883-7f05827f1cfe:europe-west1&page=queryresults
[0m10:38:39.893881 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:39.894222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d75270>]}
[0m10:38:39.894399 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m10:38:39.894600 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:38:39.894698 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:38:39.894837 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:38:39.895419 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:38:39.895681 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:38:39.895895 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:38:39.898238 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:38:39.899581 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:39.899782 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:38:39.902948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:38:39.903592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:39.904985 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m10:38:39.962896 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:16db02e2-b93e-4535-a834-24da18d1c1cb:europe-west1&page=queryresults
[0m10:38:39.963980 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:39.964338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4bdf0>]}
[0m10:38:39.964538 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m10:38:39.964781 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:38:39.964884 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:38:39.964994 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:38:39.965438 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:38:39.965559 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:38:39.965652 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:38:39.966705 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:38:39.967010 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:39.967332 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:38:39.969220 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:38:39.969603 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:38:39.970337 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m10:38:40.919437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0ee697a6-496c-4ad0-86e3-4f92303b9b80:europe-west1&page=queryresults
[0m10:38:40.922727 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:40.923393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4a4a0>]}
[0m10:38:40.923728 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m10:38:40.924109 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:38:40.924283 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m10:38:40.924677 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m10:38:40.925353 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:38:40.925511 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m10:38:40.925632 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m10:38:40.935027 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:38:40.935482 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:40.935601 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m10:38:40.947778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:41.091693 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3e4dfb14-fe6c-48df-a853-f0d7a3b8edae:europe-west1&page=queryresults
[0m10:38:41.093068 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:41.093499 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110edc1f0>]}
[0m10:38:41.093754 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m10:38:41.094047 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:38:41.094188 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:38:41.094334 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m10:38:41.094710 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:38:41.094814 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:38:41.095016 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:38:41.097055 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:38:41.098069 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:41.098223 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:38:41.100411 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:38:41.100833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:38:41.101763 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:38:41.399756 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:38:41.400387 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:38:41.884432 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bb9f3ccc-916f-41cf-bb94-3b9255a7f5ef:europe-west1&page=queryresults
[0m10:38:41.887293 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:41.888168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d24c70>]}
[0m10:38:41.888682 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m10:38:41.889289 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:38:41.889524 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:38:41.890175 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m10:38:41.890894 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:38:41.891054 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:38:41.891207 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:38:41.898458 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:38:41.899003 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:41.899162 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:38:41.922723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:38:42.371943 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:38:42.372370 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m10:38:44.108379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:728b5048-7753-4421-a4ff-7022f6d9d226:europe-west1&page=queryresults
[0m10:38:44.114738 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:44.115900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d766e0>]}
[0m10:38:44.116481 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.19s]
[0m10:38:44.117081 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m10:38:44.117343 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:38:44.117779 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m10:38:44.118703 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:38:44.118907 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:38:44.119090 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:38:44.127211 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:38:44.128305 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:44.128482 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:38:44.131255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:44.552603 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1dec66ef-065c-45d4-87b5-df9d1ff71388:europe-west1&page=queryresults
[0m10:38:44.555042 [debug] [Thread-2 (]: finished collecting timing info
[0m10:38:44.555914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f045b0>]}
[0m10:38:44.556423 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.67s]
[0m10:38:44.556990 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:38:44.609348 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:38:44.610552 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:38:45.031797 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [31:3]')
[0m10:38:46.352021 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:e934496a-d27f-4ae6-848b-d51cb38dbf07&page=queryresults
[0m10:38:46.352747 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:46.353255 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [31:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:38:46.353415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a94290-ce00-4d95-8d6e-c9be6521f3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d53130>]}
[0m10:38:46.353625 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 2.24s]
[0m10:38:46.353852 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:38:46.355101 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:38:46.355963 [info ] [MainThread]: 
[0m10:38:46.356351 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 9.36 seconds (9.36s).
[0m10:38:46.356667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:46.356806 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:38:46.356936 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m10:38:46.365931 [info ] [MainThread]: 
[0m10:38:46.366134 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:38:46.366273 [info ] [MainThread]: 
[0m10:38:46.366390 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m10:38:46.366514 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [31:3]
[0m10:38:46.366708 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:38:46.366918 [info ] [MainThread]: 
[0m10:38:46.367123 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m10:38:46.367404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107558eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e98760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e96710>]}
[0m10:38:46.367623 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:44:28.017277 | 53619aa5-248c-4ba2-a1c3-cf2d80871365 ==============================
[0m10:44:28.017328 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:44:28.018062 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:44:28.018157 [debug] [MainThread]: Tracking: tracking
[0m10:44:28.029281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf5420>]}
[0m10:44:28.064592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:28.064734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:28.065028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m10:44:28.067950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53619aa5-248c-4ba2-a1c3-cf2d80871365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0c3d0>]}
[0m10:44:28.072627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53619aa5-248c-4ba2-a1c3-cf2d80871365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8fa0>]}
[0m10:44:28.072770 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:44:28.072902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53619aa5-248c-4ba2-a1c3-cf2d80871365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a79180>]}
[0m10:44:28.073558 [info ] [MainThread]: 
[0m10:44:28.073861 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:44:28.074303 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:44:28.074445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:28.630755 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:44:28.631349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:29.181948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53619aa5-248c-4ba2-a1c3-cf2d80871365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106874d90>]}
[0m10:44:29.182474 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:44:29.182644 [info ] [MainThread]: 
[0m10:44:29.188026 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:44:29.188240 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m10:44:29.189606 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:44:29.189745 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:44:29.189843 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:44:29.195100 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:44:29.195989 [debug] [Thread-1 (]: finished collecting timing info
[0m10:44:29.196107 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:44:29.213660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:29.596928 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:44:29.597577 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:44:30.122489 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [31:3]')
[0m10:44:31.279900 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:02872b2a-fdff-40bd-a7f8-fd3644ba23db&page=queryresults
[0m10:44:31.280516 [debug] [Thread-1 (]: finished collecting timing info
[0m10:44:31.280984 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [31:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:44:31.281197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53619aa5-248c-4ba2-a1c3-cf2d80871365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fdaef0>]}
[0m10:44:31.281460 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 2.09s]
[0m10:44:31.281721 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:44:31.282677 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:44:31.283029 [info ] [MainThread]: 
[0m10:44:31.283199 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m10:44:31.283344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:31.283416 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:44:31.291305 [info ] [MainThread]: 
[0m10:44:31.291528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:44:31.291687 [info ] [MainThread]: 
[0m10:44:31.291815 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m10:44:31.291943 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [31:3]
[0m10:44:31.292062 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:44:31.292185 [info ] [MainThread]: 
[0m10:44:31.292308 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:44:31.292485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036bbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107effaf0>]}
[0m10:44:31.292618 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:57:28.313736 | 95d4cc18-ec6b-4d0e-a994-c9b71729baeb ==============================
[0m10:57:28.313773 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:57:28.315503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:57:28.315633 [debug] [MainThread]: Tracking: tracking
[0m10:57:28.328448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c394e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c393c0>]}
[0m10:57:28.364231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:28.364474 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m10:57:28.372255 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m10:57:28.387482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m10:57:28.390222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95d4cc18-ec6b-4d0e-a994-c9b71729baeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e44250>]}
[0m10:57:28.395284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95d4cc18-ec6b-4d0e-a994-c9b71729baeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106828be0>]}
[0m10:57:28.395447 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:57:28.395576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d4cc18-ec6b-4d0e-a994-c9b71729baeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abd120>]}
[0m10:57:28.396217 [info ] [MainThread]: 
[0m10:57:28.396526 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:57:28.396959 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:57:28.397067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:28.984058 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:57:28.984667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:29.452847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d4cc18-ec6b-4d0e-a994-c9b71729baeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c48a30>]}
[0m10:57:29.454080 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:57:29.454480 [info ] [MainThread]: 
[0m10:57:29.460364 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:57:29.460767 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.articles_evidence ........................ [RUN]
[0m10:57:29.465337 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:57:29.465605 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:57:29.465792 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:57:29.514590 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:57:29.515504 [debug] [Thread-1 (]: finished collecting timing info
[0m10:57:29.515623 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:57:29.527548 [debug] [Thread-1 (]: finished collecting timing info
[0m10:57:29.527881 [debug] [Thread-1 (]: Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m10:57:29.528028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d4cc18-ec6b-4d0e-a994-c9b71729baeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f7be0>]}
[0m10:57:29.528205 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_rsdun.articles_evidence ............... [[31mERROR[0m in 0.07s]
[0m10:57:29.528409 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:57:29.529098 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:57:29.529351 [info ] [MainThread]: 
[0m10:57:29.529480 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m10:57:29.529586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:29.529655 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:57:29.537794 [info ] [MainThread]: 
[0m10:57:29.537989 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:29.538121 [info ] [MainThread]: 
[0m10:57:29.538229 [error] [MainThread]: [33mCompilation Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m10:57:29.538332 [error] [MainThread]:   Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m10:57:29.538432 [error] [MainThread]:   
[0m10:57:29.538529 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m10:57:29.538624 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m10:57:29.538720 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m10:57:29.538856 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m10:57:29.538984 [error] [MainThread]:   > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m10:57:29.539095 [info ] [MainThread]: 
[0m10:57:29.539204 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:29.539369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f17e50>]}
[0m10:57:29.539506 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:58:28.506335 | e8414c05-9258-4bea-a4d0-a2f500cab2d3 ==============================
[0m10:58:28.506384 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:58:28.507278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:58:28.507368 [debug] [MainThread]: Tracking: tracking
[0m10:58:28.519929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f5120>]}
[0m10:58:28.556427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:28.556571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:28.556863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m10:58:28.559875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8414c05-9258-4bea-a4d0-a2f500cab2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0c0d0>]}
[0m10:58:28.564270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8414c05-9258-4bea-a4d0-a2f500cab2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dc9a0>]}
[0m10:58:28.564414 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:58:28.564553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8414c05-9258-4bea-a4d0-a2f500cab2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dca00>]}
[0m10:58:28.565237 [info ] [MainThread]: 
[0m10:58:28.565566 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:58:28.566057 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:58:28.566209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:29.092882 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:58:29.093526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:29.452293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8414c05-9258-4bea-a4d0-a2f500cab2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fc2e0>]}
[0m10:58:29.453538 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:58:29.454000 [info ] [MainThread]: 
[0m10:58:29.462807 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:58:29.463197 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_rsdun.articles_evidence ........................ [RUN]
[0m10:58:29.466048 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:58:29.466279 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:58:29.466452 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:58:29.469888 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:58:29.471097 [debug] [Thread-1 (]: finished collecting timing info
[0m10:58:29.471316 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:58:29.495561 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:58:29.496165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:29.497037 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`articles_evidence`
  OPTIONS()
  as with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
);


[0m10:58:30.730868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f979f636-6b90-4258-aaac-00fa4a91fb70:europe-west1&page=queryresults
[0m10:58:30.743891 [debug] [Thread-1 (]: finished collecting timing info
[0m10:58:30.744385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8414c05-9258-4bea-a4d0-a2f500cab2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0e050>]}
[0m10:58:30.744634 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_rsdun.articles_evidence ................... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m10:58:30.744922 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:58:30.745823 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:58:30.746222 [info ] [MainThread]: 
[0m10:58:30.746420 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m10:58:30.746592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:30.746681 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:58:30.759236 [info ] [MainThread]: 
[0m10:58:30.759465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:30.759602 [info ] [MainThread]: 
[0m10:58:30.759901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:58:30.760085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0e770>]}
[0m10:58:30.760211 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:58:59.372546 | d9d4e1e2-00d9-4321-919d-e02985e1abcf ==============================
[0m10:58:59.372568 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:58:59.373235 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:58:59.373335 [debug] [MainThread]: Tracking: tracking
[0m10:58:59.383766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d42530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d43580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d41240>]}
[0m10:58:59.422789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:59.423041 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m10:58:59.430101 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m10:58:59.438432 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m10:58:59.447456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m10:58:59.449974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9d4e1e2-00d9-4321-919d-e02985e1abcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111119cf0>]}
[0m10:58:59.454300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9d4e1e2-00d9-4321-919d-e02985e1abcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11107b040>]}
[0m10:58:59.454442 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:58:59.454562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d4e1e2-00d9-4321-919d-e02985e1abcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10372ca30>]}
[0m10:58:59.455169 [info ] [MainThread]: 
[0m10:58:59.455472 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:58:59.456012 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:58:59.456228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:00.102681 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:59:00.103025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:00.522675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d4e1e2-00d9-4321-919d-e02985e1abcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11107b1c0>]}
[0m10:59:00.523774 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:59:00.524169 [info ] [MainThread]: 
[0m10:59:00.579460 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:59:00.579663 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m10:59:00.580047 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:59:00.580134 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:59:00.580221 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:59:00.582630 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:59:00.582995 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:00.583090 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:59:00.602308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:01.403381 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:59:01.403952 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)


    );
  
[0m10:59:06.164028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:51fefd56-998f-4328-8708-a67611a5cd94:europe-west1&page=queryresults
[0m10:59:06.183747 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:06.184580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d4e1e2-00d9-4321-919d-e02985e1abcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040904f0>]}
[0m10:59:06.184960 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mCREATE TABLE (16.2k rows, 43.1 MB processed)[0m in 5.60s]
[0m10:59:06.185376 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:59:06.186899 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:59:06.187521 [info ] [MainThread]: 
[0m10:59:06.187771 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m10:59:06.187970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:06.188074 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:59:06.200097 [info ] [MainThread]: 
[0m10:59:06.200377 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:59:06.200576 [info ] [MainThread]: 
[0m10:59:06.200724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:59:06.200938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d12080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d11c60>]}
[0m10:59:06.201107 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 10:59:10.154200 | 128378c8-563b-4a79-a596-5bb848c11206 ==============================
[0m10:59:10.154223 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:59:10.154577 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:59:10.154675 [debug] [MainThread]: Tracking: tracking
[0m10:59:10.170021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d27e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d27f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d27d120>]}
[0m10:59:10.206990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:10.207143 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:10.207450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m10:59:10.210533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4940d0>]}
[0m10:59:10.215356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4609d0>]}
[0m10:59:10.215516 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:59:10.215647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d460a30>]}
[0m10:59:10.216448 [info ] [MainThread]: 
[0m10:59:10.216772 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:59:10.217493 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:59:10.217649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:10.857049 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:59:10.857878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:11.301027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d453b80>]}
[0m10:59:11.302055 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:59:11.302445 [info ] [MainThread]: 
[0m10:59:11.310314 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:59:11.310509 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:59:11.310874 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:59:11.311121 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:59:11.311914 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:59:11.312517 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:59:11.312691 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:59:11.312869 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:59:11.313096 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:59:11.313242 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:59:11.315128 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:59:11.316501 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:59:11.317653 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:11.317782 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:11.317913 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:59:11.318037 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:59:11.340901 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:59:11.342809 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:59:11.343188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:11.343293 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:59:11.344181 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:59:11.344846 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:59:12.302787 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5667f024-d3b2-403a-9309-1018374063b6:europe-west1&page=queryresults
[0m10:59:12.323725 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:12.324798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ff2d4de7-bca8-4a9d-aeca-f1e1a5dbcfb5:europe-west1&page=queryresults
[0m10:59:12.325441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4522f0>]}
[0m10:59:12.326875 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:12.327283 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m10:59:12.327743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53d3f0>]}
[0m10:59:12.328173 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:59:12.328439 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m10:59:12.328662 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:59:12.329385 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:59:12.329588 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m10:59:12.329765 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:59:12.330656 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:59:12.330878 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m10:59:12.331017 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:59:12.331429 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:59:12.331568 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:59:12.331673 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:59:12.333378 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:59:12.333512 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:59:12.335857 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:12.337619 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:59:12.341213 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:59:12.343448 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:59:12.344306 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:59:12.364531 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:12.365515 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m10:59:12.365641 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:59:12.448118 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:59:12.448706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:12.449353 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m10:59:13.314237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a1fd022a-432a-4d8c-9a78-6246bf27b8b7:europe-west1&page=queryresults
[0m10:59:13.316584 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:13.317341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d460160>]}
[0m10:59:13.317772 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m10:59:13.318225 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:59:13.318426 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:59:13.318645 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:59:13.319264 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:59:13.319538 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:59:13.319803 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:59:13.321799 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:59:13.323489 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:13.323825 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:59:13.326842 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:59:13.327585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:13.328825 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m10:59:13.396068 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4ee886da-5736-4202-952a-afd8f0e91052:europe-west1&page=queryresults
[0m10:59:13.397257 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:13.397605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d55cb20>]}
[0m10:59:13.397790 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m10:59:13.398002 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:59:13.398107 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:59:13.398210 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:59:13.398517 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:59:13.398697 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:59:13.398893 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:59:13.399990 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:59:13.400313 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:13.400396 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:59:13.402047 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:59:13.402269 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:59:13.402986 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m10:59:14.353131 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7d6801a9-d469-47f3-b595-16f20ceb776b:europe-west1&page=queryresults
[0m10:59:14.354339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bddf25f1-31ac-407e-a9d6-4d181afc45b9:europe-west1&page=queryresults
[0m10:59:14.355824 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:14.356816 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:14.357266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53d1e0>]}
[0m10:59:14.357590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d537eb0>]}
[0m10:59:14.357838 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m10:59:14.358029 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m10:59:14.358294 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:59:14.358498 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:59:14.358630 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m10:59:14.358762 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:59:14.359053 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m10:59:14.359176 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m10:59:14.359541 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:59:14.359898 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:59:14.359988 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m10:59:14.360070 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:59:14.360161 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m10:59:14.360238 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:59:14.362895 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:59:14.367966 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:14.369646 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m10:59:14.381109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:59:14.383962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:59:14.428527 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:14.428679 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:59:14.432734 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:59:14.433217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:14.433875 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m10:59:15.000993 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:59:15.002013 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:59:15.421550 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fbbf6bd7-2b21-4b23-ba54-8a9647628af9:europe-west1&page=queryresults
[0m10:59:15.424684 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:15.425079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d453be0>]}
[0m10:59:15.425283 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m10:59:15.425513 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:59:15.425623 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:59:15.425735 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m10:59:15.426066 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:59:15.426149 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:59:15.426232 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:59:15.436259 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:59:15.437030 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:15.437232 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:59:15.461774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:15.867391 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m10:59:15.868752 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m10:59:17.277601 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bfa2370f-daf9-4713-af90-4d3177c8200d:europe-west1&page=queryresults
[0m10:59:17.280675 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:17.281259 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d452b00>]}
[0m10:59:17.281588 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.92s]
[0m10:59:17.281947 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m10:59:17.282115 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m10:59:17.282260 [info ] [Thread-2 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m10:59:17.282842 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:59:17.282985 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:59:17.283109 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m10:59:17.286584 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:59:17.287446 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:17.287552 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m10:59:17.293016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:59:17.717355 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:59:17.718601 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:59:18.036799 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [31:3]')
[0m10:59:18.078228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:25e7fb10-e68d-43ce-85bf-9f7d91ef4a1d:europe-west1&page=queryresults
[0m10:59:18.080847 [debug] [Thread-1 (]: finished collecting timing info
[0m10:59:18.081778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc8640>]}
[0m10:59:18.082232 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.66s]
[0m10:59:18.082756 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m10:59:18.986890 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:23b0825b-699d-4e50-a9a0-9d3217c1b9b7&page=queryresults
[0m10:59:18.988520 [debug] [Thread-2 (]: finished collecting timing info
[0m10:59:18.989763 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [31:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:59:18.990179 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128378c8-563b-4a79-a596-5bb848c11206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebc8220>]}
[0m10:59:18.990727 [error] [Thread-2 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.71s]
[0m10:59:18.991277 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m10:59:18.993042 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:59:18.993734 [info ] [MainThread]: 
[0m10:59:18.994051 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m10:59:18.994315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:18.994451 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m10:59:18.994583 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:59:19.005397 [info ] [MainThread]: 
[0m10:59:19.005738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:59:19.005980 [info ] [MainThread]: 
[0m10:59:19.006180 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m10:59:19.006359 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [31:3]
[0m10:59:19.006532 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m10:59:19.006714 [info ] [MainThread]: 
[0m10:59:19.006893 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m10:59:19.007174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f78df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d460a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebcaa40>]}
[0m10:59:19.007397 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 11:18:08.047660 | 3df15a25-0370-4592-8f27-f5797295c3c4 ==============================
[0m11:18:08.047816 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:18:08.048606 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:18:08.048701 [debug] [MainThread]: Tracking: tracking
[0m11:18:08.062947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087594b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108759390>]}
[0m11:18:08.099954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:08.100092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:08.100384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m11:18:08.103276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089703d0>]}
[0m11:18:08.107730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893cfa0>]}
[0m11:18:08.107890 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:18:08.108032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e1150>]}
[0m11:18:08.108866 [info ] [MainThread]: 
[0m11:18:08.109229 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:18:08.109913 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:18:08.110073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:08.692063 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:18:08.692673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:09.049214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106954d60>]}
[0m11:18:09.049686 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:18:09.049852 [info ] [MainThread]: 
[0m11:18:09.055107 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:18:09.055319 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:18:09.055676 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:18:09.055983 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:18:09.056687 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:18:09.057465 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:18:09.057613 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:18:09.057919 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:18:09.058278 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:18:09.058515 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:18:09.060247 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:18:09.061476 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:18:09.062328 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:09.062433 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:09.062566 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:18:09.062675 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:18:09.085015 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:18:09.087073 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:18:09.087555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:09.087670 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:18:09.088610 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:18:09.089409 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:18:09.928647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bd298ec2-89e3-4e9a-8ba5-d5d4c2783ffc:europe-west1&page=queryresults
[0m11:18:09.941225 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:09.941800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a19ae0>]}
[0m11:18:09.942084 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m11:18:09.942421 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:18:09.942567 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:18:09.942816 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:18:09.943406 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:18:09.943546 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:18:09.943667 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:18:09.945288 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:18:09.947707 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:09.947860 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:18:09.993671 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f77e9dc4-7ad9-4047-891a-adea36470af9:europe-west1&page=queryresults
[0m11:18:09.995594 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:09.995910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a655a0>]}
[0m11:18:09.997030 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:18:09.997234 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m11:18:09.997454 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:18:09.997594 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:18:09.997774 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:18:09.997919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:09.998219 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:18:09.998341 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:18:09.998971 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:18:09.999054 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:18:10.037177 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:18:10.037506 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:10.037584 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:18:10.038956 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:18:10.039199 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:10.039820 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:18:10.855010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:743621ef-5b16-4c0f-835e-2dee7b4efbdc:europe-west1&page=queryresults
[0m11:18:10.857636 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:10.858992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108972080>]}
[0m11:18:10.859467 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m11:18:10.860559 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e2b54e18-f688-48af-afc4-df65ef70e562:europe-west1&page=queryresults
[0m11:18:10.861031 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:18:10.862617 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:10.862881 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:18:10.863399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087626e0>]}
[0m11:18:10.863704 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:18:10.864003 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m11:18:10.864549 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:18:10.864904 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:18:10.865094 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:18:10.865299 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:18:10.865509 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:18:10.865814 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:18:10.867557 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:18:10.868092 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:18:10.868415 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:18:10.868551 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:18:10.869951 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:18:10.871388 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:10.871513 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:10.871664 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:18:10.871801 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:18:10.874579 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:18:10.876945 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:18:10.877384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:10.877581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:10.878942 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m11:18:10.879988 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m11:18:11.800025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7ea56151-86fb-4463-8e72-d89ea8a90ae4:europe-west1&page=queryresults
[0m11:18:11.802946 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:11.803796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108972380>]}
[0m11:18:11.804305 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m11:18:11.804885 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:18:11.805146 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m11:18:11.805578 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m11:18:11.806348 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:18:11.806548 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m11:18:11.806720 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m11:18:11.820100 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:18:11.821270 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:11.821427 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m11:18:11.834911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:11.978071 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1a1992c1-8572-429c-b528-2690e6ff163f:europe-west1&page=queryresults
[0m11:18:11.979419 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:11.979844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107337010>]}
[0m11:18:11.980082 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m11:18:11.980343 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:18:11.980464 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:18:11.980590 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m11:18:11.981080 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:18:11.981189 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:18:11.981298 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:18:11.983370 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:18:11.987777 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:11.987915 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:18:11.990114 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:18:11.990927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:11.991849 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m11:18:12.306212 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:18:12.306774 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:18:12.958233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b41f48db-d153-4a1d-99fb-0d538daffe2f:europe-west1&page=queryresults
[0m11:18:12.961122 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:12.961977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed0ee0>]}
[0m11:18:12.962472 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m11:18:12.963047 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:18:12.963303 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:18:12.963710 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m11:18:12.965057 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:18:12.965307 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:18:12.965487 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:18:12.977019 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:18:12.977875 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:12.978042 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:18:13.000893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:18:13.420611 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:18:13.421079 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m11:18:14.545839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:45d12b85-d87c-4fdc-ba24-b6f83c5843f7:europe-west1&page=queryresults
[0m11:18:14.547155 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:14.547644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a85330>]}
[0m11:18:14.547898 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.74s]
[0m11:18:14.548198 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m11:18:14.548332 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m11:18:14.548486 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m11:18:14.549078 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:18:14.549222 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:18:14.549351 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m11:18:14.553396 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:18:14.553930 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:14.554093 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m11:18:14.556364 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m11:18:14.556712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:14.557599 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)


    );
  
[0m11:18:15.592383 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:24a14305-03e3-4cc4-984b-b4d9719d65c3:europe-west1&page=queryresults
[0m11:18:15.594419 [debug] [Thread-2 (]: finished collecting timing info
[0m11:18:15.595146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fa6e0>]}
[0m11:18:15.595594 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.63s]
[0m11:18:15.596072 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:18:17.294911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dad58593-2384-478c-be75-efbcd8a3e676:europe-west1&page=queryresults
[0m11:18:17.298644 [debug] [Thread-1 (]: finished collecting timing info
[0m11:18:17.299654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df15a25-0370-4592-8f27-f5797295c3c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f9de0>]}
[0m11:18:17.300194 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mCREATE TABLE (16.2k rows, 43.1 MB processed)[0m in 2.75s]
[0m11:18:17.300796 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m11:18:17.302682 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:18:17.303395 [info ] [MainThread]: 
[0m11:18:17.303723 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m11:18:17.303983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:17.304121 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:18:17.304252 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m11:18:17.314512 [info ] [MainThread]: 
[0m11:18:17.314801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:17.315031 [info ] [MainThread]: 
[0m11:18:17.315217 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m11:18:17.315469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108768af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089727a0>]}
[0m11:18:17.315667 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 11:22:33.881480 | 35e2dd1f-08f5-4824-bcd0-233f0bcc12f9 ==============================
[0m11:22:33.881538 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:22:33.882495 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:22:33.882604 [debug] [MainThread]: Tracking: tracking
[0m11:22:33.893365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c68df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c6b910>]}
[0m11:22:33.929828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:33.929977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:33.930281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m11:22:33.933296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076940d0>]}
[0m11:22:33.938140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107660c10>]}
[0m11:22:33.938283 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:22:33.938416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106058af0>]}
[0m11:22:33.939207 [info ] [MainThread]: 
[0m11:22:33.939523 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:22:33.940193 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:22:33.940320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:34.639494 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:22:34.641574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:35.112441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105578d60>]}
[0m11:22:35.113371 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:22:35.113694 [info ] [MainThread]: 
[0m11:22:35.120675 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:22:35.120879 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:22:35.121280 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:22:35.121570 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:22:35.122292 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:22:35.123249 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:22:35.123501 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:22:35.123710 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:22:35.123974 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:22:35.124201 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:22:35.126161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:22:35.127586 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:22:35.128239 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:35.128354 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:35.128509 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:22:35.128648 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:22:35.151056 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:22:35.152887 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:22:35.153285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:35.153406 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:22:35.154259 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:22:35.154977 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:22:35.942058 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:636797c8-f23e-4ac0-bfff-866228bc2ac9:europe-west1&page=queryresults
[0m11:22:35.956285 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:35.956743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107749270>]}
[0m11:22:35.956969 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m11:22:35.957230 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:22:35.957345 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:22:35.957587 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:22:35.958091 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:22:35.958221 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:22:35.958314 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:22:35.959445 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:22:35.967023 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:35.967181 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:22:36.007996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f7d8715d-b06c-4f4c-b28c-607354903eec:europe-west1&page=queryresults
[0m11:22:36.010006 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:36.011319 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:22:36.011620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060581c0>]}
[0m11:22:36.011890 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m11:22:36.012205 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:22:36.012308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:22:36.012399 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:22:36.012734 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:22:36.013026 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:22:36.013106 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:22:36.013187 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:22:36.013866 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:22:36.015706 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:22:36.052980 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:36.053093 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:22:36.054650 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:22:36.055010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:36.055768 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:22:36.972525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5bbb5aac-a19a-4c3d-9cbf-edb8aa82be9c:europe-west1&page=queryresults
[0m11:22:36.975149 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:13bc858d-53bd-41ba-93a6-e5ec4a0cd9c3:europe-west1&page=queryresults
[0m11:22:36.977388 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:36.979398 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:36.980155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605b3a0>]}
[0m11:22:36.980726 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c35b70>]}
[0m11:22:36.981197 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m11:22:36.981623 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m11:22:36.982118 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:22:36.982546 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:22:36.982778 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:22:36.983139 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:22:36.983415 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:22:36.983520 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:22:36.983824 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:22:36.984325 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:22:36.984428 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:22:36.984504 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:22:36.984583 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:22:36.984651 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:22:36.985735 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:22:36.986532 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:22:36.988242 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:36.988431 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:36.988629 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:22:36.988846 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:22:36.990714 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:22:36.992153 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:22:36.992508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:22:36.992590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:36.993286 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m11:22:37.041479 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m11:22:37.878671 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:913fb918-a7fc-4ccd-a932-3a2df256ad18:europe-west1&page=queryresults
[0m11:22:37.880824 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:37.881518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107734f10>]}
[0m11:22:37.881918 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:22:37.882370 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:22:37.882569 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m11:22:37.882902 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m11:22:37.883620 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:22:37.883807 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m11:22:37.883970 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m11:22:37.895407 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:22:37.897406 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:37.897533 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m11:22:37.907546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:22:38.079073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8235806c-61ca-4fac-9129-541865c0d00b:europe-west1&page=queryresults
[0m11:22:38.080565 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:38.081048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107660130>]}
[0m11:22:38.081329 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m11:22:38.081658 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:22:38.081801 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:22:38.082053 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m11:22:38.082754 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:22:38.082884 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:22:38.082988 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:22:38.085211 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:22:38.087112 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:38.087291 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:22:38.089740 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:22:38.090090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:38.090997 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m11:22:38.271350 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:22:38.271813 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:22:38.985247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5ca2ce65-b87c-4368-9521-2253003ae253:europe-west1&page=queryresults
[0m11:22:38.988006 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:38.988805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076534f0>]}
[0m11:22:38.989229 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m11:22:38.989717 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:22:38.989929 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:22:38.990410 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m11:22:38.991198 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:22:38.991388 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:22:38.991559 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:22:39.002415 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:22:39.003398 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:39.003542 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:22:39.026439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:39.508622 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:22:39.509173 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m11:22:40.929555 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5e9855cf-2296-4241-a756-7602420f765c:europe-west1&page=queryresults
[0m11:22:40.932407 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:40.933447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076960b0>]}
[0m11:22:40.933988 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.05s]
[0m11:22:40.934375 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m11:22:40.934496 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m11:22:40.934680 [info ] [Thread-2 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m11:22:40.935066 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:22:40.935154 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:22:40.935230 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m11:22:40.938731 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:22:40.940556 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:40.940652 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m11:22:40.942155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:22:41.296295 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m11:22:41.297577 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m11:22:41.593974 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [31:3]')
[0m11:22:41.741208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e16272ca-581f-4e62-a831-ce02a7b98fd2:europe-west1&page=queryresults
[0m11:22:41.744400 [debug] [Thread-1 (]: finished collecting timing info
[0m11:22:41.745481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9c070>]}
[0m11:22:41.746009 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.75s]
[0m11:22:41.746522 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:22:42.352094 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:7054bcfa-8b9e-4836-ac8d-5a39c8f815dc&page=queryresults
[0m11:22:42.353638 [debug] [Thread-2 (]: finished collecting timing info
[0m11:22:42.354736 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [31:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m11:22:42.355176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e2dd1f-08f5-4824-bcd0-233f0bcc12f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107484b80>]}
[0m11:22:42.355725 [error] [Thread-2 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.42s]
[0m11:22:42.356293 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m11:22:42.358270 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:22:42.359005 [info ] [MainThread]: 
[0m11:22:42.359343 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.42 seconds (8.42s).
[0m11:22:42.359613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:42.359748 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m11:22:42.359878 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:22:42.372002 [info ] [MainThread]: 
[0m11:22:42.372812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:22:42.373426 [info ] [MainThread]: 
[0m11:22:42.373935 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m11:22:42.374235 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [31:3]
[0m11:22:42.374406 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m11:22:42.374556 [info ] [MainThread]: 
[0m11:22:42.374690 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m11:22:42.374892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c62650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c60460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c03850>]}
[0m11:22:42.375057 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 11:23:12.960837 | a9ac58fe-6cc6-4350-ab27-c291d39ba6e7 ==============================
[0m11:23:12.960952 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:23:12.961520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:23:12.961620 [debug] [MainThread]: Tracking: tracking
[0m11:23:12.972029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef1390>]}
[0m11:23:13.009044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:13.009293 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m11:23:13.016996 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m11:23:13.032786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m11:23:13.035510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a100220>]}
[0m11:23:13.040351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a093b80>]}
[0m11:23:13.040552 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:23:13.040692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7d1b0>]}
[0m11:23:13.041539 [info ] [MainThread]: 
[0m11:23:13.042059 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:13.042897 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:23:13.043087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:13.633470 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:23:13.634123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:14.019866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e50d60>]}
[0m11:23:14.021163 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:23:14.021558 [info ] [MainThread]: 
[0m11:23:14.027844 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:14.030641 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:23:14.031848 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:23:14.032250 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:23:14.032660 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:14.032999 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:23:14.033234 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:23:14.033855 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:23:14.078755 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:23:14.078913 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:23:14.079895 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:23:14.081728 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:23:14.084729 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:14.084815 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:14.084905 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:14.084984 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:23:14.102713 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:23:14.103546 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:23:14.103789 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:23:14.103873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:14.104587 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:23:14.105126 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:23:14.876532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ddf83d49-18b9-4997-bee3-4de13784b348:europe-west1&page=queryresults
[0m11:23:14.889261 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:14.889721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d8dc0>]}
[0m11:23:14.889943 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m11:23:14.890215 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:14.890326 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:14.890446 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:23:14.890791 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:23:14.890886 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:14.890974 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:14.892031 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:23:14.893890 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:14.893980 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:14.895603 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:23:14.895881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:14.896642 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:23:14.943593 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bc338b37-2f0a-41f1-bb45-923147fc0bb9:europe-west1&page=queryresults
[0m11:23:14.944699 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:14.945056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f04280>]}
[0m11:23:14.945223 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m11:23:14.945423 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:23:14.945514 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:14.945612 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:23:14.946060 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:23:14.946362 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:14.946562 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:14.947578 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:23:14.950284 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:14.950372 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:14.956702 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:23:14.956939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:14.957582 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:23:15.634610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:db3ddf86-78b1-44ee-be6d-59e40abfc4e1:europe-west1&page=queryresults
[0m11:23:15.637271 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:15.638080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3381c0>]}
[0m11:23:15.638506 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m11:23:15.638983 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:15.639189 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:15.639542 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:23:15.640280 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:23:15.640465 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:15.640633 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:15.642904 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:23:15.644945 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:15.645145 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:15.648061 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:23:15.648878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:15.651430 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m11:23:15.774554 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a188944c-d812-48a6-b9aa-14b48e685317:europe-west1&page=queryresults
[0m11:23:15.775755 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:15.776156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e50d60>]}
[0m11:23:15.776375 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m11:23:15.776634 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:15.776754 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:15.776883 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:23:15.777252 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:23:15.777355 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:15.777506 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:15.778788 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:23:15.779167 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:15.779265 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:15.781101 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:23:15.781458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:15.782257 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m11:23:16.405522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5f2a3618-544b-4861-89b9-c52783adcdbe:europe-west1&page=queryresults
[0m11:23:16.409530 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:16.410536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a143580>]}
[0m11:23:16.411047 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m11:23:16.411652 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:16.411895 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m11:23:16.412241 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m11:23:16.412926 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:23:16.413100 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m11:23:16.413272 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m11:23:16.417804 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:23:16.419226 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:16.419418 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m11:23:16.429716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:16.817655 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b49ee685-ea56-458a-b3c9-215577586e89:europe-west1&page=queryresults
[0m11:23:16.820317 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:16.821065 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33b4f0>]}
[0m11:23:16.821506 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m11:23:16.822008 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:16.822227 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:16.822898 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m11:23:16.823948 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:23:16.824144 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:16.824456 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:16.841447 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:23:16.843975 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:16.844111 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:16.846342 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:23:16.846665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:16.847706 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m11:23:17.052333 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:23:17.052875 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:23:17.860152 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b565d6fa-6d12-4de3-b7d3-41f8c4728096:europe-west1&page=queryresults
[0m11:23:17.863047 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:17.863863 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef2530>]}
[0m11:23:17.864320 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m11:23:17.864826 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:17.865053 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:17.865412 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m11:23:17.866123 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:23:17.866530 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:17.866783 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:17.877319 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:23:17.877858 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:17.877999 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:17.900203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:18.488658 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:23:18.489156 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m11:23:19.371859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e43be43f-d1f9-42c9-bc95-3577342ad93f:europe-west1&page=queryresults
[0m11:23:19.375040 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:19.375975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cad10>]}
[0m11:23:19.376500 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.96s]
[0m11:23:19.377092 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m11:23:19.377323 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m11:23:19.377570 [info ] [Thread-1 (]: 10 of 10 START sql view model dbt_rsdun.articles_evidence ...................... [RUN]
[0m11:23:19.378244 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:23:19.378744 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:23:19.379100 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m11:23:19.383828 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:23:19.385313 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:19.385594 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m11:23:19.394903 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:19.395451 [debug] [Thread-1 (]: Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m11:23:19.395672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a6b00>]}
[0m11:23:19.395977 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model dbt_rsdun.articles_evidence ............. [[31mERROR[0m in 0.02s]
[0m11:23:19.396307 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m11:23:20.662314 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ec5880f6-5dd5-47de-b3ff-8955e7e003b9:europe-west1&page=queryresults
[0m11:23:20.665311 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:20.666232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ac58fe-6cc6-4350-ab27-c291d39ba6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eff910>]}
[0m11:23:20.666721 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.80s]
[0m11:23:20.667268 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:20.668997 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:20.669617 [info ] [MainThread]: 
[0m11:23:20.669901 [info ] [MainThread]: Finished running 8 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m11:23:20.670163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:20.670301 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:23:20.670428 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m11:23:20.683285 [info ] [MainThread]: 
[0m11:23:20.683588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:23:20.683796 [info ] [MainThread]: 
[0m11:23:20.683971 [error] [MainThread]: [33mCompilation Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m11:23:20.684152 [error] [MainThread]:   Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m11:23:20.684326 [error] [MainThread]:   
[0m11:23:20.684492 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m11:23:20.684658 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m11:23:20.684821 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m11:23:20.684981 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m11:23:20.685143 [error] [MainThread]:   > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m11:23:20.685334 [info ] [MainThread]: 
[0m11:23:20.685516 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m11:23:20.685796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3799c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106230610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cbee0>]}
[0m11:23:20.685998 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 11:23:38.229928 | 3bce7d35-aa5c-4620-9d46-c6a253cc6731 ==============================
[0m11:23:38.229973 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:23:38.230605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:23:38.230718 [debug] [MainThread]: Tracking: tracking
[0m11:23:38.242398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977d120>]}
[0m11:23:38.276924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:38.277175 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m11:23:38.284918 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m11:23:38.298499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m11:23:38.301201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b04d60>]}
[0m11:23:38.307164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e76650>]}
[0m11:23:38.307356 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:23:38.307490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109abf0d0>]}
[0m11:23:38.308312 [info ] [MainThread]: 
[0m11:23:38.308653 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:38.309306 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:23:38.309433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:39.034223 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:23:39.034819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:39.427797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107874d30>]}
[0m11:23:39.429015 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:23:39.429432 [info ] [MainThread]: 
[0m11:23:39.436431 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:39.439250 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:23:39.440483 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:23:39.440769 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:23:39.441033 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:39.441288 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:23:39.441519 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:23:39.442161 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:23:39.488134 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:23:39.488281 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:23:39.490386 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:23:39.492021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:23:39.492349 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:39.492447 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:39.498497 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:39.509174 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:23:39.509347 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:23:39.510897 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:23:39.511224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:39.511907 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:23:39.547444 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:23:39.548419 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:23:40.300430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4aad9ad4-b684-4699-a46a-af4c0fd0717d:europe-west1&page=queryresults
[0m11:23:40.320385 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:629ced33-1f8c-446a-a346-9d9ccb65ab2b:europe-west1&page=queryresults
[0m11:23:40.321710 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:40.322982 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:40.323577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b04e20>]}
[0m11:23:40.323979 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb2e0>]}
[0m11:23:40.324346 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m11:23:40.324583 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m11:23:40.324999 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:23:40.325345 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:23:40.325557 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:40.325760 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:40.325970 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:23:40.326373 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:23:40.326856 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:23:40.327266 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:23:40.327438 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:40.327559 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:40.327671 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:40.327764 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:40.329238 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:23:40.330407 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:23:40.330829 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:40.330980 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:40.331146 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:40.331332 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:40.333689 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:23:40.337687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:40.342037 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:23:40.342862 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:23:40.384429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:40.385166 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:23:41.218069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bacef12c-b4f6-400a-b7ab-02683d0fec5a:europe-west1&page=queryresults
[0m11:23:41.221670 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:41.222703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2c880>]}
[0m11:23:41.223232 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:23:41.225519 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:45074af6-827d-42ed-bfe7-459ab137d8f3:europe-west1&page=queryresults
[0m11:23:41.226048 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:23:41.227891 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:41.228207 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:41.229027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b2e170>]}
[0m11:23:41.229348 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:23:41.229716 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:23:41.230440 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:23:41.230955 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:23:41.231143 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:41.231330 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:41.231706 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:41.231933 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:23:41.233936 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:23:41.234553 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:23:41.234802 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:41.234969 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:41.236553 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:23:41.236967 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:41.237110 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:41.237216 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:41.239671 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:23:41.239814 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:41.242170 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:23:41.242453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:41.242644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:41.243718 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m11:23:41.290479 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m11:23:42.002825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:31da955b-1fed-464c-b0c5-cba335479e0e:europe-west1&page=queryresults
[0m11:23:42.006332 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:42.007250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2abc0>]}
[0m11:23:42.007700 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m11:23:42.008219 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:23:42.008452 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m11:23:42.008728 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m11:23:42.009703 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:23:42.009920 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m11:23:42.010114 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m11:23:42.017193 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:23:42.017909 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9bc88563-8e8c-4ef1-8894-a38df0e31c64:europe-west1&page=queryresults
[0m11:23:42.018894 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:42.019262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b05c30>]}
[0m11:23:42.019458 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m11:23:42.019719 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:23:42.019843 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:42.019994 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:42.020198 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m11:23:42.020319 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m11:23:42.020664 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:23:42.027731 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:42.029245 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:42.032457 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:23:42.035204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:42.080131 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:42.080303 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:42.083664 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:23:42.084095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:42.084730 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m11:23:42.479852 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:23:42.480837 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:23:42.796127 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c55cfd4f-b070-4426-8831-9cbfc56b1e7d:europe-west1&page=queryresults
[0m11:23:42.797481 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:42.797917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974d0c0>]}
[0m11:23:42.798156 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m11:23:42.798442 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:23:42.798571 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:42.798706 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m11:23:42.799241 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:23:42.799428 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:42.799537 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:42.806299 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:23:42.806702 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:42.806808 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:42.824649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:23:43.252954 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:23:43.253697 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m11:23:44.804052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:59999fd9-35f3-4264-8e57-dc1c8e88eb06:europe-west1&page=queryresults
[0m11:23:44.807332 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:44.808245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d999c0>]}
[0m11:23:44.808744 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.80s]
[0m11:23:44.809335 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m11:23:44.809589 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m11:23:44.809831 [info ] [Thread-1 (]: 10 of 10 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m11:23:44.810721 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:23:44.810946 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:23:44.811131 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m11:23:44.816112 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:23:44.816970 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:44.817139 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m11:23:44.824840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:45.324326 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m11:23:45.326539 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:76f58cbe-e175-4765-8ccc-9e05a4768555:europe-west1&page=queryresults
[0m11:23:45.328507 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:45.329347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dad690>]}
[0m11:23:45.329611 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)
    );
  
[0m11:23:45.330012 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.1 KB processed)[0m in 2.53s]
[0m11:23:45.331480 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:23:47.643210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f7bfb97f-6eb5-40df-80d7-7d178e1f27e1:europe-west1&page=queryresults
[0m11:23:47.653404 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:47.654305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bce7d35-aa5c-4620-9d46-c6a253cc6731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db6b60>]}
[0m11:23:47.654774 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (16.2k rows, 43.1 MB processed)[0m in 2.84s]
[0m11:23:47.655287 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m11:23:47.657133 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:23:47.657913 [info ] [MainThread]: 
[0m11:23:47.658194 [info ] [MainThread]: Finished running 7 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 9.35 seconds (9.35s).
[0m11:23:47.658413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:47.658527 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:23:47.658638 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m11:23:47.668343 [info ] [MainThread]: 
[0m11:23:47.668656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:47.668888 [info ] [MainThread]: 
[0m11:23:47.669073 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m11:23:47.669372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107874d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d56110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d568f0>]}
[0m11:23:47.669612 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 11:25:15.840138 | da40d56d-17f1-4221-a543-7fb838744a2f ==============================
[0m11:25:15.840178 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:25:15.840952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:25:15.841058 [debug] [MainThread]: Tracking: tracking
[0m11:25:15.851913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106868220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a470>]}
[0m11:25:15.888350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:15.888495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:15.888796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m11:25:15.891740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30c0d0>]}
[0m11:25:15.896766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dcb80>]}
[0m11:25:15.896952 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:25:15.897082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a470>]}
[0m11:25:15.897899 [info ] [MainThread]: 
[0m11:25:15.898221 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:25:15.898848 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:25:15.898966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:16.364598 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:25:16.365156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:16.676909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774d00>]}
[0m11:25:16.677908 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:25:16.678184 [info ] [MainThread]: 
[0m11:25:16.686901 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:16.688307 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:25:16.688568 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:25:16.688766 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:25:16.689344 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:25:16.689986 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:25:16.690192 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:16.690347 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:25:16.690499 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:25:16.690608 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:25:16.692098 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:25:16.693381 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:25:16.694616 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:16.694759 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:16.701239 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:16.714624 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:25:16.714779 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:25:16.716664 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:25:16.716924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:16.717117 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:25:16.717908 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:25:16.755388 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:25:17.389593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:844822f5-05ff-4e4a-b07a-ebe7adc002fe:europe-west1&page=queryresults
[0m11:25:17.409570 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:17.410317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925e830>]}
[0m11:25:17.410705 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m11:25:17.411137 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:17.411310 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:17.411593 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:25:17.412163 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:25:17.412313 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:17.412459 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:17.414187 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:25:17.416678 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:17.416846 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:17.460010 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:01a24168-69a5-439e-a66f-437b6334c13d:europe-west1&page=queryresults
[0m11:25:17.461950 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:17.462381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ca890>]}
[0m11:25:17.463937 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:25:17.464182 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m11:25:17.464497 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:25:17.464598 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:17.464816 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:25:17.465254 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:25:17.465370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:17.465508 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:17.465678 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:17.466365 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:25:17.468286 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:25:17.504517 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:17.504637 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:17.506145 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:25:17.506343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:17.506971 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:25:18.116862 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:acc5d585-02ed-4091-b645-952bc9f0f5ca:europe-west1&page=queryresults
[0m11:25:18.119340 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:18.120221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ca6b0>]}
[0m11:25:18.120738 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m11:25:18.121322 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:18.121582 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:18.122006 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:25:18.123041 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:25:18.123272 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:18.123443 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:18.125884 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:25:18.128259 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:18.128454 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:18.131742 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:25:18.132702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:18.134178 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m11:25:18.184814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:51ba6fe0-c85f-4fa8-9a35-ecac5c73e76f:europe-west1&page=queryresults
[0m11:25:18.185608 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:18.185904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30ed70>]}
[0m11:25:18.186118 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m11:25:18.186452 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:18.186667 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:18.186778 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:25:18.187165 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:25:18.187256 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:18.187338 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:18.188333 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:25:18.188670 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:18.188757 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:18.190232 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:25:18.190439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:18.191104 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m11:25:19.019292 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:32c5b6ae-e8b6-42a8-b10c-aa96b1b82ba0:europe-west1&page=queryresults
[0m11:25:19.021060 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:19.021434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3d68c0>]}
[0m11:25:19.021618 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m11:25:19.021830 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:19.021930 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m11:25:19.022073 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m11:25:19.022355 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:25:19.022428 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m11:25:19.022499 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m11:25:19.028604 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:25:19.029551 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:19.029640 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m11:25:19.041107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:19.098900 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:baeb3deb-fd8b-4f78-9246-75c2e3d320e8:europe-west1&page=queryresults
[0m11:25:19.099720 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:19.100039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30f130>]}
[0m11:25:19.100218 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m11:25:19.100433 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:19.100530 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:19.100633 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m11:25:19.100931 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:25:19.101172 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:19.101272 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:19.103001 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:25:19.104773 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:19.104908 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:19.106586 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:25:19.106885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:19.107588 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  referrer, slug, user_id, category, os, clinic_id, max(original_timestamp) as original_timestamp,
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, clinic_id, user_id, category, os;


[0m11:25:19.439235 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:25:19.440158 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:25:20.089139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cc24bfce-1944-498b-8eae-2d88a4a1f517:europe-west1&page=queryresults
[0m11:25:20.091138 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:20.091669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ff3d0>]}
[0m11:25:20.091912 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m11:25:20.092203 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:20.092332 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:25:20.092750 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m11:25:20.093259 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:25:20.093371 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:25:20.093464 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:25:20.098664 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:25:20.099082 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:20.099191 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:25:20.117199 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m11:25:20.117994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:20.118708 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m11:25:22.534215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7612b639-abd5-4a92-87b7-177eb4a562ca:europe-west1&page=queryresults
[0m11:25:22.538207 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:22.539353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c394190>]}
[0m11:25:22.539883 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mCREATE TABLE (1.5k rows, 548.3 KB processed)[0m in 2.45s]
[0m11:25:22.540361 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m11:25:22.540578 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m11:25:22.540939 [info ] [Thread-1 (]: 10 of 10 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m11:25:22.541744 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:25:22.541949 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:25:22.542136 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m11:25:22.553916 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:25:22.579900 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:22.580244 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m11:25:22.586954 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m11:25:22.587589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:22.588530 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)
    );
  
[0m11:25:22.860547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4dc6b73b-b7e6-40a5-94b1-9871509c88b2:europe-west1&page=queryresults
[0m11:25:22.863992 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:22.864599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30ef20>]}
[0m11:25:22.864896 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.84s]
[0m11:25:22.865233 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m11:25:25.358326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:24893082-9f26-4c3e-8963-30f37dd30037:europe-west1&page=queryresults
[0m11:25:25.361127 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:25.361953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da40d56d-17f1-4221-a543-7fb838744a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30ee30>]}
[0m11:25:25.362379 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (16.2k rows, 43.1 MB processed)[0m in 2.82s]
[0m11:25:25.362847 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m11:25:25.364377 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:25:25.365053 [info ] [MainThread]: 
[0m11:25:25.365369 [info ] [MainThread]: Finished running 7 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m11:25:25.365628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:25.365761 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:25:25.365891 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m11:25:25.375774 [info ] [MainThread]: 
[0m11:25:25.376071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:25.376296 [info ] [MainThread]: 
[0m11:25:25.376480 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m11:25:25.376736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30fb20>]}
[0m11:25:25.376931 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:09:17.468378 | fece277b-f274-4025-b93a-36efe68341f9 ==============================
[0m12:09:17.468416 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:09:17.469983 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:09:17.470200 [debug] [MainThread]: Tracking: tracking
[0m12:09:17.486364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecf0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104428df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442b910>]}
[0m12:09:17.523881 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m12:09:17.524157 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:09:17.524257 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:09:17.524363 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:09:17.532495 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m12:09:17.538710 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:09:17.549736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:09:17.552885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cce20>]}
[0m12:09:17.557931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080973d0>]}
[0m12:09:17.558089 [info ] [MainThread]: Found 9 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:09:17.558227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108097490>]}
[0m12:09:17.559007 [info ] [MainThread]: 
[0m12:09:17.559347 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:09:17.560042 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:09:17.560193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:18.173694 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:09:18.174146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:18.672788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c8d60>]}
[0m12:09:18.674161 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:09:18.674576 [info ] [MainThread]: 
[0m12:09:18.684333 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:09:18.730129 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:09:18.730387 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m12:09:18.730519 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m12:09:18.730896 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:09:18.731216 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:09:18.731330 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:09:18.731440 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:09:18.731533 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:09:18.731606 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:09:18.732636 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:09:18.733478 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:09:18.734030 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:18.734123 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:09:18.750198 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:09:18.750466 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:18.750571 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:09:18.752037 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:09:18.752200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:18.752919 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:09:18.753021 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:18.789679 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:09:19.849576 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:56e6bfd3-e2e8-4189-bd93-37498ff41d6c:europe-west1&page=queryresults
[0m12:09:19.857245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:27eb845b-5c70-48a1-9097-bac7acf9daa6:europe-west1&page=queryresults
[0m12:09:19.864591 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:19.865697 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:19.866122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ae950>]}
[0m12:09:19.866448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de7af0>]}
[0m12:09:19.866687 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m12:09:19.866866 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m12:09:19.867170 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:09:19.867410 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:09:19.867553 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:09:19.867719 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:09:19.867963 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m12:09:19.868154 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m12:09:19.868569 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:09:19.868957 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:09:19.869076 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:09:19.869176 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:09:19.869273 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:09:19.869358 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:09:19.870791 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:09:19.875303 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:19.875433 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:09:19.876023 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:09:19.879835 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:09:19.880468 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:19.880563 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:19.880715 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:09:19.881489 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:09:19.883282 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:09:19.922577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:19.923377 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:09:20.939165 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b04bc016-9402-47a8-a028-9fb317fb546e:europe-west1&page=queryresults
[0m12:09:20.940761 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:20.941172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bfb130>]}
[0m12:09:20.941384 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m12:09:20.941758 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:09:20.941931 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:09:20.942160 [info ] [Thread-2 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:09:20.945018 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:09:20.945167 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:09:20.945368 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:09:20.946693 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:09:20.947628 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:20.947787 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:09:20.949829 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:09:20.950346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:20.951186 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:09:21.638144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f1e65fcd-1483-41e1-bb34-288c4db0f894:europe-west1&page=queryresults
[0m12:09:21.642630 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:21.643448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ce770>]}
[0m12:09:21.644073 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m12:09:21.644900 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:09:21.645210 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:09:21.645547 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:09:21.646218 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:09:21.646372 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:09:21.646512 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:09:21.648438 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:09:21.649396 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:21.649581 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:09:21.652473 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:09:21.652965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:21.654083 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:09:21.824932 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:222a8b12-9e16-43db-872f-b24dac8d441a:europe-west1&page=queryresults
[0m12:09:21.826729 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:21.827292 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b8760>]}
[0m12:09:21.827593 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m12:09:21.827936 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:09:21.828099 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:09:21.828267 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m12:09:21.828914 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:09:21.829074 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:09:21.829212 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:09:21.832181 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:09:21.833594 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:21.833765 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:09:21.852501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:22.236024 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:09:22.237467 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:09:22.489532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e5a5a4f8-187b-41c3-aff7-94818240725b:europe-west1&page=queryresults
[0m12:09:22.492002 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:22.492492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cee30>]}
[0m12:09:22.492733 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m12:09:22.493000 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:09:22.493267 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:09:22.493454 [info ] [Thread-1 (]: 8 of 9 START sql table model dbt_rsdun.articles_evidence ....................... [RUN]
[0m12:09:22.493867 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:09:22.493974 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:09:22.494067 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:09:22.496654 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:09:22.498908 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:22.499097 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:09:22.501233 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:09:22.501824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:22.502779 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)
    );
  
[0m12:09:24.679411 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dcde4c82-de11-49f1-a006-8a5ebc9e03ae:europe-west1&page=queryresults
[0m12:09:24.682483 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:24.683279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104559150>]}
[0m12:09:24.683551 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.85s]
[0m12:09:24.683793 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:09:24.683901 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:09:24.684157 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:09:24.684837 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:09:24.684938 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:09:24.685022 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:09:24.689043 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:09:24.689371 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:24.689456 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:09:24.709721 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:09:24.710362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:24.711148 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`
    
    
    OPTIONS()
    as (
      

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug



    );
  
[0m12:09:25.365657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6b1c61ca-4d23-4b31-b5cb-3942e9216343:europe-west1&page=queryresults
[0m12:09:25.369236 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:25.370263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a87550>]}
[0m12:09:25.370810 [info ] [Thread-1 (]: 8 of 9 OK created sql table model dbt_rsdun.articles_evidence .................. [[32mCREATE TABLE (37.1k rows, 42.0 MB processed)[0m in 2.88s]
[0m12:09:25.371365 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:09:27.477226 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ad6b3aa4-a349-4257-8fe2-25e92bdcf197:europe-west1&page=queryresults
[0m12:09:27.480548 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:27.481133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fece277b-f274-4025-b93a-36efe68341f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cdff0>]}
[0m12:09:27.481389 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mCREATE TABLE (1.5k rows, 548.3 KB processed)[0m in 2.80s]
[0m12:09:27.481656 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:09:27.482503 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:09:27.482865 [info ] [MainThread]: 
[0m12:09:27.483041 [info ] [MainThread]: Finished running 6 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m12:09:27.483181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:27.483256 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:09:27.483326 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:09:27.501422 [info ] [MainThread]: 
[0m12:09:27.501708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:27.501935 [info ] [MainThread]: 
[0m12:09:27.502120 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:09:27.502364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108276e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fe6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081feef0>]}
[0m12:09:27.502563 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:12:31.672613 | 92db9a43-cb6b-4049-ac1b-bb6076c8c0ce ==============================
[0m12:12:31.672648 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:12:31.673398 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:12:31.673523 [debug] [MainThread]: Tracking: tracking
[0m12:12:31.683681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e44df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e47910>]}
[0m12:12:31.719169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:12:31.719394 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:12:31.719520 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:12:31.727215 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:12:31.732991 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m12:12:31.743651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m12:12:31.746480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0b460>]}
[0m12:12:31.751091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ec4730>]}
[0m12:12:31.751242 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:12:31.751372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109bb130>]}
[0m12:12:31.752153 [info ] [MainThread]: 
[0m12:12:31.752472 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:12:31.753138 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:12:31.753290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:32.334779 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:12:32.335329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:32.851870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae4d60>]}
[0m12:12:32.852890 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:12:32.853307 [info ] [MainThread]: 
[0m12:12:32.898066 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:12:32.898230 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:12:32.898468 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:12:32.898619 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:12:32.899051 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:12:32.899451 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:12:32.899576 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:12:32.899686 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:12:32.899783 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:12:32.899863 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:12:32.900947 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:12:32.901871 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:12:32.903092 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:32.903210 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:12:32.903300 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:32.920959 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:12:32.921133 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:12:32.922734 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:12:32.922959 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:12:32.923684 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:12:32.924185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:32.960780 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:12:33.747028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7643eb25-b3aa-41f9-896e-4a88dc43874f:europe-west1&page=queryresults
[0m12:12:33.766510 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:33.767170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107598d90>]}
[0m12:12:33.767530 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m12:12:33.767943 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:12:33.768118 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:12:33.768405 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:12:33.768990 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:12:33.769143 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:12:33.769279 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:12:33.771112 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:12:33.778018 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:33.778722 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:12:33.784763 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:12:33.785759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:33.786697 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:12:33.895205 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:82579691-8ccb-4e76-8c63-6baef52ed11e:europe-west1&page=queryresults
[0m12:12:33.896336 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:33.896693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110803df0>]}
[0m12:12:33.896901 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m12:12:33.897142 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:12:33.897249 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:12:33.897416 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:12:33.897758 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:12:33.897940 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:12:33.898033 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:12:33.900331 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:12:33.900761 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:33.900888 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:12:33.902776 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:12:33.903760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:33.906526 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:12:34.791859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:91c6033e-594a-4f3e-96ab-929ddfcb5371:europe-west1&page=queryresults
[0m12:12:34.794157 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:34.794705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f81f0>]}
[0m12:12:34.795014 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m12:12:34.795363 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:12:34.795519 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:12:34.795744 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:12:34.796203 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:12:34.796319 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:12:34.796431 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:12:34.798008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:12:34.799577 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7a08a40a-9bc3-405f-afd3-30ca2164f9d1:europe-west1&page=queryresults
[0m12:12:34.800738 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:34.801155 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c57b0>]}
[0m12:12:34.801388 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m12:12:34.801668 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:12:34.801762 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:34.801863 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:12:34.802208 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:12:34.802512 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:12:34.804610 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:12:34.805008 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:12:34.805263 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:12:34.805374 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:12:34.806349 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:12:34.806872 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:34.807002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:34.807101 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:12:34.807896 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:12:34.809573 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:12:34.847117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:34.847833 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:12:35.744118 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:11ed9f06-7256-4aa9-9920-33e42b484fdc:europe-west1&page=queryresults
[0m12:12:35.745464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c775c269-faf2-461e-b529-9eafd50ed716:europe-west1&page=queryresults
[0m12:12:35.748131 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:35.750232 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:35.750960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f6fe0>]}
[0m12:12:35.751492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f84c0>]}
[0m12:12:35.751948 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m12:12:35.752262 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m12:12:35.752726 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:12:35.753067 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:12:35.753279 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:12:35.753659 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:12:35.754037 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:12:35.754449 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:12:35.755109 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:12:35.755731 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:12:35.755920 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:12:35.756063 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:12:35.756224 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:12:35.756349 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:12:35.761642 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:12:35.771307 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:12:35.771437 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:35.771635 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:12:35.778837 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:12:35.779144 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:35.779282 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:12:35.779389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:35.786917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:35.787852 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
WHERE (event = 'Community | Viewed article')
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:12:36.281217 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:12:36.282810 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:12:36.490028 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event; Did you mean event_id? at [10:8]')
[0m12:12:37.624777 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:750c9ebb-7f30-4efb-942f-c2e3fc7c5673&page=queryresults
[0m12:12:37.626595 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:37.627650 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  Unrecognized name: event; Did you mean event_id? at [10:8]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:12:37.628088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ff3d0>]}
[0m12:12:37.628702 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 1.87s]
[0m12:12:37.629267 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:12:37.629536 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:12:37.630161 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:12:37.631094 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:12:37.631357 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:12:37.631581 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:12:37.642332 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:12:37.643100 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:37.643263 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:12:37.667761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:38.131955 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:12:38.132871 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:12:38.382307 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8862d986-a5c6-4cc3-8af1-3a6ade3b7eef:europe-west1&page=queryresults
[0m12:12:38.386102 [debug] [Thread-2 (]: finished collecting timing info
[0m12:12:38.387039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f8790>]}
[0m12:12:38.387556 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.63s]
[0m12:12:38.388132 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:12:38.388364 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:12:38.388652 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m12:12:38.389030 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:12:40.336024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:449c0c4e-4454-4b98-9ad2-1c22ad0419d4:europe-west1&page=queryresults
[0m12:12:40.337858 [debug] [Thread-1 (]: finished collecting timing info
[0m12:12:40.338455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92db9a43-cb6b-4049-ac1b-bb6076c8c0ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af20b0>]}
[0m12:12:40.338799 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.71s]
[0m12:12:40.339162 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:12:40.340526 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:12:40.341072 [info ] [MainThread]: 
[0m12:12:40.341311 [info ] [MainThread]: Finished running 7 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m12:12:40.341504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:40.341605 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:12:40.341700 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m12:12:40.356410 [info ] [MainThread]: 
[0m12:12:40.356666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:40.356839 [info ] [MainThread]: 
[0m12:12:40.356980 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m12:12:40.357119 [error] [MainThread]:   Unrecognized name: event; Did you mean event_id? at [10:8]
[0m12:12:40.357256 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:12:40.357403 [info ] [MainThread]: 
[0m12:12:40.357543 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m12:12:40.357750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eca950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c6f50>]}
[0m12:12:40.357915 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:15:49.573826 | f785dfad-413e-42f6-bf62-26174b935a66 ==============================
[0m12:15:49.573893 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:15:49.574594 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:15:49.574714 [debug] [MainThread]: Tracking: tracking
[0m12:15:49.585361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b12410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b13460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b11120>]}
[0m12:15:49.624092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:15:49.624351 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:15:49.624468 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:15:49.631767 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:15:49.637284 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:15:49.646545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m12:15:49.649209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27e20>]}
[0m12:15:49.653856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdaec0>]}
[0m12:15:49.654039 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:15:49.654174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a43bb0>]}
[0m12:15:49.655016 [info ] [MainThread]: 
[0m12:15:49.655400 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:15:49.656061 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:15:49.656186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:50.310175 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:15:50.310690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:50.678171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0cdc0>]}
[0m12:15:50.679517 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:15:50.679927 [info ] [MainThread]: 
[0m12:15:50.739077 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:15:50.739230 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:15:50.739472 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:15:50.739612 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:15:50.740008 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:15:50.740381 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:15:50.740475 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:15:50.740552 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:15:50.740637 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:15:50.740728 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:15:50.741776 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:15:50.742613 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:15:50.744640 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:50.744732 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:50.744822 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:15:50.744917 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:15:50.761708 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:15:50.763321 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:15:50.763646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:15:50.763733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:50.764468 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:15:50.800991 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:15:51.493842 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5ea9ef85-5f2a-47ae-bd83-657cfe0f3148:europe-west1&page=queryresults
[0m12:15:51.513482 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:51.514124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1ac50>]}
[0m12:15:51.514449 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m12:15:51.514865 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:15:51.515034 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:15:51.515305 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:15:51.515881 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:15:51.516026 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:15:51.516153 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:15:51.517846 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:15:51.520368 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:51.520508 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:15:51.526730 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:15:51.527124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:15:51.528015 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:15:51.920077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9bb4fda1-4afb-4d5b-b0a7-23291e3e6ce1:europe-west1&page=queryresults
[0m12:15:51.922685 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:51.923475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587afb0>]}
[0m12:15:51.923889 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m12:15:51.924359 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:15:51.924565 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:51.924914 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:15:51.925692 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:15:51.925979 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:51.926159 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:51.928484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:15:51.929186 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:51.929360 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:51.932300 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:15:51.932764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:51.934037 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:15:52.196365 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:68140164-0a87-4e37-8915-34e3baa6bc95:europe-west1&page=queryresults
[0m12:15:52.198218 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:52.198756 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d110f0>]}
[0m12:15:52.199061 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m12:15:52.199416 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:15:52.199590 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:15:52.199845 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:15:52.200355 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:15:52.200487 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:15:52.200612 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:15:52.202402 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:15:52.203262 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:52.203455 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:15:52.206374 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:15:52.207086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:15:52.208361 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:15:52.691026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7a5936eb-37fd-45c2-a1b3-008e29e36b4e:europe-west1&page=queryresults
[0m12:15:52.695268 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:52.696259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3e740>]}
[0m12:15:52.696806 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m12:15:52.697369 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:15:52.697640 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:15:52.698064 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:15:52.699359 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:15:52.699583 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:15:52.699766 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:15:52.702161 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:15:52.702913 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:52.703090 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:15:52.706175 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:15:52.706584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:52.708049 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:15:53.254480 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:13996152-6a0c-431c-9ba5-3013734ec45f:europe-west1&page=queryresults
[0m12:15:53.257371 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:53.258278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e66170>]}
[0m12:15:53.258791 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m12:15:53.259374 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:15:53.259589 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:15:53.259825 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:15:53.260623 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:15:53.260795 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:15:53.260964 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:15:53.274041 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:15:53.275637 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:53.275776 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:15:53.288995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:15:53.707012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0ecd264d-34a5-41ee-9bac-27920b8a42a8:europe-west1&page=queryresults
[0m12:15:53.711152 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:53.712110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eba560>]}
[0m12:15:53.712634 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m12:15:53.713193 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:15:53.713418 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:15:53.713802 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:15:53.714751 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:15:53.714959 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:15:53.715171 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:15:53.719078 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:15:53.721100 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:53.721279 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:15:53.724566 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:15:53.725196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:53.726401 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:15:53.783228 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:15:53.783772 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:15:54.635769 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column original_timestamp which is neither grouped nor aggregated at [8:42]')
[0m12:15:55.864078 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:7aa7d9a4-bd37-47bf-a2f0-4c1a121e804c&page=queryresults
[0m12:15:55.865412 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:55.866403 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  SELECT list expression references column original_timestamp which is neither grouped nor aggregated at [8:42]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:15:55.866854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eda800>]}
[0m12:15:55.867693 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 2.15s]
[0m12:15:55.868309 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:15:55.868584 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:15:55.869300 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:15:55.870310 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:15:55.870548 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:15:55.870745 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:15:55.881773 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:15:55.883515 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:55.883696 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:15:55.907874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:15:56.315573 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fefcccfb-f5c4-42a6-8c32-e78c5ab0ebce:europe-west1&page=queryresults
[0m12:15:56.318418 [debug] [Thread-2 (]: finished collecting timing info
[0m12:15:56.319190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046cb610>]}
[0m12:15:56.319524 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 3.06s]
[0m12:15:56.319808 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:15:56.319928 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:15:56.320024 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m12:15:56.320222 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:15:56.743337 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:15:56.743874 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:15:59.106152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c7be1ab2-0ba4-4f23-a3bc-af4e92c065e7:europe-west1&page=queryresults
[0m12:15:59.110707 [debug] [Thread-1 (]: finished collecting timing info
[0m12:15:59.111631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f785dfad-413e-42f6-bf62-26174b935a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b10970>]}
[0m12:15:59.112101 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 3.24s]
[0m12:15:59.112618 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:15:59.114502 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:15:59.115383 [info ] [MainThread]: 
[0m12:15:59.115711 [info ] [MainThread]: Finished running 7 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 9.46 seconds (9.46s).
[0m12:15:59.115968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:59.116100 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:15:59.116232 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m12:15:59.128658 [info ] [MainThread]: 
[0m12:15:59.129028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:15:59.129222 [info ] [MainThread]: 
[0m12:15:59.129383 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m12:15:59.129544 [error] [MainThread]:   SELECT list expression references column original_timestamp which is neither grouped nor aggregated at [8:42]
[0m12:15:59.129691 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:15:59.129873 [info ] [MainThread]: 
[0m12:15:59.130111 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m12:15:59.130363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020f1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd68c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a47a90>]}
[0m12:15:59.130557 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:16:33.763730 | d8042239-127f-4fba-a0c7-78e4e777c808 ==============================
[0m12:16:33.763793 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:16:33.764670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:16:33.764784 [debug] [MainThread]: Tracking: tracking
[0m12:16:33.776282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b455d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b45450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b450f0>]}
[0m12:16:33.818236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:33.818519 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:16:33.826345 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:16:33.840057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m12:16:33.842726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d54250>]}
[0m12:16:33.847548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce7a30>]}
[0m12:16:33.847738 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:16:33.847866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020eeb60>]}
[0m12:16:33.848668 [info ] [MainThread]: 
[0m12:16:33.849029 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:16:33.849697 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:16:33.849815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:34.377150 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:16:34.377715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:34.781952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d44d90>]}
[0m12:16:34.783289 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:16:34.783714 [info ] [MainThread]: 
[0m12:16:34.789526 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:16:34.791031 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:16:34.794171 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:16:34.794507 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:16:34.794936 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:16:34.795202 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:16:34.842381 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:16:34.842819 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:16:34.842908 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:16:34.844832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:16:34.844955 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:16:34.850259 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:16:34.850746 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:34.850833 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:16:34.862567 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:34.868106 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:16:34.868360 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:16:34.870072 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:16:34.870394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:34.871116 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:16:34.871226 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:16:34.908525 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:16:35.627985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:253c3b5d-cfee-4eac-a6bc-7c0530d9b1ff:europe-west1&page=queryresults
[0m12:16:35.647381 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:35.648214 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3c11389b-c8c2-4a13-874d-df7b1fceb9c2:europe-west1&page=queryresults
[0m12:16:35.648837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d54c70>]}
[0m12:16:35.650099 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:35.650500 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m12:16:35.650933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3ca60>]}
[0m12:16:35.651365 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:16:35.651584 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m12:16:35.651774 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:16:35.652176 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:16:35.652343 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:16:35.652512 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:16:35.653047 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:16:35.653383 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:16:35.653542 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:16:35.653966 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:16:35.654102 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:16:35.654202 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:16:35.655717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:16:35.655865 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:16:35.657154 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:16:35.657679 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:35.657789 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:35.657890 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:16:35.658003 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:16:35.662701 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:16:35.666079 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:16:35.666306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:35.667230 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:16:35.667330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:16:35.709164 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:16:36.557977 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:25646a0e-60c7-4822-b83b-c0f2f4b24440:europe-west1&page=queryresults
[0m12:16:36.560873 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:36.561742 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea00a0>]}
[0m12:16:36.562291 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m12:16:36.562877 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:16:36.563134 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:16:36.563491 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:16:36.564395 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:16:36.564625 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:16:36.564812 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:16:36.567239 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:16:36.568610 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:36.568798 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:16:36.571920 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:16:36.572693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:16:36.574103 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:16:36.623991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8393e6c1-d5ef-4187-b3d8-71608a9096fa:europe-west1&page=queryresults
[0m12:16:36.624983 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:36.625284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0ca0>]}
[0m12:16:36.625460 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m12:16:36.625657 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:16:36.625748 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:16:36.625846 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:16:36.626314 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:16:36.626483 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:16:36.626715 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:16:36.627762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:16:36.628174 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:36.628255 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:16:36.629823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:16:36.630146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:36.630852 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:16:37.321019 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ac735d78-0915-480d-93e8-97cb6f3e5daf:europe-west1&page=queryresults
[0m12:16:37.324300 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:37.325151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9e380>]}
[0m12:16:37.325587 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m12:16:37.326065 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:16:37.326274 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:16:37.326632 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:16:37.327949 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:16:37.328494 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:16:37.328710 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:16:37.333014 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:16:37.334618 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:37.334797 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:16:37.344681 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:16:37.508892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b5c9ad40-9157-490c-924d-52bea941b399:europe-west1&page=queryresults
[0m12:16:37.510433 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:37.510928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2c0a0>]}
[0m12:16:37.511210 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m12:16:37.511552 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:16:37.511717 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:16:37.512238 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:16:37.513041 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:16:37.513195 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:16:37.513326 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:16:37.526091 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:16:37.528701 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:37.528826 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:16:37.535738 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:16:37.536127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:37.536954 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp)
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:16:37.927871 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:16:37.928581 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:16:38.169234 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE VIEW columns must be named, but column 6 has no name at [6:6]')
[0m12:16:39.719766 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:07f87595-0015-458d-a410-d35655edb894&page=queryresults
[0m12:16:39.720701 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:39.721642 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  CREATE VIEW columns must be named, but column 6 has no name at [6:6]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:16:39.722040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6d870>]}
[0m12:16:39.722609 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 2.21s]
[0m12:16:39.723168 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:16:39.723437 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:16:39.723719 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:16:39.724557 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:16:39.725010 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:16:39.725341 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:16:39.736700 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:16:39.737238 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:39.737378 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:16:39.760248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:40.201754 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:16:40.202861 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:16:40.257660 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c1d09f0a-95f7-4c14-b7ba-4cf2ccb0fc72:europe-west1&page=queryresults
[0m12:16:40.258811 [debug] [Thread-2 (]: finished collecting timing info
[0m12:16:40.259195 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e530a0>]}
[0m12:16:40.259426 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.93s]
[0m12:16:40.259688 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:16:40.259806 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:16:40.259970 [info ] [Thread-2 (]: 10 of 10 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m12:16:40.260226 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:16:42.366351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:31725593-1dac-467d-b195-250035f481a1:europe-west1&page=queryresults
[0m12:16:42.369961 [debug] [Thread-1 (]: finished collecting timing info
[0m12:16:42.370966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8042239-127f-4fba-a0c7-78e4e777c808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6d5a0>]}
[0m12:16:42.371475 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.65s]
[0m12:16:42.372016 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:16:42.373670 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:16:42.374372 [info ] [MainThread]: 
[0m12:16:42.374691 [info ] [MainThread]: Finished running 7 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m12:16:42.374948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:42.375081 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:16:42.375209 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m12:16:42.389929 [info ] [MainThread]: 
[0m12:16:42.390195 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:42.390404 [info ] [MainThread]: 
[0m12:16:42.390580 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m12:16:42.390757 [error] [MainThread]:   CREATE VIEW columns must be named, but column 6 has no name at [6:6]
[0m12:16:42.390924 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:16:42.391164 [info ] [MainThread]: 
[0m12:16:42.391406 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m12:16:42.391665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a7bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eafca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eae890>]}
[0m12:16:42.391848 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:17:26.352186 | 8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5 ==============================
[0m12:17:26.352213 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:17:26.353039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:17:26.353147 [debug] [MainThread]: Tracking: tracking
[0m12:17:26.363728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f5120>]}
[0m12:17:26.402806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:17:26.403055 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:17:26.409770 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m12:17:26.425272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:17:26.428255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b08e80>]}
[0m12:17:26.433392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113abf310>]}
[0m12:17:26.433601 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:17:26.433749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113abf2e0>]}
[0m12:17:26.434589 [info ] [MainThread]: 
[0m12:17:26.434916 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:17:26.435656 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:17:26.435875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:26.875521 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:17:26.875973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:27.206462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113900580>]}
[0m12:17:27.207605 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:17:27.208059 [info ] [MainThread]: 
[0m12:17:27.212232 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:17:27.213026 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:17:27.215087 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:17:27.215376 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:17:27.215680 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:17:27.217079 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:17:27.259264 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:17:27.259457 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:17:27.259636 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:27.259969 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:17:27.260101 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:17:27.260214 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:17:27.278363 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:17:27.278531 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:17:27.279547 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:17:27.279767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:27.279897 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:27.279994 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:17:27.280694 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:17:27.282338 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:17:27.318630 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:17:27.319281 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:17:27.952811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b794513b-9991-4bd3-9a98-b38b6ec96791:europe-west1&page=queryresults
[0m12:17:27.973498 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:27.974448 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c154ff90-0d67-4cae-9d86-e66f30a5ec50:europe-west1&page=queryresults
[0m12:17:27.975161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b2a260>]}
[0m12:17:27.976475 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:27.976858 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m12:17:27.977303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113784cd0>]}
[0m12:17:27.977677 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:17:27.977908 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m12:17:27.978088 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:17:27.978494 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:17:27.978712 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:17:27.979144 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:17:27.979817 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:17:27.980111 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:17:27.980238 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:17:27.980637 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:17:27.980772 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:17:27.980884 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:17:27.982612 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:17:27.982771 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:17:27.984290 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:17:27.984640 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:27.984773 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:17:27.988448 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:27.989950 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:17:27.992024 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:17:27.993087 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:17:27.993415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:27.993521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:27.994433 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Clinic id') as clinic_id,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:17:27.995241 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:17:28.671159 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f652cd1b-edc1-454f-b780-4adc2bed89c6:europe-west1&page=queryresults
[0m12:17:28.675414 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:28.676507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c55810>]}
[0m12:17:28.677027 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m12:17:28.677627 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:17:28.677870 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:17:28.678242 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:17:28.679202 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:17:28.679408 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:17:28.679594 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:17:28.681966 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:17:28.684390 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:28.684617 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:17:28.688005 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:17:28.689074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:28.690595 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:17:29.024672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:469a0b8f-b75f-4b29-939c-42f5327e44e6:europe-west1&page=queryresults
[0m12:17:29.027040 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:29.027817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf0280>]}
[0m12:17:29.028360 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m12:17:29.028850 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:17:29.029065 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:17:29.029382 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:17:29.030068 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:17:29.030234 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:17:29.030390 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:17:29.032473 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:17:29.033203 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:29.033370 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:17:29.036339 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:17:29.036812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:29.038007 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:17:29.499137 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6ca4b786-1526-4bc9-bb5a-f4b7713ab72a:europe-west1&page=queryresults
[0m12:17:29.500071 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:29.500367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113893f70>]}
[0m12:17:29.500530 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m12:17:29.500722 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:17:29.500813 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:17:29.500978 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:17:29.501308 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:17:29.501389 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:17:29.501466 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:17:29.503290 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:17:29.504538 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:29.504636 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:17:29.510234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:29.679417 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e73d71b3-a3b2-4834-9f5d-1a7998f57ef6:europe-west1&page=queryresults
[0m12:17:29.680762 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:29.681197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f6d40>]}
[0m12:17:29.681440 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.65s]
[0m12:17:29.681723 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:17:29.681841 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:17:29.682042 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:17:29.682529 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:17:29.682652 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:17:29.682749 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:17:29.691907 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:17:29.693449 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:29.693553 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:17:29.699851 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:17:29.700159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:29.700903 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:17:29.975513 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:17:29.976147 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:17:30.581085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:816979e3-772c-466f-88a1-5a2987a4346c:europe-west1&page=queryresults
[0m12:17:30.583757 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:30.584411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113af4a30>]}
[0m12:17:30.584751 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m12:17:30.585190 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:17:30.585398 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:17:30.585628 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:17:30.586631 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:17:30.587031 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:17:30.587286 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:17:30.598329 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:17:30.598979 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:30.599149 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:17:30.623478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:31.189658 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:17:31.190734 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:17:32.060016 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:38c97322-e933-4678-907f-a32e6ec0d77f:europe-west1&page=queryresults
[0m12:17:32.064499 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:32.065584 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adeb00>]}
[0m12:17:32.066090 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.56s]
[0m12:17:32.066619 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:17:32.066865 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:17:32.067232 [info ] [Thread-2 (]: 10 of 10 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m12:17:32.068036 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:17:32.068243 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:17:32.068422 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m12:17:32.073268 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:17:32.076061 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:32.076260 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m12:17:32.082048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:17:32.445108 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:17:32.446109 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, clinic_id, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)
    );
  
[0m12:17:33.100412 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: clinic_id at [24:48]')
[0m12:17:33.316573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:521ce151-201a-4b1f-b39b-7223e9ccd8e9:europe-west1&page=queryresults
[0m12:17:33.318913 [debug] [Thread-1 (]: finished collecting timing info
[0m12:17:33.319845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ca8340>]}
[0m12:17:33.320384 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.73s]
[0m12:17:33.320967 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:17:34.447859 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:66a93f15-5598-4d50-be3c-f8b84d64773d&page=queryresults
[0m12:17:34.449555 [debug] [Thread-2 (]: finished collecting timing info
[0m12:17:34.450745 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Unrecognized name: clinic_id at [24:48]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:17:34.451205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e7c08e3-0bc8-43c1-b96a-d88afe9dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ca9180>]}
[0m12:17:34.451773 [error] [Thread-2 (]: 10 of 10 ERROR creating sql table model dbt_rsdun.articles_evidence ............ [[31mERROR[0m in 2.38s]
[0m12:17:34.452375 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:17:34.454345 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:17:34.455092 [info ] [MainThread]: 
[0m12:17:34.455412 [info ] [MainThread]: Finished running 7 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m12:17:34.455679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:34.455819 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:17:34.455951 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:17:34.473785 [info ] [MainThread]: 
[0m12:17:34.474604 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:17:34.475128 [info ] [MainThread]: 
[0m12:17:34.475283 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:17:34.475426 [error] [MainThread]:   Unrecognized name: clinic_id at [24:48]
[0m12:17:34.475552 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:17:34.475853 [info ] [MainThread]: 
[0m12:17:34.476016 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:17:34.476273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113acaf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113acb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ca8100>]}
[0m12:17:34.476595 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:18:15.447060 | b3d12173-39a0-4151-b9ca-3b1059c7aba9 ==============================
[0m12:18:15.447104 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:18:15.447972 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:18:15.448081 [debug] [MainThread]: Tracking: tracking
[0m12:18:15.457866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dda5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd9300>]}
[0m12:18:15.493922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:18:15.494162 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:18:15.494278 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:18:15.500743 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m12:18:15.506518 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m12:18:15.515799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:18:15.518425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc1990>]}
[0m12:18:15.523441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7370>]}
[0m12:18:15.523647 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:18:15.523779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa74c0>]}
[0m12:18:15.524589 [info ] [MainThread]: 
[0m12:18:15.524925 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:18:15.525559 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:18:15.525701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:16.110795 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:18:16.111343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:16.412586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8910>]}
[0m12:18:16.413839 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:18:16.414251 [info ] [MainThread]: 
[0m12:18:16.479571 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:18:16.424718 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:18:16.479896 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:18:16.480021 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:18:16.480386 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:18:16.480670 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:18:16.480753 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:18:16.480908 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:18:16.481072 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:18:16.481148 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:18:16.482186 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:18:16.482966 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:18:16.484764 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:16.484879 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:16.485004 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:18:16.485132 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:18:16.500401 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:18:16.501851 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:18:16.502170 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:16.502848 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:18:16.538083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:16.539099 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:18:17.265161 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c420479d-f9ac-4f90-b199-501beb62d22b:europe-west1&page=queryresults
[0m12:18:17.284334 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:17.284981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049be1a0>]}
[0m12:18:17.285365 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m12:18:17.285781 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:18:17.285962 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:18:17.286246 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:18:17.286846 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:18:17.286994 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:18:17.287140 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:18:17.288942 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:18:17.289608 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:17.289747 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:18:17.295247 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:18:17.295643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:17.296668 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:18:17.441297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2e7a95ae-9c28-448c-a9c4-4061e44bcf24:europe-west1&page=queryresults
[0m12:18:17.442701 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:17.443119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102381f90>]}
[0m12:18:17.443412 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m12:18:17.443717 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:18:17.443844 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:18:17.444043 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:18:17.444594 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:18:17.444727 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:18:17.444830 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:18:17.447223 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:18:17.447650 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:17.447763 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:18:17.449762 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:18:17.450097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:17.450984 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:18:17.985951 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3ba5a276-4a10-4272-8e54-2cd50f4a605f:europe-west1&page=queryresults
[0m12:18:17.988174 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:17.988550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106001270>]}
[0m12:18:17.988728 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m12:18:17.988934 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:18:17.989029 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:18:17.989188 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:18:17.989527 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:18:17.989615 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:18:17.989694 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:18:17.990652 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:18:17.991997 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:17.992103 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:18:17.993662 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:18:17.994155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:17.994873 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:18:18.405124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e8ff4fdf-49a7-44f7-898e-9c42d4c121b9:europe-west1&page=queryresults
[0m12:18:18.408828 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:18.409743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624b640>]}
[0m12:18:18.410218 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m12:18:18.410746 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:18:18.410996 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:18:18.411509 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:18:18.412679 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:18:18.412899 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:18:18.413064 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:18:18.415252 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:18:18.415815 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:18.416001 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:18:18.419293 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:18:18.419751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:18.421043 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:18:18.869700 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a68e8725-5a28-4c1b-b52f-1cba15f6001a:europe-west1&page=queryresults
[0m12:18:18.872530 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:18.873391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd88b0>]}
[0m12:18:18.873905 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m12:18:18.874473 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:18:18.874729 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:18:18.875099 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:18:18.876238 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:18:18.876446 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:18:18.876619 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:18:18.888733 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:18:18.890161 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:18.890334 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:18:18.902940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:19.160244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:00515837-9e53-4d98-8d6a-b10e1b755296:europe-west1&page=queryresults
[0m12:18:19.161486 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:19.161877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629e710>]}
[0m12:18:19.162098 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m12:18:19.162357 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:18:19.162475 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:18:19.162601 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:18:19.163346 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:18:19.163468 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:18:19.163559 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:18:19.165379 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:18:19.166843 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:19.167004 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:18:19.169730 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:18:19.170066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:19.171189 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:18:19.292295 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:18:19.292788 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:18:19.880516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:535db723-1b50-461b-b3eb-79c78eda8b22:europe-west1&page=queryresults
[0m12:18:19.883256 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:19.884098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddb610>]}
[0m12:18:19.884619 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m12:18:19.885215 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:18:19.885437 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:18:19.885908 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:18:19.886682 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:18:19.886874 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:18:19.887042 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:18:19.897596 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:18:19.898219 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:19.898387 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:18:19.921184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:20.331154 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:18:20.331749 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:18:21.363459 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b1c9b5a7-8e49-415e-b45a-4e61d06765e1:europe-west1&page=queryresults
[0m12:18:21.368075 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:21.369031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc27d0>]}
[0m12:18:21.369521 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.49s]
[0m12:18:21.370092 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:18:21.370336 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:18:21.370778 [info ] [Thread-2 (]: 10 of 10 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m12:18:21.371568 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:18:21.371769 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:18:21.371954 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m12:18:21.378399 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:18:21.379565 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:21.379759 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m12:18:21.381779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:18:21.788764 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:18:21.789522 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)
    );
  
[0m12:18:22.604884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ed7f8a82-6f7f-4e7e-9b5b-0ef202e0ccf6:europe-west1&page=queryresults
[0m12:18:22.607203 [debug] [Thread-1 (]: finished collecting timing info
[0m12:18:22.607971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602cd90>]}
[0m12:18:22.608420 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.72s]
[0m12:18:22.608917 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:18:24.333031 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4c608e0c-3286-441b-847b-32305f41f784:europe-west1&page=queryresults
[0m12:18:24.347890 [debug] [Thread-2 (]: finished collecting timing info
[0m12:18:24.348867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d12173-39a0-4151-b9ca-3b1059c7aba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602ca00>]}
[0m12:18:24.349384 [info ] [Thread-2 (]: 10 of 10 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (15.9k rows, 43.0 MB processed)[0m in 2.98s]
[0m12:18:24.349948 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:18:24.351982 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:18:24.352625 [info ] [MainThread]: 
[0m12:18:24.352924 [info ] [MainThread]: Finished running 7 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m12:18:24.353182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:24.353317 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:18:24.353444 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:18:24.363857 [info ] [MainThread]: 
[0m12:18:24.364155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:24.364389 [info ] [MainThread]: 
[0m12:18:24.364581 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m12:18:24.364840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f63370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddb730>]}
[0m12:18:24.365049 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:22:30.619218 | a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a ==============================
[0m12:22:30.619371 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:22:30.620295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:22:30.620434 [debug] [MainThread]: Tracking: tracking
[0m12:22:30.633189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a18e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a18f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a18d3c0>]}
[0m12:22:30.673243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:30.673514 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:22:30.680721 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:22:30.689308 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:22:30.698379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m12:22:30.701193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b03a0>]}
[0m12:22:30.708839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32b9a0>]}
[0m12:22:30.709074 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:22:30.709212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bec50>]}
[0m12:22:30.710110 [info ] [MainThread]: 
[0m12:22:30.710464 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:22:30.711162 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:22:30.711301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:31.499446 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:22:31.500016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:31.818223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108388dc0>]}
[0m12:22:31.819319 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:22:31.819659 [info ] [MainThread]: 
[0m12:22:31.878132 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:22:31.878284 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:22:31.878437 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:22:31.878571 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:22:31.878949 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:22:31.879401 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:22:31.879514 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:22:31.879624 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:22:31.879733 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:22:31.879826 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:22:31.880847 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:22:31.881715 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:22:31.882300 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:31.882376 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:31.882469 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:22:31.882555 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:22:31.898450 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:22:31.900114 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:22:31.900530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:31.901229 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:22:31.936592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:31.937610 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:22:32.745515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b17fe320-d18c-4660-b487-b22c026b3b06:europe-west1&page=queryresults
[0m12:22:32.763499 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:32.764164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108218e50>]}
[0m12:22:32.764539 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m12:22:32.764952 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:22:32.765138 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:22:32.765411 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:22:32.765989 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:22:32.766137 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:22:32.766273 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:22:32.767966 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:22:32.770044 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:32.770180 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:22:32.776831 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:22:32.777305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:32.778231 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:22:33.713834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f3b87818-c7a2-408d-8f7f-cab813a81951:europe-west1&page=queryresults
[0m12:22:33.717023 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:33.717882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32abc0>]}
[0m12:22:33.718338 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m12:22:33.718828 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:22:33.719043 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:22:33.719393 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:22:33.720143 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:22:33.720335 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:22:33.720515 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:22:33.722780 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:22:33.723608 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:33.723802 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:22:33.727052 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:22:33.728134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:33.729565 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:22:33.780442 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2d50db98-e792-48e3-9c77-c8d3f8c41d96:europe-west1&page=queryresults
[0m12:22:33.796797 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:33.797153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082195a0>]}
[0m12:22:33.797337 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m12:22:33.797559 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:22:33.797656 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:22:33.797823 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:22:33.798324 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:22:33.798445 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:22:33.798528 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:22:33.799583 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:22:33.800273 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:33.800369 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:22:33.802002 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:22:33.802451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:33.803160 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:22:34.817928 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:29553643-2204-4942-afba-fa3e993f1fe2:europe-west1&page=queryresults
[0m12:22:34.819375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:99696b8e-7a71-4045-ba3a-738d49b15cc8:europe-west1&page=queryresults
[0m12:22:34.822059 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:34.823728 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:34.824488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32a140>]}
[0m12:22:34.825052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a329f30>]}
[0m12:22:34.825491 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m12:22:34.825815 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m12:22:34.826334 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:22:34.826713 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:22:34.826960 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:22:34.827276 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m12:22:34.828017 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:22:34.828428 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:22:34.829236 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:22:34.829822 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:22:34.830031 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:22:34.830168 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m12:22:34.830331 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:22:34.830453 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m12:22:34.834872 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:22:34.840146 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:22:34.840562 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:34.840706 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m12:22:34.845907 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:34.848966 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:22:34.853586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:34.857985 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:22:34.900053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:34.900728 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:22:35.443551 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:22:35.445317 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:22:35.829784 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:369d95f7-c502-427e-89e9-6e9d6ddd91b1:europe-west1&page=queryresults
[0m12:22:35.833944 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:35.835035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32a0b0>]}
[0m12:22:35.835582 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m12:22:35.836094 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:22:35.836314 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:22:35.836686 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:22:35.837743 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:22:35.837960 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:22:35.838143 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:22:35.842238 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:22:35.845608 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:35.845808 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:22:35.848885 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:22:35.849409 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:35.850745 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:22:36.851504 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dbef1f08-7f2e-4bf4-844d-33137e5e2153:europe-west1&page=queryresults
[0m12:22:36.853925 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:36.854615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32a8c0>]}
[0m12:22:36.854989 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m12:22:36.855381 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:22:36.855551 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:22:36.856106 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:22:36.856706 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:22:36.856845 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:22:36.856974 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:22:36.864878 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:22:36.865594 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:36.865711 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:22:36.883461 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:37.455598 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:22:37.456538 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:22:37.718073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1acad815-8a20-4c00-9156-2f854e3a82c0:europe-west1&page=queryresults
[0m12:22:37.722102 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:37.723129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32abc0>]}
[0m12:22:37.723662 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.89s]
[0m12:22:37.724270 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m12:22:37.724529 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:22:37.725001 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m12:22:37.725897 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:22:37.726094 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:22:37.726270 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:22:37.734249 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:22:37.736129 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:37.736328 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:22:37.738888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:38.095528 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:22:38.096415 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)
UNION ALL
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
)



  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:22:38.389798 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [31:3]')
[0m12:22:38.805341 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:b711d25b-533e-4f45-9497-a229a49b6f3b&page=queryresults
[0m12:22:38.806315 [debug] [Thread-1 (]: finished collecting timing info
[0m12:22:38.807246 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword WHERE at [31:3]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:22:38.807619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a69abf0>]}
[0m12:22:38.808138 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.08s]
[0m12:22:38.808674 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:22:39.660970 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:60545a31-9fb5-411f-97c3-3a30fc5462bc:europe-west1&page=queryresults
[0m12:22:39.663339 [debug] [Thread-2 (]: finished collecting timing info
[0m12:22:39.664245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0eebfc4-7478-4d3d-8c48-d1eee3bb8e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108283190>]}
[0m12:22:39.664631 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.81s]
[0m12:22:39.665019 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:22:39.666181 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:22:39.666722 [info ] [MainThread]: 
[0m12:22:39.666958 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m12:22:39.667152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:39.667254 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:22:39.667356 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:22:39.675409 [info ] [MainThread]: 
[0m12:22:39.675729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:39.675931 [info ] [MainThread]: 
[0m12:22:39.676094 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:22:39.676257 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [31:3]
[0m12:22:39.676425 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:22:39.676600 [info ] [MainThread]: 
[0m12:22:39.676778 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:22:39.677013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a662530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f2e60>]}
[0m12:22:39.677199 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:25:04.376907 | a523ffb1-5956-4c25-ae1f-0b7e553dd0dc ==============================
[0m12:25:04.376940 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:25:04.377764 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:25:04.377864 [debug] [MainThread]: Tracking: tracking
[0m12:25:04.388911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae7b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae79540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae79420>]}
[0m12:25:04.424933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:04.425181 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:25:04.435019 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:25:04.443552 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:25:04.451998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m12:25:04.454613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b21abf0>]}
[0m12:25:04.459445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b047670>]}
[0m12:25:04.459645 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:25:04.459780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad051e0>]}
[0m12:25:04.460574 [info ] [MainThread]: 
[0m12:25:04.460919 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:25:04.461601 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:25:04.461737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:05.050981 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:25:05.051453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:06.558750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774dc0>]}
[0m12:25:06.559946 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:25:06.560356 [info ] [MainThread]: 
[0m12:25:06.621894 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:25:06.621990 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:25:06.622152 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:25:06.622278 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:25:06.622709 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:25:06.623001 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:25:06.623176 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:25:06.623341 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:25:06.623451 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:25:06.623527 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:25:06.624594 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:25:06.625445 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:25:06.626501 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:06.626570 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:06.626661 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:25:06.626741 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:25:06.642400 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:25:06.643942 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:25:06.644779 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:25:06.645465 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:25:06.680696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:06.681713 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:25:07.631866 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:15804621-7b10-48dc-b32b-74547330dd48:europe-west1&page=queryresults
[0m12:25:07.651693 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:07.652654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d4326b6e-4ef6-4006-80fe-b619631fe778:europe-west1&page=queryresults
[0m12:25:07.653389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b304fa0>]}
[0m12:25:07.654710 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:07.655094 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m12:25:07.655548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae84040>]}
[0m12:25:07.655913 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:25:07.656115 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m12:25:07.656280 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:25:07.657077 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:25:07.657407 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:25:07.657599 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:25:07.658230 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:25:07.658651 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:25:07.658814 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:25:07.659093 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:25:07.659537 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:25:07.661213 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:25:07.662853 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:25:07.664034 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:25:07.665403 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:25:07.667356 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:07.667472 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:07.667573 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:25:07.667688 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:25:07.670799 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:25:07.672647 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:25:07.673514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:07.674365 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:25:07.674488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:07.715636 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:25:08.526261 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:696e6a97-6025-415f-98cd-9ace3e8b7e93:europe-west1&page=queryresults
[0m12:25:08.529007 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:08.529809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b34eda0>]}
[0m12:25:08.530237 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m12:25:08.530714 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:25:08.530931 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:25:08.531268 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:25:08.532506 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:25:08.532727 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:25:08.532911 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:25:08.535291 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:25:08.537008 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:08.537330 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:25:08.540806 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:25:08.541752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:08.543109 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:25:08.713278 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:17de0e6e-de4f-4b5e-a4c4-836288533b17:europe-west1&page=queryresults
[0m12:25:08.714685 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:08.715110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e9a80>]}
[0m12:25:08.715358 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m12:25:08.715642 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:25:08.715760 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:25:08.715958 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:25:08.716408 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:25:08.716521 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:25:08.716621 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:25:08.717923 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:25:08.719753 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:08.719901 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:25:08.721938 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:25:08.722598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:08.723499 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:25:09.285369 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dfc83968-b131-4293-aa78-975cedf4324f:europe-west1&page=queryresults
[0m12:25:09.287467 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:09.287836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20b130>]}
[0m12:25:09.288007 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m12:25:09.288234 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:25:09.288324 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m12:25:09.288478 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:25:09.288801 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:25:09.288883 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m12:25:09.288960 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m12:25:09.295129 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:25:09.295873 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:09.295967 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m12:25:09.305574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:09.653923 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:69bb2ea3-d0bf-44e5-ae4a-9240d80245dd:europe-west1&page=queryresults
[0m12:25:09.656899 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:09.657675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae86530>]}
[0m12:25:09.658088 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m12:25:09.658541 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:25:09.658736 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:25:09.659156 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:25:09.659886 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:25:09.660071 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:25:09.660238 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:25:09.663829 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:25:09.665675 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:09.665919 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:25:09.669283 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:25:09.669836 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:09.671195 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:25:09.873892 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:25:09.874491 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:25:10.518019 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:44fa6a49-2137-47a6-9e96-f64dca2dd2ee:europe-west1&page=queryresults
[0m12:25:10.520924 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:10.521818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e81c0>]}
[0m12:25:10.522332 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m12:25:10.522938 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:25:10.523195 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:25:10.523884 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:25:10.524950 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:25:10.525155 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:25:10.525332 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:25:10.532691 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:25:10.535073 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:10.535359 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:25:10.559600 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:25:10.940718 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:25:10.941730 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:25:12.265051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:66c6eb4e-3119-4902-b4d1-6baa134d0b3e:europe-west1&page=queryresults
[0m12:25:12.269031 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:12.270052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3866b0>]}
[0m12:25:12.270557 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.98s]
[0m12:25:12.271142 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m12:25:12.271416 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:25:12.272030 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m12:25:12.273111 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:25:12.273307 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:25:12.273478 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:25:12.281675 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:25:12.283999 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:12.284186 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:25:12.286767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:12.857785 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:25:12.858283 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
)
UNION ALL
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
)
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:25:13.172999 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AND at [23:5]')
[0m12:25:13.420014 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:46851e37-2dfd-4106-aea1-1c0ef0c15612:europe-west1&page=queryresults
[0m12:25:13.422470 [debug] [Thread-2 (]: finished collecting timing info
[0m12:25:13.423330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2170d0>]}
[0m12:25:13.423820 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.90s]
[0m12:25:13.424383 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:25:13.659749 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:34f25ab1-e110-4958-9156-220a76ad8c72&page=queryresults
[0m12:25:13.660765 [debug] [Thread-1 (]: finished collecting timing info
[0m12:25:13.661831 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword AND at [23:5]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:25:13.662224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a523ffb1-5956-4c25-ae1f-0b7e553dd0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f6440>]}
[0m12:25:13.662708 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.39s]
[0m12:25:13.663438 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:25:13.665066 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:25:13.665838 [info ] [MainThread]: 
[0m12:25:13.666209 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 9.21 seconds (9.21s).
[0m12:25:13.666517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:13.666685 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:25:13.666815 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:25:13.675857 [info ] [MainThread]: 
[0m12:25:13.676091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:13.676269 [info ] [MainThread]: 
[0m12:25:13.676425 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:25:13.676583 [error] [MainThread]:   Syntax error: Expected ")" but got keyword AND at [23:5]
[0m12:25:13.676729 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:25:13.676891 [info ] [MainThread]: 
[0m12:25:13.677045 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:25:13.677267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a597b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10addf760>]}
[0m12:25:13.677441 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:27:14.188471 | 7e93259f-6bac-4feb-a337-f7a8d3f25d14 ==============================
[0m12:27:14.188526 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:27:14.189207 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:27:14.189303 [debug] [MainThread]: Tracking: tracking
[0m12:27:14.203803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70c6d0>]}
[0m12:27:14.240998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:14.241289 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:27:14.247858 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:27:14.256297 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:27:14.265748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m12:27:14.268369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f81f0>]}
[0m12:27:14.272834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a886500>]}
[0m12:27:14.272986 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:27:14.273119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bfbe0>]}
[0m12:27:14.273905 [info ] [MainThread]: 
[0m12:27:14.274222 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:27:14.274897 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:27:14.275047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:14.788953 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:27:14.789549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:15.102080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fcdc0>]}
[0m12:27:15.103398 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:27:15.103824 [info ] [MainThread]: 
[0m12:27:15.167970 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:15.168127 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:27:15.168273 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:27:15.168398 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:27:15.168765 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:27:15.169052 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:27:15.169197 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:15.169316 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:27:15.169410 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:27:15.169482 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:27:15.170511 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:27:15.171304 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:27:15.171852 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:15.171956 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:15.172047 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:27:15.172119 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:15.188635 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:27:15.190281 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:27:15.190667 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:27:15.191380 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:27:15.191506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:15.228793 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:27:15.954838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c4bd4a8f-5731-4dbf-99b2-a03d63acb61c:europe-west1&page=queryresults
[0m12:27:15.973987 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:15.975133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9fba60>]}
[0m12:27:15.975450 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m12:27:15.976261 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c1164ceb-318e-4153-aabf-35799445e66b:europe-west1&page=queryresults
[0m12:27:15.976640 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:15.977968 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:15.978182 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:15.978681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a903220>]}
[0m12:27:15.978882 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:27:15.979123 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m12:27:15.979623 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:27:15.980120 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:27:15.980284 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:15.980442 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:15.980742 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:15.980960 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:27:15.984426 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:27:15.986027 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:27:15.986257 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:15.986480 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:15.989079 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:27:15.989435 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:15.989543 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:15.989654 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:15.989754 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:15.991840 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:27:15.993657 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:27:15.994030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:15.994129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:15.995057 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:27:16.037876 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:27:16.793820 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e6ad8fb6-4ddd-4418-b83a-4a4851541e2c:europe-west1&page=queryresults
[0m12:27:16.797322 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:16.798150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa57700>]}
[0m12:27:16.798577 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m12:27:16.799492 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:16.800004 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:16.800759 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:27:16.801538 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:27:16.801737 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:16.801911 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:16.806763 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:27:16.808702 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:16.808887 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:16.812991 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:27:16.813664 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:16.814812 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:27:16.894529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ff6c2f5e-2bb1-4f91-8410-ebb1c21d95b4:europe-west1&page=queryresults
[0m12:27:16.895601 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:16.895941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a922110>]}
[0m12:27:16.896131 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m12:27:16.896346 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:16.896445 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:16.896653 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:27:16.897228 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:27:16.897333 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:16.897420 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:16.898371 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:27:16.898849 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:16.898939 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:16.900510 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:27:16.900765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:16.901507 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:27:17.643169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e9f8a98b-4696-497d-a099-fe2a4149ca7a:europe-west1&page=queryresults
[0m12:27:17.646496 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:17.647461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa82590>]}
[0m12:27:17.647967 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m12:27:17.648556 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:17.648810 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m12:27:17.649385 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:27:17.650494 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:27:17.650690 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m12:27:17.650865 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m12:27:17.657268 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:27:17.659405 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:17.659748 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m12:27:17.670058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:17.716977 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:86fb2dd6-c585-4805-93fc-ee88a8badcaf:europe-west1&page=queryresults
[0m12:27:17.718048 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:17.718376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e63e0>]}
[0m12:27:17.718543 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m12:27:17.718746 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:17.718836 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:17.718979 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:27:17.719296 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:27:17.719599 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:17.719763 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:17.721296 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:27:17.722565 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:17.722654 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:17.724209 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:27:17.724535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:17.725201 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:27:18.084936 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:27:18.085438 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:27:18.495864 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3683eb13-302b-4408-934e-54d05f1f958a:europe-west1&page=queryresults
[0m12:27:18.497898 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:18.498501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a705c60>]}
[0m12:27:18.498862 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m12:27:18.499240 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:18.499407 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:18.499705 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:27:18.500444 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:27:18.500598 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:18.500741 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:18.508319 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:27:18.509105 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:18.509270 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:18.533844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:18.913943 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:27:18.914542 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:27:20.187489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:be7ad683-f544-4a33-9494-d726dd65709b:europe-west1&page=queryresults
[0m12:27:20.189408 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:20.191476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa2980>]}
[0m12:27:20.191722 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.54s]
[0m12:27:20.191991 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m12:27:20.192106 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:27:20.192229 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m12:27:20.192649 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:27:20.192738 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:27:20.192819 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:27:20.196872 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:27:20.198420 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:20.198600 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:27:20.200971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:20.622858 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:27:20.623708 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
)

with segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
)

with historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
)

segment_events UNION ALL historical_events
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:27:20.989896 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:1]')
[0m12:27:21.001239 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:76b86de6-343a-470c-a6c8-c173314554f9:europe-west1&page=queryresults
[0m12:27:21.003935 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:21.004882 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e6110>]}
[0m12:27:21.005394 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.50s]
[0m12:27:21.005958 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:21.719789 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:03110213-9ac1-4127-96c5-de906a7f2386&page=queryresults
[0m12:27:21.721323 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:21.722418 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:27:21.723040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93259f-6bac-4feb-a337-f7a8d3f25d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad1ea0>]}
[0m12:27:21.723632 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.53s]
[0m12:27:21.724212 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:27:21.726234 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:27:21.726927 [info ] [MainThread]: 
[0m12:27:21.727229 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m12:27:21.727481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:21.727614 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:27:21.727746 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:27:21.746358 [info ] [MainThread]: 
[0m12:27:21.746565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:21.746709 [info ] [MainThread]: 
[0m12:27:21.746832 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:27:21.746957 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:1]
[0m12:27:21.747073 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:27:21.747237 [info ] [MainThread]: 
[0m12:27:21.747432 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:27:21.747714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a670370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ddfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e5570>]}
[0m12:27:21.747934 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:27:47.488870 | eb903fa4-3e87-4645-adcb-7233a0f0d7ac ==============================
[0m12:27:47.488915 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:27:47.492819 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:27:47.493054 [debug] [MainThread]: Tracking: tracking
[0m12:27:47.505115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7cf10>]}
[0m12:27:47.543773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:47.552327 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:27:47.560045 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:27:47.568837 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:27:47.578319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m12:27:47.581251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea02e0>]}
[0m12:27:47.586047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e47790>]}
[0m12:27:47.586209 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:27:47.586340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb2b60>]}
[0m12:27:47.587204 [info ] [MainThread]: 
[0m12:27:47.587556 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:27:47.588205 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:27:47.588328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:48.260679 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:27:48.261326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:48.609202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110278d90>]}
[0m12:27:48.610500 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:27:48.610940 [info ] [MainThread]: 
[0m12:27:48.670768 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:48.670893 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:27:48.671038 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:27:48.671165 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:27:48.671543 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:27:48.671931 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:27:48.672033 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:48.672128 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:27:48.672212 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:27:48.672283 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:27:48.673300 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:27:48.674079 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:27:48.674763 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:48.674895 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:27:48.674979 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:48.690727 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:27:48.690906 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:48.692469 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:27:48.692698 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:27:48.692804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:48.693469 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:27:48.694040 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:27:49.545089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f0cdd400-b030-40e4-8760-d352cb4eaea9:europe-west1&page=queryresults
[0m12:27:49.563513 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:49.564140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c86e60>]}
[0m12:27:49.564475 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m12:27:49.564868 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:27:49.565038 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:49.565310 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:27:49.565898 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:27:49.566037 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:49.566171 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:49.571033 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:27:49.571463 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:49.571586 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:49.575038 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:27:49.575422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:49.576319 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:27:49.660131 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fdcc2b8d-1cc3-435d-8490-ab540c2ca0d8:europe-west1&page=queryresults
[0m12:27:49.661105 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:49.661419 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f65e10>]}
[0m12:27:49.661612 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m12:27:49.661831 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:27:49.661929 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:49.662030 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:27:49.662392 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:27:49.662533 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:49.662614 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:49.663646 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:27:49.663981 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:49.664069 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:49.665678 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:27:49.665980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:49.666720 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:27:50.536278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:07e3714e-a559-4ee6-b056-d4699753624f:europe-west1&page=queryresults
[0m12:27:50.538553 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:50.538981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c85c60>]}
[0m12:27:50.539217 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m12:27:50.539491 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:27:50.539620 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:50.539833 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:27:50.540322 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:27:50.540441 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:50.540550 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:50.541967 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:27:50.542375 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:50.542490 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:50.544621 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:27:50.544974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:50.545977 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m12:27:50.597857 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8e340df5-5564-43c4-a5f3-5e51fd971ec8:europe-west1&page=queryresults
[0m12:27:50.598928 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:50.599267 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e9edd0>]}
[0m12:27:50.599638 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m12:27:50.599842 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:27:50.599932 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:50.600029 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:27:50.600317 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:27:50.600569 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:50.600652 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:50.601606 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:27:50.601916 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:50.601989 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:50.606741 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:27:50.607038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:50.607721 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m12:27:52.144127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:127d8a03-c80a-4501-9bee-67551f1198aa:europe-west1&page=queryresults
[0m12:27:52.146009 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:52.146571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399d630>]}
[0m12:27:52.146859 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m12:27:52.147192 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:27:52.147353 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m12:27:52.147601 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m12:27:52.148185 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:27:52.148326 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m12:27:52.148461 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m12:27:52.154178 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:27:52.156299 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:52.156478 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m12:27:52.164603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:52.518802 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:27:52.519722 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:27:52.584793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0fa13f85-634b-4779-8277-b3e3e4cc6ff1:europe-west1&page=queryresults
[0m12:27:52.586973 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:52.587667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113921ea0>]}
[0m12:27:52.588071 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m12:27:52.588528 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:27:52.588754 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:52.589346 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m12:27:52.590168 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:27:52.590411 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:52.590591 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:52.594121 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:27:52.597456 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:52.597731 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:52.601017 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:27:52.601646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:52.602862 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m12:27:53.343367 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bc6ffc5b-c35c-49af-a514-83d5e14a72e0:europe-west1&page=queryresults
[0m12:27:53.346719 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:53.347733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113955690>]}
[0m12:27:53.348230 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m12:27:53.348786 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:27:53.349040 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:53.349484 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m12:27:53.350408 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:27:53.350590 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:53.350758 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:53.362287 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:27:53.363757 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:53.363924 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:53.386441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:53.781294 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m12:27:53.781935 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m12:27:54.852592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5c0a3516-081d-4b35-950d-0aa0b62c8c0d:europe-west1&page=queryresults
[0m12:27:54.858482 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:54.859222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110177040>]}
[0m12:27:54.859601 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (342.0 rows, 44.9 KB processed)[0m in 2.71s]
[0m12:27:54.860041 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m12:27:54.860242 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:27:54.860598 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m12:27:54.861327 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:27:54.861509 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:27:54.861680 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:27:54.867093 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:27:54.867918 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:54.868121 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:27:54.870633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:55.380835 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:27:55.383076 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

with segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

with historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

segment_events UNION ALL historical_events
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:27:55.652713 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [17:1]')
[0m12:27:55.999300 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b5c1877a-a70c-4abf-8b23-a770e815fac1:europe-west1&page=queryresults
[0m12:27:56.002104 [debug] [Thread-2 (]: finished collecting timing info
[0m12:27:56.002864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397a410>]}
[0m12:27:56.003272 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.65s]
[0m12:27:56.003803 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m12:27:56.514548 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:d5fc5cd9-3bed-445d-8460-0578b562691f&page=queryresults
[0m12:27:56.516089 [debug] [Thread-1 (]: finished collecting timing info
[0m12:27:56.517253 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [17:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:27:56.517663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb903fa4-3e87-4645-adcb-7233a0f0d7ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e90bb0>]}
[0m12:27:56.518225 [error] [Thread-1 (]: 10 of 10 ERROR creating sql incremental model dbt_rsdun.articles_evidence ...... [[31mERROR[0m in 1.66s]
[0m12:27:56.518805 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:27:56.520764 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:27:56.521677 [info ] [MainThread]: 
[0m12:27:56.522000 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.93 seconds (8.93s).
[0m12:27:56.522262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:56.522401 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:27:56.522532 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m12:27:56.538081 [info ] [MainThread]: 
[0m12:27:56.538295 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:56.538444 [info ] [MainThread]: 
[0m12:27:56.538579 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:27:56.538704 [error] [MainThread]:   Syntax error: Expected keyword SELECT but got keyword WITH at [17:1]
[0m12:27:56.538823 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:27:56.538952 [info ] [MainThread]: 
[0m12:27:56.539076 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m12:27:56.539262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111765210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117651e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e9d450>]}
[0m12:27:56.539412 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:29:11.743035 | d98744c7-a680-4bd1-a3a3-0e381e73fa45 ==============================
[0m12:29:11.743063 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:29:11.743739 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:29:11.743844 [debug] [MainThread]: Tracking: tracking
[0m12:29:11.754618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a409690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a409570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a408f40>]}
[0m12:29:11.794519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:11.794776 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:29:11.800947 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:29:11.809409 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:29:11.817929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m12:29:11.820532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd98744c7-a680-4bd1-a3a3-0e381e73fa45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62e4a0>]}
[0m12:29:11.825446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd98744c7-a680-4bd1-a3a3-0e381e73fa45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d3790>]}
[0m12:29:11.825633 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:29:11.825766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd98744c7-a680-4bd1-a3a3-0e381e73fa45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ac50>]}
[0m12:29:11.826416 [info ] [MainThread]: 
[0m12:29:11.826745 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:29:11.827200 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:29:11.827329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:12.336391 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:29:12.336960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:12.814310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd98744c7-a680-4bd1-a3a3-0e381e73fa45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a418640>]}
[0m12:29:12.815464 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:29:12.815865 [info ] [MainThread]: 
[0m12:29:12.868408 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:29:12.868607 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:29:12.868969 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:29:12.869055 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:29:12.869140 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:29:12.873149 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:29:12.873868 [debug] [Thread-1 (]: finished collecting timing info
[0m12:29:12.873983 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:29:12.891931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:13.290156 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:29:13.292347 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE mixpanel.original_timestamp < (select start_date From StartDate)
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

segment_events UNION ALL historical_events
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:29:13.559172 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AND at [23:5]')
[0m12:29:14.152832 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:29d95a21-563c-4990-b1bf-3bfa6f7c6ac3&page=queryresults
[0m12:29:14.154474 [debug] [Thread-1 (]: finished collecting timing info
[0m12:29:14.155472 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected ")" but got keyword AND at [23:5]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:29:14.155890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98744c7-a680-4bd1-a3a3-0e381e73fa45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73bb50>]}
[0m12:29:14.156468 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.29s]
[0m12:29:14.157063 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:29:14.159051 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:29:14.159755 [info ] [MainThread]: 
[0m12:29:14.160054 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m12:29:14.160305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:14.160443 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:29:14.175141 [info ] [MainThread]: 
[0m12:29:14.175412 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:14.175621 [info ] [MainThread]: 
[0m12:29:14.175800 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:29:14.175977 [error] [MainThread]:   Syntax error: Expected ")" but got keyword AND at [23:5]
[0m12:29:14.176145 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:29:14.176333 [info ] [MainThread]: 
[0m12:29:14.176510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:29:14.176772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3dbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d96f0>]}
[0m12:29:14.176979 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:31:02.226112 | 9d696ac8-11e9-4647-8820-a678c75e41a7 ==============================
[0m12:31:02.226147 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:31:02.226922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:31:02.227028 [debug] [MainThread]: Tracking: tracking
[0m12:31:02.237448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697d390>]}
[0m12:31:02.276915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:02.277179 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:31:02.284045 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:31:02.292537 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:31:02.301134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m12:31:02.303816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d696ac8-11e9-4647-8820-a678c75e41a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba1f90>]}
[0m12:31:02.308224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d696ac8-11e9-4647-8820-a678c75e41a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b475e0>]}
[0m12:31:02.308367 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:31:02.308503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d696ac8-11e9-4647-8820-a678c75e41a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106801150>]}
[0m12:31:02.309118 [info ] [MainThread]: 
[0m12:31:02.309420 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:31:02.309860 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:31:02.309994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:02.944230 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:31:02.944622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:03.326700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d696ac8-11e9-4647-8820-a678c75e41a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694ee00>]}
[0m12:31:03.327980 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:31:03.328392 [info ] [MainThread]: 
[0m12:31:03.394275 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:31:03.394474 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:31:03.394942 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:31:03.395021 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:31:03.395097 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:31:03.398822 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:31:03.399615 [debug] [Thread-1 (]: finished collecting timing info
[0m12:31:03.399731 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:31:03.416980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:03.771429 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:31:03.772077 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

segment_events UNION ALL historical_events
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:31:04.056416 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got keyword UNION at [41:16]')
[0m12:31:05.104668 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:ae9c93ad-a25a-47e6-829f-da49030b6e22&page=queryresults
[0m12:31:05.105939 [debug] [Thread-1 (]: finished collecting timing info
[0m12:31:05.107017 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected keyword AS but got keyword UNION at [41:16]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:31:05.107464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d696ac8-11e9-4647-8820-a678c75e41a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caf8b0>]}
[0m12:31:05.108002 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.71s]
[0m12:31:05.108609 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:31:05.110616 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:31:05.111446 [info ] [MainThread]: 
[0m12:31:05.111844 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m12:31:05.112157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:05.112323 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:31:05.125473 [info ] [MainThread]: 
[0m12:31:05.125764 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:05.125996 [info ] [MainThread]: 
[0m12:31:05.126202 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:31:05.126403 [error] [MainThread]:   Syntax error: Expected keyword AS but got keyword UNION at [41:16]
[0m12:31:05.126581 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:31:05.126752 [info ] [MainThread]: 
[0m12:31:05.126928 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:05.127164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba1db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba1cc0>]}
[0m12:31:05.127359 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:31:37.145630 | d599c1ea-c15b-498c-8219-974839cd14b5 ==============================
[0m12:31:37.145666 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:31:37.146238 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:31:37.146334 [debug] [MainThread]: Tracking: tracking
[0m12:31:37.159421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106566590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065675e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065652a0>]}
[0m12:31:37.195945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:37.196262 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:31:37.203536 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:31:37.212140 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:31:37.220744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m12:31:37.223547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd599c1ea-c15b-498c-8219-974839cd14b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a3e0>]}
[0m12:31:37.228180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd599c1ea-c15b-498c-8219-974839cd14b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672f490>]}
[0m12:31:37.228354 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:31:37.228481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd599c1ea-c15b-498c-8219-974839cd14b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105140c10>]}
[0m12:31:37.229098 [info ] [MainThread]: 
[0m12:31:37.229400 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:31:37.229890 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:31:37.230090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:37.937129 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:31:37.937685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:38.322758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd599c1ea-c15b-498c-8219-974839cd14b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e8040>]}
[0m12:31:38.323909 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:31:38.324327 [info ] [MainThread]: 
[0m12:31:38.376233 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:31:38.376445 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:31:38.376838 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:31:38.376927 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:31:38.377015 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:31:38.381077 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:31:38.381544 [debug] [Thread-1 (]: finished collecting timing info
[0m12:31:38.381650 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:31:38.400152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:39.000238 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:31:39.001026 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

SELECT * FROM (
    segment_events UNION ALL historical_events
)
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:31:39.287451 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [41:1]')
[0m12:31:40.023000 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:ccda4e25-eb19-413b-85ad-e8f2409a5532&page=queryresults
[0m12:31:40.024276 [debug] [Thread-1 (]: finished collecting timing info
[0m12:31:40.025235 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [41:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:31:40.025646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd599c1ea-c15b-498c-8219-974839cd14b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a27640>]}
[0m12:31:40.026185 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.65s]
[0m12:31:40.026727 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:31:40.028733 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:31:40.029482 [info ] [MainThread]: 
[0m12:31:40.029780 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m12:31:40.030035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:40.030171 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:31:40.043837 [info ] [MainThread]: 
[0m12:31:40.044128 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:40.044337 [info ] [MainThread]: 
[0m12:31:40.044520 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:31:40.044698 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [41:1]
[0m12:31:40.044867 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:31:40.045051 [info ] [MainThread]: 
[0m12:31:40.045228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:40.045485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789b10>]}
[0m12:31:40.045687 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:32:06.274753 | df25fe20-90cc-4f20-ab94-6fd903ff2410 ==============================
[0m12:32:06.274777 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:32:06.275434 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:32:06.275546 [debug] [MainThread]: Tracking: tracking
[0m12:32:06.292576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10280a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10231bfd0>]}
[0m12:32:06.329154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:06.329416 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:32:06.336826 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:32:06.345767 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:32:06.356003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m12:32:06.359125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df25fe20-90cc-4f20-ab94-6fd903ff2410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a2170>]}
[0m12:32:06.364587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df25fe20-90cc-4f20-ab94-6fd903ff2410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108547580>]}
[0m12:32:06.364774 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:32:06.364918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df25fe20-90cc-4f20-ab94-6fd903ff2410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10231bfd0>]}
[0m12:32:06.365602 [info ] [MainThread]: 
[0m12:32:06.365959 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:32:06.366534 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:32:06.366771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:06.900243 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:32:06.900702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:07.294710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df25fe20-90cc-4f20-ab94-6fd903ff2410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851bb20>]}
[0m12:32:07.295462 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:32:07.295720 [info ] [MainThread]: 
[0m12:32:07.350445 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:32:07.350659 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:32:07.351033 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:32:07.351127 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:32:07.351214 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:32:07.355400 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:32:07.355979 [debug] [Thread-1 (]: finished collecting timing info
[0m12:32:07.356084 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:32:07.374120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:07.793042 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:32:07.793626 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
)

SELECT * FROM (
    segment_events UNION ALL historical_events
)
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:32:08.345543 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got keyword UNION at [42:20]')
[0m12:32:08.837713 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:b5fee366-38ec-440e-beab-3f013fe9aa09&page=queryresults
[0m12:32:08.839135 [debug] [Thread-1 (]: finished collecting timing info
[0m12:32:08.840750 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected keyword JOIN but got keyword UNION at [42:20]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:32:08.841502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df25fe20-90cc-4f20-ab94-6fd903ff2410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086937c0>]}
[0m12:32:08.842485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.49s]
[0m12:32:08.843117 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:32:08.844766 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:32:08.845354 [info ] [MainThread]: 
[0m12:32:08.845622 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m12:32:08.845883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:08.846014 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:32:08.860710 [info ] [MainThread]: 
[0m12:32:08.860988 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:32:08.861335 [info ] [MainThread]: 
[0m12:32:08.861487 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:32:08.861624 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got keyword UNION at [42:20]
[0m12:32:08.861749 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:32:08.861876 [info ] [MainThread]: 
[0m12:32:08.862006 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:32:08.862203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a11b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a18d0>]}
[0m12:32:08.862361 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:32:27.210688 | b31ffcdd-69a1-420f-b1e4-19f940890e33 ==============================
[0m12:32:27.210746 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:32:27.211466 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:32:27.211561 [debug] [MainThread]: Tracking: tracking
[0m12:32:27.222123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f5360>]}
[0m12:32:27.260007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:27.260276 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:32:27.266655 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:32:27.275268 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:32:27.283931 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:32:27.286596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b31ffcdd-69a1-420f-b1e4-19f940890e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097184f0>]}
[0m12:32:27.294576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b31ffcdd-69a1-420f-b1e4-19f940890e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109693b20>]}
[0m12:32:27.294760 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:32:27.294901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31ffcdd-69a1-420f-b1e4-19f940890e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a2c50>]}
[0m12:32:27.295590 [info ] [MainThread]: 
[0m12:32:27.295919 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:32:27.296351 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:32:27.296501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:27.885545 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:32:27.885998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:28.279614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31ffcdd-69a1-420f-b1e4-19f940890e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096917e0>]}
[0m12:32:28.280258 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:32:28.280446 [info ] [MainThread]: 
[0m12:32:28.337176 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:32:28.337428 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:32:28.337793 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:32:28.337876 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:32:28.337959 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:32:28.342280 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:32:28.343592 [debug] [Thread-1 (]: finished collecting timing info
[0m12:32:28.343882 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:32:28.361992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:28.763881 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:32:28.764945 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
)

segment_events UNION ALL historical_events
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:32:29.189111 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "segment_events" at [41:1]')
[0m12:32:30.243988 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:90892680-96c5-4d02-992e-fda3aa449ad4&page=queryresults
[0m12:32:30.245606 [debug] [Thread-1 (]: finished collecting timing info
[0m12:32:30.246875 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "segment_events" at [41:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:32:30.247540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31ffcdd-69a1-420f-b1e4-19f940890e33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a808a30>]}
[0m12:32:30.248129 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.91s]
[0m12:32:30.248744 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:32:30.250739 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:32:30.251523 [info ] [MainThread]: 
[0m12:32:30.251897 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m12:32:30.252192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:30.252330 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:32:30.265380 [info ] [MainThread]: 
[0m12:32:30.265644 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:32:30.265856 [info ] [MainThread]: 
[0m12:32:30.266034 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:32:30.266209 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "segment_events" at [41:1]
[0m12:32:30.266377 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:32:30.266546 [info ] [MainThread]: 
[0m12:32:30.266725 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:32:30.266969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109718f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109719ff0>]}
[0m12:32:30.267160 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:33:16.751184 | d779a5ca-22ac-495b-851a-9e273dce5621 ==============================
[0m12:33:16.751209 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:33:16.751927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:33:16.752030 [debug] [MainThread]: Tracking: tracking
[0m12:33:16.765112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dfa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114dfb460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114df9120>]}
[0m12:33:16.802446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:16.802738 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:33:16.809058 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:33:16.817560 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:33:16.826527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:33:16.829211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd779a5ca-22ac-495b-851a-9e273dce5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151080a0>]}
[0m12:33:16.833690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd779a5ca-22ac-495b-851a-9e273dce5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150bf070>]}
[0m12:33:16.833832 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:33:16.833958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd779a5ca-22ac-495b-851a-9e273dce5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150bf040>]}
[0m12:33:16.834568 [info ] [MainThread]: 
[0m12:33:16.834881 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:33:16.835547 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:33:16.835686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:17.475552 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:33:17.477838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:17.827812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd779a5ca-22ac-495b-851a-9e273dce5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11385d5d0>]}
[0m12:33:17.828984 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:33:17.829357 [info ] [MainThread]: 
[0m12:33:17.879880 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:33:17.880099 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:33:17.880444 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:33:17.880534 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:33:17.880621 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:33:17.884712 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:33:17.885460 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:17.885562 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:33:17.904610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:18.471333 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:33:18.473547 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

final as (
    segment_events UNION ALL historical_events
)

select * from final
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:33:18.729253 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "segment_events" at [42:5]')
[0m12:33:20.014630 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:764d8b6f-9d89-4abe-8e5b-fe7dee69f994&page=queryresults
[0m12:33:20.016011 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:20.017004 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "segment_events" at [42:5]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:33:20.017415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd779a5ca-22ac-495b-851a-9e273dce5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115223610>]}
[0m12:33:20.017979 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 2.14s]
[0m12:33:20.018559 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:33:20.020464 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:33:20.021253 [info ] [MainThread]: 
[0m12:33:20.021572 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m12:33:20.021835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:20.021980 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:33:20.043508 [info ] [MainThread]: 
[0m12:33:20.043815 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:20.043990 [info ] [MainThread]: 
[0m12:33:20.044123 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:33:20.044253 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "segment_events" at [42:5]
[0m12:33:20.044577 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:33:20.044735 [info ] [MainThread]: 
[0m12:33:20.044875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:20.045076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106423be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115109630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115109780>]}
[0m12:33:20.045248 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:36:23.921743 | fa65f454-e26d-4186-81ad-22abc22c5f85 ==============================
[0m12:36:23.921780 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:36:23.922597 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:36:23.922723 [debug] [MainThread]: Tracking: tracking
[0m12:36:23.933842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111142410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111143460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111141120>]}
[0m12:36:23.969932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:23.970188 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:36:23.976326 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:36:23.984872 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:36:23.993590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m12:36:23.996276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa65f454-e26d-4186-81ad-22abc22c5f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113546a0>]}
[0m12:36:24.000738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa65f454-e26d-4186-81ad-22abc22c5f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130b130>]}
[0m12:36:24.000890 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:36:24.001019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa65f454-e26d-4186-81ad-22abc22c5f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130b100>]}
[0m12:36:24.001625 [info ] [MainThread]: 
[0m12:36:24.001933 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:36:24.002387 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:36:24.002521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:24.532802 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:36:24.533371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:24.980935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa65f454-e26d-4186-81ad-22abc22c5f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111424a0>]}
[0m12:36:24.982159 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:36:24.982521 [info ] [MainThread]: 
[0m12:36:25.042819 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:36:25.043010 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:36:25.043366 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:36:25.043449 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:36:25.043530 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:36:25.047458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:36:25.048373 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:25.048532 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:36:25.066262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:25.439453 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:36:25.440053 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

final as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL historical_events
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
)

select * from final
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:36:25.836363 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT but got identifier "historical_events" at [44:15]')
[0m12:36:27.079513 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:ddfb8db1-18ec-4e45-bc51-fe8c4b719317&page=queryresults
[0m12:36:27.080421 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:27.081216 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected "(" or keyword SELECT but got identifier "historical_events" at [44:15]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:36:27.081543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa65f454-e26d-4186-81ad-22abc22c5f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111447340>]}
[0m12:36:27.082011 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 2.04s]
[0m12:36:27.082477 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:36:27.083988 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:36:27.084308 [info ] [MainThread]: 
[0m12:36:27.084447 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m12:36:27.084559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:27.084810 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:36:27.097055 [info ] [MainThread]: 
[0m12:36:27.097320 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:36:27.097504 [info ] [MainThread]: 
[0m12:36:27.097667 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:36:27.097824 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT but got identifier "historical_events" at [44:15]
[0m12:36:27.097973 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:36:27.098122 [info ] [MainThread]: 
[0m12:36:27.098277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:36:27.098504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113545e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111356440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111355db0>]}
[0m12:36:27.098686 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:36:39.369640 | 70270370-fd5a-4cce-aa90-b058ff13fe61 ==============================
[0m12:36:39.369836 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:36:39.373128 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:36:39.373273 [debug] [MainThread]: Tracking: tracking
[0m12:36:39.382058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d32620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d33670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d31330>]}
[0m12:36:39.416815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:39.417089 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:36:39.424507 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:36:39.433322 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:36:39.441998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m12:36:39.444609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70270370-fd5a-4cce-aa90-b058ff13fe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f56800>]}
[0m12:36:39.449379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70270370-fd5a-4cce-aa90-b058ff13fe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7160>]}
[0m12:36:39.449565 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:36:39.449698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70270370-fd5a-4cce-aa90-b058ff13fe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c62c50>]}
[0m12:36:39.450340 [info ] [MainThread]: 
[0m12:36:39.450662 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:36:39.451120 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:36:39.451265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:40.169630 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:36:40.170214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:40.521848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70270370-fd5a-4cce-aa90-b058ff13fe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb4070>]}
[0m12:36:40.522923 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:36:40.523298 [info ] [MainThread]: 
[0m12:36:40.585444 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:36:40.585632 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:36:40.585972 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:36:40.586050 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:36:40.586128 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:36:40.589856 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:36:40.590226 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:40.590325 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:36:40.607504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:40.994480 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:36:40.995060 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate as (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
),

segment_events as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events as
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

final as (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
)

select * from final
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:36:43.297956 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bced98ba-326d-4a08-a98d-d74a127d3567:europe-west1&page=queryresults
[0m12:36:43.316162 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:43.316925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70270370-fd5a-4cce-aa90-b058ff13fe61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d32f20>]}
[0m12:36:43.317282 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.2 MB processed)[0m in 2.73s]
[0m12:36:43.317698 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:36:43.318958 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:36:43.319451 [info ] [MainThread]: 
[0m12:36:43.319690 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m12:36:43.319887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:43.319990 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:36:43.330017 [info ] [MainThread]: 
[0m12:36:43.330288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:43.330490 [info ] [MainThread]: 
[0m12:36:43.330660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:43.330887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102311030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d00580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d03280>]}
[0m12:36:43.331067 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:44:58.903419 | f06b10c8-68b9-4fa2-839e-de353289d749 ==============================
[0m12:44:58.903457 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:44:58.906449 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:44:58.906687 [debug] [MainThread]: Tracking: tracking
[0m12:44:58.922496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d16560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d175b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d15270>]}
[0m12:44:58.960186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:58.960448 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:44:58.966791 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:44:58.976145 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:44:58.986391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m12:44:58.989253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f06b10c8-68b9-4fa2-839e-de353289d749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f39ae0>]}
[0m12:44:58.994277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f06b10c8-68b9-4fa2-839e-de353289d749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9b0a0>]}
[0m12:44:58.994501 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:44:58.994639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f06b10c8-68b9-4fa2-839e-de353289d749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c46c50>]}
[0m12:44:58.995350 [info ] [MainThread]: 
[0m12:44:58.995701 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:44:58.996192 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:44:58.996356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:59.701279 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:44:59.701878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:00.028683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f06b10c8-68b9-4fa2-839e-de353289d749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9b160>]}
[0m12:45:00.029440 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:45:00.029655 [info ] [MainThread]: 
[0m12:45:00.081239 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:45:00.081483 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:45:00.081873 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:45:00.081973 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:45:00.082060 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:45:00.086221 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:45:00.086920 [debug] [Thread-1 (]: finished collecting timing info
[0m12:45:00.087036 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:45:00.105398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:00.574984 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:45:00.575826 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
)

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, ca.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` AS ca ON ae.slug = ca.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:45:00.774811 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "all_events_with_article_id" at [49:1]')
[0m12:45:01.731590 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:5ba3b1c8-6ff1-4a4e-be0b-27f053e56fb2&page=queryresults
[0m12:45:01.733234 [debug] [Thread-1 (]: finished collecting timing info
[0m12:45:01.734299 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "all_events_with_article_id" at [49:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:45:01.734747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f06b10c8-68b9-4fa2-839e-de353289d749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef8d90>]}
[0m12:45:01.735324 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.articles_evidence ........ [[31mERROR[0m in 1.65s]
[0m12:45:01.735924 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:45:01.737627 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:45:01.738358 [info ] [MainThread]: 
[0m12:45:01.738684 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m12:45:01.738950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:01.739088 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:45:01.752137 [info ] [MainThread]: 
[0m12:45:01.752431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:45:01.752651 [info ] [MainThread]: 
[0m12:45:01.752834 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:45:01.753012 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "all_events_with_article_id" at [49:1]
[0m12:45:01.753180 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:45:01.753351 [info ] [MainThread]: 
[0m12:45:01.753523 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:45:01.753781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce5f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce6c20>]}
[0m12:45:01.753987 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 12:45:12.685109 | 1a0807f9-9b06-4076-ba44-f68cc280c83a ==============================
[0m12:45:12.685152 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:45:12.685574 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:45:12.685670 [debug] [MainThread]: Tracking: tracking
[0m12:45:12.694061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbe6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028cbfd0>]}
[0m12:45:12.733546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:12.733819 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:45:12.740571 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m12:45:12.749318 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m12:45:12.758007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m12:45:12.760934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a0807f9-9b06-4076-ba44-f68cc280c83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a900a0>]}
[0m12:45:12.765655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a0807f9-9b06-4076-ba44-f68cc280c83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a46ef0>]}
[0m12:45:12.765786 [info ] [MainThread]: Found 10 models, 2 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:45:12.765912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0807f9-9b06-4076-ba44-f68cc280c83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458340>]}
[0m12:45:12.766491 [info ] [MainThread]: 
[0m12:45:12.766781 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:45:12.767290 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:45:12.767483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:13.298442 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:45:13.299119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:13.671476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0807f9-9b06-4076-ba44-f68cc280c83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a78d30>]}
[0m12:45:13.672727 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:45:13.673127 [info ] [MainThread]: 
[0m12:45:13.735552 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:45:13.735737 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m12:45:13.736087 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:45:13.736173 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:45:13.736251 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:45:13.739933 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:45:13.740423 [debug] [Thread-1 (]: finished collecting timing info
[0m12:45:13.740513 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:45:13.757673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:14.316876 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:45:14.317858 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, ca.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` AS ca ON ae.slug = ca.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:45:16.841790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9ad26e67-3bfc-4dfe-b581-e4c65142eab3:europe-west1&page=queryresults
[0m12:45:16.858729 [debug] [Thread-1 (]: finished collecting timing info
[0m12:45:16.859409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a0807f9-9b06-4076-ba44-f68cc280c83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104972c50>]}
[0m12:45:16.859803 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.2 MB processed)[0m in 3.12s]
[0m12:45:16.860193 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:45:16.861510 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:45:16.862022 [info ] [MainThread]: 
[0m12:45:16.862258 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m12:45:16.862452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:16.862555 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:45:16.872062 [info ] [MainThread]: 
[0m12:45:16.872312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:16.872509 [info ] [MainThread]: 
[0m12:45:16.872665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:16.872916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025ab100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049731c0>]}
[0m12:45:16.873195 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 13:49:36.931212 | ba0e4cbe-b766-4ac7-870b-1bd57d58c8c2 ==============================
[0m13:49:36.931253 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:49:36.931989 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['articles_evidence'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:49:36.932108 [debug] [MainThread]: Tracking: tracking
[0m13:49:36.951679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f10f0>]}
[0m13:49:36.990934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:49:36.991210 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/schema.yml
[0m13:49:36.991344 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m13:49:36.991451 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_viewed_backfill_fall_2022.sql
[0m13:49:36.997867 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m13:49:37.006999 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m13:49:37.007650 [debug] [MainThread]: 1603: static parser failed on marts/articles_viewed_backfill_fall_2022.sql
[0m13:49:37.010770 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_viewed_backfill_fall_2022.sql
[0m13:49:37.071698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m13:49:37.074753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba0e4cbe-b766-4ac7-870b-1bd57d58c8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134592d0>]}
[0m13:49:37.080372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba0e4cbe-b766-4ac7-870b-1bd57d58c8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bf490>]}
[0m13:49:37.080517 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:49:37.080643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0e4cbe-b766-4ac7-870b-1bd57d58c8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044730d0>]}
[0m13:49:37.081283 [info ] [MainThread]: 
[0m13:49:37.081593 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:49:37.082015 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:49:37.082131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:37.602867 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:49:37.603257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:37.956940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0e4cbe-b766-4ac7-870b-1bd57d58c8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110978dc0>]}
[0m13:49:37.957527 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:49:37.957733 [info ] [MainThread]: 
[0m13:49:37.964822 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m13:49:37.965069 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m13:49:37.965542 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m13:49:37.965661 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m13:49:37.965773 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m13:49:37.972051 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m13:49:37.972918 [debug] [Thread-1 (]: finished collecting timing info
[0m13:49:37.973044 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m13:49:37.994185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:38.352200 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m13:49:38.355013 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m13:49:41.117551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e95c96f9-8808-40ab-aa5d-8f78b419516c:europe-west1&page=queryresults
[0m13:49:41.128017 [debug] [Thread-1 (]: finished collecting timing info
[0m13:49:41.128469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba0e4cbe-b766-4ac7-870b-1bd57d58c8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132046d0>]}
[0m13:49:41.128693 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.2 MB processed)[0m in 3.16s]
[0m13:49:41.128956 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m13:49:41.129777 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:49:41.130158 [info ] [MainThread]: 
[0m13:49:41.130325 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m13:49:41.130466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:41.130542 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m13:49:41.138205 [info ] [MainThread]: 
[0m13:49:41.138386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:41.138540 [info ] [MainThread]: 
[0m13:49:41.138673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:49:41.138852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bfb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113419bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134194b0>]}
[0m13:49:41.139000 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 13:50:06.800936 | e965d265-298e-4b4a-9c40-ce416e38bc84 ==============================
[0m13:50:06.800993 [info ] [MainThread]: Running with dbt=1.3.1
[0m13:50:06.801677 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:50:06.801786 [debug] [MainThread]: Tracking: tracking
[0m13:50:06.812816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116679570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116679450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116678e20>]}
[0m13:50:06.848059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:06.848212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:06.848529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m13:50:06.851738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a1d840>]}
[0m13:50:06.856822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116906470>]}
[0m13:50:06.856975 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:50:06.857119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169064a0>]}
[0m13:50:06.858110 [info ] [MainThread]: 
[0m13:50:06.858459 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:50:06.859123 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m13:50:06.859264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:07.367849 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m13:50:07.368303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:07.696233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f78d90>]}
[0m13:50:07.697230 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:50:07.697524 [info ] [MainThread]: 
[0m13:50:07.704151 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m13:50:07.704339 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m13:50:07.704549 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m13:50:07.704696 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m13:50:07.705181 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m13:50:07.705527 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m13:50:07.705640 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m13:50:07.705997 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m13:50:07.706333 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m13:50:07.706481 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m13:50:07.708871 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:50:07.710536 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:50:07.711475 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:07.711575 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:07.711687 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m13:50:07.711775 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m13:50:07.732715 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m13:50:07.733512 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m13:50:07.734367 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:50:07.734481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:07.735194 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630.raw_apple_app_store_connect__reports.sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m13:50:07.735774 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630.raw_google_play__reports.p_Store_Performance_traffic_source_raw` 
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m13:50:08.649832 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1e33adb9-fa68-48d8-9906-095179bade2b:europe-west1&page=queryresults
[0m13:50:08.668373 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:08.668959 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11664edd0>]}
[0m13:50:08.669321 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m13:50:08.669717 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m13:50:08.669882 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:50:08.670153 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m13:50:08.670721 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:50:08.670871 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:50:08.671010 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:50:08.726799 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:50:08.727971 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:08.728071 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:50:08.729499 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m13:50:08.729717 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:50:08.730402 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m13:50:09.048521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:197c27e4-1a4f-4d7c-906e-6755cf4916c2:europe-west1&page=queryresults
[0m13:50:09.051958 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:09.052817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a1c4f0>]}
[0m13:50:09.053233 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m13:50:09.054157 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m13:50:09.054917 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:50:09.055632 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m13:50:09.056476 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:50:09.056696 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m13:50:09.056873 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m13:50:09.059045 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:50:09.059665 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:09.059811 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m13:50:09.062818 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m13:50:09.063403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:09.064750 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m13:50:09.698984 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5ec4d6b7-61cd-46de-b1fd-02ddf3961e33:europe-west1&page=queryresults
[0m13:50:09.701945 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:09.702844 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11664caf0>]}
[0m13:50:09.703381 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m13:50:09.703956 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m13:50:09.704186 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:50:09.704530 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m13:50:09.705304 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:50:09.705500 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:50:09.705686 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m13:50:09.708085 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:50:09.709238 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:09.709433 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:50:09.712911 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m13:50:09.714040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:50:09.715604 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m13:50:10.234150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bc92f888-4e79-4592-bda6-def27e74104c:europe-west1&page=queryresults
[0m13:50:10.236674 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:10.237059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c571c0>]}
[0m13:50:10.237257 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m13:50:10.237477 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m13:50:10.237579 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:50:10.237743 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m13:50:10.238034 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:50:10.238111 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:50:10.238310 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:50:10.241063 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:50:10.241746 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:10.241970 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:50:10.250150 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m13:50:10.250582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.251278 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m13:50:10.485820 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0a2d203b-73bf-4b11-a269-66c3af915c94:europe-west1&page=queryresults
[0m13:50:10.488814 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:10.489559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c6a770>]}
[0m13:50:10.490004 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m13:50:10.490464 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m13:50:10.490675 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m13:50:10.490991 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m13:50:10.491696 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m13:50:10.491892 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m13:50:10.492066 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m13:50:10.496497 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m13:50:10.497592 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:10.497758 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m13:50:10.507910 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:50:10.861376 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m13:50:10.861852 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m13:50:10.977530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2e7c67e4-376f-4be9-8fea-cf94f201aa17:europe-west1&page=queryresults
[0m13:50:10.980482 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:10.981354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169061a0>]}
[0m13:50:10.981802 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m13:50:10.982326 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m13:50:10.982562 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m13:50:10.982996 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m13:50:10.984060 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m13:50:10.984296 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m13:50:10.984493 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m13:50:10.987928 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m13:50:10.989398 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:10.989647 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m13:50:10.992199 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m13:50:10.992527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:10.993499 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m13:50:11.746491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b9fb94e6-42aa-40e0-a351-873024922843:europe-west1&page=queryresults
[0m13:50:11.749517 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:11.750022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a1c970>]}
[0m13:50:11.750270 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m13:50:11.750549 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m13:50:11.750675 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:50:11.750884 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m13:50:11.751804 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:50:11.751957 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:50:11.752067 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:50:11.759136 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:50:11.759604 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:11.759719 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:50:11.789767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:12.222159 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m13:50:12.223078 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m13:50:13.450549 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:42bff5bb-0a25-43b6-becc-d9585995d4fb:europe-west1&page=queryresults
[0m13:50:13.454213 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:13.454853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a1ca60>]}
[0m13:50:13.455182 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.96s]
[0m13:50:13.455582 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m13:50:13.455764 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m13:50:13.456020 [info ] [Thread-2 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m13:50:13.456493 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m13:50:13.456617 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m13:50:13.456732 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m13:50:13.461120 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m13:50:13.461969 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:13.462114 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m13:50:13.465051 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m13:50:13.465497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:50:13.466604 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
    );
  
[0m13:50:14.459609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a1f540e2-9dd5-4011-ad5f-89319e0272a7:europe-west1&page=queryresults
[0m13:50:14.461919 [debug] [Thread-1 (]: finished collecting timing info
[0m13:50:14.462663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cd0f70>]}
[0m13:50:14.463099 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.71s]
[0m13:50:14.463626 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m13:50:16.529980 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fd327994-29c4-424d-85ea-e916f5197176:europe-west1&page=queryresults
[0m13:50:16.533162 [debug] [Thread-2 (]: finished collecting timing info
[0m13:50:16.533884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e965d265-298e-4b4a-9c40-ce416e38bc84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a1cbb0>]}
[0m13:50:16.534252 [info ] [Thread-2 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mCREATE TABLE (15.9k rows, 43.1 MB processed)[0m in 3.08s]
[0m13:50:16.534772 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m13:50:16.536374 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:50:16.537167 [info ] [MainThread]: 
[0m13:50:16.537550 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 9.68 seconds (9.68s).
[0m13:50:16.537866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:16.538037 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m13:50:16.538183 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m13:50:16.553002 [info ] [MainThread]: 
[0m13:50:16.553260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:16.553480 [info ] [MainThread]: 
[0m13:50:16.553658 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:50:16.553907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c90d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c90ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c93790>]}
[0m13:50:16.554100 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 14:36:48.538525 | 48ed4645-efea-4276-8237-ea837232589f ==============================
[0m14:36:48.538587 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:36:48.539427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:36:48.539530 [debug] [MainThread]: Tracking: tracking
[0m14:36:48.555454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f5420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f5360>]}
[0m14:36:48.597661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m14:36:48.597906 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/google_play_store/source.yml
[0m14:36:48.598146 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/schema.yml
[0m14:36:48.598272 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/google_play_store/stg_google_play_store__downloads.sql
[0m14:36:48.598381 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m14:36:48.605180 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m14:36:48.613870 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m14:36:48.614499 [debug] [MainThread]: 1603: static parser failed on marts/articles_viewed_backfill_fall_2022.sql
[0m14:36:48.616827 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_viewed_backfill_fall_2022.sql
[0m14:36:48.617982 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m14:36:48.619165 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m14:36:48.683097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m14:36:48.686019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097596c0>]}
[0m14:36:48.691803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ba3b0>]}
[0m14:36:48.691998 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:36:48.692129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d5b10>]}
[0m14:36:48.692949 [info ] [MainThread]: 
[0m14:36:48.693290 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:36:48.693938 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:36:48.694059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:49.206544 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:36:49.207090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:49.600322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649c0d0>]}
[0m14:36:49.601802 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:36:49.602447 [info ] [MainThread]: 
[0m14:36:49.607696 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:36:49.607904 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:36:49.608404 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m14:36:49.608669 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m14:36:49.609442 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:36:49.610226 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:36:49.610427 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:36:49.610588 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:36:49.610750 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:36:49.610929 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:36:49.614207 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:36:49.617082 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:36:49.618233 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:49.618345 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:49.618500 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:36:49.618631 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:36:49.645685 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:36:49.648404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:36:49.649426 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:36:49.650318 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:36:49.688394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:49.689013 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:36:50.437233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:00a7a0f2-365f-4659-897f-dc8a5d3f9d60:europe-west1&page=queryresults
[0m14:36:50.448067 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:50.448492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b33ac20>]}
[0m14:36:50.448694 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m14:36:50.448939 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:36:50.449051 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:36:50.449159 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m14:36:50.449787 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:36:50.450096 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:36:50.450205 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:36:50.451349 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:36:50.453091 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:50.453235 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:36:50.455022 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:36:50.455355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:50.456113 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:36:50.605158 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bea46f13-3756-4da7-b790-43bf657d5f2c:europe-west1&page=queryresults
[0m14:36:50.606775 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:50.607193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1ac50>]}
[0m14:36:50.607455 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m14:36:50.607744 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:36:50.607880 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:36:50.608255 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m14:36:50.608830 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:36:50.608942 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:36:50.609030 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:36:50.610112 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:36:50.610452 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:50.610545 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:36:50.612192 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:36:50.612445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:36:50.613207 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:36:51.392427 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:401f1378-e181-4e51-ae7a-fe8064334be6:europe-west1&page=queryresults
[0m14:36:51.395685 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:51.396153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b47f0>]}
[0m14:36:51.396365 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m14:36:51.396586 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:36:51.396692 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:36:51.396857 [info ] [Thread-1 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:36:51.397213 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:36:51.397301 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:36:51.397377 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:36:51.398410 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:36:51.400035 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:51.400123 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:36:51.401695 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:36:51.402163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:51.402865 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:36:51.812192 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:26eaedc4-5ae6-42c5-bd7c-2644a36084e4:europe-west1&page=queryresults
[0m14:36:51.814361 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:51.814728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fd0f0>]}
[0m14:36:51.814916 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m14:36:51.815129 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:36:51.815223 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:36:51.815321 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:36:51.815598 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:36:51.815729 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:36:51.815893 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:36:51.826254 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:36:51.826658 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:51.826749 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:36:51.832965 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:36:51.833301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:36:51.834300 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:36:52.148444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5323db85-cd91-4bf2-b529-0fd849ed34c8:europe-west1&page=queryresults
[0m14:36:52.150392 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:52.150911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4cffa0>]}
[0m14:36:52.151211 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:36:52.151562 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:36:52.151746 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m14:36:52.152002 [info ] [Thread-1 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m14:36:52.152615 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:36:52.152766 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m14:36:52.152894 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m14:36:52.156080 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:36:52.156848 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:52.157041 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m14:36:52.166363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:52.509199 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:36:52.510154 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:36:52.539619 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:78d16012-369f-425c-a4c0-b9208e755ba7:europe-west1&page=queryresults
[0m14:36:52.541380 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:52.541983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4d3940>]}
[0m14:36:52.542331 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m14:36:52.542758 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:36:52.542942 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:36:52.543326 [info ] [Thread-2 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m14:36:52.543985 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:36:52.544185 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:36:52.544355 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:36:52.547496 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:36:52.549008 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:52.549168 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:36:52.551931 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:36:52.552514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:36:52.553911 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m14:36:53.261864 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a2b79367-4bc4-4bd3-98c4-e99b70a2d9b9:europe-west1&page=queryresults
[0m14:36:53.264683 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:53.265477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a2680>]}
[0m14:36:53.265851 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m14:36:53.266263 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:36:53.266443 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:36:53.266747 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m14:36:53.268163 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:36:53.268508 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:36:53.268730 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:36:53.284135 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:36:53.284661 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:53.284811 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:36:53.308644 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:36:53.673420 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:36:53.673995 [debug] [Thread-2 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m14:36:54.876151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:04ab6785-a9cf-40b5-978f-647e05500b2e:europe-west1&page=queryresults
[0m14:36:54.880778 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:54.881778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c5630>]}
[0m14:36:54.882318 [info ] [Thread-1 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.73s]
[0m14:36:54.882947 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m14:36:54.883221 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m14:36:54.883648 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m14:36:54.884439 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:36:54.884635 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:36:54.884808 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m14:36:54.891596 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:36:54.893263 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:54.893450 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m14:36:54.896242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:55.222696 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:36:55.225831 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m14:36:55.892544 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:afb00b06-b349-44b6-9c16-7ba17109d0b2:europe-west1&page=queryresults
[0m14:36:55.894389 [debug] [Thread-2 (]: finished collecting timing info
[0m14:36:55.895044 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4d37c0>]}
[0m14:36:55.895417 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.63s]
[0m14:36:55.895863 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:36:57.728437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:636054a8-73c8-4de2-892d-5ccc6d335980:europe-west1&page=queryresults
[0m14:36:57.729413 [debug] [Thread-1 (]: finished collecting timing info
[0m14:36:57.729794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed4645-efea-4276-8237-ea837232589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f56f0>]}
[0m14:36:57.730008 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mMERGE (0.0 rows, 43.3 MB processed)[0m in 2.85s]
[0m14:36:57.730275 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m14:36:57.731084 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:36:57.731442 [info ] [MainThread]: 
[0m14:36:57.731608 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 9.04 seconds (9.04s).
[0m14:36:57.731755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:57.731832 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:36:57.731906 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m14:36:57.745054 [info ] [MainThread]: 
[0m14:36:57.745236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:57.745383 [info ] [MainThread]: 
[0m14:36:57.745501 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:36:57.745677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac50610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31c6d0>]}
[0m14:36:57.745811 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 14:48:10.149423 | c6c63e39-1fc0-4b21-8eab-a3ed96720541 ==============================
[0m14:48:10.149461 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:48:10.150142 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:48:10.150256 [debug] [MainThread]: Tracking: tracking
[0m14:48:10.165785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f5120>]}
[0m14:48:10.203249 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m14:48:10.203485 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:48:10.203608 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/backfills/schema.yml
[0m14:48:10.203780 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/apple_app_store/schema.yml
[0m14:48:10.203920 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/google_play_store/schema.yml
[0m14:48:10.204064 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/schema.yml
[0m14:48:10.204132 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/marts/articles_viewed_backfill_fall_2022.sql
[0m14:48:10.210319 [debug] [MainThread]: 1603: static parser failed on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:48:10.218904 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:48:10.219749 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m14:48:10.220980 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m14:48:10.278566 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m14:48:10.281570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038aa10>]}
[0m14:48:10.286940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e0310>]}
[0m14:48:10.287115 [info ] [MainThread]: Found 10 models, 12 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:48:10.287252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110190700>]}
[0m14:48:10.288152 [info ] [MainThread]: 
[0m14:48:10.288511 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:48:10.289254 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:48:10.289446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:10.781050 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:48:10.783267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:11.107003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106574d90>]}
[0m14:48:11.108140 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:48:11.108556 [info ] [MainThread]: 
[0m14:48:11.119198 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:48:11.119382 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:48:11.119784 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m14:48:11.120074 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m14:48:11.120858 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:48:11.121397 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:48:11.121779 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:48:11.122227 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:48:11.122436 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:48:11.122583 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:48:11.127431 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:48:11.129657 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:48:11.130930 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:11.131082 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:48:11.137472 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:11.152802 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:48:11.152944 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:48:11.154851 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:48:11.155117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:11.155260 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:11.156073 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:48:11.156778 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:48:12.173410 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:74adaffe-34a9-4eb4-a7e3-8bc2e6a25f11:europe-west1&page=queryresults
[0m14:48:12.174985 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:27518507-09ea-450e-b358-eacdade97ff3:europe-west1&page=queryresults
[0m14:48:12.193114 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:12.194353 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:12.194940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046aa70>]}
[0m14:48:12.195336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046bd90>]}
[0m14:48:12.195681 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:48:12.195923 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:48:12.196298 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:48:12.196645 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:48:12.196825 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:48:12.196965 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:48:12.197396 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m14:48:12.197587 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m14:48:12.198022 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:48:12.198411 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:48:12.198657 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:48:12.198867 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:48:12.199008 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:48:12.199114 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:48:12.200713 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:48:12.201855 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:48:12.204357 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:12.204503 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:12.204612 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:48:12.204725 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:48:12.207941 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:48:12.210962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:12.215992 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:48:12.216835 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:48:12.257506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:12.259958 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:48:12.941635 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b063c8a3-2839-4d95-8473-f59da29e3a6f:europe-west1&page=queryresults
[0m14:48:12.944133 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:12.944853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb1f90>]}
[0m14:48:12.945060 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:48:12.945642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6c7801f5-f37d-48a4-a3cc-8bf9e104c779:europe-west1&page=queryresults
[0m14:48:12.945920 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:48:12.946882 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:12.947022 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:48:12.947404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e3a30>]}
[0m14:48:12.947614 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:48:12.947804 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:48:12.948156 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:48:12.948383 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:48:12.948474 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:48:12.948698 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:48:12.948873 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:48:12.949081 [info ] [Thread-1 (]: 6 of 10 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:48:12.950349 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:48:12.950760 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:48:12.950924 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:48:12.951017 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:48:12.952042 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:48:12.952484 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:12.952594 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:12.952714 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:48:12.952818 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:48:12.954759 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:48:12.956444 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:48:12.956845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:12.956974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:12.957773 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:48:12.959085 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:48:13.650790 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4ff3b490-afca-4667-902c-7ed83ea016b8:europe-west1&page=queryresults
[0m14:48:13.653107 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:13.653737 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb0cd0>]}
[0m14:48:13.654058 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m14:48:13.654405 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:48:13.654538 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m14:48:13.654802 [info ] [Thread-2 (]: 7 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m14:48:13.655241 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:48:13.655363 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m14:48:13.655475 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m14:48:13.661175 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:48:13.662225 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:13.662349 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m14:48:13.673973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:13.906627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ffb249a3-3b74-4573-9483-5569abc83949:europe-west1&page=queryresults
[0m14:48:13.908577 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:13.909119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb3d00>]}
[0m14:48:13.909436 [info ] [Thread-1 (]: 6 of 10 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:48:13.909802 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:48:13.909967 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:48:13.910254 [info ] [Thread-1 (]: 8 of 10 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ........ [RUN]
[0m14:48:13.910904 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:48:13.911043 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:48:13.911173 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:48:13.916956 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:48:13.919531 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:13.919722 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:48:13.922288 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:48:13.922634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:13.923607 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m14:48:14.002966 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:48:14.003364 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:48:14.575909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:13b65822-7fb5-4754-ab7a-e3851ee800fc:europe-west1&page=queryresults
[0m14:48:14.580139 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:14.581174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038aaa0>]}
[0m14:48:14.581705 [info ] [Thread-1 (]: 8 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m14:48:14.582206 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:48:14.582429 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:48:14.582815 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [RUN]
[0m14:48:14.583626 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:48:14.583803 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:48:14.583968 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:48:14.591575 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:48:14.592377 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:14.592560 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:48:14.615991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:14.940757 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_viewed_backfill_fall_2022"
[0m14:48:14.941954 [debug] [Thread-1 (]: On model.my_new_project.articles_viewed_backfill_fall_2022: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_viewed_backfill_fall_2022"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022` as DBT_INTERNAL_DEST
        using (
          

/*
'Community | Viewed article' events from 2022-10-07 07:58:22.030000 UTC to 2022-12-08 12:57:18.498000 UTC
Very few for android
*/


SELECT 
    event.slug, 
    event.original_timestamp, 
    event.category, 
    event.user_id, 
    CASE
        WHEN event.referrer = 'Personal assistant' THEN 'home'
        WHEN event.referrer = 'Community' THEN 'community'
        ELSE event.referrer
    END as referrer,
    event.clinic_id, 
    metadata.id as article_id
FROM (
    SELECT slug, original_timestamp, category, user_id, referrer, clinic_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`

    UNION ALL

    SELECT slug, original_timestamp, category, user_id, referrer, NULL
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
) as event
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` as metadata on metadata.slug=event.slug




  -- this filter will only be applied on an incremental run
  where original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_viewed_backfill_fall_2022`)


        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `clinic_id`, `article_id`)


    
[0m14:48:16.197544 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f8a08745-8004-45f3-9f12-53ba7aa1880e:europe-west1&page=queryresults
[0m14:48:16.201553 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:16.202466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110389c30>]}
[0m14:48:16.202937 [info ] [Thread-2 (]: 7 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.55s]
[0m14:48:16.203521 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m14:48:16.203756 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m14:48:16.204141 [info ] [Thread-2 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m14:48:16.204940 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:48:16.205157 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:48:16.205340 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m14:48:16.217734 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:48:16.219917 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:16.220075 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m14:48:16.225014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:16.535431 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:48:16.536597 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m14:48:16.908304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:19b9e09c-5aea-4130-96a8-815696592352:europe-west1&page=queryresults
[0m14:48:16.910323 [debug] [Thread-1 (]: finished collecting timing info
[0m14:48:16.910993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cdd990>]}
[0m14:48:16.911314 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.articles_viewed_backfill_fall_2022  [[32mMERGE (0.0 rows, 560.2 KB processed)[0m in 2.33s]
[0m14:48:16.911721 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_viewed_backfill_fall_2022
[0m14:48:18.746439 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d20c5960-90eb-4df9-9cea-729df69a6bfa:europe-west1&page=queryresults
[0m14:48:18.748075 [debug] [Thread-2 (]: finished collecting timing info
[0m14:48:18.748655 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c63e39-1fc0-4b21-8eab-a3ed96720541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e3df0>]}
[0m14:48:18.748991 [info ] [Thread-2 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mMERGE (0.0 rows, 43.3 MB processed)[0m in 2.54s]
[0m14:48:18.749400 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m14:48:18.750948 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:48:18.751509 [info ] [MainThread]: 
[0m14:48:18.751705 [info ] [MainThread]: Finished running 7 view models, 1 table model, 2 incremental models in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m14:48:18.751857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:18.751933 [debug] [MainThread]: Connection 'model.my_new_project.articles_viewed_backfill_fall_2022' was properly closed.
[0m14:48:18.752008 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:48:18.760387 [info ] [MainThread]: 
[0m14:48:18.760724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:18.760964 [info ] [MainThread]: 
[0m14:48:18.761155 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:48:18.761421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cdd600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f0c10>]}
[0m14:48:18.761640 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 14:55:55.867334 | c04f3e98-be5b-456a-9d2b-7706cf06bdbe ==============================
[0m14:55:55.867373 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:55:55.868182 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:55:55.868287 [debug] [MainThread]: Tracking: tracking
[0m14:55:55.884343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108269120>]}
[0m14:55:55.904648 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:55:55.904900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108270520>]}
[0m14:55:55.925544 [debug] [MainThread]: Parsing macros/etc.sql
[0m14:55:55.926682 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:55:55.930108 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:55:55.939367 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m14:55:55.940396 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m14:55:55.941583 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m14:55:55.945174 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m14:55:55.946422 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m14:55:55.953914 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m14:55:55.954595 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:55:55.954760 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:55:55.955024 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m14:55:55.955457 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:55:55.955615 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:55:55.955842 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:55:55.956109 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:55:55.956511 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:55:55.957008 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:55:55.957216 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:55:55.957423 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:55:55.957643 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:55:55.957855 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:55:55.958035 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:55:55.958646 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:55:55.958870 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:55:55.959209 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:55:55.959454 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:55:55.960510 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:55:55.962081 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:55:55.962989 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:55:55.963674 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:55:55.970582 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:55:55.976679 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:55:55.982098 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:55:55.983947 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:55:55.984682 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:55:55.985403 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:55:55.988739 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:55:55.995724 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:55:55.996341 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m14:55:55.999096 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:55:56.003508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:55:56.011129 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:55:56.013448 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:55:56.014852 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:55:56.017151 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:55:56.017666 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:55:56.019036 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:55:56.019954 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:55:56.022865 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:55:56.030958 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:55:56.031577 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:55:56.032586 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:55:56.033213 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:55:56.033587 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:55:56.033907 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:55:56.034184 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:55:56.034739 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:55:56.036889 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:55:56.040397 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:55:56.040729 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:55:56.041221 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:55:56.041600 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:55:56.041972 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:55:56.042490 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:55:56.042828 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:55:56.043264 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:55:56.043778 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:55:56.044760 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:55:56.045270 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:55:56.045739 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:55:56.046215 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:55:56.046662 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:55:56.047115 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:55:56.047636 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:55:56.048061 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:55:56.051065 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:55:56.051557 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:55:56.051951 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:55:56.052732 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:55:56.053714 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:55:56.054162 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:55:56.054806 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:55:56.055261 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:55:56.056155 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m14:55:56.057589 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:55:56.058762 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:55:56.065409 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:55:56.066281 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:55:56.072546 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:55:56.074746 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:55:56.078013 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:55:56.115390 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m14:55:56.118134 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:55:56.230779 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m14:55:56.236226 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m14:55:56.237387 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m14:55:56.238590 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m14:55:56.239693 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m14:55:56.240805 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m14:55:56.241999 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m14:55:56.243127 [debug] [MainThread]: 1603: static parser failed on marts/articles_evidence.sql
[0m14:55:56.247366 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/articles_evidence.sql
[0m14:55:56.248029 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m14:55:56.249331 [debug] [MainThread]: 1603: static parser failed on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:55:56.251711 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:55:56.271482 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m14:55:56.278943 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_ios__community_viewed_article' in the 'models' section of file 'models/staging/segment_ios__production_events/schema.yml'
[0m14:55:56.304852 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_slug.01cb357c20' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m14:55:56.305073 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_slug.c394d06565' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m14:55:56.305185 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_original_timestamp.f45027f819' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m14:55:56.305290 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_original_timestamp.42ba45d2f8' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m14:55:56.305389 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_user_id.a07ae945b5' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m14:55:56.305492 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_user_id.75bc497418' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m14:55:56.305593 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_slug.8035cd1030' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m14:55:56.305693 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_slug.aef30b956f' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m14:55:56.305794 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_original_timestamp.17a3cd91f0' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m14:55:56.305892 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_original_timestamp.048440ddbc' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m14:55:56.305989 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_ios__community_viewed_article_user_id.845753e1c8' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m14:55:56.306184 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_ios__community_viewed_article_user_id.cc8a746681' (models/staging/segment_ios__production_events/schema.yml) depends on a node named 'stg_ios__community_viewed_article' which was not found
[0m14:55:56.306393 [debug] [MainThread]: Test 'test.my_new_project.not_null_articles_viewed_backfill_fall_2022_original_timestamp.2a0861a663' (models/marts/backfills/schema.yml) depends on a node named 'articles_viewed_backfill_fall_2022' which is disabled
[0m14:55:56.306461 [debug] [MainThread]: Test 'test.my_new_project.not_null_articles_viewed_backfill_fall_2022_user_id.83bea0cd46' (models/marts/backfills/schema.yml) depends on a node named 'articles_viewed_backfill_fall_2022' which is disabled
[0m14:55:56.322480 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m14:55:56.325648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e9630>]}
[0m14:55:56.331147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de39d0>]}
[0m14:55:56.331355 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:55:56.331490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108422b90>]}
[0m14:55:56.332407 [info ] [MainThread]: 
[0m14:55:56.332737 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:55:56.333375 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:55:56.333501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:56.812874 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:55:56.813455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:57.161414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106460d90>]}
[0m14:55:57.161925 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:55:57.162107 [info ] [MainThread]: 
[0m14:55:57.165462 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:55:57.165672 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m14:55:57.165779 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:55:57.166145 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:55:57.166361 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m14:55:57.166508 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:55:57.166880 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:55:57.167031 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:55:57.167172 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:55:57.169923 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:55:57.172838 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:55:57.176844 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:55:57.177047 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:57.177157 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:55:57.189805 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:57.196543 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:55:57.196743 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:55:57.198675 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:55:57.198955 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:57.199803 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:55:57.199918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.239625 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:55:57.891229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:812243d2-ff79-47da-af1c-1623eeb2ecb5:europe-west1&page=queryresults
[0m14:55:57.912134 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:57.912850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d35c60>]}
[0m14:55:57.913237 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:55:57.913653 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:55:57.913833 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:55:57.914115 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m14:55:57.914698 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:55:57.914841 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:55:57.914980 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:55:57.916854 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:55:57.918945 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:57.919095 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:55:57.921555 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:55:57.922981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0ada3915-2ada-4133-a248-cf10452b13af:europe-west1&page=queryresults
[0m14:55:57.924269 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:57.924746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d50790>]}
[0m14:55:57.924899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:57.925121 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m14:55:57.926119 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:55:57.926288 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:55:57.969324 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:55:57.969545 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m14:55:57.969977 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:55:57.970055 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:55:57.970126 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:55:57.971123 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:55:57.971580 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:57.971658 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:55:57.977543 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:55:57.977820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:57.978497 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:55:58.776318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f3e473e4-b7df-4b7b-8e81-9ef988c55dfd:europe-west1&page=queryresults
[0m14:55:58.780723 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:58.781760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dafca0>]}
[0m14:55:58.783554 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:04581c4f-161f-4690-b44e-f50d6d13ec41:europe-west1&page=queryresults
[0m14:55:58.784020 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m14:55:58.785698 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:58.786259 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:55:58.786865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddb250>]}
[0m14:55:58.787139 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:55:58.787495 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m14:55:58.787708 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:55:58.788298 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:55:58.788889 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:55:58.789093 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:55:58.789298 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:55:58.789548 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:55:58.789725 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:55:58.790277 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:55:58.792435 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:55:58.792609 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:55:58.792853 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:55:58.794214 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:55:58.794825 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:58.794944 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:58.795049 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:55:58.795169 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:55:58.798052 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:55:58.800498 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:55:58.800989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:58.801146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:58.802214 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:55:58.803080 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:55:59.476116 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c8d97bab-4a16-4140-bd33-43428b9c2db3:europe-west1&page=queryresults
[0m14:55:59.479057 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:59.479965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbded0>]}
[0m14:55:59.480491 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m14:55:59.481062 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:55:59.481313 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m14:55:59.481725 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m14:55:59.482554 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:55:59.482751 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m14:55:59.482918 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m14:55:59.487458 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:55:59.489891 [debug] [Thread-2 (]: finished collecting timing info
[0m14:55:59.490078 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m14:55:59.500632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:59.759247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:731cfa9f-1bb7-482a-b76e-15ab6e4ce7ff:europe-west1&page=queryresults
[0m14:55:59.761616 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:59.762293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbe2f0>]}
[0m14:55:59.762702 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m14:55:59.763131 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:55:59.763329 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:55:59.763547 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m14:55:59.764137 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:55:59.764481 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:55:59.764676 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:55:59.780569 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:55:59.782213 [debug] [Thread-1 (]: finished collecting timing info
[0m14:55:59.782387 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:55:59.784476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:55:59.784762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:59.785656 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m14:55:59.836204 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:55:59.836549 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:56:00.660576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bde6593c-c712-4352-9fff-ddf66d82879a:europe-west1&page=queryresults
[0m14:56:00.663568 [debug] [Thread-1 (]: finished collecting timing info
[0m14:56:00.664430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7b3d0>]}
[0m14:56:00.664898 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article .... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m14:56:00.665413 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:56:00.665891 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m14:56:00.666206 [info ] [Thread-1 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m14:56:00.667444 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:56:00.667644 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:56:00.667833 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m14:56:00.675848 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:56:00.678150 [debug] [Thread-1 (]: finished collecting timing info
[0m14:56:00.678317 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m14:56:00.701106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:01.264414 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:56:01.265445 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m14:56:02.939464 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:52e94eba-723a-4fb3-a1de-35a63b9e3c52:europe-west1&page=queryresults
[0m14:56:02.943901 [debug] [Thread-2 (]: finished collecting timing info
[0m14:56:02.944977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108444e80>]}
[0m14:56:02.945532 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 3.46s]
[0m14:56:02.946176 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m14:56:04.390876 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b31cd760-e0ff-424f-8013-d867cc0d61fe:europe-west1&page=queryresults
[0m14:56:04.393260 [debug] [Thread-1 (]: finished collecting timing info
[0m14:56:04.394136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c04f3e98-be5b-456a-9d2b-7706cf06bdbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddb550>]}
[0m14:56:04.394633 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.3 MB processed)[0m in 3.73s]
[0m14:56:04.395239 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m14:56:04.396883 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:56:04.397578 [info ] [MainThread]: 
[0m14:56:04.397887 [info ] [MainThread]: Finished running 7 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 8.06 seconds (8.06s).
[0m14:56:04.398148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:04.398284 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:56:04.398414 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m14:56:04.417411 [info ] [MainThread]: 
[0m14:56:04.417681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:04.417889 [info ] [MainThread]: 
[0m14:56:04.418051 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:56:04.418284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc6e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc6a10>]}
[0m14:56:04.418470 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 14:58:19.660321 | c81ce4b6-f061-4f3e-91d4-7e229847ea2e ==============================
[0m14:58:19.660364 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:58:19.661170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:58:19.661277 [debug] [MainThread]: Tracking: tracking
[0m14:58:19.671416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0d360>]}
[0m14:58:19.708149 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m14:58:19.708396 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/sources.yml
[0m14:58:19.708533 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/google_play_store/sources.yml
[0m14:58:19.708656 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/apple_app_store/sources.yml
[0m14:58:19.708825 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_google_play__reports.p_Store_Performance_traffic_source_raw
[0m14:58:19.708930 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_apple_app_store_connect__reports.sales_and_trends_reports
[0m14:58:19.716146 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m14:58:19.722299 [debug] [MainThread]: 1699: static parser successfully parsed staging/google_play_store/stg_google_play_store__downloads.sql
[0m14:58:19.723506 [debug] [MainThread]: 1699: static parser successfully parsed staging/apple_app_store/stg_apple_app_store__downloads.sql
[0m14:58:19.791722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m14:58:19.794746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d573a0>]}
[0m14:58:19.800126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d810>]}
[0m14:58:19.800321 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:58:19.800453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd3df0>]}
[0m14:58:19.801293 [info ] [MainThread]: 
[0m14:58:19.801666 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:58:19.802319 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:58:19.802438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:20.300104 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:58:20.300632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:20.593734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e08d90>]}
[0m14:58:20.595048 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:58:20.595471 [info ] [MainThread]: 
[0m14:58:20.602278 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:58:20.602716 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:58:20.603081 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m14:58:20.603385 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m14:58:20.604181 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:58:20.604820 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:58:20.605056 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:58:20.605250 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:58:20.605440 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:58:20.605572 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:58:20.609154 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:58:20.611560 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:58:20.612827 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:20.612932 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:20.613106 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:58:20.613274 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:58:20.635918 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:58:20.637744 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:58:20.638148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:20.638260 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:58:20.639137 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:58:20.639833 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:58:21.296175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5479eee7-59af-4524-81d5-3af8cef7c0d8:europe-west1&page=queryresults
[0m14:58:21.322979 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:21.323468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0e0e0>]}
[0m14:58:21.323753 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m14:58:21.324083 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:58:21.324248 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:58:21.324497 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m14:58:21.324942 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:58:21.325056 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:58:21.325167 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:58:21.329222 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:58:21.330401 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:21.330524 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:58:21.332542 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:58:21.332883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:21.333785 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:58:21.517787 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:efe238fa-ef68-4ed1-b096-ffe995135bd9:europe-west1&page=queryresults
[0m14:58:21.519169 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:21.519618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61240>]}
[0m14:58:21.519870 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m14:58:21.520172 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:58:21.520308 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:58:21.520537 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m14:58:21.521131 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:58:21.521265 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:58:21.521375 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:58:21.522844 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:58:21.523241 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:21.523364 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:58:21.525497 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:58:21.525850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:21.526757 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:58:21.952802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5b7cb887-3c93-412f-b534-5f97bbd37fd9:europe-west1&page=queryresults
[0m14:58:21.955736 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:21.956650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c18c10>]}
[0m14:58:21.957152 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m14:58:21.957732 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:58:21.958006 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:58:21.958422 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:58:21.959138 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:58:21.959310 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:58:21.959476 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:58:21.961732 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:58:21.964074 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:21.964314 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:58:21.967315 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:58:21.969174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:21.970189 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m14:58:22.228097 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2d7b074e-1b32-4f81-8ac7-5ccca37cc490:europe-west1&page=queryresults
[0m14:58:22.230719 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:22.231536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e50850>]}
[0m14:58:22.231978 [info ] [Thread-2 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m14:58:22.232453 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:58:22.232673 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:58:22.233104 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:58:22.233778 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:58:22.233946 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:58:22.234116 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:58:22.236428 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:58:22.237221 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:22.237380 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:58:22.250077 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:58:22.250630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:22.251699 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630.raw_segment_ios__production_events.community_viewed_article` 
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m14:58:22.868213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ddafea9e-b726-4f49-9990-b30955e6e29b:europe-west1&page=queryresults
[0m14:58:22.872089 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:22.873072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7f40>]}
[0m14:58:22.873591 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m14:58:22.874170 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:58:22.874410 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m14:58:22.874764 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m14:58:22.875553 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:58:22.875749 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m14:58:22.875925 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m14:58:22.880658 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:58:22.883367 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:22.883588 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m14:58:22.894199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:22.992834 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f6b43be2-f3bf-4e62-ad50-44779c079f85:europe-west1&page=queryresults
[0m14:58:22.994087 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:22.994438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5810>]}
[0m14:58:22.994645 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m14:58:22.994894 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:58:22.994999 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:58:22.995111 [info ] [Thread-2 (]: 8 of 9 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m14:58:22.995630 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:58:22.995793 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:58:22.995900 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:58:22.997599 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:58:23.000118 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:23.000250 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:58:23.001935 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:58:23.002259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:23.003003 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m14:58:23.243191 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:58:23.244001 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:58:23.795144 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:214af992-1a4a-49ea-9fd3-7ebd214a4a28:europe-west1&page=queryresults
[0m14:58:23.798104 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:23.798996 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e31db0>]}
[0m14:58:23.799519 [info ] [Thread-2 (]: 8 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article .... [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:58:23.800123 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:58:23.800686 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m14:58:23.800996 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m14:58:23.801706 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:58:23.801894 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:58:23.802070 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m14:58:23.814097 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:58:23.815608 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:23.815771 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m14:58:23.844075 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:58:24.177010 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:58:24.177981 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m14:58:25.427755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:091ba616-bd44-4cf7-b220-d7a6156ec7f4:europe-west1&page=queryresults
[0m14:58:25.429876 [debug] [Thread-1 (]: finished collecting timing info
[0m14:58:25.430544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2b100>]}
[0m14:58:25.430955 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.56s]
[0m14:58:25.431421 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m14:58:26.930220 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1223c83b-e74c-4f6c-adad-c860a41183ff:europe-west1&page=queryresults
[0m14:58:26.932826 [debug] [Thread-2 (]: finished collecting timing info
[0m14:58:26.933586 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c81ce4b6-f061-4f3e-91d4-7e229847ea2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61240>]}
[0m14:58:26.934008 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.3 MB processed)[0m in 3.13s]
[0m14:58:26.934893 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m14:58:26.936667 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:58:26.937351 [info ] [MainThread]: 
[0m14:58:26.937680 [info ] [MainThread]: Finished running 7 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m14:58:26.937943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:26.938076 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m14:58:26.938204 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:58:26.948753 [info ] [MainThread]: 
[0m14:58:26.949061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:26.949289 [info ] [MainThread]: 
[0m14:58:26.949475 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:58:26.949724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d06c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eacd00>]}
[0m14:58:26.949932 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:03:26.023952 | 5fbc2062-80b2-4e09-a2be-457e0bf97f4c ==============================
[0m15:03:26.023999 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:03:26.024741 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:26.024848 [debug] [MainThread]: Tracking: tracking
[0m15:03:26.035372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e7f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107768df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776b910>]}
[0m15:03:26.061138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150678b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115067af0>]}
[0m15:03:26.061316 [debug] [MainThread]: Flushing usage events
[0m15:03:26.490413 [error] [MainThread]: Encountered an error:
Compilation Error
  The yml property file at models/staging/segment_ios__production_events/sources.yml is invalid because the yml property file models/staging/segment_ios__production_events/sources.yml is missing a version tag. Please consult the documentation for more information on yml property file syntax:
  
  https://docs.getdbt.com/reference/configs-and-properties


============================== 2022-12-12 15:03:54.554594 | 3af34aa6-ea3d-45c4-9190-76124782ca4b ==============================
[0m15:03:54.554659 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:03:54.555468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:54.555569 [debug] [MainThread]: Tracking: tracking
[0m15:03:54.564134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067514e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067513c0>]}
[0m15:03:54.604280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:03:54.604636 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_ios__production_events/sources.yml
[0m15:03:54.604770 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:03:54.612618 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:03:54.671264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m15:03:54.674331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698c100>]}
[0m15:03:54.680421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f61a0>]}
[0m15:03:54.680634 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
[0m15:03:54.680769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105340be0>]}
[0m15:03:54.681624 [info ] [MainThread]: 
[0m15:03:54.681956 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:03:54.682649 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:03:54.682761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:55.194601 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:03:55.195186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:55.631039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494cd90>]}
[0m15:03:55.631916 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:03:55.632197 [info ] [MainThread]: 
[0m15:03:55.637044 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:03:55.637779 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:03:55.639739 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:03:55.639913 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:03:55.640093 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:03:55.642196 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:03:55.643623 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:03:55.644001 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:03:55.644157 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:55.644657 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:03:55.644808 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:03:55.644921 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:03:55.664528 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:03:55.664661 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:03:55.666675 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:03:55.667033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:55.667152 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:55.667303 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:03:55.668938 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:03:55.669699 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:03:55.707668 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:55.708426 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:03:56.436265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:917cae88-a0f2-48b7-9ff6-654babe06113:europe-west1&page=queryresults
[0m15:03:56.455616 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:56.456271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698e320>]}
[0m15:03:56.456644 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m15:03:56.457082 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:03:56.457264 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:03:56.457539 [info ] [Thread-1 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m15:03:56.458130 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:03:56.458283 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:03:56.458426 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:03:56.460216 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:03:56.462834 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:56.462983 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:03:56.465475 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:03:56.466003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:56.467096 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m15:03:56.511740 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:07ed7d44-3663-4f87-8711-d3fa6f889c82:europe-west1&page=queryresults
[0m15:03:56.512811 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:56.513143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106981ed0>]}
[0m15:03:56.513301 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m15:03:56.513500 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:03:56.513587 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:03:56.513790 [info ] [Thread-2 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m15:03:56.516548 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:03:56.516668 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m15:03:56.516750 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m15:03:56.518553 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:03:56.518904 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:56.518986 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m15:03:56.520426 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:03:56.520655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:03:56.521304 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m15:03:57.214651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e5aca53a-7735-466b-9dbe-fcde573e89d8:europe-west1&page=queryresults
[0m15:03:57.215799 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:57.216170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adffa0>]}
[0m15:03:57.216390 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m15:03:57.216626 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:03:57.216733 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:03:57.216847 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:03:57.217435 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:03:57.217599 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:03:57.217695 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:03:57.218901 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:03:57.219761 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:57.219893 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:03:57.221849 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:03:57.222285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:57.223136 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630.raw_segment_android__production_events.community_viewed_article`;


[0m15:03:57.490328 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c48507a4-eae7-4dd4-9474-e860c1000d9f:europe-west1&page=queryresults
[0m15:03:57.491390 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:57.491736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e1360>]}
[0m15:03:57.491928 [info ] [Thread-2 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m15:03:57.492148 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:03:57.492247 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:03:57.492358 [info ] [Thread-2 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:03:57.492660 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:03:57.492790 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:03:57.492883 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:03:57.494715 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:03:57.495103 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:57.495224 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:03:57.497023 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:03:57.497377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:03:57.498161 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m15:03:57.853691 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:54af4bf8-4ef2-4c77-9d4a-e42a8df82e1c:europe-west1&page=queryresults
[0m15:03:57.855072 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:57.855507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c4190>]}
[0m15:03:57.855753 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m15:03:57.856042 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:03:57.856169 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m15:03:57.856380 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:03:57.856851 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:03:57.856970 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m15:03:57.857078 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m15:03:57.859594 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:03:57.860889 [debug] [Thread-1 (]: finished collecting timing info
[0m15:03:57.860990 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m15:03:57.873835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:58.163032 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:705ccc11-fac0-4f10-819b-038c56f5e72e:europe-west1&page=queryresults
[0m15:03:58.164150 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:58.164502 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b27d30>]}
[0m15:03:58.164709 [info ] [Thread-2 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m15:03:58.164962 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:03:58.165074 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:03:58.165189 [info ] [Thread-2 (]: 8 of 9 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m15:03:58.165844 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:03:58.166046 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:03:58.166180 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:03:58.168767 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:03:58.171624 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:58.171805 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:03:58.174165 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:03:58.186055 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:03:58.186422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:03:58.187393 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m15:03:58.187520 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:03:59.141269 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:94aa321d-59e3-490b-970c-036e48fc5e83:europe-west1&page=queryresults
[0m15:03:59.143577 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:59.144227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2f490>]}
[0m15:03:59.144612 [info ] [Thread-2 (]: 8 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article .... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m15:03:59.145027 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:03:59.145456 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m15:03:59.145723 [info ] [Thread-2 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m15:03:59.146357 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m15:03:59.146525 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m15:03:59.146679 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m15:03:59.157038 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m15:03:59.158481 [debug] [Thread-2 (]: finished collecting timing info
[0m15:03:59.158618 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m15:03:59.179089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:03:59.516227 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m15:03:59.517043 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m15:04:00.759246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:26b9858b-a890-4e47-ba48-068f6230c659:europe-west1&page=queryresults
[0m15:04:00.763767 [debug] [Thread-1 (]: finished collecting timing info
[0m15:04:00.764723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f5930>]}
[0m15:04:00.765235 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.91s]
[0m15:04:00.765856 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m15:04:02.518476 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:99c871eb-9359-460d-9c14-0fd221171e5c:europe-west1&page=queryresults
[0m15:04:02.520690 [debug] [Thread-2 (]: finished collecting timing info
[0m15:04:02.521328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af34aa6-ea3d-45c4-9190-76124782ca4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106870cd0>]}
[0m15:04:02.521654 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.3 MB processed)[0m in 3.38s]
[0m15:04:02.522050 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m15:04:02.523267 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:04:02.523896 [info ] [MainThread]: 
[0m15:04:02.524169 [info ] [MainThread]: Finished running 7 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m15:04:02.524387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:02.524502 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:04:02.524612 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m15:04:02.544415 [info ] [MainThread]: 
[0m15:04:02.544708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:02.544911 [info ] [MainThread]: 
[0m15:04:02.545085 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:04:02.545311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4f790>]}
[0m15:04:02.545490 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:07:18.439808 | 2113b366-53cc-457a-9588-11f671c130a7 ==============================
[0m15:07:18.439847 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:07:18.440592 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:07:18.440692 [debug] [MainThread]: Tracking: tracking
[0m15:07:18.455352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f1150>]}
[0m15:07:18.494171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:07:18.494462 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_android__production_events/sources.yml
[0m15:07:18.494604 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:07:18.502567 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m15:07:18.560004 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m15:07:18.563044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b732c20>]}
[0m15:07:18.573249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e3fd0>]}
[0m15:07:18.573440 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:07:18.573574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c71c0>]}
[0m15:07:18.574446 [info ] [MainThread]: 
[0m15:07:18.574779 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:07:18.575424 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:07:18.575560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:19.010875 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:07:19.011399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:19.325132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c71f0>]}
[0m15:07:19.326422 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:07:19.326835 [info ] [MainThread]: 
[0m15:07:19.333684 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:19.334096 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:07:19.334421 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m15:07:19.334714 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m15:07:19.335599 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:07:19.336350 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:07:19.336606 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:19.336810 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:07:19.337037 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:07:19.337201 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:07:19.340773 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:07:19.343472 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:07:19.344317 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:19.344489 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:19.344617 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:19.344746 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:07:19.367987 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:07:19.369869 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:07:19.370311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:19.370433 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:19.371345 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:07:19.412396 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:07:20.229171 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:07066845-3d49-4afc-bd01-fce6fad11760:europe-west1&page=queryresults
[0m15:07:20.243520 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:20.243947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c043b80>]}
[0m15:07:20.244158 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m15:07:20.244400 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:07:20.244510 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:07:20.244624 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m15:07:20.245043 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:07:20.245150 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:07:20.245231 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:07:20.250153 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:07:20.251429 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:20.251611 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:07:20.256275 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:07:20.256673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:20.257572 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m15:07:20.401121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:511dcdba-fd60-4164-af67-c52245adb572:europe-west1&page=queryresults
[0m15:07:20.402485 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:20.402881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b79e350>]}
[0m15:07:20.403116 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m15:07:20.403389 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:07:20.403512 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:07:20.403728 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m15:07:20.404341 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:07:20.404472 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m15:07:20.404577 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m15:07:20.406009 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:07:20.406498 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:20.406619 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m15:07:20.408687 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:07:20.409023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:20.409915 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m15:07:20.966287 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c9ce56a3-629e-44fc-8f42-894cba228df8:europe-west1&page=queryresults
[0m15:07:20.970158 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:20.971197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b761c90>]}
[0m15:07:20.971759 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m15:07:20.972269 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:07:20.972496 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:20.972869 [info ] [Thread-2 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:07:20.973630 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:07:20.973823 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:20.973989 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:20.977890 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:07:20.980336 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:20.980528 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:20.983717 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:07:20.984551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:20.986033 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m15:07:21.358806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5ba92e69-5a98-42ae-8658-8a91751ab066:europe-west1&page=queryresults
[0m15:07:21.361828 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:21.362730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b73a9e0>]}
[0m15:07:21.363179 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m15:07:21.363717 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:07:21.363971 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:21.364253 [info ] [Thread-1 (]: 6 of 9 START sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:07:21.365245 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:07:21.365443 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:21.365624 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:21.369236 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:07:21.369874 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:21.370049 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:21.378403 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:07:21.378882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:21.379960 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
  OPTIONS()
  as SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer;


[0m15:07:21.625425 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:60c2a4ed-16bf-4a55-82d8-78145efdc2ca:europe-west1&page=queryresults
[0m15:07:21.627827 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:21.628545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0ca830>]}
[0m15:07:21.628984 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m15:07:21.629470 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:07:21.629683 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:07:21.630011 [info ] [Thread-2 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m15:07:21.630782 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:07:21.630987 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:07:21.631160 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:07:21.638446 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:07:21.639843 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:21.640024 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:07:21.648991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:21.996425 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:07:21.997470 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:07:22.417756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:eea9e2f8-9eea-47ff-80fc-238fccd9214f:europe-west1&page=queryresults
[0m15:07:22.420718 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:22.421183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7305b0>]}
[0m15:07:22.421370 [info ] [Thread-1 (]: 6 of 9 OK created sql view model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m15:07:22.421582 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:07:22.421676 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:07:22.421775 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article ......... [RUN]
[0m15:07:22.422068 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:07:22.422191 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:07:22.422295 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:07:22.424008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:07:22.426458 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:22.426650 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:07:22.429410 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:07:22.429951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:22.430690 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
GROUP BY reading_session, referrer, slug, user_id, category, os;


[0m15:07:23.107002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6693fef6-a75c-410b-bd32-1312430dac59:europe-west1&page=queryresults
[0m15:07:23.110158 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:23.111120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c099ba0>]}
[0m15:07:23.111654 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__agg_viewed_article .... [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m15:07:23.112245 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:07:23.112807 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m15:07:23.113204 [info ] [Thread-1 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m15:07:23.113998 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m15:07:23.114187 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m15:07:23.114354 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m15:07:23.126304 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m15:07:23.128227 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:23.128383 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m15:07:23.157319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:23.484028 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m15:07:23.484718 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    

    -- this filter will only be applied on an incremental run
    WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
    

    -- this filter will only be applied on an incremental run
    AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`articles_evidence`))

    
),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m15:07:24.271235 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:48740bd8-8b79-4b38-9539-2ef8fa02f177:europe-west1&page=queryresults
[0m15:07:24.275734 [debug] [Thread-2 (]: finished collecting timing info
[0m15:07:24.276731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09b670>]}
[0m15:07:24.277266 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.65s]
[0m15:07:24.277880 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:07:25.995965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5924e635-34b8-4114-9b5c-1ed78f108b70:europe-west1&page=queryresults
[0m15:07:25.998611 [debug] [Thread-1 (]: finished collecting timing info
[0m15:07:25.999513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2113b366-53cc-457a-9588-11f671c130a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7317b0>]}
[0m15:07:26.000060 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (0.0 rows, 43.3 MB processed)[0m in 2.89s]
[0m15:07:26.000666 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m15:07:26.002419 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:07:26.003114 [info ] [MainThread]: 
[0m15:07:26.003439 [info ] [MainThread]: Finished running 7 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m15:07:26.003709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:26.003847 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m15:07:26.003977 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:07:26.014220 [info ] [MainThread]: 
[0m15:07:26.014485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:26.014704 [info ] [MainThread]: 
[0m15:07:26.014883 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:07:26.015123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3fc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c099ae0>]}
[0m15:07:26.015349 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:37:36.893820 | 6d86a02c-9626-49df-89e1-9ebd8bb34f56 ==============================
[0m15:37:36.893881 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:37:36.894731 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:37:36.894866 [debug] [MainThread]: Tracking: tracking
[0m15:37:36.913596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf6680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf5390>]}
[0m15:37:36.952622 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m15:37:36.952867 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article copy.sql
[0m15:37:36.952964 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:37:36.953178 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_ios__production_events.community_viewed_article
[0m15:37:36.953247 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_ios__production_events/sources.yml
[0m15:37:36.953352 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:37:36.953461 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m15:37:36.953544 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m15:37:36.960729 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article copy.sql
[0m15:37:36.968693 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article copy.sql
[0m15:37:36.969311 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:37:36.971461 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:37:36.977249 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m15:37:36.978654 [debug] [MainThread]: 1603: static parser failed on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m15:37:36.980937 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m15:37:37.041385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfeb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bff6d0>]}
[0m15:37:37.041591 [debug] [MainThread]: Flushing usage events
[0m15:37:37.609325 [error] [MainThread]: Encountered an error:
Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Model 'model.my_new_project.articles_evidence' (models/marts/articles_evidence.sql) depends on a node named 'stg_segment_ios__community_viewed_article' which was not found


============================== 2022-12-12 15:38:16.067038 | 2a1dfec9-c39d-44d9-a00e-7daf28e02719 ==============================
[0m15:38:16.067076 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:38:16.067901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:16.068005 [debug] [MainThread]: Tracking: tracking
[0m15:38:16.078986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf53c0>]}
[0m15:38:16.121858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m15:38:16.122125 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:38:16.122440 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_ios__production_events.community_viewed_article
[0m15:38:16.122518 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_ios__production_events/sources.yml
[0m15:38:16.122635 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m15:38:16.122718 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:38:16.122797 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m15:38:16.129939 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:38:16.137879 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:38:16.139205 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m15:38:16.140607 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:38:16.142737 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:38:16.143239 [debug] [MainThread]: 1603: static parser failed on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m15:38:16.145336 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m15:38:16.213539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:38:16.216614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f13ee0>]}
[0m15:38:16.222841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a380>]}
[0m15:38:16.223047 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:38:16.223178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a3b0>]}
[0m15:38:16.224049 [info ] [MainThread]: 
[0m15:38:16.224396 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:38:16.225037 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:38:16.225172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:16.911660 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:38:16.912178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:17.270895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c78dc0>]}
[0m15:38:17.272055 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:38:17.272552 [info ] [MainThread]: 
[0m15:38:17.280575 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:38:17.280753 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:38:17.281055 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m15:38:17.281330 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m15:38:17.283885 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:38:17.284524 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:38:17.284716 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:38:17.284881 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:38:17.285051 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:38:17.285202 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:38:17.288021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:38:17.290538 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:38:17.292067 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:17.292212 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:17.292366 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:38:17.292468 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:38:17.316370 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:38:17.318330 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:38:17.319531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:17.319644 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:38:17.320553 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:38:17.360910 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:38:18.121970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:54491526-cd11-4928-b62e-62aba3daae2e:europe-west1&page=queryresults
[0m15:38:18.141059 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:18.142178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f71990>]}
[0m15:38:18.142569 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m15:38:18.143436 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:99a17704-508d-4d7c-aa13-f06ae737492c:europe-west1&page=queryresults
[0m15:38:18.143839 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:38:18.145235 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:18.145461 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:38:18.145954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f700a0>]}
[0m15:38:18.146135 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m15:38:18.146353 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m15:38:18.146903 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:38:18.147238 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:38:18.147376 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:38:18.147773 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:38:18.148009 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:38:18.148364 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m15:38:18.149932 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:38:18.150455 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:38:18.150681 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m15:38:18.150799 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m15:38:18.155102 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:18.155255 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:38:18.156623 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:38:18.161270 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:38:18.162524 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:18.162651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:18.162770 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m15:38:18.163647 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m15:38:18.165319 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:38:18.206028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:18.207024 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m15:38:19.135167 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b573dd0e-0077-45c1-b4d1-7837a5122618:europe-west1&page=queryresults
[0m15:38:19.140204 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:19.141062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e63e0>]}
[0m15:38:19.142147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f5a0784c-bfe1-42ad-9566-d40c4acfa8ab:europe-west1&page=queryresults
[0m15:38:19.142626 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m15:38:19.144446 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:19.144996 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:38:19.145588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f71030>]}
[0m15:38:19.145849 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:38:19.146528 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m15:38:19.146768 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:38:19.147100 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:38:19.147669 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:38:19.147868 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:38:19.148103 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:38:19.148342 [info ] [Thread-1 (]: 6 of 10 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:38:19.148517 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:38:19.149090 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:38:19.150200 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:38:19.152262 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:38:19.155669 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:38:19.159489 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:38:19.160890 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:19.161023 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:19.161139 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:38:19.161299 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:38:19.163601 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:38:19.185606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:19.225377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:19.226230 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m15:38:19.749212 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:38:19.751328 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer


    );
  
[0m15:38:20.175442 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:eb75de63-05d1-418a-af6a-906c08f76138:europe-west1&page=queryresults
[0m15:38:20.178595 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:20.179520 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f100d0>]}
[0m15:38:20.180085 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m15:38:20.180707 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:38:20.180974 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:38:20.181413 [info ] [Thread-2 (]: 7 of 10 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m15:38:20.182239 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:38:20.182438 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m15:38:20.182617 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m15:38:20.189872 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:38:20.190507 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:20.190677 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m15:38:20.194035 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:38:20.194566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:20.195720 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, timestamp as original_timestamp, category, clinic_id, user_id, referrer, article_id
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer


    );
  
[0m15:38:20.821630 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: clinic_id at [13:57]')
[0m15:38:21.946564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:12bf06e1-3206-4f3f-8da4-16227b75afc1:europe-west1&page=queryresults
[0m15:38:21.949800 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:21.950781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f3dc0>]}
[0m15:38:21.951312 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE TABLE (1.5k rows, 447.0 KB processed)[0m in 2.80s]
[0m15:38:21.951894 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:38:21.952158 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m15:38:21.952566 [info ] [Thread-1 (]: 8 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m15:38:21.953488 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:38:21.953737 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m15:38:21.953955 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m15:38:21.958735 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:38:21.961702 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:21.961896 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m15:38:21.972631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:22.046608 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:0b781039-0d06-4e57-8332-eda7617ff5fe&page=queryresults
[0m15:38:22.046996 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:22.047364 [debug] [Thread-2 (]: Database Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)
  Unrecognized name: clinic_id at [13:57]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:38:22.047514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4c550>]}
[0m15:38:22.047722 [error] [Thread-2 (]: 7 of 10 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[31mERROR[0m in 1.87s]
[0m15:38:22.047936 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:38:22.048044 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:38:22.048244 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article . [RUN]
[0m15:38:22.048617 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:38:22.048712 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:38:22.048792 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:38:22.050977 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:38:22.053429 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:22.053601 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:38:22.055402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:22.374244 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:38:22.376402 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:38:22.377577 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

GROUP BY reading_session, referrer, slug, user_id, category, os
    );
  
[0m15:38:22.377839 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:38:24.807900 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23c18b51-c6a2-42b5-9c63-c73bcce5a78c:europe-west1&page=queryresults
[0m15:38:24.808753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b755b7c0-63bd-48ca-a569-0ca6146756f1:europe-west1&page=queryresults
[0m15:38:24.812658 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:24.814641 [debug] [Thread-1 (]: finished collecting timing info
[0m15:38:24.815551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12d40>]}
[0m15:38:24.816229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12dd0>]}
[0m15:38:24.816732 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mCREATE TABLE (15.0k rows, 42.6 MB processed)[0m in 2.77s]
[0m15:38:24.817169 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.86s]
[0m15:38:24.817721 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:38:24.818135 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m15:38:24.818765 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m15:38:24.819424 [info ] [Thread-2 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m15:38:24.820356 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m15:38:24.820551 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m15:38:24.820722 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m15:38:24.832828 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m15:38:24.833817 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:24.833989 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m15:38:24.838992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:25.221675 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m15:38:25.222619 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment

),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m15:38:27.412862 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9f4a29d2-d3b9-45f4-8e17-bbbf5bb0fb2f:europe-west1&page=queryresults
[0m15:38:27.415745 [debug] [Thread-2 (]: finished collecting timing info
[0m15:38:27.416665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1dfec9-c39d-44d9-a00e-7daf28e02719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108243010>]}
[0m15:38:27.417158 [info ] [Thread-2 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mMERGE (15.9k rows, 2.2 MB processed)[0m in 2.60s]
[0m15:38:27.417718 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m15:38:27.419371 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:38:27.420022 [info ] [MainThread]: 
[0m15:38:27.420322 [info ] [MainThread]: Finished running 5 view models, 4 incremental models, 1 table model in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m15:38:27.420582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:27.420725 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:38:27.420854 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m15:38:27.432953 [info ] [MainThread]: 
[0m15:38:27.433285 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:38:27.433500 [info ] [MainThread]: 
[0m15:38:27.433679 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)[0m
[0m15:38:27.433859 [error] [MainThread]:   Unrecognized name: clinic_id at [13:57]
[0m15:38:27.434030 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:38:27.434215 [info ] [MainThread]: 
[0m15:38:27.434391 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m15:38:27.434639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fccd0>]}
[0m15:38:27.434837 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:49:36.713246 | aee6d851-6718-42d8-a74d-4a7540d2a31e ==============================
[0m15:49:36.713315 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:49:36.714031 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:49:36.714141 [debug] [MainThread]: Tracking: tracking
[0m15:49:36.724710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727d300>]}
[0m15:49:36.766563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:36.766859 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:49:36.774060 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:49:36.782123 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:49:36.790887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:49:36.794151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074efe50>]}
[0m15:49:36.834262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107104f40>]}
[0m15:49:36.834468 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:49:36.834599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10209bbb0>]}
[0m15:49:36.835485 [info ] [MainThread]: 
[0m15:49:36.835818 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:49:36.836473 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:49:36.836610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:37.425499 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:49:37.426079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:37.753385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af79d0>]}
[0m15:49:37.754545 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:49:37.754986 [info ] [MainThread]: 
[0m15:49:37.760661 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:49:37.760923 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:49:37.761215 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m15:49:37.761490 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m15:49:37.762227 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:49:37.762847 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:49:37.763017 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:49:37.763203 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:49:37.763399 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:49:37.763616 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:49:37.767234 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:49:37.775515 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:49:37.775738 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:37.775893 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:49:37.788709 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:37.800592 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:49:37.800796 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:49:37.802709 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:49:37.802934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:37.803782 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:49:37.804262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:37.844214 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:49:38.740909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3bc5e21f-16e0-4367-9c30-262819bf8ee4:europe-west1&page=queryresults
[0m15:49:38.742567 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c1966a40-ab3a-460a-ac6c-81d64f2581e7:europe-west1&page=queryresults
[0m15:49:38.759573 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:38.760853 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:38.761377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749b7f0>]}
[0m15:49:38.761765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e35e0>]}
[0m15:49:38.762070 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m15:49:38.762292 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m15:49:38.762670 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:49:38.762931 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:49:38.763108 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:49:38.763327 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:49:38.763710 [info ] [Thread-1 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m15:49:38.764197 [info ] [Thread-2 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m15:49:38.764738 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:49:38.765161 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:49:38.765303 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:49:38.765410 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m15:49:38.765526 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:49:38.765622 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m15:49:38.767209 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:49:38.768458 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:49:38.769858 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:38.769994 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:38.770087 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m15:49:38.770274 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:49:38.772503 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:49:38.777953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:38.778552 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:49:38.779429 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m15:49:38.819947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:38.820905 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m15:49:39.675270 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:87d42540-9a7b-4d20-9a40-2b3b26293342:europe-west1&page=queryresults
[0m15:49:39.678401 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:39.679257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10779c850>]}
[0m15:49:39.679737 [info ] [Thread-2 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m15:49:39.680260 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:49:39.680506 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:49:39.681102 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:49:39.682019 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:49:39.682229 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:49:39.682429 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:49:39.685915 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:49:39.687918 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:39.688117 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:49:39.691301 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:49:39.692108 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:39.693404 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m15:49:39.695303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a9fb88b7-f1ba-4bc3-90f0-d4bf1b174fbb:europe-west1&page=queryresults
[0m15:49:39.744684 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:39.745194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077903a0>]}
[0m15:49:39.745376 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m15:49:39.745617 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:49:39.745710 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:49:39.745810 [info ] [Thread-1 (]: 6 of 10 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:49:39.746283 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:49:39.746383 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:49:39.746460 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:49:39.749713 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:49:39.750302 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:39.750409 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:49:39.765804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:40.366643 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:49:40.368740 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer


-- this filter will only be applied on an incremental run
WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m15:49:40.692861 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4bb6b6ff-1514-448d-bccb-f8bddd387998:europe-west1&page=queryresults
[0m15:49:40.696379 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:40.697293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107781180>]}
[0m15:49:40.697798 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m15:49:40.698317 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:49:40.698547 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:49:40.698929 [info ] [Thread-2 (]: 7 of 10 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m15:49:40.699749 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:49:40.699945 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m15:49:40.700123 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m15:49:40.705280 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:49:40.706473 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:40.706653 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m15:49:40.716726 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword WHERE at [19:1]')
[0m15:49:40.734056 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:49:40.734626 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:40.735521 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, timestamp as original_timestamp, category, IFNULL(clinic_id,""), user_id, referrer, article_id
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer


    );
  
[0m15:49:41.422135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:e93732e7-d5f8-4a78-a187-6ee781f825ce&page=queryresults
[0m15:49:41.423476 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:41.424756 [debug] [Thread-1 (]: Database Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)
  Syntax error: Expected ")" but got keyword WHERE at [19:1]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:49:41.425247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f8730>]}
[0m15:49:41.425812 [error] [Thread-1 (]: 6 of 10 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[31mERROR[0m in 1.68s]
[0m15:49:41.426531 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:49:41.427001 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m15:49:41.427567 [info ] [Thread-1 (]: 8 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m15:49:41.428543 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:49:41.428774 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m15:49:41.428970 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m15:49:41.433539 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:49:41.434370 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:41.434559 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m15:49:41.444863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:41.493437 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: clinic_id at [13:64]')
[0m15:49:41.768086 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:49:41.769083 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:49:42.410616 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:01df5f77-31ef-4ef2-8902-ec56ec165166&page=queryresults
[0m15:49:42.413321 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:42.414141 [debug] [Thread-2 (]: Database Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)
  Unrecognized name: clinic_id at [13:64]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:49:42.414451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111841900>]}
[0m15:49:42.414923 [error] [Thread-2 (]: 7 of 10 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[31mERROR[0m in 1.72s]
[0m15:49:42.415370 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:49:42.415572 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:49:42.415788 [info ] [Thread-2 (]: 9 of 10 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article . [RUN]
[0m15:49:42.416799 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:49:42.417072 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:49:42.417240 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:49:42.421357 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:49:42.422915 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:42.423151 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:49:42.425636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:49:42.792216 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:49:42.792899 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m15:49:44.074580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:59aa69ba-a273-4fd5-9a6b-e3627c6e6f8c:europe-west1&page=queryresults
[0m15:49:44.078867 [debug] [Thread-1 (]: finished collecting timing info
[0m15:49:44.079911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cd810>]}
[0m15:49:44.080466 [info ] [Thread-1 (]: 8 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.65s]
[0m15:49:44.081032 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m15:49:45.047342 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c06984da-3efd-4ba5-83f2-95a459e93eb8:europe-west1&page=queryresults
[0m15:49:45.049051 [debug] [Thread-2 (]: finished collecting timing info
[0m15:49:45.049678 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee6d851-6718-42d8-a74d-4a7540d2a31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cda50>]}
[0m15:49:45.050029 [info ] [Thread-2 (]: 9 of 10 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.63s]
[0m15:49:45.050400 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:49:45.050841 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m15:49:45.051382 [info ] [Thread-1 (]: 10 of 10 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m15:49:45.051757 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m15:49:45.052725 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:49:45.053172 [info ] [MainThread]: 
[0m15:49:45.053394 [info ] [MainThread]: Finished running 5 view models, 4 incremental models, 1 table model in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m15:49:45.053585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:45.053685 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:49:45.053780 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m15:49:45.067473 [info ] [MainThread]: 
[0m15:49:45.067700 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:49:45.067869 [info ] [MainThread]: 
[0m15:49:45.068011 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__community_viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql)[0m
[0m15:49:45.068155 [error] [MainThread]:   Syntax error: Expected ")" but got keyword WHERE at [19:1]
[0m15:49:45.068288 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:49:45.068588 [info ] [MainThread]: 
[0m15:49:45.068757 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)[0m
[0m15:49:45.068907 [error] [MainThread]:   Unrecognized name: clinic_id at [13:64]
[0m15:49:45.069040 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:49:45.069190 [info ] [MainThread]: 
[0m15:49:45.069333 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m15:49:45.069534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e37d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e37820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111823f70>]}
[0m15:49:45.069689 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:50:07.822051 | 75119bc6-ef20-4cfa-8cac-b2657bc939ba ==============================
[0m15:50:07.822088 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:50:07.826380 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:50:07.826919 [debug] [MainThread]: Tracking: tracking
[0m15:50:07.836674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11517f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e28df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2b910>]}
[0m15:50:07.877198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:07.877472 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:50:07.884857 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:50:07.892895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m15:50:07.901135 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m15:50:07.904354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11569bfa0>]}
[0m15:50:07.944551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11500cb50>]}
[0m15:50:07.944754 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:50:07.944882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ee7070>]}
[0m15:50:07.945763 [info ] [MainThread]: 
[0m15:50:07.946091 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:50:07.946915 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:50:07.946998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:08.498100 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:50:08.498534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:08.826901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114abce20>]}
[0m15:50:08.828710 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:50:08.829208 [info ] [MainThread]: 
[0m15:50:08.836712 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m15:50:08.836975 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m15:50:08.837411 [info ] [Thread-1 (]: 1 of 10 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m15:50:08.837673 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m15:50:08.838422 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m15:50:08.839059 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m15:50:08.839244 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m15:50:08.839396 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m15:50:08.839575 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m15:50:08.839718 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m15:50:08.843181 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:50:08.848724 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:08.848897 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m15:50:08.871079 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m15:50:08.874870 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:50:08.875332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:08.875440 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:08.875589 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m15:50:08.877363 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m15:50:08.878171 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m15:50:08.917825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:08.918701 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m15:50:09.549191 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f3dbdb09-5cd7-4b5e-8a3b-50860d784730:europe-west1&page=queryresults
[0m15:50:09.554964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:746b23c7-d397-4d11-a956-879022459b97:europe-west1&page=queryresults
[0m15:50:09.559383 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:09.560312 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:09.560668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115644700>]}
[0m15:50:09.560999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115635e10>]}
[0m15:50:09.561218 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m15:50:09.561520 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.72s]
[0m15:50:09.561811 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m15:50:09.561989 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m15:50:09.562130 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:50:09.562331 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:50:09.562500 [info ] [Thread-2 (]: 3 of 10 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m15:50:09.562712 [info ] [Thread-1 (]: 4 of 10 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m15:50:09.563113 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:50:09.563447 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:50:09.563543 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:50:09.563644 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m15:50:09.563732 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:50:09.563804 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m15:50:09.564946 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:50:09.565762 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:50:09.566475 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:09.566618 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:50:09.568263 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m15:50:09.568386 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:09.568586 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m15:50:09.570224 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m15:50:09.570521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:09.571587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:09.571742 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m15:50:09.610761 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m15:50:10.448793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:13a66130-73de-48f1-902c-aef4f832e70e:europe-west1&page=queryresults
[0m15:50:10.451062 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:10.451478 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115644a30>]}
[0m15:50:10.451681 [info ] [Thread-2 (]: 3 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m15:50:10.451892 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m15:50:10.451991 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:50:10.452142 [info ] [Thread-2 (]: 5 of 10 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m15:50:10.452484 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:50:10.452576 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:50:10.452656 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m15:50:10.459195 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:50:10.459570 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:10.459659 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:50:10.463752 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m15:50:10.464043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:10.464739 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m15:50:10.509128 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ecaa9c87-daf2-43d9-9b0a-4d5f85052d11:europe-west1&page=queryresults
[0m15:50:10.510154 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:10.510519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11569bfd0>]}
[0m15:50:10.510707 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:50:10.511172 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m15:50:10.511318 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:50:10.511578 [info ] [Thread-1 (]: 6 of 10 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m15:50:10.511917 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:50:10.512058 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:50:10.512183 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:50:10.515499 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:50:10.515895 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:10.515990 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:50:10.531890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.854233 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m15:50:10.854852 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m15:50:11.108395 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:028018e8-0fd5-42f3-9705-577251b3866c:europe-west1&page=queryresults
[0m15:50:11.111423 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:11.112314 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115644700>]}
[0m15:50:11.133624 [info ] [Thread-2 (]: 5 of 10 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m15:50:11.135408 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m15:50:11.136970 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:50:11.137491 [info ] [Thread-2 (]: 7 of 10 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m15:50:11.138533 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:50:11.139004 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m15:50:11.139437 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m15:50:11.144922 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:50:11.145665 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:11.145859 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m15:50:11.167537 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:50:11.168063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:11.169057 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, timestamp as original_timestamp, category, IFNULL(clinic_id,""), user_id, referrer, article_id
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer


    );
  
[0m15:50:11.825860 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: clinic_id at [13:64]')
[0m15:50:12.440226 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:bb14d741-a39c-490e-9f36-449b658d1f9d&page=queryresults
[0m15:50:12.440717 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:12.441225 [debug] [Thread-2 (]: Database Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)
  Unrecognized name: clinic_id at [13:64]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:50:12.441434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200116f0>]}
[0m15:50:12.441729 [error] [Thread-2 (]: 7 of 10 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[31mERROR[0m in 1.30s]
[0m15:50:12.442034 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:50:12.442192 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m15:50:12.442478 [info ] [Thread-2 (]: 8 of 10 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m15:50:12.443045 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m15:50:12.443199 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m15:50:12.443323 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m15:50:12.451045 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m15:50:12.452766 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:12.452893 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m15:50:12.460619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:12.768016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:71d6bb88-0a84-4a18-a206-c8b942eea6ba:europe-west1&page=queryresults
[0m15:50:12.770431 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:12.771327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156342e0>]}
[0m15:50:12.771854 [info ] [Thread-1 (]: 6 of 10 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 458.5 KB processed)[0m in 2.26s]
[0m15:50:12.772440 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m15:50:12.772713 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:50:12.772990 [info ] [Thread-1 (]: 9 of 10 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article . [RUN]
[0m15:50:12.773825 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:50:12.774294 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:50:12.774626 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:50:12.779865 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:50:12.780551 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:12.780715 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:50:12.783401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:12.835279 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m15:50:12.835819 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m15:50:13.140595 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m15:50:13.142051 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m15:50:15.266052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bd40d987-1ea9-422d-ae04-b563bc5b0d8a:europe-west1&page=queryresults
[0m15:50:15.268370 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:15.269233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115683130>]}
[0m15:50:15.269743 [info ] [Thread-1 (]: 9 of 10 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.50s]
[0m15:50:15.270248 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m15:50:15.270705 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m15:50:15.271004 [info ] [Thread-1 (]: 10 of 10 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m15:50:15.272146 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m15:50:15.272347 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m15:50:15.272522 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m15:50:15.277208 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m15:50:15.280227 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:15.280401 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m15:50:15.283003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:15.404580 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:db756fb5-b11d-404f-9257-faa3d119cba0:europe-west1&page=queryresults
[0m15:50:15.405781 [debug] [Thread-2 (]: finished collecting timing info
[0m15:50:15.406178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200130a0>]}
[0m15:50:15.406661 [info ] [Thread-2 (]: 8 of 10 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.96s]
[0m15:50:15.407107 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m15:50:15.615070 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m15:50:15.616328 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment

),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m15:50:17.997835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f062e568-12d9-497d-a163-4bef3dd7df5a:europe-west1&page=queryresults
[0m15:50:18.000267 [debug] [Thread-1 (]: finished collecting timing info
[0m15:50:18.001179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75119bc6-ef20-4cfa-8cac-b2657bc939ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115788520>]}
[0m15:50:18.001701 [info ] [Thread-1 (]: 10 of 10 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mMERGE (15.9k rows, 2.2 MB processed)[0m in 2.73s]
[0m15:50:18.002242 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m15:50:18.004009 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:50:18.004726 [info ] [MainThread]: 
[0m15:50:18.005047 [info ] [MainThread]: Finished running 5 view models, 4 incremental models, 1 table model in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m15:50:18.005311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:18.005451 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m15:50:18.005582 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m15:50:18.029616 [info ] [MainThread]: 
[0m15:50:18.029845 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:18.030055 [info ] [MainThread]: 
[0m15:50:18.030219 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)[0m
[0m15:50:18.030366 [error] [MainThread]:   Unrecognized name: clinic_id at [13:64]
[0m15:50:18.030501 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:50:18.030649 [info ] [MainThread]: 
[0m15:50:18.030793 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m15:50:18.031002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c37c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c35a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12006e260>]}
[0m15:50:18.031160 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:51:29.528361 | 80fffb47-2e03-4b6b-8329-b78c8c14f5c8 ==============================
[0m15:51:29.528383 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:51:29.529089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:29.529198 [debug] [MainThread]: Tracking: tracking
[0m15:51:29.539286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d79390>]}
[0m15:51:29.577888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:29.578036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:29.578349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m15:51:29.581637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80fffb47-2e03-4b6b-8329-b78c8c14f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff00d0>]}
[0m15:51:29.587711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80fffb47-2e03-4b6b-8329-b78c8c14f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc03a0>]}
[0m15:51:29.587901 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:51:29.588037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80fffb47-2e03-4b6b-8329-b78c8c14f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc0190>]}
[0m15:51:29.588805 [info ] [MainThread]: 
[0m15:51:29.589148 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:51:29.589629 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:51:29.589761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:30.105950 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:51:30.106525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:30.442824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80fffb47-2e03-4b6b-8329-b78c8c14f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f7cdc0>]}
[0m15:51:30.443964 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:51:30.444354 [info ] [MainThread]: 
[0m15:51:30.451200 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:51:30.451693 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article ... [RUN]
[0m15:51:30.452526 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:51:30.452729 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m15:51:30.452926 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m15:51:30.461734 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:51:30.462954 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:30.463163 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m15:51:30.537380 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:51:30.537798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:30.538450 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, timestamp as original_timestamp, category, IFNULL(clinic_id,""), user_id, referrer, article_id
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`
WHERE slug is not null
group by reading_session, slug, category, clinic_id, user_id, referrer


    );
  
[0m15:51:31.269831 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: clinic_id at [13:64]')
[0m15:51:32.241166 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:2048ba24-5b3d-4cb7-9d1d-782fb834191f&page=queryresults
[0m15:51:32.242058 [debug] [Thread-1 (]: finished collecting timing info
[0m15:51:32.242968 [debug] [Thread-1 (]: Database Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)
  Unrecognized name: clinic_id at [13:64]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:51:32.243340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fffb47-2e03-4b6b-8329-b78c8c14f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d86080>]}
[0m15:51:32.243801 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[31mERROR[0m in 1.79s]
[0m15:51:32.244279 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:51:32.246201 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:51:32.247023 [info ] [MainThread]: 
[0m15:51:32.247349 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m15:51:32.247611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:32.247746 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__viewed_article' was properly closed.
[0m15:51:32.259084 [info ] [MainThread]: 
[0m15:51:32.259352 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:51:32.259559 [info ] [MainThread]: 
[0m15:51:32.259737 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)[0m
[0m15:51:32.259909 [error] [MainThread]:   Unrecognized name: clinic_id at [13:64]
[0m15:51:32.260080 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:51:32.260248 [info ] [MainThread]: 
[0m15:51:32.260424 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:51:32.260665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff2cb0>]}
[0m15:51:32.260858 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 15:52:23.025027 | 61bf8b57-f006-49e3-a846-d98032731de8 ==============================
[0m15:52:23.025063 [info ] [MainThread]: Running with dbt=1.3.1
[0m15:52:23.025799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:52:23.025904 [debug] [MainThread]: Tracking: tracking
[0m15:52:23.036174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f5120>]}
[0m15:52:23.075964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:23.076225 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:52:23.083296 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:52:23.091195 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:52:23.099388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m15:52:23.102503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61bf8b57-f006-49e3-a846-d98032731de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111566950>]}
[0m15:52:23.142671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61bf8b57-f006-49e3-a846-d98032731de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111180c70>]}
[0m15:52:23.142880 [info ] [MainThread]: Found 10 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m15:52:23.143015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61bf8b57-f006-49e3-a846-d98032731de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104813be0>]}
[0m15:52:23.143734 [info ] [MainThread]: 
[0m15:52:23.144050 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:52:23.147333 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m15:52:23.147502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:23.656598 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m15:52:23.657255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:23.952758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61bf8b57-f006-49e3-a846-d98032731de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106840dc0>]}
[0m15:52:23.954133 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:52:23.954579 [info ] [MainThread]: 
[0m15:52:23.961313 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:52:23.961820 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article ... [RUN]
[0m15:52:23.962638 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:52:23.962832 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m15:52:23.963015 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m15:52:23.967854 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:52:23.969964 [debug] [Thread-1 (]: finished collecting timing info
[0m15:52:23.970176 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m15:52:24.017405 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m15:52:24.018270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:24.019005 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, timestamp as original_timestamp, category, user_id, referrer, article_id
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


    );
  
[0m15:52:24.682947 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: article_id at [13:76]')
[0m15:52:25.397714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:7b2bda7c-1804-4939-a700-4e526b23aa38&page=queryresults
[0m15:52:25.398212 [debug] [Thread-1 (]: finished collecting timing info
[0m15:52:25.398686 [debug] [Thread-1 (]: Database Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)
  Unrecognized name: article_id at [13:76]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:52:25.398834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61bf8b57-f006-49e3-a846-d98032731de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573d30>]}
[0m15:52:25.399027 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[31mERROR[0m in 1.44s]
[0m15:52:25.399222 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m15:52:25.399976 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m15:52:25.400222 [info ] [MainThread]: 
[0m15:52:25.400342 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m15:52:25.400449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:25.400508 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__viewed_article' was properly closed.
[0m15:52:25.407320 [info ] [MainThread]: 
[0m15:52:25.407514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:25.407649 [info ] [MainThread]: 
[0m15:52:25.407857 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)[0m
[0m15:52:25.408041 [error] [MainThread]:   Unrecognized name: article_id at [13:76]
[0m15:52:25.408253 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m15:52:25.408376 [info ] [MainThread]: 
[0m15:52:25.408543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:52:25.408752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11151b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11151be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c7250>]}
[0m15:52:25.408891 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 16:03:30.879932 | a5bf7e83-d918-4b1b-997e-d53a9bbd9ef3 ==============================
[0m16:03:30.879963 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:03:30.880766 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['stg_segment_ios__viewed_article'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:03:30.880898 [debug] [MainThread]: Tracking: tracking
[0m16:03:30.890214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367ce50>]}
[0m16:03:30.928384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:30.928652 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m16:03:30.935915 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m16:03:30.944526 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m16:03:30.953777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m16:03:30.957053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5bf7e83-d918-4b1b-997e-d53a9bbd9ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114166fb0>]}
[0m16:03:30.997967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5bf7e83-d918-4b1b-997e-d53a9bbd9ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113593e80>]}
[0m16:03:30.998173 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m16:03:30.998302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bf7e83-d918-4b1b-997e-d53a9bbd9ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244c4c0>]}
[0m16:03:30.998544 [warn ] [MainThread]: The selection criterion 'stg_segment_ios__viewed_article' does not match any nodes
[0m16:03:30.999075 [info ] [MainThread]: 
[0m16:03:30.999206 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m16:03:31.004212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106410be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412680>]}
[0m16:03:31.004426 [debug] [MainThread]: Flushing usage events


============================== 2022-12-12 16:03:43.241830 | 3c24b8ab-cef7-4c92-a569-5ec11c084ff2 ==============================
[0m16:03:43.241870 [info ] [MainThread]: Running with dbt=1.3.1
[0m16:03:43.243029 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:03:43.243240 [debug] [MainThread]: Tracking: tracking
[0m16:03:43.255947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317d360>]}
[0m16:03:43.292386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:43.292579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:43.292879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m16:03:43.296116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e80d0>]}
[0m16:03:43.303457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113341900>]}
[0m16:03:43.303614 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics
[0m16:03:43.303744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b8160>]}
[0m16:03:43.304823 [info ] [MainThread]: 
[0m16:03:43.305158 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:03:43.305806 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m16:03:43.305915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:43.774528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m16:03:43.775075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:44.069689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111174dc0>]}
[0m16:03:44.070806 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:03:44.071208 [info ] [MainThread]: 
[0m16:03:44.077578 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m16:03:44.077855 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m16:03:44.078175 [info ] [Thread-1 (]: 1 of 9 START sql view model dbt_rsdun.stg_apple_app_store__downloads ........... [RUN]
[0m16:03:44.078571 [info ] [Thread-2 (]: 2 of 9 START sql view model dbt_rsdun.stg_google_play_store__downloads ......... [RUN]
[0m16:03:44.079258 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m16:03:44.080293 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m16:03:44.080509 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m16:03:44.080663 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m16:03:44.080838 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m16:03:44.080984 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m16:03:44.084479 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m16:03:44.087332 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m16:03:44.088635 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:44.088758 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:44.088933 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m16:03:44.089080 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m16:03:44.112784 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m16:03:44.113252 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:03:44.152744 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m16:03:44.153625 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m16:03:44.189128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:44.189723 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m16:03:44.796492 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e27df5ce-843e-4a60-aece-5295d379ff10:europe-west1&page=queryresults
[0m16:03:44.816682 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:44.817385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5aec0>]}
[0m16:03:44.817747 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dbt_rsdun.stg_google_play_store__downloads .... [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m16:03:44.818147 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m16:03:44.818315 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m16:03:44.818581 [info ] [Thread-2 (]: 3 of 9 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article ... [RUN]
[0m16:03:44.819153 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m16:03:44.819299 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m16:03:44.819446 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m16:03:44.821181 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m16:03:44.823632 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:44.823758 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m16:03:44.825990 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m16:03:44.826423 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:44.827443 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m16:03:44.872099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2d375855-37b4-421f-b39c-c0e57f7db3fa:europe-west1&page=queryresults
[0m16:03:44.873182 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:44.873515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110756bc0>]}
[0m16:03:44.873679 [info ] [Thread-1 (]: 1 of 9 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ...... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m16:03:44.873884 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m16:03:44.873970 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m16:03:44.874113 [info ] [Thread-1 (]: 4 of 9 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............. [RUN]
[0m16:03:44.874534 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m16:03:44.874629 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m16:03:44.874705 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m16:03:44.875676 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m16:03:44.875941 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:44.876036 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m16:03:44.877552 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m16:03:44.878124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:44.878834 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m16:03:45.514730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0cc7d9e0-aa54-4c40-854c-a2f9e63875ae:europe-west1&page=queryresults
[0m16:03:45.516345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:58449887-0963-45b4-b6e8-829d5f5f9e5b:europe-west1&page=queryresults
[0m16:03:45.517919 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:45.519268 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:45.519836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e9780>]}
[0m16:03:45.520206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c59db0>]}
[0m16:03:45.520553 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ........ [[32mCREATE VIEW (0 processed)[0m in 0.65s]
[0m16:03:45.520768 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m16:03:45.521164 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m16:03:45.521422 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m16:03:45.521594 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m16:03:45.521734 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m16:03:45.522318 [info ] [Thread-1 (]: 5 of 9 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m16:03:45.522481 [info ] [Thread-2 (]: 6 of 9 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m16:03:45.522943 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m16:03:45.523348 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m16:03:45.523458 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m16:03:45.523589 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m16:03:45.523715 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m16:03:45.523812 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m16:03:45.526177 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m16:03:45.530652 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:45.530954 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m16:03:45.536064 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m16:03:45.543898 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m16:03:45.544219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:45.544444 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:45.545366 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m16:03:45.545505 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m16:03:45.607760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:45.916969 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m16:03:45.918024 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m16:03:46.340345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a7f29c88-2281-4ab4-8148-d57469c92fa2:europe-west1&page=queryresults
[0m16:03:46.341690 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:46.342113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e9d50>]}
[0m16:03:46.342357 [info ] [Thread-1 (]: 5 of 9 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m16:03:46.342648 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m16:03:46.342783 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m16:03:46.342996 [info ] [Thread-1 (]: 7 of 9 START sql table model dbt_rsdun.downloads ............................... [RUN]
[0m16:03:46.343420 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m16:03:46.343530 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m16:03:46.343631 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m16:03:46.346385 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m16:03:46.347782 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:46.347944 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m16:03:46.355483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:46.673397 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m16:03:46.674395 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m16:03:47.780588 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:91b9ceb7-118e-4800-abc3-a7ff850d6cb6:europe-west1&page=queryresults
[0m16:03:47.782045 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:47.782601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f7d30>]}
[0m16:03:47.782911 [info ] [Thread-2 (]: 6 of 9 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 458.5 KB processed)[0m in 2.26s]
[0m16:03:47.783289 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m16:03:47.783466 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m16:03:47.783838 [info ] [Thread-2 (]: 8 of 9 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article .. [RUN]
[0m16:03:47.784447 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m16:03:47.784684 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m16:03:47.784889 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m16:03:47.788600 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m16:03:47.790003 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:47.790205 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m16:03:47.796926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:48.099269 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m16:03:48.100377 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m16:03:48.627895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:97fcc353-6a54-4e75-abc2-23f6fd34a40a:europe-west1&page=queryresults
[0m16:03:48.631859 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:48.632836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113119780>]}
[0m16:03:48.633371 [info ] [Thread-1 (]: 7 of 9 OK created sql table model dbt_rsdun.downloads .......................... [[32mCREATE TABLE (343.0 rows, 45.1 KB processed)[0m in 2.29s]
[0m16:03:48.633991 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m16:03:50.224252 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:12c4c43d-4837-4961-8adb-2d26bab28ecb:europe-west1&page=queryresults
[0m16:03:50.228055 [debug] [Thread-2 (]: finished collecting timing info
[0m16:03:50.229235 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c5a470>]}
[0m16:03:50.229972 [info ] [Thread-2 (]: 8 of 9 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.44s]
[0m16:03:50.230639 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m16:03:50.231421 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m16:03:50.231826 [info ] [Thread-1 (]: 9 of 9 START sql incremental model dbt_rsdun.articles_evidence ................. [RUN]
[0m16:03:50.232701 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m16:03:50.232897 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m16:03:50.233090 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m16:03:50.238313 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m16:03:50.240741 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:50.240953 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m16:03:50.244405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:50.551192 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m16:03:50.552300 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment

),

historical_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m16:03:52.702072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:78d00aa2-73cc-46d3-9853-7abf1d0261b2:europe-west1&page=queryresults
[0m16:03:52.705832 [debug] [Thread-1 (]: finished collecting timing info
[0m16:03:52.706771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c24b8ab-cef7-4c92-a569-5ec11c084ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135638b0>]}
[0m16:03:52.707289 [info ] [Thread-1 (]: 9 of 9 OK created sql incremental model dbt_rsdun.articles_evidence ............ [[32mMERGE (15.9k rows, 2.2 MB processed)[0m in 2.47s]
[0m16:03:52.707944 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m16:03:52.709876 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:03:52.710708 [info ] [MainThread]: 
[0m16:03:52.711041 [info ] [MainThread]: Finished running 5 view models, 3 incremental models, 1 table model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m16:03:52.711313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:52.711454 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m16:03:52.711588 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m16:03:52.725841 [info ] [MainThread]: 
[0m16:03:52.726144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:52.726377 [info ] [MainThread]: 
[0m16:03:52.726616 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m16:03:52.726923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11311aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113118d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e9e10>]}
[0m16:03:52.727140 [debug] [MainThread]: Flushing usage events


============================== 2022-12-15 14:43:10.194242 | 8e38007f-97bd-4992-934a-9d746e47b9fc ==============================
[0m14:43:10.194279 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:43:10.194983 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:43:10.195084 [debug] [MainThread]: Tracking: tracking
[0m14:43:10.210136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef1120>]}
[0m14:43:10.253465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 6 files changed.
[0m14:43:10.253695 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m14:43:10.253799 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m14:43:10.253981 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/schema.yml
[0m14:43:10.254139 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/backfills/schema.yml
[0m14:43:10.254371 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_android__production_events.community_viewed_article
[0m14:43:10.254449 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/sources.yml
[0m14:43:10.254826 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_ios__production_events.community_viewed_article
[0m14:43:10.254919 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_ios__production_events.viewed_article
[0m14:43:10.254991 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_ios__production_events/sources.yml
[0m14:43:10.255083 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:43:10.255166 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m14:43:10.262476 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m14:43:10.270968 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m14:43:10.271583 [debug] [MainThread]: 1603: static parser failed on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m14:43:10.273795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m14:43:10.275205 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m14:43:10.276653 [debug] [MainThread]: 1603: static parser failed on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:43:10.279397 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:43:10.279926 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m14:43:10.281259 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m14:43:10.282719 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m14:43:10.285165 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m14:43:10.373930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11426a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114269840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114268760>]}
[0m14:43:10.374153 [debug] [MainThread]: Flushing usage events
[0m14:43:10.964982 [error] [MainThread]: Encountered an error:
Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Model 'model.my_new_project.articles_evidence' (models/marts/articles_evidence.sql) depends on a node named 'stg_segment_ios__screens_article' which is disabled


============================== 2022-12-15 14:43:44.337295 | e63c3d52-2451-4d8b-8468-704834287dcd ==============================
[0m14:43:44.337333 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:43:44.339411 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:43:44.339609 [debug] [MainThread]: Tracking: tracking
[0m14:43:44.350203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108662410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108663460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108661120>]}
[0m14:43:44.388875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 6 files changed.
[0m14:43:44.389095 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m14:43:44.389208 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m14:43:44.389377 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/backfills/schema.yml
[0m14:43:44.389541 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/schema.yml
[0m14:43:44.390093 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_ios__production_events.community_viewed_article
[0m14:43:44.390176 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_ios__production_events.viewed_article
[0m14:43:44.390252 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_ios__production_events/sources.yml
[0m14:43:44.390460 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_segment_android__production_events.community_viewed_article
[0m14:43:44.390528 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/sources.yml
[0m14:43:44.390617 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m14:43:44.390693 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:43:44.397128 [debug] [MainThread]: 1603: static parser failed on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m14:43:44.405320 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m14:43:44.405914 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m14:43:44.408095 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m14:43:44.408628 [debug] [MainThread]: 1603: static parser failed on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:43:44.410988 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/backfills/articles_viewed_backfill_fall_2022.sql
[0m14:43:44.412459 [debug] [MainThread]: 1699: static parser successfully parsed marts/downloads.sql
[0m14:43:44.414098 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m14:43:44.415254 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m14:43:44.417369 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m14:43:44.417846 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m14:43:44.502413 [debug] [MainThread]: Test 'test.my_new_project.not_null_articles_viewed_backfill_fall_2022_original_timestamp.2a0861a663' (models/marts/backfills/schema.yml) depends on a node named 'articles_viewed_backfill_fall_2022' which is disabled
[0m14:43:44.502589 [debug] [MainThread]: Test 'test.my_new_project.not_null_articles_viewed_backfill_fall_2022_user_id.83bea0cd46' (models/marts/backfills/schema.yml) depends on a node named 'articles_viewed_backfill_fall_2022' which is disabled
[0m14:43:44.512541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m14:43:44.515761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ff2e0>]}
[0m14:43:44.522670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886b790>]}
[0m14:43:44.522870 [info ] [MainThread]: Found 11 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m14:43:44.523010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045923e0>]}
[0m14:43:44.523912 [info ] [MainThread]: 
[0m14:43:44.524259 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:43:44.524896 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:43:44.525035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:48.625758 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:43:48.626384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:49.256488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685cd90>]}
[0m14:43:49.257607 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:43:49.257955 [info ] [MainThread]: 
[0m14:43:49.263089 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:43:49.263301 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:43:49.263533 [info ] [Thread-1 (]: 1 of 11 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m14:43:49.263746 [info ] [Thread-2 (]: 2 of 11 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m14:43:49.264280 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:43:49.264906 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:43:49.265046 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:43:49.265206 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:43:49.265500 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:43:49.265657 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:43:49.268720 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:43:49.271241 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:43:49.272570 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:49.272726 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:49.272875 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:43:49.273032 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:43:49.300125 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:43:49.300573 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:43:49.305082 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:43:49.306007 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:43:49.306516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:49.345897 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:43:53.132699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e9328856-037a-4d31-8705-471e65672776:europe-west1&page=queryresults
[0m14:43:53.153666 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:53.154287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108632470>]}
[0m14:43:53.154655 [info ] [Thread-1 (]: 1 of 11 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 3.89s]
[0m14:43:53.155070 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:43:53.155242 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:43:53.155528 [info ] [Thread-1 (]: 3 of 11 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m14:43:53.156113 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:43:53.156254 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:43:53.156387 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:43:53.158146 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:43:53.159953 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:53.160083 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:43:53.162324 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:43:53.162750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:53.163746 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:43:55.936465 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:831ac856-9186-4dbc-b285-60572f4ed526:europe-west1&page=queryresults
[0m14:43:55.939438 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:55.940337 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108631960>]}
[0m14:43:55.940869 [info ] [Thread-2 (]: 2 of 11 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 6.68s]
[0m14:43:55.941487 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:43:55.941740 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:43:55.942242 [info ] [Thread-2 (]: 4 of 11 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m14:43:55.943064 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:43:55.943280 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:43:55.943469 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:43:55.945959 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:43:55.946768 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:55.946959 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:43:55.950123 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:43:55.950609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:55.951880 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:43:56.819867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6cb67dc6-46c8-45db-9499-43cc2a7a5deb:europe-west1&page=queryresults
[0m14:43:56.823521 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:56.824424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc8b20>]}
[0m14:43:56.824895 [info ] [Thread-1 (]: 3 of 11 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 3.67s]
[0m14:43:56.825425 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:43:56.825674 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:43:56.826071 [info ] [Thread-1 (]: 5 of 11 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:43:56.826942 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:43:56.827112 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:43:56.827274 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:43:56.830599 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:43:56.832146 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:56.832316 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:43:56.842429 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:43:56.842886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:56.843999 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m14:43:57.013172 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5e9003f3-693a-4fef-a212-15b6316d4f82:europe-west1&page=queryresults
[0m14:43:57.014596 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:57.015081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902f9d0>]}
[0m14:43:57.015351 [info ] [Thread-2 (]: 4 of 11 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:43:57.015638 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:43:57.015775 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m14:43:57.016168 [info ] [Thread-2 (]: 6 of 11 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m14:43:57.016822 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m14:43:57.016961 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m14:43:57.017070 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m14:43:57.020274 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m14:43:57.020759 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:57.020891 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m14:43:57.049202 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m14:43:57.049730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:57.050498 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`
    
    
    OPTIONS()
    as (
      

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



    );
  
[0m14:43:57.875963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9722d90e-bb82-4196-8ab3-f9a7ac560d3c:europe-west1&page=queryresults
[0m14:43:57.879090 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:57.880112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a4370>]}
[0m14:43:57.880596 [info ] [Thread-1 (]: 5 of 11 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m14:43:57.881153 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:43:57.881400 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:43:57.881791 [info ] [Thread-1 (]: 7 of 11 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:43:57.882304 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:43:57.882437 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:43:57.882541 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:43:57.885828 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:43:57.887266 [debug] [Thread-1 (]: finished collecting timing info
[0m14:43:57.887403 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:43:57.890010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:58.681210 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:43:58.683589 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m14:43:59.915475 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3c21a4ae-c9ad-4afd-bed8-c4f02d1b941d:europe-west1&page=queryresults
[0m14:43:59.919783 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:59.920772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109089540>]}
[0m14:43:59.921309 [info ] [Thread-2 (]: 6 of 11 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mCREATE TABLE (137.0 rows, 807.0 KB processed)[0m in 2.90s]
[0m14:43:59.921909 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m14:43:59.922214 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m14:43:59.922667 [info ] [Thread-2 (]: 8 of 11 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m14:43:59.923617 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m14:43:59.923854 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m14:43:59.924060 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m14:43:59.929295 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m14:43:59.930138 [debug] [Thread-2 (]: finished collecting timing info
[0m14:43:59.930326 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m14:43:59.944101 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m14:43:59.944569 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:59.945558 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`
    
    
    OPTIONS()
    as (
      

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



    );
  
[0m14:44:00.681911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a2198c11-a4fc-47a3-aad2-0300e1a1d81c:europe-west1&page=queryresults
[0m14:44:00.684442 [debug] [Thread-1 (]: finished collecting timing info
[0m14:44:00.685111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a4100>]}
[0m14:44:00.685512 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (1.0 rows, 458.9 KB processed)[0m in 2.80s]
[0m14:44:00.685944 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:44:00.686142 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m14:44:00.686486 [info ] [Thread-1 (]: 9 of 11 START sql table model dbt_rsdun.downloads .............................. [RUN]
[0m14:44:00.687138 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:44:00.687295 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m14:44:00.687438 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m14:44:00.690799 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:44:00.691765 [debug] [Thread-1 (]: finished collecting timing info
[0m14:44:00.691901 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m14:44:00.700945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:01.081179 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:44:01.083223 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:44:02.878980 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f3471a29-91db-4a3b-878c-36b25108771f:europe-west1&page=queryresults
[0m14:44:02.881463 [debug] [Thread-2 (]: finished collecting timing info
[0m14:44:02.882328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086327a0>]}
[0m14:44:02.882793 [info ] [Thread-2 (]: 8 of 11 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mCREATE TABLE (448.0 rows, 973.8 KB processed)[0m in 2.96s]
[0m14:44:02.883292 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m14:44:02.883507 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:44:02.883870 [info ] [Thread-2 (]: 10 of 11 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m14:44:02.884631 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:44:02.884828 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:44:02.885007 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:44:02.890050 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:44:02.893246 [debug] [Thread-2 (]: finished collecting timing info
[0m14:44:02.893408 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:44:02.896060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:03.296278 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:44:03.297247 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m14:44:03.810224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7e699630-6d12-4478-bbc6-22fb520fa398:europe-west1&page=queryresults
[0m14:44:03.811492 [debug] [Thread-1 (]: finished collecting timing info
[0m14:44:03.811911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086601c0>]}
[0m14:44:03.812159 [info ] [Thread-1 (]: 9 of 11 OK created sql table model dbt_rsdun.downloads ......................... [[32mCREATE TABLE (346.0 rows, 45.4 KB processed)[0m in 3.13s]
[0m14:44:03.812470 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m14:44:05.736643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e453eda8-24c7-4a8c-98eb-de9353edfab7:europe-west1&page=queryresults
[0m14:44:05.740456 [debug] [Thread-2 (]: finished collecting timing info
[0m14:44:05.741489 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc1630>]}
[0m14:44:05.742027 [info ] [Thread-2 (]: 10 of 11 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.86s]
[0m14:44:05.742597 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:44:05.743221 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m14:44:05.743753 [info ] [Thread-1 (]: 11 of 11 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m14:44:05.744577 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:44:05.744760 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:44:05.744928 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m14:44:05.751301 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:44:05.754221 [debug] [Thread-1 (]: finished collecting timing info
[0m14:44:05.754478 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m14:44:05.763566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:06.236320 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:44:06.237485 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

historic_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment

),

historical_mixpanel_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

current_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment

),

current_android_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historic_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_mixpanel_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_android_segment_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m14:44:08.252765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:60eb87d8-0c78-4200-bb41-7c734dad8e74:europe-west1&page=queryresults
[0m14:44:08.256996 [debug] [Thread-1 (]: finished collecting timing info
[0m14:44:08.257535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e63c3d52-2451-4d8b-8468-704834287dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892b4c0>]}
[0m14:44:08.257845 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mMERGE (16.4k rows, 2.3 MB processed)[0m in 2.51s]
[0m14:44:08.258174 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m14:44:08.259566 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:44:08.260157 [info ] [MainThread]: 
[0m14:44:08.260366 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m14:44:08.260517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:08.260591 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:44:08.260664 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m14:44:08.269390 [info ] [MainThread]: 
[0m14:44:08.269634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:08.269809 [info ] [MainThread]: 
[0m14:44:08.269943 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m14:44:08.270141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086327a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fc4c0>]}
[0m14:44:08.270317 [debug] [MainThread]: Flushing usage events


============================== 2022-12-15 14:49:45.730503 | 64809375-a03e-405a-8bff-8c5ce222f1c6 ==============================
[0m14:49:45.730548 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:49:45.733137 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:49:45.733270 [debug] [MainThread]: Tracking: tracking
[0m14:49:45.748499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f1150>]}
[0m14:49:45.790384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:49:45.790671 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m14:49:45.790803 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:49:45.798627 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m14:49:45.804375 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:49:45.808227 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:49:45.851849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d43b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109093ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109093eb0>]}
[0m14:49:45.852066 [debug] [MainThread]: Flushing usage events
[0m14:49:46.311315 [error] [MainThread]: Encountered an error:
Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Model 'model.my_new_project.articles_evidence' (models/marts/articles_evidence.sql) depends on a node named 'stg_segment_ios__viewed_article' which is disabled


============================== 2022-12-15 14:50:03.625425 | 3039fc52-fec6-4de0-89e3-7aa4b1f12775 ==============================
[0m14:50:03.625458 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:50:03.626143 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:50:03.626243 [debug] [MainThread]: Tracking: tracking
[0m14:50:03.634356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef93f0>]}
[0m14:50:03.674214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:50:03.674477 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:50:03.674604 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m14:50:03.681362 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:50:03.689340 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:50:03.690731 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m14:50:03.742262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m14:50:03.745433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03340>]}
[0m14:50:03.751363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812f580>]}
[0m14:50:03.751503 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m14:50:03.751634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad6620>]}
[0m14:50:03.752499 [info ] [MainThread]: 
[0m14:50:03.752821 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:50:03.753812 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:50:03.753939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:04.339550 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:50:04.340136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:04.700899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f4d60>]}
[0m14:50:04.702119 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:50:04.702523 [info ] [MainThread]: 
[0m14:50:04.708393 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:04.708692 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:50:04.709012 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m14:50:04.709308 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m14:50:04.710213 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:50:04.711200 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:50:04.711460 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:04.711689 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:50:04.711884 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:50:04.712033 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:50:04.715717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:50:04.721153 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:04.721509 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:04.732889 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:50:04.748343 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:50:04.748734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:04.749577 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:50:04.749682 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:04.788933 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:50:04.790470 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:50:04.790720 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:04.791298 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:50:05.760402 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b8b2d2d5-0a13-400a-9be4-3bb99a958865:europe-west1&page=queryresults
[0m14:50:05.762218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3b1a3eaf-c0c8-4b3e-91f6-4277853ff695:europe-west1&page=queryresults
[0m14:50:05.780385 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:05.781691 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:05.782297 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108291030>]}
[0m14:50:05.782661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082900d0>]}
[0m14:50:05.783021 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:50:05.783234 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m14:50:05.783626 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:50:05.783884 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:50:05.784055 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:05.784300 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:05.784683 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m14:50:05.784842 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m14:50:05.785278 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:50:05.785663 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:50:05.785783 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:05.785894 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:05.786012 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:05.786105 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:05.787713 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:50:05.788939 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:50:05.791266 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:05.791413 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:05.791506 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:05.791610 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:05.793664 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:50:05.795562 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:50:05.795981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:05.796149 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:05.797177 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:50:05.797925 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:50:06.696142 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23eac261-f941-47c0-9115-72f9830d1e7b:europe-west1&page=queryresults
[0m14:50:06.697512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bb94791e-8396-47af-a73c-91ad7cc1d957:europe-west1&page=queryresults
[0m14:50:06.700224 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:06.702013 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:06.702746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f5750>]}
[0m14:50:06.703302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d9990>]}
[0m14:50:06.703753 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m14:50:06.704069 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m14:50:06.704571 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:50:06.704997 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:50:06.705240 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:06.705689 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m14:50:06.706036 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:50:06.706421 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m14:50:06.707089 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:50:06.707627 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m14:50:06.707789 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:06.707916 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m14:50:06.708062 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:06.708181 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m14:50:06.714721 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:50:06.719719 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m14:50:06.720916 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:06.721019 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:06.721149 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:06.721279 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m14:50:06.723383 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:50:06.743769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:06.783983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:06.784664 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m14:50:07.340996 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m14:50:07.342072 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m14:50:07.694001 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e3931796-88e6-4b15-9c1a-39849d519158:europe-west1&page=queryresults
[0m14:50:07.697518 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:07.698431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d8160>]}
[0m14:50:07.698874 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m14:50:07.699402 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:50:07.699674 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:07.700093 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:50:07.701049 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:50:07.701279 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:07.701455 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:07.706765 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:50:07.707638 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:07.707818 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:07.714838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:08.267654 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:50:08.268098 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m14:50:09.620233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4c5d6f10-8bf6-46f9-81c6-622f3c919264:europe-west1&page=queryresults
[0m14:50:09.624120 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:09.624894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108387970>]}
[0m14:50:09.625334 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 950.2 KB processed)[0m in 2.92s]
[0m14:50:09.625841 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m14:50:09.626067 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m14:50:09.626421 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m14:50:09.627209 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m14:50:09.627407 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m14:50:09.627580 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m14:50:09.632295 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m14:50:09.633351 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:09.633510 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m14:50:09.636073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:10.154547 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m14:50:10.155145 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m14:50:10.806021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d0b891c7-f963-439f-94b8-4a032e55abd5:europe-west1&page=queryresults
[0m14:50:10.808749 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:10.809617 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108382e60>]}
[0m14:50:10.810063 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 458.9 KB processed)[0m in 3.11s]
[0m14:50:10.810567 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:50:10.810794 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m14:50:10.811135 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m14:50:10.811904 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m14:50:10.812095 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m14:50:10.812270 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m14:50:10.817431 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m14:50:10.819890 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:10.820071 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m14:50:10.835796 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m14:50:10.836623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:10.837611 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer, article_id
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


    );
  
[0m14:50:11.895472 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: article_id at [14:76]')
[0m14:50:12.302905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:eee04554-a156-433f-8d0a-ca1428359e91:europe-west1&page=queryresults
[0m14:50:12.305005 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:12.305401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108382a70>]}
[0m14:50:12.305600 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.1 MB processed)[0m in 2.68s]
[0m14:50:12.305827 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m14:50:12.305930 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m14:50:12.306095 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m14:50:12.306441 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:50:12.306521 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m14:50:12.306600 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m14:50:12.308403 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:50:12.309687 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:12.309774 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m14:50:12.318768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:12.706106 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:50:12.708398 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:50:12.841177 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:75d4e7e9-6ede-48f0-8127-37da051b3b54&page=queryresults
[0m14:50:12.842882 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:12.844121 [debug] [Thread-2 (]: Database Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)
  Unrecognized name: article_id at [14:76]
  compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:50:12.844701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b1a20>]}
[0m14:50:12.845268 [error] [Thread-2 (]: 9 of 12 ERROR creating sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[31mERROR[0m in 2.03s]
[0m14:50:12.845868 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m14:50:12.846162 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:50:12.846793 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m14:50:12.847864 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:50:12.848067 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:50:12.848250 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:50:12.858480 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:50:12.861094 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:12.861273 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:50:12.864211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:13.507331 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:50:13.508270 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m14:50:15.066416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9664217c-3716-47d4-b80c-c67aa3f95917:europe-west1&page=queryresults
[0m14:50:15.070487 [debug] [Thread-1 (]: finished collecting timing info
[0m14:50:15.071147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080daf50>]}
[0m14:50:15.071390 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (346.0 rows, 45.4 KB processed)[0m in 2.76s]
[0m14:50:15.071654 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m14:50:15.857047 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:19d7d9fb-3190-4d12-87ed-ac87d46feb38:europe-west1&page=queryresults
[0m14:50:15.859779 [debug] [Thread-2 (]: finished collecting timing info
[0m14:50:15.860690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3039fc52-fec6-4de0-89e3-7aa4b1f12775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080dae30>]}
[0m14:50:15.861130 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 3.01s]
[0m14:50:15.861645 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:50:15.862452 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m14:50:15.862748 [info ] [Thread-1 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m14:50:15.863262 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m14:50:15.864727 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:50:15.865406 [info ] [MainThread]: 
[0m14:50:15.865711 [info ] [MainThread]: Finished running 5 view models, 6 incremental models, 1 table model in 0 hours 0 minutes and 12.11 seconds (12.11s).
[0m14:50:15.865970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:15.866106 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m14:50:15.866233 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m14:50:15.878276 [info ] [MainThread]: 
[0m14:50:15.878595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:15.878800 [info ] [MainThread]: 
[0m14:50:15.878978 [error] [MainThread]: [33mDatabase Error in model stg_segment_ios__viewed_article (models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql)[0m
[0m14:50:15.879153 [error] [MainThread]:   Unrecognized name: article_id at [14:76]
[0m14:50:15.879321 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:50:15.879503 [info ] [MainThread]: 
[0m14:50:15.879679 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m14:50:15.879916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108151fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046beb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03310>]}
[0m14:50:15.880118 [debug] [MainThread]: Flushing usage events


============================== 2022-12-15 14:51:39.453443 | cb801e1c-10a2-49f9-8dc9-f4ff12e076ae ==============================
[0m14:51:39.453483 [info ] [MainThread]: Running with dbt=1.3.1
[0m14:51:39.454374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:51:39.454489 [debug] [MainThread]: Tracking: tracking
[0m14:51:39.464251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d02560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d035b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d01270>]}
[0m14:51:39.505315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:39.505604 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:51:39.512860 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:51:39.520949 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m14:51:39.562313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m14:51:39.565627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7e500>]}
[0m14:51:39.576677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee1030>]}
[0m14:51:39.576903 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m14:51:39.577032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee1000>]}
[0m14:51:39.577909 [info ] [MainThread]: 
[0m14:51:39.578223 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:51:39.578952 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m14:51:39.579134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:40.280100 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m14:51:40.280667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:40.779047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efcd30>]}
[0m14:51:40.780492 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:51:40.780937 [info ] [MainThread]: 
[0m14:51:40.787278 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m14:51:40.787530 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m14:51:40.787797 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m14:51:40.788085 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m14:51:40.788755 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m14:51:40.789394 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m14:51:40.789599 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m14:51:40.789789 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m14:51:40.789977 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m14:51:40.790153 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m14:51:40.793090 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:51:40.795043 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:51:40.796196 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:40.796309 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:40.796388 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m14:51:40.796468 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m14:51:40.818942 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m14:51:40.822645 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:51:40.824753 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m14:51:40.825624 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m14:51:40.867027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:40.867807 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m14:51:41.418787 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2cf06aa7-1d33-4815-9f3b-c72be141a01b:europe-west1&page=queryresults
[0m14:51:41.432178 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:41.432684 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb7940>]}
[0m14:51:41.433092 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m14:51:41.433568 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m14:51:41.433877 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:51:41.434202 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m14:51:41.434663 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:51:41.434779 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:51:41.434882 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:51:41.436150 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:51:41.437045 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:41.437170 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:51:41.439201 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m14:51:41.439578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:41.440533 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m14:51:41.531452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:88a49ddb-9506-40cf-9ae5-2fd5445c7332:europe-west1&page=queryresults
[0m14:51:41.532454 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:41.532761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080707c0>]}
[0m14:51:41.532946 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m14:51:41.533164 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m14:51:41.533264 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:51:41.533370 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m14:51:41.533995 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:51:41.534186 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m14:51:41.534301 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m14:51:41.535335 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:51:41.535622 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:41.535713 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m14:51:41.537214 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m14:51:41.537450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:41.538139 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m14:51:42.321774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7b764e16-4e56-4b34-999e-ee31b4834376:europe-west1&page=queryresults
[0m14:51:42.325026 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:42.325926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f84940>]}
[0m14:51:42.326382 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m14:51:42.326916 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m14:51:42.327128 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:51:42.327518 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m14:51:42.328476 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:51:42.328684 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:51:42.328854 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m14:51:42.331903 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:51:42.332737 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:42.332889 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:51:42.338615 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:523d6eff-6449-49f4-a943-6acae61b1e39:europe-west1&page=queryresults
[0m14:51:42.339696 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:42.340205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f85b10>]}
[0m14:51:42.340584 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m14:51:42.342583 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m14:51:42.342992 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m14:51:42.343349 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m14:51:42.343684 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m14:51:42.344214 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m14:51:42.344350 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m14:51:42.344514 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m14:51:42.344626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:42.353268 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m14:51:42.354762 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m14:51:42.354995 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:42.397547 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m14:51:42.414127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:42.903879 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m14:51:42.904495 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m14:51:43.103504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:695ce4f8-6e1a-4d4d-a9d0-a8e956ff4fae:europe-west1&page=queryresults
[0m14:51:43.106301 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:43.107162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f84d90>]}
[0m14:51:43.107694 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m14:51:43.108305 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m14:51:43.108567 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:51:43.108930 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m14:51:43.109669 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:51:43.109856 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:51:43.110039 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:51:43.115255 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:51:43.117762 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:43.117966 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:51:43.120991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:43.588467 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m14:51:43.589608 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m14:51:44.972762 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:faebe509-a279-4fe8-90d1-f2755712abea:europe-west1&page=queryresults
[0m14:51:44.975931 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:44.976877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f76f20>]}
[0m14:51:44.977403 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 962.1 KB processed)[0m in 2.63s]
[0m14:51:44.977914 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m14:51:44.978135 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m14:51:44.978374 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m14:51:44.979705 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m14:51:44.979952 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m14:51:44.980137 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m14:51:44.985291 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m14:51:44.986045 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:44.986208 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m14:51:44.996452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:45.364791 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m14:51:45.365715 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m14:51:45.473151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dc51b792-2e46-48d5-a300-692ada50ae5a:europe-west1&page=queryresults
[0m14:51:45.475413 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:45.476127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108080910>]}
[0m14:51:45.476416 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 458.9 KB processed)[0m in 2.37s]
[0m14:51:45.476659 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m14:51:45.476762 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m14:51:45.476873 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m14:51:45.477881 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m14:51:45.478111 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m14:51:45.478284 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m14:51:45.482763 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m14:51:45.483936 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:45.484104 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m14:51:45.493764 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m14:51:45.494195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:45.494927 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


    );
  
[0m14:51:47.291074 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4ebff3eb-0570-4d6c-9e57-4d037b718481:europe-west1&page=queryresults
[0m14:51:47.293548 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:47.294330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108080700>]}
[0m14:51:47.294772 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.1 MB processed)[0m in 2.32s]
[0m14:51:47.295258 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m14:51:47.295470 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m14:51:47.295814 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m14:51:47.296572 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m14:51:47.296765 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m14:51:47.296940 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m14:51:47.301569 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m14:51:47.302725 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:47.302898 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m14:51:47.313011 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:47.776490 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m14:51:47.778083 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m14:51:48.119059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f3b3c7aa-1bb6-4d20-912b-f049f8a071c9:europe-west1&page=queryresults
[0m14:51:48.123471 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:48.124451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108152830>]}
[0m14:51:48.124947 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mCREATE TABLE (14.0 rows, 1.7 KB processed)[0m in 2.65s]
[0m14:51:48.125795 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m14:51:48.126079 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:51:48.126940 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m14:51:48.128259 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:51:48.128572 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:51:48.128755 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:51:48.133388 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:51:48.134932 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:48.135185 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:51:48.138145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:48.520948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m14:51:48.522230 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m14:51:49.817672 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:489ae55d-8a44-4bb5-8355-6b06443b0234:europe-west1&page=queryresults
[0m14:51:49.820558 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:49.821138 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819f220>]}
[0m14:51:49.821396 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (346.0 rows, 45.4 KB processed)[0m in 2.52s]
[0m14:51:49.821723 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m14:51:50.697840 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5c78efd3-a178-4459-a079-9136468c896a:europe-west1&page=queryresults
[0m14:51:50.701067 [debug] [Thread-1 (]: finished collecting timing info
[0m14:51:50.701977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108193820>]}
[0m14:51:50.702413 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.57s]
[0m14:51:50.702929 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m14:51:50.703924 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m14:51:50.704399 [info ] [Thread-2 (]: 12 of 12 START sql incremental model dbt_rsdun.articles_evidence ............... [RUN]
[0m14:51:50.705184 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m14:51:50.705370 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m14:51:50.705548 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m14:51:50.715449 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m14:51:50.717383 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:50.717539 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m14:51:50.720116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:51.270760 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m14:51:51.272017 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`articles_evidence` as DBT_INTERNAL_DEST
        using (
          

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

historical_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment

),

historical_mixpanel_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

current_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment

),

current_android_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_mixpanel_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_android_segment_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`, `article_id`)


    
[0m14:51:53.533982 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:84346108-0e6f-495c-a0a1-79ad49df5c7e:europe-west1&page=queryresults
[0m14:51:53.536417 [debug] [Thread-2 (]: finished collecting timing info
[0m14:51:53.537329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb801e1c-10a2-49f9-8dc9-f4ff12e076ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108192f20>]}
[0m14:51:53.537850 [info ] [Thread-2 (]: 12 of 12 OK created sql incremental model dbt_rsdun.articles_evidence .......... [[32mMERGE (16.5k rows, 2.3 MB processed)[0m in 2.83s]
[0m14:51:53.538475 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m14:51:53.540430 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:51:53.541142 [info ] [MainThread]: 
[0m14:51:53.541444 [info ] [MainThread]: Finished running 5 view models, 6 incremental models, 1 table model in 0 hours 0 minutes and 13.96 seconds (13.96s).
[0m14:51:53.541709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:53.541847 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m14:51:53.541975 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m14:51:53.554126 [info ] [MainThread]: 
[0m14:51:53.554469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:53.554671 [info ] [MainThread]: 
[0m14:51:53.554815 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m14:51:53.555009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f761d0>]}
[0m14:51:53.555162 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 09:41:02.259194 | 017cd20e-7fb3-4a11-8e28-d41e687a04b1 ==============================
[0m09:41:02.259229 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:41:02.259884 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:41:02.259997 [debug] [MainThread]: Tracking: tracking
[0m09:41:02.279819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f5120>]}
[0m09:41:02.323925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:41:02.324210 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m09:41:02.331954 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m09:41:02.389429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m09:41:02.392679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b591b40>]}
[0m09:41:02.400030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b533f40>]}
[0m09:41:02.400244 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m09:41:02.400393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b512530>]}
[0m09:41:02.401384 [info ] [MainThread]: 
[0m09:41:02.401791 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:41:02.402480 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:41:02.402596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:02.966398 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:41:02.966922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:03.467567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108690d90>]}
[0m09:41:03.468830 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:41:03.469263 [info ] [MainThread]: 
[0m09:41:03.475876 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:03.476102 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:41:03.476447 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:41:03.476662 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:41:03.477276 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:41:03.477841 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:41:03.478008 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:03.478377 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:41:03.478735 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:41:03.478972 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:41:03.482367 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:41:03.486964 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:03.487200 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:03.497240 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:41:03.512671 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:41:03.513331 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:03.513452 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:41:03.515343 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:41:03.515534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:03.515712 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:41:03.516486 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:41:03.517611 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:41:04.522805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3e938b5b-3e8e-4812-9f80-383f43483996:europe-west1&page=queryresults
[0m09:41:04.524363 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ec747c83-04dc-4b83-b2c5-41a344e56ee8:europe-west1&page=queryresults
[0m09:41:04.542674 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:04.543987 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:04.544561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97ad70>]}
[0m09:41:04.544957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b2c50>]}
[0m09:41:04.545313 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:41:04.545537 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m09:41:04.545912 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:04.546202 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:41:04.546375 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:04.546858 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:04.547336 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m09:41:04.547529 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m09:41:04.547965 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:41:04.548433 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:41:04.548570 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:04.548674 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:04.548799 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:04.548895 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:04.550543 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:41:04.551529 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:41:04.554778 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:04.554899 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:04.555001 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:04.555101 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:04.557095 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:41:04.559129 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:41:04.559845 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:04.560051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:04.561023 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m09:41:04.602979 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m09:41:05.306956 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8d40e08a-796e-4452-8f02-597b58312d8a:europe-west1&page=queryresults
[0m09:41:05.310269 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:05.311456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e30d0>]}
[0m09:41:05.312102 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m09:41:05.312673 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:05.312930 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:05.313228 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:41:05.314246 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:41:05.314496 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:05.314697 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:05.322432 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:41:05.324586 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:05.324782 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:05.327750 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:41:05.328208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:05.329396 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m09:41:05.558911 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f21a33d6-a4ec-4eb7-96ef-4aec3a01cb5a:europe-west1&page=queryresults
[0m09:41:05.561299 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:05.561982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ae380>]}
[0m09:41:05.562381 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m09:41:05.562797 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:05.562974 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:41:05.563265 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:41:05.563838 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:41:05.564007 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:41:05.564384 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:41:05.573798 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:41:05.576004 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:05.576235 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:41:05.597968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:05.971246 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:41:05.973142 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:41:06.614357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6d304c5d-e855-4bf5-be18-a8a4c7cef860:europe-west1&page=queryresults
[0m09:41:06.619155 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:06.619902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e34df0>]}
[0m09:41:06.620291 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m09:41:06.620735 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:06.620919 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:06.621227 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:41:06.621883 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:41:06.622036 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:06.622174 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:06.626453 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:41:06.627012 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:06.627155 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:06.632319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:07.011088 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:41:07.014483 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:41:08.828080 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:08e96b16-f545-4e7b-a1bb-0d4d165e9e24:europe-west1&page=queryresults
[0m09:41:08.830475 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:08.831356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b0d00>]}
[0m09:41:08.831883 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1002.3 KB processed)[0m in 3.27s]
[0m09:41:08.832400 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:41:08.832631 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:08.833005 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:41:08.833805 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:41:08.833996 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:08.834170 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:41:08.839035 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:41:08.839896 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:08.840073 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:08.843008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:09.242311 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:41:09.244457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bc7258f7-f3a6-4102-8c19-67866127e052:europe-west1&page=queryresults
[0m09:41:09.246943 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:09.247794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a45c610>]}
[0m09:41:09.248239 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (9.0 rows, 461.9 KB processed)[0m in 2.63s]
[0m09:41:09.248490 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:41:09.249019 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:09.250276 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:09.250717 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:41:09.251390 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:41:09.251571 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:09.251744 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:09.256605 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:41:09.258543 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:09.258774 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:09.261611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:09.760817 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:41:09.765054 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:41:11.333484 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fc60344e-504b-415f-b200-a546dfe92710:europe-west1&page=queryresults
[0m09:41:11.336348 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:11.337273 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b975570>]}
[0m09:41:11.337737 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.3 MB processed)[0m in 2.50s]
[0m09:41:11.338259 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:11.338474 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:41:11.338795 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:41:11.339484 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:41:11.339668 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:41:11.339827 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:41:11.343940 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:41:11.345940 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:11.346121 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:41:11.355734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:11.691938 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:41:11.692737 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:41:12.001773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fccc2621-a63d-4412-831f-c633053160fc:europe-west1&page=queryresults
[0m09:41:12.004081 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:12.004891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9708b0>]}
[0m09:41:12.005362 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.7 KB processed)[0m in 2.75s]
[0m09:41:12.005879 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:12.006105 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:12.006481 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:41:12.007301 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:41:12.007514 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:12.007700 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:12.018045 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:41:12.019821 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:12.020027 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:12.022896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:12.432377 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:41:12.433723 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:41:14.390639 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a5c9e593-148f-4269-ae1c-18da613787d2:europe-west1&page=queryresults
[0m09:41:14.393940 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:14.394561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10babb2b0>]}
[0m09:41:14.394831 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (350.0 rows, 45.8 KB processed)[0m in 3.06s]
[0m09:41:14.395120 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:41:14.763318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:408c21db-1cd2-4d16-a159-fcf6b84c88ab:europe-west1&page=queryresults
[0m09:41:14.766328 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:14.767290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b57b370>]}
[0m09:41:14.767848 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.76s]
[0m09:41:14.768454 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:14.769627 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:41:14.770202 [info ] [Thread-2 (]: 12 of 12 START sql view model dbt_rsdun.articles_evidence ...................... [RUN]
[0m09:41:14.771075 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:41:14.771277 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:41:14.771453 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m09:41:14.777252 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:41:14.778764 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:14.779143 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m09:41:14.784795 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:14.785340 [debug] [Thread-2 (]: Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m09:41:14.785561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '017cd20e-7fb3-4a11-8e28-d41e687a04b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b18ca90>]}
[0m09:41:14.785835 [error] [Thread-2 (]: 12 of 12 ERROR creating sql view model dbt_rsdun.articles_evidence ............. [[31mERROR[0m in 0.01s]
[0m09:41:14.786185 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:41:14.787336 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:41:14.787895 [info ] [MainThread]: 
[0m09:41:14.788137 [info ] [MainThread]: Finished running 6 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 12.39 seconds (12.39s).
[0m09:41:14.788334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:14.788439 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:41:14.788537 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:41:14.801091 [info ] [MainThread]: 
[0m09:41:14.801373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:41:14.801572 [info ] [MainThread]: 
[0m09:41:14.801718 [error] [MainThread]: [33mCompilation Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m09:41:14.801863 [error] [MainThread]:   Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m09:41:14.801999 [error] [MainThread]:   
[0m09:41:14.802129 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m09:41:14.802260 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m09:41:14.802391 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m09:41:14.802520 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m09:41:14.802648 [error] [MainThread]:   > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m09:41:14.802793 [info ] [MainThread]: 
[0m09:41:14.802931 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m09:41:14.803131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b979090>]}
[0m09:41:14.803296 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 09:41:46.505233 | a13953b7-8af0-47bc-95a3-308b29b63100 ==============================
[0m09:41:46.505255 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:41:46.505797 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:41:46.505889 [debug] [MainThread]: Tracking: tracking
[0m09:41:46.519126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bd570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bcf40>]}
[0m09:41:46.560999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:41:46.561148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:41:46.561509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m09:41:46.565179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c91bd0>]}
[0m09:41:46.571715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56800>]}
[0m09:41:46.571922 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m09:41:46.572063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56830>]}
[0m09:41:46.573107 [info ] [MainThread]: 
[0m09:41:46.573487 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:41:46.574199 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:41:46.574347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:47.152458 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:41:47.153035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:47.663522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab8dc0>]}
[0m09:41:47.664603 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:41:47.665014 [info ] [MainThread]: 
[0m09:41:47.669069 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:47.669243 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:41:47.669497 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:41:47.669638 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:41:47.670070 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:41:47.670834 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:41:47.670970 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:47.671086 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:41:47.671204 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:41:47.671295 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:41:47.673340 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:41:47.675040 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:41:47.676061 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:47.676236 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:47.676373 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:47.676510 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:41:47.697765 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:41:47.699432 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:41:47.699942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:47.700115 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:41:47.701099 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:41:47.744311 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:41:48.566894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:645a911e-a7fe-4e6b-a3ef-25bf2fcae1b7:europe-west1&page=queryresults
[0m09:41:48.588174 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:48.588872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1a110>]}
[0m09:41:48.589319 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m09:41:48.589763 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:41:48.589954 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:48.590199 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m09:41:48.590766 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:41:48.590913 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:48.591047 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:48.592468 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:41:48.593787 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:48.593935 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:48.596245 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:41:48.596646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:48.597644 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m09:41:48.686831 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0688cc97-8cb2-4466-a509-f218f93f67a7:europe-west1&page=queryresults
[0m09:41:48.688051 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:48.688394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1bb80>]}
[0m09:41:48.688595 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m09:41:48.688832 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:41:48.688939 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:48.689128 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m09:41:48.689647 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:41:48.689752 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:48.689842 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:48.691033 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:41:48.691508 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:48.691604 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:48.693293 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:41:48.693753 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:48.694561 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m09:41:49.274508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e68e16dd-48f7-4e9e-abcd-aff47e9189f5:europe-west1&page=queryresults
[0m09:41:49.277264 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:49.278126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9efe0>]}
[0m09:41:49.278628 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m09:41:49.279127 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:41:49.279357 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:49.279702 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:41:49.281356 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:41:49.281665 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:49.282783 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:49.286699 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:41:49.289163 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:49.289393 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:49.292323 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:41:49.292828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:49.293987 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m09:41:49.372912 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c155091b-7593-4937-9f3e-3e9af92406d0:europe-west1&page=queryresults
[0m09:41:49.373964 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:49.374300 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56440>]}
[0m09:41:49.374485 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m09:41:49.374701 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:41:49.374801 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:41:49.374907 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:41:49.375398 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:41:49.375577 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:41:49.375702 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:41:49.388115 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:41:49.390174 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:49.390271 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:41:49.405236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:49.889175 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:41:49.889624 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:41:50.334656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23070e7d-54d3-4803-a95e-66e3369034bf:europe-west1&page=queryresults
[0m09:41:50.339661 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:50.340889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd8940>]}
[0m09:41:50.341613 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m09:41:50.342303 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:41:50.342609 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:50.343033 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:41:50.343899 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:41:50.344093 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:50.344276 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:50.349739 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:41:50.350626 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:50.350802 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:50.353960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:50.906033 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:41:50.906492 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:41:52.101258 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2c50168f-bc12-4506-82b5-8f5fc3fbd8ef:europe-west1&page=queryresults
[0m09:41:52.102321 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:52.102713 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7ee00>]}
[0m09:41:52.102932 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1002.3 KB processed)[0m in 2.73s]
[0m09:41:52.103190 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:41:52.103318 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:52.103521 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:41:52.103998 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:41:52.104124 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:52.104233 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:41:52.106900 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:41:52.107289 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:52.107389 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:52.109062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:52.484056 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:41:52.484484 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:41:52.865951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:263ef6a3-ff0d-4d23-bf47-22a54053d61d:europe-west1&page=queryresults
[0m09:41:52.866921 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:52.867276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d23ee0>]}
[0m09:41:52.867491 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 461.9 KB processed)[0m in 2.52s]
[0m09:41:52.867746 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:41:52.867859 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:52.867973 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:41:52.868426 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:41:52.868559 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:52.868667 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:52.872147 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:41:52.873996 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:52.874095 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:52.875587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:53.194875 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:41:53.195370 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:41:54.660786 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4977e002-91d1-459f-b034-35f534f75e6f:europe-west1&page=queryresults
[0m09:41:54.662478 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:54.662935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56440>]}
[0m09:41:54.663192 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.3 MB processed)[0m in 2.56s]
[0m09:41:54.663484 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:41:54.663619 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:41:54.663841 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:41:54.664352 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:41:54.664481 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:41:54.664596 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:41:54.667263 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:41:54.667957 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:54.668069 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:41:54.675404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:41:55.003601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7bdb9616-cb7f-491f-9c2b-3fda15e54095:europe-west1&page=queryresults
[0m09:41:55.004614 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:55.004992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da1e10>]}
[0m09:41:55.005202 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.7 KB processed)[0m in 2.14s]
[0m09:41:55.005425 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:41:55.005529 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:55.005749 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:41:55.006215 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:41:55.006310 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:55.006388 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:55.008557 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:41:55.009838 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:55.009976 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:55.011535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:55.254301 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:41:55.254898 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:41:55.461069 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:41:55.461626 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:41:57.487899 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:26793c63-2516-40bb-88a8-a120b2a0d467:europe-west1&page=queryresults
[0m09:41:57.494082 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:57.494372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e76a680>]}
[0m09:41:57.494548 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (350.0 rows, 45.8 KB processed)[0m in 2.83s]
[0m09:41:57.494749 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:41:57.730072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d520833d-1c7c-4bf5-8f04-c70b48b41936:europe-west1&page=queryresults
[0m09:41:57.731552 [debug] [Thread-1 (]: finished collecting timing info
[0m09:41:57.732037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e771ea0>]}
[0m09:41:57.732348 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.73s]
[0m09:41:57.732673 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:41:57.733202 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:41:57.733781 [info ] [Thread-2 (]: 12 of 12 START sql view model dbt_rsdun.articles_evidence ...................... [RUN]
[0m09:41:57.734346 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:41:57.734449 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:41:57.734547 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m09:41:57.738932 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:41:57.739679 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:57.739807 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m09:41:57.743252 [debug] [Thread-2 (]: finished collecting timing info
[0m09:41:57.743603 [debug] [Thread-2 (]: Compilation Error in model articles_evidence (models/marts/articles_evidence.sql)
  Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m09:41:57.743746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a13953b7-8af0-47bc-95a3-308b29b63100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e770820>]}
[0m09:41:57.743931 [error] [Thread-2 (]: 12 of 12 ERROR creating sql view model dbt_rsdun.articles_evidence ............. [[31mERROR[0m in 0.01s]
[0m09:41:57.744162 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:41:57.744944 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:41:57.745246 [info ] [MainThread]: 
[0m09:41:57.745389 [info ] [MainThread]: Finished running 6 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 11.17 seconds (11.17s).
[0m09:41:57.745559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:57.745656 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:41:57.745748 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:41:57.752510 [info ] [MainThread]: 
[0m09:41:57.752745 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:41:57.752932 [info ] [MainThread]: 
[0m09:41:57.753077 [error] [MainThread]: [33mCompilation Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m09:41:57.753217 [error] [MainThread]:   Trying to create view `wawa-83630`.`dbt_rsdun`.`articles_evidence`, but it currently exists as a table. Either drop `wawa-83630`.`dbt_rsdun`.`articles_evidence` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m09:41:57.753353 [error] [MainThread]:   
[0m09:41:57.753484 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m09:41:57.753613 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m09:41:57.753742 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m09:41:57.753874 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m09:41:57.754004 [error] [MainThread]:   > called by model articles_evidence (models/marts/articles_evidence.sql)
[0m09:41:57.754154 [info ] [MainThread]: 
[0m09:41:57.754294 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m09:41:57.754495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f27a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2a680>]}
[0m09:41:57.754658 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 09:42:09.239972 | c133eabf-323c-4467-9195-868b954b26c8 ==============================
[0m09:42:09.240012 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:42:09.241009 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:42:09.243308 [debug] [MainThread]: Tracking: tracking
[0m09:42:09.253208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f25f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f1300>]}
[0m09:42:09.293920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:42:09.294227 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m09:42:09.300945 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m09:42:09.358938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m09:42:09.362409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d5ab0>]}
[0m09:42:09.368962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f7c0>]}
[0m09:42:09.369141 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m09:42:09.369271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107412920>]}
[0m09:42:09.370191 [info ] [MainThread]: 
[0m09:42:09.370581 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:42:09.371324 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:42:09.371460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:09.952420 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:42:09.952644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:10.279473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104878d90>]}
[0m09:42:10.279958 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:42:10.280123 [info ] [MainThread]: 
[0m09:42:10.283574 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:42:10.283709 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:42:10.283935 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:42:10.284078 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:42:10.284517 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:42:10.284971 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:42:10.285112 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:42:10.285206 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:42:10.285297 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:42:10.285369 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:42:10.287035 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:42:10.289824 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:10.289927 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:42:10.305110 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:42:10.310609 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:42:10.311092 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:10.311231 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:42:10.311340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:10.313037 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:42:10.313784 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:42:10.350162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:42:10.350934 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:42:11.155338 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fe1657c2-cc70-412e-b991-e45f72a5752d:europe-west1&page=queryresults
[0m09:42:11.163496 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:11.163892 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074935e0>]}
[0m09:42:11.164081 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m09:42:11.164291 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:42:11.164378 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:42:11.164476 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m09:42:11.165086 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:42:11.165204 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:42:11.165282 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:42:11.166180 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:42:11.166431 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:11.166503 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:42:11.167859 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:42:11.168044 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:11.168668 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m09:42:11.205812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c4c24dd5-0640-4f11-987a-9392a1af403c:europe-west1&page=queryresults
[0m09:42:11.206890 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:11.207322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744d270>]}
[0m09:42:11.207758 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m09:42:11.207974 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:42:11.208065 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:42:11.208267 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m09:42:11.208593 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:42:11.208743 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:42:11.208842 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:42:11.209886 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:42:11.210418 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:11.210532 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:42:11.212172 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:42:11.212480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:11.213130 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m09:42:11.927995 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b2627022-2f62-4dda-b3da-a77963d84c21:europe-west1&page=queryresults
[0m09:42:11.932969 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:11.934197 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c6980>]}
[0m09:42:11.934778 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m09:42:11.935583 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:42:11.935942 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:42:11.936337 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:42:11.937484 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:42:11.937814 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:42:11.938093 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:42:11.951613 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:42:11.952068 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:11.952170 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:42:11.953960 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:42:11.954247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:11.954998 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m09:42:12.116639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4b117383-7623-49bd-aa4d-95dd34f51433:europe-west1&page=queryresults
[0m09:42:12.117738 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:12.118089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107574b20>]}
[0m09:42:12.118301 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m09:42:12.118535 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:42:12.118641 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:42:12.118823 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:42:12.119626 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:42:12.119940 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:42:12.120075 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:42:12.130680 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:42:12.131398 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:12.131534 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:42:12.152576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:12.476066 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:42:12.476586 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:42:12.869232 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e0ea9256-0b9e-4a54-870a-eb0128225b56:europe-west1&page=queryresults
[0m09:42:12.873926 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:12.875333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107574c40>]}
[0m09:42:12.876103 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m09:42:12.877152 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:42:12.877552 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:42:12.877968 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:42:12.879219 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:42:12.879567 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:42:12.879857 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:42:12.887959 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:42:12.888675 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:12.888814 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:42:12.892926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:13.300137 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:42:13.301761 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:42:14.887145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:298259e2-802c-45a9-a104-9316a246d840:europe-west1&page=queryresults
[0m09:42:14.894382 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:14.894871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d1a80>]}
[0m09:42:14.895139 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1002.3 KB processed)[0m in 2.78s]
[0m09:42:14.895457 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:42:14.895587 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:42:14.895793 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:42:14.896395 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:42:14.896615 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:42:14.896734 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:42:14.899617 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:42:14.900032 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:14.900151 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:42:14.902005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:15.335339 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:247cd4c4-4395-4d5d-b21f-ab9cebaca5a5:europe-west1&page=queryresults
[0m09:42:15.338306 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:42:15.340759 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:42:15.340024 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:15.342606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107640910>]}
[0m09:42:15.343281 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 461.9 KB processed)[0m in 2.46s]
[0m09:42:15.344087 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:42:15.344409 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:42:15.344738 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:42:15.346559 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:42:15.346939 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:42:15.347221 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:42:15.356224 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:42:15.357732 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:15.357983 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:42:15.360924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:15.824808 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:42:15.825609 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:42:17.490788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:690bedd7-7386-4596-a0f7-3e7fddb8e876:europe-west1&page=queryresults
[0m09:42:17.492265 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:17.492766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715b760>]}
[0m09:42:17.493082 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.3 MB processed)[0m in 2.60s]
[0m09:42:17.493445 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:42:17.493610 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m09:42:17.494092 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:42:17.495154 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:42:17.495309 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m09:42:17.495437 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m09:42:17.499331 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:42:17.501194 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:17.501427 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m09:42:17.510350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:17.974892 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:42:17.975599 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:42:18.049248 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:06c26a29-6d2d-4c50-89d4-780fb599595f:europe-west1&page=queryresults
[0m09:42:18.050179 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:18.050516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cf5b0>]}
[0m09:42:18.050708 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.7 KB processed)[0m in 2.71s]
[0m09:42:18.050934 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:42:18.051037 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:42:18.051290 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:42:18.051792 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:42:18.051899 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:42:18.051985 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:42:18.056634 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:42:18.057104 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:18.057262 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:42:18.059563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:18.366620 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:42:18.367957 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:42:20.465100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5eea041f-858f-40b1-992c-837d1b7fe6bb:europe-west1&page=queryresults
[0m09:42:20.469680 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:20.470637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107490190>]}
[0m09:42:20.471121 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (350.0 rows, 45.8 KB processed)[0m in 2.98s]
[0m09:42:20.471758 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m09:42:20.913753 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ba123103-4ebe-495a-ab43-8164e0fd89fc:europe-west1&page=queryresults
[0m09:42:20.920318 [debug] [Thread-2 (]: finished collecting timing info
[0m09:42:20.922477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cf1c0>]}
[0m09:42:20.923409 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.87s]
[0m09:42:20.924393 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:42:20.926989 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m09:42:20.927986 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m09:42:20.929192 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:42:20.929517 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:42:20.930814 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m09:42:20.939397 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:42:20.941621 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:20.941872 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m09:42:20.944428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:21.487364 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m09:42:21.490375 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

historical_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment

),

historical_mixpanel_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

current_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment

),

current_android_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_mixpanel_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_android_segment_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
    );
  
[0m09:42:23.371740 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Destination deleted/expired during operation: wawa-83630:dbt_rsdun.articles_evidence')
[0m09:42:26.576076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:055f2132-5f57-4d2a-814f-ed7340b919d0:europe-west1&page=queryresults
[0m09:42:26.579496 [debug] [Thread-1 (]: finished collecting timing info
[0m09:42:26.580844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c133eabf-323c-4467-9195-868b954b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744fd90>]}
[0m09:42:26.581572 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (16.5k rows, 2.3 MB processed)[0m in 5.65s]
[0m09:42:26.582324 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m09:42:26.586549 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:42:26.587423 [info ] [MainThread]: 
[0m09:42:26.587782 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 17.22 seconds (17.22s).
[0m09:42:26.588091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:26.588303 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:42:26.588466 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:42:26.609707 [info ] [MainThread]: 
[0m09:42:26.610028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:26.610193 [info ] [MainThread]: 
[0m09:42:26.610363 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:42:26.610679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075743a0>]}
[0m09:42:26.610926 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 09:49:33.311620 | b31b28ab-2f69-4987-90fe-6ad75414e40b ==============================
[0m09:49:33.311670 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:49:33.313496 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:49:33.313666 [debug] [MainThread]: Tracking: tracking
[0m09:49:33.327160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af1120>]}
[0m09:49:33.372399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:49:33.372556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:49:33.372919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m09:49:33.376855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e91570>]}
[0m09:49:33.383770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4e170>]}
[0m09:49:33.383957 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m09:49:33.384094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4e200>]}
[0m09:49:33.385071 [info ] [MainThread]: 
[0m09:49:33.385412 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:49:33.386099 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:49:33.386229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:34.036300 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:49:34.037077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:49:34.473346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104317ca0>]}
[0m09:49:34.473800 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:49:34.473965 [info ] [MainThread]: 
[0m09:49:34.476727 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:49:34.476832 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:49:34.477005 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:49:34.477130 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:49:34.477474 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:49:34.477838 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:49:34.477994 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:49:34.478124 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:49:34.478234 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:49:34.478365 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:49:34.480144 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:49:34.481703 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:49:34.482299 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:34.482372 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:34.482460 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:49:34.482542 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:49:34.498522 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:49:34.500174 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:49:34.500536 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:49:34.500631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:34.501333 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:49:34.541495 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:49:35.308386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ec4958c2-73a0-4703-a80b-f2321d9c4bc3:europe-west1&page=queryresults
[0m09:49:35.332039 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:35.332768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f2e830>]}
[0m09:49:35.333205 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m09:49:35.333626 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:49:35.333821 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:49:35.334120 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m09:49:35.334841 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:49:35.334978 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:49:35.335102 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:49:35.336614 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:49:35.337551 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:35.337693 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:49:35.340017 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:49:35.340446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:35.341465 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m09:49:35.440062 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:29d75619-a1ae-46cc-abb4-00abb08bd036:europe-west1&page=queryresults
[0m09:49:35.441174 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:35.441526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1db10>]}
[0m09:49:35.441729 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m09:49:35.441971 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:49:35.442088 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:49:35.442203 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m09:49:35.442543 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:49:35.442635 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:49:35.442731 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:49:35.444094 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:49:35.444851 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:35.444961 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:49:35.448505 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:49:35.449514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:49:35.450301 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m09:49:36.357902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9a739fd4-8a47-4ab4-8940-c21d88f5c0cb:europe-west1&page=queryresults
[0m09:49:36.359230 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:edee5f73-f90b-4b63-aab5-5f7d8c569893:europe-west1&page=queryresults
[0m09:49:36.361942 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:36.363658 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:36.364411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694efe0>]}
[0m09:49:36.364964 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f7b280>]}
[0m09:49:36.365497 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m09:49:36.365830 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m09:49:36.366360 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:49:36.366710 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:49:36.366924 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:49:36.367122 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:49:36.367843 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:49:36.368152 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:49:36.368761 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:49:36.369308 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:49:36.369473 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:49:36.369609 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:49:36.369761 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:49:36.369882 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:49:36.373190 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:49:36.381646 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:49:36.383461 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:36.383612 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:49:36.385013 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:36.386305 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:49:36.409321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:49:36.411389 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:49:36.450723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:36.451507 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m09:49:36.959932 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:49:36.961761 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:49:37.165936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:14ee8424-f094-4a1b-b380-35212c8ae557:europe-west1&page=queryresults
[0m09:49:37.167072 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:37.167418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe3b50>]}
[0m09:49:37.167617 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m09:49:37.167855 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:49:37.167962 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:49:37.168075 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:49:37.168410 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:49:37.168587 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:49:37.168678 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:49:37.171197 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:49:37.171602 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:37.171696 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:49:37.173381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:37.685530 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:49:37.686674 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:49:38.992375 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:28416e66-a20c-451a-a3a9-d186982bff1e:europe-west1&page=queryresults
[0m09:49:38.994926 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:38.995729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1ee90>]}
[0m09:49:38.996194 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1002.3 KB processed)[0m in 2.63s]
[0m09:49:38.996693 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:49:38.996910 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:49:38.997268 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:49:38.998076 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:49:38.998281 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:49:38.998462 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:49:39.003542 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:49:39.004231 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:39.004389 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:49:39.007114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:49:39.348278 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:49:39.349545 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:49:39.601211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:866b1fc6-ca50-453c-8994-405c214fd5ca:europe-west1&page=queryresults
[0m09:49:39.602571 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:39.603123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692bb20>]}
[0m09:49:39.603426 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 461.9 KB processed)[0m in 2.43s]
[0m09:49:39.603786 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:49:39.603955 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:49:39.604299 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:49:39.604884 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:49:39.605027 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:49:39.605152 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:49:39.610147 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:49:39.613527 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:39.613756 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:49:39.623331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:39.944846 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:49:39.946205 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (timestamp > (select max(timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:49:41.706633 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e2bf430c-0314-4f9e-941a-7ccda5666031:europe-west1&page=queryresults
[0m09:49:41.711825 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:41.712203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116864520>]}
[0m09:49:41.712398 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.3 MB processed)[0m in 2.71s]
[0m09:49:41.712637 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:49:41.712738 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:49:41.712843 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:49:41.713241 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:49:41.713356 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:49:41.713446 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:49:41.715359 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:49:41.716570 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:41.716661 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:49:41.722759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:49:41.861752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cfb73bd5-a284-40fe-a358-e9061efb89f3:europe-west1&page=queryresults
[0m09:49:41.862649 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:41.863058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c05ab0>]}
[0m09:49:41.863297 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.7 KB processed)[0m in 2.26s]
[0m09:49:41.863537 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:49:41.863648 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:49:41.863831 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:49:41.864230 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:49:41.864333 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:49:41.864426 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:49:41.867149 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:49:41.868084 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:41.868191 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:49:41.870426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:42.179992 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:49:42.180480 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:49:42.298707 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:49:42.299488 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:49:44.436528 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:32934273-ed16-4feb-8d65-375c2a69bd83:europe-west1&page=queryresults
[0m09:49:44.441482 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:44.442477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168655a0>]}
[0m09:49:44.442992 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (350.0 rows, 45.8 KB processed)[0m in 2.73s]
[0m09:49:44.443617 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:49:44.480930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bddbdaca-02b8-4add-a73c-2159f9bcc0d2:europe-west1&page=queryresults
[0m09:49:44.482722 [debug] [Thread-1 (]: finished collecting timing info
[0m09:49:44.483380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c04490>]}
[0m09:49:44.483737 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.62s]
[0m09:49:44.484105 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:49:44.484725 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:49:44.485006 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m09:49:44.485609 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:49:44.485884 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:49:44.486192 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m09:49:44.490977 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:49:44.493215 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:44.493496 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m09:49:44.495509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:49:44.979485 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m09:49:44.981023 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

historical_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment

),

historical_mixpanel_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

current_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment

),

current_android_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_mixpanel_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_android_segment_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
    );
  
[0m09:49:47.234174 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:02667bc5-60d4-4eae-8b45-b4643ca07f7b:europe-west1&page=queryresults
[0m09:49:47.236091 [debug] [Thread-2 (]: finished collecting timing info
[0m09:49:47.236673 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b28ab-2f69-4987-90fe-6ad75414e40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168768c0>]}
[0m09:49:47.236970 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (16.5k rows, 2.3 MB processed)[0m in 2.75s]
[0m09:49:47.237323 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:49:47.238571 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:49:47.239146 [info ] [MainThread]: 
[0m09:49:47.239368 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 13.85 seconds (13.85s).
[0m09:49:47.239544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:47.239636 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:49:47.239721 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:49:47.251044 [info ] [MainThread]: 
[0m09:49:47.251306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:47.251496 [info ] [MainThread]: 
[0m09:49:47.251642 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:49:47.251858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2fa00>]}
[0m09:49:47.252035 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 10:20:33.293072 | 9da7341b-f276-479f-92b9-fc748bfa075a ==============================
[0m10:20:33.293119 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:20:33.294067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:20:33.294166 [debug] [MainThread]: Tracking: tracking
[0m10:20:33.306942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f13f0>]}
[0m10:20:33.350523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:20:33.350808 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m10:20:33.350924 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m10:20:33.351031 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m10:20:33.357333 [debug] [MainThread]: 1603: static parser failed on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m10:20:33.365534 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m10:20:33.366110 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m10:20:33.368294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m10:20:33.368814 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m10:20:33.370897 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m10:20:33.414386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m10:20:33.417783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77b760>]}
[0m10:20:33.427277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d7c40>]}
[0m10:20:33.427555 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m10:20:33.427788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e88280>]}
[0m10:20:33.428868 [info ] [MainThread]: 
[0m10:20:33.429230 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:20:33.429908 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:20:33.430097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:34.023638 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:20:34.024180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:34.510790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108accd00>]}
[0m10:20:34.512952 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:20:34.513449 [info ] [MainThread]: 
[0m10:20:34.520226 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:20:34.520510 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:20:34.520983 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:20:34.521251 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:20:34.522173 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:20:34.522752 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:20:34.522903 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:20:34.523035 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:20:34.523186 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:20:34.523323 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:20:34.526436 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:20:34.532646 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:34.532864 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:20:34.551564 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:20:34.560511 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:20:34.560939 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:34.561133 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:20:34.561270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:34.563278 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:20:34.564234 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:20:34.602760 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:20:34.603852 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:20:35.488110 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bc30befe-3071-47cb-bcb3-291d47a5fe05:europe-west1&page=queryresults
[0m10:20:35.505907 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:35.506699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:212b86c8-e91c-4b4d-8572-8af5eada7171:europe-west1&page=queryresults
[0m10:20:35.507307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77ff40>]}
[0m10:20:35.508448 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:35.508806 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m10:20:35.509193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7794e0>]}
[0m10:20:35.509583 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:20:35.509823 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m10:20:35.510019 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:20:35.510411 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:20:35.510598 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m10:20:35.511018 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:20:35.511671 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m10:20:35.512132 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:20:35.512559 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:20:35.512731 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:20:35.512883 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:20:35.513003 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:20:35.513102 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:20:35.514563 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:20:35.515709 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:20:35.517503 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:35.517649 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:35.517781 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:20:35.517951 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:20:35.520199 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:20:35.522260 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:20:35.522753 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:35.522909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:35.523867 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m10:20:35.524572 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m10:20:36.431271 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:54d0332e-85e8-4806-9435-0f083e370e2a:europe-west1&page=queryresults
[0m10:20:36.432470 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:36.432916 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97ae00>]}
[0m10:20:36.433172 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m10:20:36.433455 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:20:36.433587 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:20:36.433797 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:20:36.434294 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:20:36.434416 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:20:36.434523 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:20:36.441447 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:20:36.443247 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:36.443364 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:20:36.448813 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:20:36.449204 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:36.449954 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m10:20:36.623352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:de537d45-957c-4974-b477-f7ec64a6ba52:europe-west1&page=queryresults
[0m10:20:36.624149 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:36.624552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76a710>]}
[0m10:20:36.624822 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m10:20:36.625056 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:20:36.625151 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m10:20:36.625250 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m10:20:36.625537 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m10:20:36.625733 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m10:20:36.625897 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m10:20:36.628073 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:20:36.629414 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:36.629574 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m10:20:36.656324 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:20:36.656793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:36.657503 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`
    
    
    OPTIONS()
    as (
      

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



    );
  
[0m10:20:37.091292 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1ce08bd4-a089-4f6f-bfe9-383372a181f3:europe-west1&page=queryresults
[0m10:20:37.094004 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:37.095036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c76aa10>]}
[0m10:20:37.095719 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m10:20:37.096335 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:20:37.096618 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:20:37.097112 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:20:37.097842 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:20:37.098028 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:20:37.098198 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:20:37.103847 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:20:37.105288 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:37.105666 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:20:37.110460 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:20:37.111070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:37.112743 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

group by reading_session, slug, category, clinic_id, user_id, referrer
    );
  
[0m10:20:38.824166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6e0f6d65-4ee6-462e-a507-586a04641718:europe-west1&page=queryresults
[0m10:20:38.825137 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:38.825506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b43a0>]}
[0m10:20:38.825715 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mCREATE TABLE (199.0 rows, 852.8 KB processed)[0m in 2.20s]
[0m10:20:38.825947 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m10:20:38.826049 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m10:20:38.826268 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m10:20:38.826862 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m10:20:38.826987 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m10:20:38.827095 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m10:20:38.834421 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:20:38.834826 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:38.834928 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m10:20:38.840238 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:20:38.840642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:38.841409 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`
    
    
    OPTIONS()
    as (
      

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



    );
  
[0m10:20:40.624431 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dd061a9d-f4a6-42e6-92f3-bd30a4d2da0f:europe-west1&page=queryresults
[0m10:20:40.625468 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:40.625801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da24f10>]}
[0m10:20:40.625987 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE TABLE (1.5k rows, 450.4 KB processed)[0m in 3.53s]
[0m10:20:40.626210 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:20:40.626315 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:20:40.626412 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m10:20:40.626689 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:20:40.626769 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m10:20:40.626949 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m10:20:40.628996 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:20:40.630018 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:40.630174 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m10:20:40.632260 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:20:40.632661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:40.633376 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


    );
  
[0m10:20:41.243137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7347f00f-04d0-40af-bef9-f5f1b0bd8ca1:europe-west1&page=queryresults
[0m10:20:41.246869 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:41.248061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da2dd80>]}
[0m10:20:41.248737 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mCREATE TABLE (729.0 rows, 1.1 MB processed)[0m in 2.42s]
[0m10:20:41.249542 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m10:20:41.249928 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m10:20:41.250394 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m10:20:41.251559 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:20:41.252183 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m10:20:41.253764 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m10:20:41.264772 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:20:41.265470 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:41.265649 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m10:20:41.271982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:41.679385 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:20:41.679835 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:20:42.879836 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:14a540c2-8b6e-4e72-86ae-0fc0d67af3e8:europe-west1&page=queryresults
[0m10:20:42.881925 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:42.882557 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9d3ee0>]}
[0m10:20:42.882901 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mCREATE TABLE (14.0 rows, 1.7 KB processed)[0m in 2.26s]
[0m10:20:42.883231 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:20:42.883390 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:20:42.883628 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m10:20:42.884208 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:20:42.884351 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:20:42.884474 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:20:42.887836 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:20:42.889311 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:42.889499 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:20:42.900064 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:20:42.900548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:20:42.901554 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

GROUP BY reading_session, referrer, slug, user_id, category, os
    );
  
[0m10:20:44.015311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:37a53402-4437-439d-844d-677d8f2e3e39:europe-west1&page=queryresults
[0m10:20:44.021899 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:44.023873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da70610>]}
[0m10:20:44.025072 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (350.0 rows, 45.8 KB processed)[0m in 2.77s]
[0m10:20:44.026164 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m10:20:45.550547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a4648e94-db57-4a89-b114-961bf8a28b52:europe-west1&page=queryresults
[0m10:20:45.551734 [debug] [Thread-2 (]: finished collecting timing info
[0m10:20:45.552159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da78d30>]}
[0m10:20:45.552409 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mCREATE TABLE (15.0k rows, 42.6 MB processed)[0m in 2.67s]
[0m10:20:45.552726 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:20:45.553482 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:20:45.554029 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m10:20:45.554547 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:20:45.554657 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:20:45.554760 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:20:45.558338 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:20:45.559320 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:45.559523 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:20:45.561527 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:20:45.561886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:45.562783 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

historical_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment

),

historical_mixpanel_events AS
(
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))

),

current_ios_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment

),

current_android_segment_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment

),

all_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM historical_mixpanel_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_ios_segment_events
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM current_android_segment_events
),

all_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.id AS article_id
    FROM all_events AS ae
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
)

select * from all_events_with_article_id
    );
  
[0m10:20:48.257821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:01fa3272-5d20-43ce-9807-19c3327eabb6:europe-west1&page=queryresults
[0m10:20:48.258931 [debug] [Thread-1 (]: finished collecting timing info
[0m10:20:48.259420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da7341b-f276-479f-92b9-fc748bfa075a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4b6a0>]}
[0m10:20:48.259968 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (16.8k rows, 2.3 MB processed)[0m in 2.71s]
[0m10:20:48.260688 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:20:48.264404 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:20:48.265137 [info ] [MainThread]: 
[0m10:20:48.265509 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 14.84 seconds (14.84s).
[0m10:20:48.265829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:48.266000 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:20:48.266161 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m10:20:48.276868 [info ] [MainThread]: 
[0m10:20:48.277133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:48.277342 [info ] [MainThread]: 
[0m10:20:48.277515 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m10:20:48.277744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da98be0>]}
[0m10:20:48.277926 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 10:30:24.152770 | fc2609b3-d609-423e-800d-641bd744022f ==============================
[0m10:30:24.152827 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:30:24.153670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m10:30:24.153788 [debug] [MainThread]: Tracking: tracking
[0m10:30:24.163168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d03310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d014e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d013c0>]}
[0m10:30:24.206319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:30:24.206543 [debug] [MainThread]: Partial parsing: added file: my_new_project://macros/test_row_count.sql
[0m10:30:24.206689 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/schema.yml
[0m10:30:24.206772 [debug] [MainThread]: Parsing macros/test_row_count.sql
[0m10:30:24.212142 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m10:30:24.221552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118472e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111887460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111888dc0>]}
[0m10:30:24.221732 [debug] [MainThread]: Flushing usage events
[0m10:30:24.796136 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/segment_android__production_events/schema.yml:
  	test definition dictionary must have exactly one key, got [('row_count', None), ('equal', 199)] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2022-12-20 10:31:47.729640 | 774aa92b-b2be-498b-919c-736a3e611f29 ==============================
[0m10:31:47.729662 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:31:47.730351 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m10:31:47.730473 [debug] [MainThread]: Tracking: tracking
[0m10:31:47.739909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789420>]}
[0m10:31:47.781675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:31:47.781909 [debug] [MainThread]: Partial parsing: added file: my_new_project://macros/test_row_count.sql
[0m10:31:47.782057 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/schema.yml
[0m10:31:47.782140 [debug] [MainThread]: Parsing macros/test_row_count.sql
[0m10:31:47.787423 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m10:31:47.797050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ef340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1ce80>]}
[0m10:31:47.797292 [debug] [MainThread]: Flushing usage events
[0m10:31:48.448512 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/segment_android__production_events/schema.yml:
  	test definition dictionary must have exactly one key, got [('row_count', None), ('equal', 199)] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2022-12-20 10:32:26.246620 | a3310eda-9653-4076-b761-cfe184ec313e ==============================
[0m10:32:26.246667 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:32:26.247820 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m10:32:26.248117 [debug] [MainThread]: Tracking: tracking
[0m10:32:26.258252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a135690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a135570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a134f40>]}
[0m10:32:26.300827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:32:26.301066 [debug] [MainThread]: Partial parsing: added file: my_new_project://macros/test_row_count.sql
[0m10:32:26.301215 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/schema.yml
[0m10:32:26.301309 [debug] [MainThread]: Parsing macros/test_row_count.sql
[0m10:32:26.306718 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m10:32:26.324097 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_slug.01cb357c20' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.324295 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_slug.c394d06565' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.324400 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.row_count_stg_android__community_viewed_article_slug__199.baf5934648' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.324503 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_original_timestamp.f45027f819' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.324602 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_original_timestamp.42ba45d2f8' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.324705 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_user_id.a07ae945b5' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.324804 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_user_id.75bc497418' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:32:26.369458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m10:32:26.372833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3310eda-9653-4076-b761-cfe184ec313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3aec20>]}
[0m10:32:26.381407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3310eda-9653-4076-b761-cfe184ec313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a293e20>]}
[0m10:32:26.381628 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 320 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m10:32:26.381769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3310eda-9653-4076-b761-cfe184ec313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066daaa0>]}
[0m10:32:26.382735 [info ] [MainThread]: 
[0m10:32:26.383076 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:32:26.383808 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:32:26.383935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:26.941583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3310eda-9653-4076-b761-cfe184ec313e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108330df0>]}
[0m10:32:26.943908 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:32:26.944506 [info ] [MainThread]: 
[0m10:32:26.951530 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:32:26.951852 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:32:26.952108 [info ] [Thread-1 (]: 1 of 9 START test not_null_articles_evidence_original_timestamp ................ [RUN]
[0m10:32:26.952329 [info ] [Thread-2 (]: 2 of 9 START test not_null_articles_evidence_user_id ........................... [RUN]
[0m10:32:26.953158 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:32:26.953827 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"
[0m10:32:26.954035 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:32:26.954210 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:32:26.954403 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:32:26.954564 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:32:26.964178 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:32:26.967595 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"
[0m10:32:26.968396 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:26.968535 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:26.968669 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:32:26.968814 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:32:26.983741 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"
[0m10:32:26.985699 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:32:26.985961 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:32:26.986092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:26.986891 [debug] [Thread-2 (]: On test.my_new_project.not_null_articles_evidence_user_id.8111c67641: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `wawa-83630`.`dbt_rsdun`.`articles_evidence`
where user_id is null



      
    ) dbt_internal_test
[0m10:32:26.987691 [debug] [Thread-1 (]: On test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select original_timestamp
from `wawa-83630`.`dbt_rsdun`.`articles_evidence`
where original_timestamp is null



      
    ) dbt_internal_test
[0m10:32:28.397279 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cdc0680d-7898-4f17-b93d-64bdb56cb00b:europe-west1&page=queryresults
[0m10:32:28.400123 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:28.401351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:efebfdd0-07c9-4e4a-89d5-e39a86547164:europe-west1&page=queryresults
[0m10:32:28.402113 [error] [Thread-2 (]: 2 of 9 FAIL 2 not_null_articles_evidence_user_id ............................... [[31mFAIL 2[0m in 1.45s]
[0m10:32:28.402709 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:28.403364 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:32:28.404043 [info ] [Thread-1 (]: 1 of 9 PASS not_null_articles_evidence_original_timestamp ...................... [[32mPASS[0m in 1.45s]
[0m10:32:28.404340 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:32:28.404972 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:32:28.405160 [info ] [Thread-2 (]: 3 of 9 START test not_null_downloads_download_date ............................. [RUN]
[0m10:32:28.405380 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:32:28.406133 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:32:28.406542 [info ] [Thread-1 (]: 4 of 9 START test not_null_downloads_total_downloads ........................... [RUN]
[0m10:32:28.406907 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:32:28.407678 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:32:28.407935 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:32:28.408122 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:32:28.413092 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:32:28.413352 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:32:28.417396 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:32:28.417698 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:28.417838 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:28.417959 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:32:28.418106 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:32:28.419949 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:32:28.421564 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:32:28.421977 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:32:28.422163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:28.423221 [debug] [Thread-2 (]: On test.my_new_project.not_null_downloads_download_date.2298360128: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_downloads_download_date.2298360128"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select download_date
from `wawa-83630`.`dbt_rsdun`.`downloads`
where download_date is null



      
    ) dbt_internal_test
[0m10:32:28.424172 [debug] [Thread-1 (]: On test.my_new_project.not_null_downloads_total_downloads.9265a0287f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_downloads
from `wawa-83630`.`dbt_rsdun`.`downloads`
where total_downloads is null



      
    ) dbt_internal_test
[0m10:32:29.670576 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e3841253-f0f9-4b4f-912b-49913ef7e26a:europe-west1&page=queryresults
[0m10:32:29.672568 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:29.673747 [info ] [Thread-2 (]: 3 of 9 PASS not_null_downloads_download_date ................................... [[32mPASS[0m in 1.27s]
[0m10:32:29.674419 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:32:29.674703 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:32:29.675043 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_apple_app_store__downloads_date ................. [RUN]
[0m10:32:29.675985 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:32:29.676237 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:32:29.676460 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:32:29.682491 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:32:29.684509 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:29.684702 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:32:29.686862 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:32:29.687784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:32:29.689201 [debug] [Thread-2 (]: On test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
where date is null



      
    ) dbt_internal_test
[0m10:32:29.737531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5a5129d0-e52a-4eb0-bfeb-97bc232d667e:europe-west1&page=queryresults
[0m10:32:29.737989 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:29.738324 [info ] [Thread-1 (]: 4 of 9 PASS not_null_downloads_total_downloads ................................. [[32mPASS[0m in 1.33s]
[0m10:32:29.738527 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:32:29.738621 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:32:29.738692 [info ] [Thread-1 (]: 6 of 9 START test not_null_stg_google_play_store__downloads_date ............... [RUN]
[0m10:32:29.738976 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:32:29.739155 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:32:29.739482 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:32:29.750811 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:32:29.751260 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:29.751345 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:32:29.752358 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:32:29.752625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:29.753286 [debug] [Thread-1 (]: On test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
where date is null



      
    ) dbt_internal_test
[0m10:32:31.351364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:89f377fa-10bd-45e5-84e1-207f2d85d357:europe-west1&page=queryresults
[0m10:32:31.353152 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:82698bdf-1c81-48b5-ab95-2ed9ad618006:europe-west1&page=queryresults
[0m10:32:31.354005 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:31.354538 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:31.355437 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stg_google_play_store__downloads_date ..................... [[32mPASS[0m in 1.62s]
[0m10:32:31.356126 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_apple_app_store__downloads_date ....................... [[32mPASS[0m in 1.68s]
[0m10:32:31.356719 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:32:31.357149 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:32:31.357401 [debug] [Thread-1 (]: Began running node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:32:31.357845 [debug] [Thread-2 (]: Began running node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:32:31.358445 [info ] [Thread-1 (]: 7 of 9 START test unique_downloads_download_date ............................... [RUN]
[0m10:32:31.358811 [info ] [Thread-2 (]: 8 of 9 START test unique_stg_apple_app_store__downloads_date ................... [RUN]
[0m10:32:31.359746 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:32:31.360467 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:32:31.360702 [debug] [Thread-1 (]: Began compiling node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:32:31.360864 [debug] [Thread-2 (]: Began compiling node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:32:31.361038 [debug] [Thread-1 (]: Compiling test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:32:31.361185 [debug] [Thread-2 (]: Compiling test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:32:31.369083 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:32:31.372636 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:32:31.373191 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:31.373340 [debug] [Thread-1 (]: Began executing node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:32:31.375131 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:32:31.375265 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:31.375494 [debug] [Thread-2 (]: Began executing node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:32:31.377033 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:32:31.377242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:31.378398 [debug] [Thread-1 (]: On test.my_new_project.unique_downloads_download_date.07157a0e00: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_downloads_download_date.07157a0e00"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select download_date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`downloads`
  where download_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:32:31.378572 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:32:31.425262 [debug] [Thread-2 (]: On test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:32:32.566400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cddc5c8c-078b-40e6-b58d-43b462adc7d0:europe-west1&page=queryresults
[0m10:32:32.568924 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:32.570239 [info ] [Thread-1 (]: 7 of 9 PASS unique_downloads_download_date ..................................... [[32mPASS[0m in 1.21s]
[0m10:32:32.570877 [debug] [Thread-1 (]: Finished running node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:32:32.571170 [debug] [Thread-1 (]: Began running node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:32:32.571509 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_google_play_store__downloads_date ................. [RUN]
[0m10:32:32.572463 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:32:32.572718 [debug] [Thread-1 (]: Began compiling node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:32:32.572938 [debug] [Thread-1 (]: Compiling test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:32:32.578729 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:32:32.579591 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:32.579784 [debug] [Thread-1 (]: Began executing node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:32:32.588335 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:32:32.588795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:32.589900 [debug] [Thread-1 (]: On test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:32:32.774401 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0beb837d-5705-4484-bedf-0d50de7f7764:europe-west1&page=queryresults
[0m10:32:32.774815 [debug] [Thread-2 (]: finished collecting timing info
[0m10:32:32.775251 [info ] [Thread-2 (]: 8 of 9 PASS unique_stg_apple_app_store__downloads_date ......................... [[32mPASS[0m in 1.42s]
[0m10:32:32.775558 [debug] [Thread-2 (]: Finished running node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:32:34.259737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:70d10e70-db90-47a1-bf56-f8302f36d733:europe-west1&page=queryresults
[0m10:32:34.261877 [debug] [Thread-1 (]: finished collecting timing info
[0m10:32:34.262983 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_google_play_store__downloads_date ....................... [[32mPASS[0m in 1.69s]
[0m10:32:34.263600 [debug] [Thread-1 (]: Finished running node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:32:34.265638 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:32:34.266375 [info ] [MainThread]: 
[0m10:32:34.266747 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m10:32:34.267056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:34.267217 [debug] [MainThread]: Connection 'test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e' was properly closed.
[0m10:32:34.267376 [debug] [MainThread]: Connection 'test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77' was properly closed.
[0m10:32:34.285062 [info ] [MainThread]: 
[0m10:32:34.285286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:32:34.285515 [info ] [MainThread]: 
[0m10:32:34.285711 [error] [MainThread]: [31mFailure in test not_null_articles_evidence_user_id (models/marts/schema.yml)[0m
[0m10:32:34.285898 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m10:32:34.286067 [info ] [MainThread]: 
[0m10:32:34.286236 [info ] [MainThread]:   compiled Code at target/compiled/my_new_project/models/marts/schema.yml/not_null_articles_evidence_user_id.sql
[0m10:32:34.286430 [info ] [MainThread]: 
[0m10:32:34.286598 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m10:32:34.286849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a570700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a570040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a570af0>]}
[0m10:32:34.287046 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 10:46:17.992911 | 449d2e48-daf8-409d-86b6-f0e317c48e65 ==============================
[0m10:46:17.992962 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:46:17.997288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m10:46:17.998344 [debug] [MainThread]: Tracking: tracking
[0m10:46:18.009789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f68b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f68c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f68d00>]}
[0m10:46:18.052600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:46:18.052911 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/segment_android__production_events/schema.yml
[0m10:46:18.057938 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_android__community_viewed_article' in the 'models' section of file 'models/staging/segment_android__production_events/schema.yml'
[0m10:46:18.070864 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_slug.01cb357c20' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:46:18.071070 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_slug.c394d06565' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:46:18.071173 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_original_timestamp.f45027f819' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:46:18.071277 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.not_null_stg_android__community_viewed_article_original_timestamp.42ba45d2f8' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:46:18.071379 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_new_project.unique_stg_android__community_viewed_article_user_id.a07ae945b5' (models/staging/segment_android__production_events/schema.yml) depends on a node named 'stg_android__community_viewed_article' which was not found
[0m10:46:18.119292 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m10:46:18.122798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '449d2e48-daf8-409d-86b6-f0e317c48e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ead40>]}
[0m10:46:18.134373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '449d2e48-daf8-409d-86b6-f0e317c48e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1affa0>]}
[0m10:46:18.134596 [info ] [MainThread]: Found 12 models, 9 tests, 0 snapshots, 0 analyses, 320 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m10:46:18.134728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '449d2e48-daf8-409d-86b6-f0e317c48e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e97c10>]}
[0m10:46:18.135717 [info ] [MainThread]: 
[0m10:46:18.136071 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:46:18.136792 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:46:18.136900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:18.635678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '449d2e48-daf8-409d-86b6-f0e317c48e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815cd90>]}
[0m10:46:18.636574 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:46:18.636857 [info ] [MainThread]: 
[0m10:46:18.642101 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:46:18.642431 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:46:18.642578 [info ] [Thread-1 (]: 1 of 9 START test not_null_articles_evidence_original_timestamp ................ [RUN]
[0m10:46:18.642726 [info ] [Thread-2 (]: 2 of 9 START test not_null_articles_evidence_user_id ........................... [RUN]
[0m10:46:18.643261 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:46:18.643860 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"
[0m10:46:18.644144 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:46:18.644380 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:46:18.644550 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:46:18.644718 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:46:18.655026 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:46:18.657631 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"
[0m10:46:18.658821 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:18.658939 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:18.659041 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:46:18.659143 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:46:18.674006 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:46:18.674578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:18.675467 [debug] [Thread-1 (]: On test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select original_timestamp
from `wawa-83630`.`dbt_rsdun`.`articles_evidence`
where original_timestamp is null



      
    ) dbt_internal_test
[0m10:46:18.680130 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"
[0m10:46:18.718490 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:46:18.720177 [debug] [Thread-2 (]: On test.my_new_project.not_null_articles_evidence_user_id.8111c67641: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_articles_evidence_user_id.8111c67641"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `wawa-83630`.`dbt_rsdun`.`articles_evidence`
where user_id is null



      
    ) dbt_internal_test
[0m10:46:19.855321 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5c45c03e-d993-4d49-866a-a19d823c4968:europe-west1&page=queryresults
[0m10:46:19.858260 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:19.859053 [error] [Thread-2 (]: 2 of 9 FAIL 2 not_null_articles_evidence_user_id ............................... [[31mFAIL 2[0m in 1.22s]
[0m10:46:19.859527 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_articles_evidence_user_id.8111c67641
[0m10:46:19.859729 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:46:19.859983 [info ] [Thread-2 (]: 3 of 9 START test not_null_downloads_download_date ............................. [RUN]
[0m10:46:19.860659 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:46:19.860866 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:46:19.861023 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:46:19.864866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ec67bec6-ebc4-480e-9aff-861c7eb33e70:europe-west1&page=queryresults
[0m10:46:19.870156 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:46:19.870602 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:19.871089 [info ] [Thread-1 (]: 1 of 9 PASS not_null_articles_evidence_original_timestamp ...................... [[32mPASS[0m in 1.23s]
[0m10:46:19.871387 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:46:19.871523 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:46:19.871691 [info ] [Thread-1 (]: 4 of 9 START test not_null_downloads_total_downloads ........................... [RUN]
[0m10:46:19.872340 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:46:19.872548 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:46:19.872719 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:46:19.872845 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:19.875999 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:46:19.876195 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:46:19.877769 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:46:19.878054 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:19.878172 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:46:19.878293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:19.879802 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:46:19.880832 [debug] [Thread-2 (]: On test.my_new_project.not_null_downloads_download_date.2298360128: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_downloads_download_date.2298360128"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select download_date
from `wawa-83630`.`dbt_rsdun`.`downloads`
where download_date is null



      
    ) dbt_internal_test
[0m10:46:19.923157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:19.924202 [debug] [Thread-1 (]: On test.my_new_project.not_null_downloads_total_downloads.9265a0287f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_downloads
from `wawa-83630`.`dbt_rsdun`.`downloads`
where total_downloads is null



      
    ) dbt_internal_test
[0m10:46:21.134699 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e8d6d588-d4f9-49d7-abf2-bd2f3c0869cf:europe-west1&page=queryresults
[0m10:46:21.135140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d2a1c533-ef4a-4f9d-9834-bda46524947e:europe-west1&page=queryresults
[0m10:46:21.136007 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:21.136452 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:21.137376 [info ] [Thread-2 (]: 3 of 9 PASS not_null_downloads_download_date ................................... [[32mPASS[0m in 1.28s]
[0m10:46:21.138039 [info ] [Thread-1 (]: 4 of 9 PASS not_null_downloads_total_downloads ................................. [[32mPASS[0m in 1.27s]
[0m10:46:21.138552 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:46:21.138895 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:46:21.139111 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:46:21.139589 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:46:21.140046 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_apple_app_store__downloads_date ................. [RUN]
[0m10:46:21.140252 [info ] [Thread-1 (]: 6 of 9 START test not_null_stg_google_play_store__downloads_date ............... [RUN]
[0m10:46:21.140897 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:46:21.141663 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:46:21.141890 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:46:21.142222 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:46:21.142581 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:46:21.142801 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:46:21.148241 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:46:21.152412 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:46:21.153054 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:21.153191 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:21.153314 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:46:21.153459 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:46:21.157460 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:46:21.162497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:21.163646 [debug] [Thread-1 (]: On test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
where date is null



      
    ) dbt_internal_test
[0m10:46:21.164905 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:46:21.209461 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:21.210189 [debug] [Thread-2 (]: On test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
where date is null



      
    ) dbt_internal_test
[0m10:46:22.325680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a463883e-0076-47b8-bc43-0d818b6747e0:europe-west1&page=queryresults
[0m10:46:22.328471 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:22.330482 [info ] [Thread-1 (]: 6 of 9 PASS not_null_stg_google_play_store__downloads_date ..................... [[32mPASS[0m in 1.19s]
[0m10:46:22.331705 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:46:22.332210 [debug] [Thread-1 (]: Began running node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:46:22.332565 [info ] [Thread-1 (]: 7 of 9 START test unique_downloads_download_date ............................... [RUN]
[0m10:46:22.333269 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:46:22.333959 [debug] [Thread-1 (]: Began compiling node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:46:22.334381 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:61e404d4-2ee8-4a8c-8d07-db10c8ca75a4:europe-west1&page=queryresults
[0m10:46:22.334555 [debug] [Thread-1 (]: Compiling test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:46:22.335027 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:22.341460 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:46:22.341965 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_apple_app_store__downloads_date ....................... [[32mPASS[0m in 1.20s]
[0m10:46:22.342388 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:46:22.342537 [debug] [Thread-2 (]: Began running node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:46:22.342652 [info ] [Thread-2 (]: 8 of 9 START test unique_stg_apple_app_store__downloads_date ................... [RUN]
[0m10:46:22.343264 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:46:22.343391 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:22.343496 [debug] [Thread-2 (]: Began compiling node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:46:22.343622 [debug] [Thread-1 (]: Began executing node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:46:22.343731 [debug] [Thread-2 (]: Compiling test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:46:22.345418 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:46:22.348374 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:46:22.349397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:22.349518 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:22.350417 [debug] [Thread-1 (]: On test.my_new_project.unique_downloads_download_date.07157a0e00: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_downloads_download_date.07157a0e00"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select download_date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`downloads`
  where download_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:22.350517 [debug] [Thread-2 (]: Began executing node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:46:22.394860 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:46:22.395859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:46:22.396555 [debug] [Thread-2 (]: On test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:23.554148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:87fb7f37-d6d0-437a-a1ba-5cfeff9a0906:europe-west1&page=queryresults
[0m10:46:23.554559 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:23.554949 [info ] [Thread-1 (]: 7 of 9 PASS unique_downloads_download_date ..................................... [[32mPASS[0m in 1.22s]
[0m10:46:23.555208 [debug] [Thread-1 (]: Finished running node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:46:23.555331 [debug] [Thread-1 (]: Began running node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:46:23.555478 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_google_play_store__downloads_date ................. [RUN]
[0m10:46:23.555902 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:46:23.556007 [debug] [Thread-1 (]: Began compiling node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:46:23.556106 [debug] [Thread-1 (]: Compiling test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:46:23.558961 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:46:23.559990 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:23.560120 [debug] [Thread-1 (]: Began executing node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:46:23.561668 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:46:23.562234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:23.563089 [debug] [Thread-1 (]: On test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:46:23.603893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5ccb31a2-9821-4fef-bbe1-565fe4fac3c0:europe-west1&page=queryresults
[0m10:46:23.604198 [debug] [Thread-2 (]: finished collecting timing info
[0m10:46:23.604477 [info ] [Thread-2 (]: 8 of 9 PASS unique_stg_apple_app_store__downloads_date ......................... [[32mPASS[0m in 1.26s]
[0m10:46:23.604673 [debug] [Thread-2 (]: Finished running node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:46:25.107038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a3e3d261-5124-47f9-84c9-97975fd084b8:europe-west1&page=queryresults
[0m10:46:25.109313 [debug] [Thread-1 (]: finished collecting timing info
[0m10:46:25.110409 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_google_play_store__downloads_date ....................... [[32mPASS[0m in 1.55s]
[0m10:46:25.111017 [debug] [Thread-1 (]: Finished running node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:46:25.113194 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:46:25.114127 [info ] [MainThread]: 
[0m10:46:25.114524 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m10:46:25.114849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:25.115015 [debug] [MainThread]: Connection 'test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e' was properly closed.
[0m10:46:25.115145 [debug] [MainThread]: Connection 'test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77' was properly closed.
[0m10:46:25.146609 [info ] [MainThread]: 
[0m10:46:25.146875 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:46:25.147048 [info ] [MainThread]: 
[0m10:46:25.147201 [error] [MainThread]: [31mFailure in test not_null_articles_evidence_user_id (models/marts/schema.yml)[0m
[0m10:46:25.147351 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m10:46:25.147489 [info ] [MainThread]: 
[0m10:46:25.147623 [info ] [MainThread]:   compiled Code at target/compiled/my_new_project/models/marts/schema.yml/not_null_articles_evidence_user_id.sql
[0m10:46:25.147774 [info ] [MainThread]: 
[0m10:46:25.147907 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m10:46:25.148121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2de230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2df520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2df2e0>]}
[0m10:46:25.148303 [debug] [MainThread]: Flushing usage events


============================== 2022-12-20 10:47:19.674413 | 5dae2f8a-ef5c-4244-ab52-e00306b58b35 ==============================
[0m10:47:19.674614 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:47:19.675639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m10:47:19.675744 [debug] [MainThread]: Tracking: tracking
[0m10:47:19.685556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137f26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137f3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137f13c0>]}
[0m10:47:19.727407 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m10:47:19.727734 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/marts/schema.yml
[0m10:47:19.727817 [debug] [MainThread]: Partial parsing: deleted file: my_new_project://macros/test_row_count.sql
[0m10:47:19.736939 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m10:47:19.810627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m10:47:19.814173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dae2f8a-ef5c-4244-ab52-e00306b58b35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ac6f80>]}
[0m10:47:19.871533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dae2f8a-ef5c-4244-ab52-e00306b58b35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a1ece0>]}
[0m10:47:19.871783 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m10:47:19.871942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dae2f8a-ef5c-4244-ab52-e00306b58b35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a41db0>]}
[0m10:47:19.872984 [info ] [MainThread]: 
[0m10:47:19.873372 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:47:19.874219 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:47:19.874421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:20.164442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dae2f8a-ef5c-4244-ab52-e00306b58b35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111578df0>]}
[0m10:47:20.165918 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:47:20.166371 [info ] [MainThread]: 
[0m10:47:20.172957 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:47:20.173205 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:47:20.173518 [info ] [Thread-1 (]: 1 of 8 START test not_null_articles_evidence_original_timestamp ................ [RUN]
[0m10:47:20.173722 [info ] [Thread-2 (]: 2 of 8 START test not_null_downloads_download_date ............................. [RUN]
[0m10:47:20.174485 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:47:20.175720 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:47:20.176066 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:47:20.176355 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:47:20.176804 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:47:20.176991 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:47:20.192386 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:47:20.197793 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:47:20.198183 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:20.198359 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:47:20.198454 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:20.210705 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_downloads_download_date.2298360128"
[0m10:47:20.210889 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:47:20.212324 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"
[0m10:47:20.212576 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:47:20.212723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:20.213533 [debug] [Thread-2 (]: On test.my_new_project.not_null_downloads_download_date.2298360128: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_downloads_download_date.2298360128"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select download_date
from `wawa-83630`.`dbt_rsdun`.`downloads`
where download_date is null



      
    ) dbt_internal_test
[0m10:47:20.214413 [debug] [Thread-1 (]: On test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select original_timestamp
from `wawa-83630`.`dbt_rsdun`.`articles_evidence`
where original_timestamp is null



      
    ) dbt_internal_test
[0m10:47:21.172991 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7ffdde70-1075-4d09-adcb-0c25226878bb:europe-west1&page=queryresults
[0m10:47:21.175834 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:21.177033 [info ] [Thread-2 (]: 2 of 8 PASS not_null_downloads_download_date ................................... [[32mPASS[0m in 1.00s]
[0m10:47:21.177632 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_downloads_download_date.2298360128
[0m10:47:21.177903 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:47:21.178100 [info ] [Thread-2 (]: 3 of 8 START test not_null_downloads_total_downloads ........................... [RUN]
[0m10:47:21.178999 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:47:21.179490 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:47:21.179756 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:47:21.185784 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:47:21.186431 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:21.186615 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:47:21.189038 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"
[0m10:47:21.191682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:21.193220 [debug] [Thread-2 (]: On test.my_new_project.not_null_downloads_total_downloads.9265a0287f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_downloads_total_downloads.9265a0287f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_downloads
from `wawa-83630`.`dbt_rsdun`.`downloads`
where total_downloads is null



      
    ) dbt_internal_test
[0m10:47:21.357961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:21422b30-dbe1-4f25-9e09-daa368607268:europe-west1&page=queryresults
[0m10:47:21.358351 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:21.358708 [info ] [Thread-1 (]: 1 of 8 PASS not_null_articles_evidence_original_timestamp ...................... [[32mPASS[0m in 1.18s]
[0m10:47:21.358956 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_articles_evidence_original_timestamp.66e01b2fac
[0m10:47:21.359069 [debug] [Thread-1 (]: Began running node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:47:21.359158 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_apple_app_store__downloads_date ................. [RUN]
[0m10:47:21.359608 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:47:21.359725 [debug] [Thread-1 (]: Began compiling node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:47:21.359819 [debug] [Thread-1 (]: Compiling test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:47:21.362697 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:47:21.363146 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:21.363250 [debug] [Thread-1 (]: Began executing node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:47:21.368077 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"
[0m10:47:21.368435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:21.369305 [debug] [Thread-1 (]: On test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
where date is null



      
    ) dbt_internal_test
[0m10:47:22.244392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6820758f-52fb-41b8-a51e-2be629a7e466:europe-west1&page=queryresults
[0m10:47:22.246416 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:22.247658 [info ] [Thread-2 (]: 3 of 8 PASS not_null_downloads_total_downloads ................................. [[32mPASS[0m in 1.07s]
[0m10:47:22.248459 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_downloads_total_downloads.9265a0287f
[0m10:47:22.248748 [debug] [Thread-2 (]: Began running node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:47:22.249103 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_google_play_store__downloads_date ............... [RUN]
[0m10:47:22.250020 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:47:22.250246 [debug] [Thread-2 (]: Began compiling node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:47:22.250465 [debug] [Thread-2 (]: Compiling test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:47:22.260243 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:47:22.260856 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:22.261024 [debug] [Thread-2 (]: Began executing node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:47:22.263348 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"
[0m10:47:22.263833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:22.265030 [debug] [Thread-2 (]: On test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
where date is null



      
    ) dbt_internal_test
[0m10:47:22.363146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5b44023f-f56a-4079-bbab-88c568cb232e:europe-west1&page=queryresults
[0m10:47:22.363508 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:22.363858 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_apple_app_store__downloads_date ....................... [[32mPASS[0m in 1.00s]
[0m10:47:22.364107 [debug] [Thread-1 (]: Finished running node test.my_new_project.not_null_stg_apple_app_store__downloads_date.2bcfde4be9
[0m10:47:22.364222 [debug] [Thread-1 (]: Began running node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:47:22.364310 [info ] [Thread-1 (]: 6 of 8 START test unique_downloads_download_date ............................... [RUN]
[0m10:47:22.364767 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:47:22.364879 [debug] [Thread-1 (]: Began compiling node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:47:22.364971 [debug] [Thread-1 (]: Compiling test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:47:22.369355 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:47:22.369745 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:22.369850 [debug] [Thread-1 (]: Began executing node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:47:22.371175 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.unique_downloads_download_date.07157a0e00"
[0m10:47:22.371999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:22.372821 [debug] [Thread-1 (]: On test.my_new_project.unique_downloads_download_date.07157a0e00: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_downloads_download_date.07157a0e00"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select download_date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`downloads`
  where download_date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:47:23.451608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:95b79973-d053-4a09-81a6-86a6d3f1d27a:europe-west1&page=queryresults
[0m10:47:23.453027 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:23.454068 [info ] [Thread-1 (]: 6 of 8 PASS unique_downloads_download_date ..................................... [[32mPASS[0m in 1.09s]
[0m10:47:23.454702 [debug] [Thread-1 (]: Finished running node test.my_new_project.unique_downloads_download_date.07157a0e00
[0m10:47:23.454986 [debug] [Thread-1 (]: Began running node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:47:23.455340 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_apple_app_store__downloads_date ................... [RUN]
[0m10:47:23.456256 [debug] [Thread-1 (]: Acquiring new bigquery connection "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:47:23.456451 [debug] [Thread-1 (]: Began compiling node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:47:23.456635 [debug] [Thread-1 (]: Compiling test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:47:23.462402 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:47:23.464489 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:46e49745-da2d-4092-b36d-f8aa01cabba8:europe-west1&page=queryresults
[0m10:47:23.465073 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:23.465216 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:23.465779 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_google_play_store__downloads_date ..................... [[32mPASS[0m in 1.22s]
[0m10:47:23.465981 [debug] [Thread-1 (]: Began executing node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:47:23.466368 [debug] [Thread-2 (]: Finished running node test.my_new_project.not_null_stg_google_play_store__downloads_date.98bb16654d
[0m10:47:23.468623 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"
[0m10:47:23.468833 [debug] [Thread-2 (]: Began running node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:47:23.469106 [info ] [Thread-2 (]: 8 of 8 START test unique_stg_google_play_store__downloads_date ................. [RUN]
[0m10:47:23.469588 [debug] [Thread-2 (]: Acquiring new bigquery connection "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:47:23.469719 [debug] [Thread-2 (]: Began compiling node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:47:23.469861 [debug] [Thread-2 (]: Compiling test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:47:23.473320 [debug] [Thread-2 (]: Writing injected SQL for node "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:47:23.473480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:23.474786 [debug] [Thread-1 (]: On test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:47:23.475378 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:23.521158 [debug] [Thread-2 (]: Began executing node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:47:23.526845 [debug] [Thread-2 (]: Writing runtime sql for node "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"
[0m10:47:23.529010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:23.529711 [debug] [Thread-2 (]: On test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select date as unique_field
  from `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:47:24.519835 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f403554d-afdd-4913-88e7-f4e4c0a615c1:europe-west1&page=queryresults
[0m10:47:24.522233 [debug] [Thread-2 (]: finished collecting timing info
[0m10:47:24.524063 [info ] [Thread-2 (]: 8 of 8 PASS unique_stg_google_play_store__downloads_date ....................... [[32mPASS[0m in 1.05s]
[0m10:47:24.525105 [debug] [Thread-2 (]: Finished running node test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e
[0m10:47:24.544159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:450ac0ec-a22b-4604-a58b-ecc2116558c2:europe-west1&page=queryresults
[0m10:47:24.544892 [debug] [Thread-1 (]: finished collecting timing info
[0m10:47:24.545451 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_apple_app_store__downloads_date ......................... [[32mPASS[0m in 1.09s]
[0m10:47:24.545846 [debug] [Thread-1 (]: Finished running node test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77
[0m10:47:24.547485 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:47:24.548047 [info ] [MainThread]: 
[0m10:47:24.548261 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m10:47:24.548439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:24.548527 [debug] [MainThread]: Connection 'test.my_new_project.unique_stg_apple_app_store__downloads_date.5d1909be77' was properly closed.
[0m10:47:24.548613 [debug] [MainThread]: Connection 'test.my_new_project.unique_stg_google_play_store__downloads_date.5b55a6ef3e' was properly closed.
[0m10:47:24.557294 [info ] [MainThread]: 
[0m10:47:24.557549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:47:24.557737 [info ] [MainThread]: 
[0m10:47:24.557885 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:47:24.558090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113790fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4fcd0>]}
[0m10:47:24.558284 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 12:33:21.863211 | 12431339-b84d-42b7-9a42-f9307b403eb9 ==============================
[0m12:33:21.863254 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:33:21.864565 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:33:21.864891 [debug] [MainThread]: Tracking: tracking
[0m12:33:21.879467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7d0f0>]}
[0m12:33:21.923297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:21.923568 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:33:21.931428 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m12:33:21.988877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m12:33:21.992041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd9e10>]}
[0m12:33:21.999506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4ff40>]}
[0m12:33:21.999730 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m12:33:21.999876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ab2aa0>]}
[0m12:33:22.000844 [info ] [MainThread]: 
[0m12:33:22.001276 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:33:22.002031 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:33:22.002195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:22.467544 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:33:22.468043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:22.760818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105278df0>]}
[0m12:33:22.761410 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:33:22.761610 [info ] [MainThread]: 
[0m12:33:22.766065 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:33:22.766330 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:33:22.766467 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:33:22.766915 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:33:22.767164 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:33:22.767327 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:33:22.767733 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:33:22.767897 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:33:22.768104 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:33:22.770277 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:33:22.770459 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:33:22.773665 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:22.773782 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:33:22.791042 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:33:22.794769 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:33:22.795011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:22.795805 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:33:22.832127 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:22.832338 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:33:22.833959 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:33:22.834471 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:33:22.835111 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:33:23.423941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5f1bfc31-e629-4d7c-acb9-e92d93e7c01d:europe-west1&page=queryresults
[0m12:33:23.436961 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:23.437384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e74100>]}
[0m12:33:23.438045 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m12:33:23.438416 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:33:23.438550 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:33:23.438807 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:33:23.439257 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:33:23.439360 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:33:23.439718 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:33:23.441008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:33:23.443607 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:23.443760 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:33:23.445721 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:33:23.448979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:23.449726 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:33:23.538489 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:baa8fcd5-2b62-4b75-b4ed-1ee245116989:europe-west1&page=queryresults
[0m12:33:23.539859 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:23.540294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a96b30>]}
[0m12:33:23.540518 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m12:33:23.540731 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:33:23.540820 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:33:23.540924 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:33:23.541411 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:33:23.541818 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:33:23.541967 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:33:23.543327 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:33:23.543726 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:23.543822 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:33:23.545828 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:33:23.546209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:23.546941 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:33:24.082921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23fa78b6-ca15-446b-9950-19d5a0ff83d5:europe-west1&page=queryresults
[0m12:33:24.085360 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:24.086163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aec4c0>]}
[0m12:33:24.086616 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.65s]
[0m12:33:24.087115 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:33:24.087346 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:33:24.087728 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:33:24.088672 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:33:24.088883 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:33:24.089071 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:33:24.096960 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:33:24.098228 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:24.098420 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:33:24.101522 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:33:24.102003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:24.103284 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m12:33:24.154203 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:00581c38-910a-40b2-9649-154cba0cc988:europe-west1&page=queryresults
[0m12:33:24.155116 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:24.155451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7cf10>]}
[0m12:33:24.155632 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.61s]
[0m12:33:24.156056 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:33:24.156176 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m12:33:24.156295 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m12:33:24.156638 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m12:33:24.156762 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m12:33:24.156927 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m12:33:24.161554 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m12:33:24.163816 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:24.163894 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m12:33:24.178558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:24.508974 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m12:33:24.511386 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m12:33:24.791610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7e358205-a4ed-4480-b78a-fb8cd19caa0d:europe-west1&page=queryresults
[0m12:33:24.798404 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:24.801486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b3e50>]}
[0m12:33:24.802396 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m12:33:24.803294 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:33:24.804393 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:33:24.804801 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:33:24.805881 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:33:24.806235 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:33:24.806561 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:33:24.813918 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:33:24.815841 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:24.816118 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:33:24.824964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:25.136038 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:33:25.138425 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m12:33:26.636123 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f81229a9-027e-4e28-a345-bc248b6bd2ff:europe-west1&page=queryresults
[0m12:33:26.644460 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:26.645768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b09e40>]}
[0m12:33:26.646899 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (7.0 rows, 862.1 KB processed)[0m in 2.49s]
[0m12:33:26.647644 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m12:33:26.647960 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m12:33:26.648285 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m12:33:26.649580 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m12:33:26.650057 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m12:33:26.650343 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m12:33:26.662363 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m12:33:26.665828 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:26.666068 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m12:33:26.668788 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:26.920620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c35009c7-a428-4975-9be3-7c527114387b:europe-west1&page=queryresults
[0m12:33:26.922775 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:26.923488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b6aec0>]}
[0m12:33:26.923908 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (4.0 rows, 463.0 KB processed)[0m in 2.12s]
[0m12:33:26.924377 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:33:26.924594 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m12:33:26.924946 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m12:33:26.925922 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:33:26.926294 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m12:33:26.926480 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m12:33:26.931461 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:33:26.934492 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:26.934842 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m12:33:26.938106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:26.990022 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m12:33:26.990417 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m12:33:27.259240 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:33:27.264936 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:33:28.794121 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b41e9d67-855b-4bd7-932c-b62eee5ef9ce:europe-west1&page=queryresults
[0m12:33:28.795350 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:28.795784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b50e80>]}
[0m12:33:28.796025 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (54.0 rows, 1.1 MB processed)[0m in 2.15s]
[0m12:33:28.796305 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m12:33:28.796436 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:33:28.796637 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m12:33:28.797222 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:33:28.797319 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:33:28.797407 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:33:28.799788 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:33:28.800459 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:28.800570 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:33:28.808317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:29.097064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3d86d37c-51cd-44a2-98b4-e4255439cce3:europe-west1&page=queryresults
[0m12:33:29.098797 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:29.099430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b53b80>]}
[0m12:33:29.099776 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.9 KB processed)[0m in 2.17s]
[0m12:33:29.100104 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m12:33:29.100260 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:33:29.100428 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m12:33:29.101073 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:33:29.101245 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:33:29.101371 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:33:29.110659 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:33:29.112989 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:29.113123 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:33:29.119447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:29.129639 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:33:29.169303 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:33:29.449874 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:33:29.452101 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m12:33:31.419109 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:06371bd4-aa0b-4e5a-9309-9833d21bbeab:europe-west1&page=queryresults
[0m12:33:31.420784 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:31.421182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8e0e0>]}
[0m12:33:31.421410 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (351.0 rows, 45.9 KB processed)[0m in 2.62s]
[0m12:33:31.421696 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:33:31.678473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8aac388a-42e5-4c94-b38b-b6d538e883a4:europe-west1&page=queryresults
[0m12:33:31.680199 [debug] [Thread-1 (]: finished collecting timing info
[0m12:33:31.680792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066597e0>]}
[0m12:33:31.681131 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.58s]
[0m12:33:31.681511 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:33:31.682023 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:33:31.682578 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m12:33:31.683093 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:33:31.683235 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:33:31.683365 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m12:33:31.688076 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:33:31.690634 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:31.690851 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m12:33:31.692454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:31.998011 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:33:31.998528 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events

select * from (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)
    );
  
[0m12:33:32.278602 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [49:1]')
[0m12:33:32.880388 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:9f23618c-7b80-4243-bab6-115ede3bc764&page=queryresults
[0m12:33:32.881128 [debug] [Thread-2 (]: finished collecting timing info
[0m12:33:32.881697 [debug] [Thread-2 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [49:1]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:33:32.881948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12431339-b84d-42b7-9a42-f9307b403eb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a85ea0>]}
[0m12:33:32.882323 [error] [Thread-2 (]: 12 of 12 ERROR creating sql table model dbt_rsdun.articles_evidence ............ [[31mERROR[0m in 1.20s]
[0m12:33:32.882690 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:33:32.884154 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:33:32.884680 [info ] [MainThread]: 
[0m12:33:32.884900 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m12:33:32.885072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:32.885161 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m12:33:32.885247 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:33:32.899752 [info ] [MainThread]: 
[0m12:33:32.899973 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:32.900125 [info ] [MainThread]: 
[0m12:33:32.900254 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:33:32.900566 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [49:1]
[0m12:33:32.900711 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:33:32.900863 [info ] [MainThread]: 
[0m12:33:32.901001 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m12:33:32.901200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aabc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa9960>]}
[0m12:33:32.901353 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 12:35:01.244962 | 7a606750-3f98-412f-8797-e2e6093e7dc1 ==============================
[0m12:35:01.245003 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:35:01.245718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:35:01.245819 [debug] [MainThread]: Tracking: tracking
[0m12:35:01.254991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf4f40>]}
[0m12:35:01.294664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:01.294933 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:35:01.301761 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m12:35:01.356258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m12:35:01.359439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dd9f00>]}
[0m12:35:01.366298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4ff40>]}
[0m12:35:01.366502 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m12:35:01.366633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b30d0>]}
[0m12:35:01.367484 [info ] [MainThread]: 
[0m12:35:01.367832 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:35:01.368552 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:35:01.368754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:01.817528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:35:01.818095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:02.112828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107974d60>]}
[0m12:35:02.114130 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:35:02.114548 [info ] [MainThread]: 
[0m12:35:02.122348 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:02.122613 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:35:02.123044 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:35:02.123338 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:35:02.124179 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:35:02.124945 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:35:02.125209 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:02.125402 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:35:02.125646 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:35:02.125851 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:35:02.129459 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:35:02.134409 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:02.134633 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:02.151816 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:35:02.161118 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:35:02.161519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:02.161639 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:02.161787 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:35:02.162569 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:35:02.164442 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:35:02.203643 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:35:02.204250 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:35:03.799699 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dcf682e4-e435-4889-91a3-728e528d4134:europe-west1&page=queryresults
[0m12:35:03.819981 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:03.820716 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e8de40>]}
[0m12:35:03.821092 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m12:35:03.821511 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:35:03.821682 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:03.821976 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:35:03.822554 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:35:03.822701 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:03.822837 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:03.824632 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:35:03.825286 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:03.825432 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:03.827786 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:35:03.828169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:03.829181 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:35:03.976461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:01613dd9-0534-41b2-b163-f14eddc98df5:europe-west1&page=queryresults
[0m12:35:03.977875 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:03.978267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e4dde0>]}
[0m12:35:03.978501 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.85s]
[0m12:35:03.978776 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:03.978895 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:03.979109 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:35:03.979647 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:35:03.979765 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:03.979867 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:03.981093 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:35:03.981511 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:03.981618 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:03.983479 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:35:03.983781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:03.984588 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:35:05.836001 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fbd2a3f6-e417-4344-8623-ad30109720a9:europe-west1&page=queryresults
[0m12:35:05.839266 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:05.840153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc7580>]}
[0m12:35:05.840646 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m12:35:05.841136 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:05.841336 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:05.841657 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:35:05.842334 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:35:05.842498 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:05.842657 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:05.849368 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:35:05.849920 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:05.850062 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:05.852704 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:35:05.853172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:05.853985 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m12:35:05.989380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f216b6f4-5294-4e99-80c6-7c6bb24da500:europe-west1&page=queryresults
[0m12:35:05.990554 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:05.990926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea00d0>]}
[0m12:35:05.991147 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m12:35:05.991408 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:05.991525 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m12:35:05.991650 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m12:35:05.992132 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m12:35:05.992243 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m12:35:05.992352 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m12:35:05.998514 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m12:35:05.999082 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:05.999185 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m12:35:06.016620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:06.346573 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m12:35:06.347532 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m12:35:07.869087 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:09042e9c-7405-4b46-85f2-f786b2249348:europe-west1&page=queryresults
[0m12:35:07.871491 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:07.872252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea2e30>]}
[0m12:35:07.872703 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m12:35:07.873257 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:07.873494 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:07.873905 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:35:07.874717 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:35:07.874897 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:07.875052 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:07.879606 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:35:07.880200 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:07.880357 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:07.885925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:08.510965 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:35:08.513474 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m12:35:09.388457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:97148ea5-247f-4e3d-8764-20e3fb1e2ef9:europe-west1&page=queryresults
[0m12:35:09.390455 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:09.391192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110120b0>]}
[0m12:35:09.391658 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 862.2 KB processed)[0m in 3.40s]
[0m12:35:09.392164 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m12:35:09.392384 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:09.392723 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m12:35:09.393397 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m12:35:09.393574 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:09.393734 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m12:35:09.398382 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m12:35:09.399064 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:09.399206 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:09.401586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:09.815535 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m12:35:09.817017 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m12:35:10.428483 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1aefa9d3-b0e0-4a48-8f91-3c12d90560c1:europe-west1&page=queryresults
[0m12:35:10.431314 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:10.432102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea0130>]}
[0m12:35:10.432548 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 463.0 KB processed)[0m in 2.56s]
[0m12:35:10.433047 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:10.433257 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:10.433610 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m12:35:10.434368 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:35:10.434564 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:10.434735 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:10.439615 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:35:10.440423 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:10.440585 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:10.443404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:10.859981 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:35:10.861165 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:35:11.597701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f460e1e0-70a8-4909-acc4-715f088aca13:europe-west1&page=queryresults
[0m12:35:11.600144 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:11.601008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea2860>]}
[0m12:35:11.601525 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.1 MB processed)[0m in 2.21s]
[0m12:35:11.602117 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:11.602367 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m12:35:11.602761 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m12:35:11.603527 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:35:11.603727 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m12:35:11.603902 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m12:35:11.608509 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:35:11.609275 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:11.609441 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m12:35:11.619666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:12.125622 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:35:12.126454 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:35:12.716780 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3fc38f4e-fe17-4864-abba-6c081f1760b4:europe-west1&page=queryresults
[0m12:35:12.719369 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:12.720414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea0a00>]}
[0m12:35:12.720949 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.9 KB processed)[0m in 2.29s]
[0m12:35:12.721541 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:12.721757 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:35:12.721996 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m12:35:12.722863 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:35:12.723045 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:35:12.723210 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:35:12.732195 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:35:12.733757 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:12.733958 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:35:12.736566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:13.250955 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:35:13.251848 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m12:35:14.261749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4701a5d6-e657-43ef-bc04-29980d44b365:europe-west1&page=queryresults
[0m12:35:14.265372 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:14.266156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea2800>]}
[0m12:35:14.266578 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (351.0 rows, 45.9 KB processed)[0m in 2.66s]
[0m12:35:14.267048 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m12:35:15.316337 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d3f6a6ff-a03f-4032-919c-3a4dbec254ea:europe-west1&page=queryresults
[0m12:35:15.317452 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:15.317885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea0e80>]}
[0m12:35:15.318125 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 2.60s]
[0m12:35:15.318402 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:35:15.318801 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m12:35:15.319156 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m12:35:15.319614 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:35:15.319777 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:35:15.319929 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m12:35:15.323572 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:35:15.324029 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:15.324148 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m12:35:15.325564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:15.739510 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:35:15.741215 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT ae.slug, original_timestamp, ae.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON ae.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT * FROM all_events_with_article_id
    );
  
[0m12:35:16.338062 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: ae at [35:103]')
[0m12:35:17.693698 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:61ed755b-7e73-4f9c-ba16-47f3a1a52656&page=queryresults
[0m12:35:17.695941 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:17.697376 [debug] [Thread-1 (]: Database Error in model articles_evidence (models/marts/articles_evidence.sql)
  Unrecognized name: ae at [35:103]
  compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:35:17.698033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a606750-3f98-412f-8797-e2e6093e7dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110c7fa0>]}
[0m12:35:17.698644 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model dbt_rsdun.articles_evidence ............ [[31mERROR[0m in 2.38s]
[0m12:35:17.699280 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m12:35:17.701428 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:35:17.702263 [info ] [MainThread]: 
[0m12:35:17.702628 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 16.33 seconds (16.33s).
[0m12:35:17.702949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:17.703113 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:35:17.703246 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m12:35:17.722980 [info ] [MainThread]: 
[0m12:35:17.723238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:35:17.723423 [info ] [MainThread]: 
[0m12:35:17.723578 [error] [MainThread]: [33mDatabase Error in model articles_evidence (models/marts/articles_evidence.sql)[0m
[0m12:35:17.723733 [error] [MainThread]:   Unrecognized name: ae at [35:103]
[0m12:35:17.723878 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/marts/articles_evidence.sql
[0m12:35:17.724041 [info ] [MainThread]: 
[0m12:35:17.724197 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m12:35:17.724413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5a500>]}
[0m12:35:17.724590 [debug] [MainThread]: Flushing usage events


============================== 2022-12-21 12:35:54.007626 | 45760abf-2483-47c8-b3ed-ad28f42c7333 ==============================
[0m12:35:54.007659 [info ] [MainThread]: Running with dbt=1.3.1
[0m12:35:54.008433 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:35:54.008562 [debug] [MainThread]: Tracking: tracking
[0m12:35:54.021719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b31690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b31570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b30f40>]}
[0m12:35:54.063168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:54.063446 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m12:35:54.069933 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m12:35:54.124907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m12:35:54.128072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d15f30>]}
[0m12:35:54.135036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8bf40>]}
[0m12:35:54.135232 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m12:35:54.135361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020d6b60>]}
[0m12:35:54.136251 [info ] [MainThread]: 
[0m12:35:54.136590 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:35:54.137263 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m12:35:54.137404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:54.667131 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m12:35:54.667769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:54.972407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2cd90>]}
[0m12:35:54.973602 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:35:54.973992 [info ] [MainThread]: 
[0m12:35:54.980844 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:54.981069 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m12:35:54.981545 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m12:35:54.981848 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m12:35:54.982733 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m12:35:54.983439 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m12:35:54.983666 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:54.983852 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m12:35:54.984064 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m12:35:54.984203 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m12:35:54.987362 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:35:54.991913 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:54.992104 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:55.015805 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m12:35:55.019932 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:35:55.020356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:55.020472 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:55.021394 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m12:35:55.021495 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m12:35:55.062424 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m12:35:55.062736 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:35:55.063372 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m12:35:55.640661 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ee6ead56-e9d6-459f-a5a8-078f8bdb16fd:europe-west1&page=queryresults
[0m12:35:55.659380 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:55.660032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db2d10>]}
[0m12:35:55.660411 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m12:35:55.660842 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m12:35:55.661015 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:55.661315 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m12:35:55.661891 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:35:55.662038 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:55.662179 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:55.663899 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:35:55.664533 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:55.664677 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:55.667179 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m12:35:55.667568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:55.668541 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m12:35:55.959289 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6971345b-45f9-464e-8c45-5418e1329cb8:europe-west1&page=queryresults
[0m12:35:55.963561 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:55.964613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddca90>]}
[0m12:35:55.965232 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m12:35:55.965800 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m12:35:55.966033 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:55.966561 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m12:35:55.967755 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:35:55.967964 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:55.968145 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:55.970736 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:35:55.971572 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:55.971787 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:55.975023 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m12:35:55.975604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:55.977058 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m12:35:56.218552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:adc34172-dfd3-4f36-b595-fbacd5ecd182:europe-west1&page=queryresults
[0m12:35:56.219898 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:56.220325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f03d60>]}
[0m12:35:56.220573 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.56s]
[0m12:35:56.220861 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m12:35:56.220994 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:56.221134 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m12:35:56.221663 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:35:56.221801 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:56.221910 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:56.226563 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:35:56.226981 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:56.227102 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:56.229166 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m12:35:56.229525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:56.230407 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m12:35:56.520154 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3573f2da-f8cb-439d-9147-217388f7bf14:europe-west1&page=queryresults
[0m12:35:56.522182 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:56.522811 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dddf60>]}
[0m12:35:56.523174 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.56s]
[0m12:35:56.523563 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m12:35:56.523742 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m12:35:56.524030 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m12:35:56.524918 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m12:35:56.525124 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m12:35:56.525290 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m12:35:56.534269 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m12:35:56.534898 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:56.535027 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m12:35:56.555799 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:56.858450 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m12:35:56.859270 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m12:35:56.913159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1b287920-4d2e-4bbc-b77b-6f8f12003200:europe-west1&page=queryresults
[0m12:35:56.915108 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:56.915744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e3b80>]}
[0m12:35:56.916126 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.69s]
[0m12:35:56.916563 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m12:35:56.916750 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:56.917061 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m12:35:56.917747 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:35:56.917916 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:56.918083 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:56.922257 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:35:56.922787 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:56.922924 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:56.928642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:57.229552 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m12:35:57.230443 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m12:35:58.638451 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0ef8d0f2-12ac-4068-ad65-34d2b5511af5:europe-west1&page=queryresults
[0m12:35:58.642110 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:58.642791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f53eb0>]}
[0m12:35:58.643159 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 862.2 KB processed)[0m in 2.12s]
[0m12:35:58.643572 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m12:35:58.643748 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:58.644042 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m12:35:58.644709 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m12:35:58.644876 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:58.645027 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m12:35:58.648710 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m12:35:58.649194 [debug] [Thread-2 (]: finished collecting timing info
[0m12:35:58.649343 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m12:35:58.651631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:35:58.967994 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m12:35:58.969194 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m12:35:59.014030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f3b6fc44-b3be-49c4-92fb-5b7f527a1ea5:europe-west1&page=queryresults
[0m12:35:59.017022 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:59.017949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddf490>]}
[0m12:35:59.018469 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 463.0 KB processed)[0m in 2.10s]
[0m12:35:59.019038 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m12:35:59.019286 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:59.019647 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m12:35:59.020411 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:35:59.020622 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:59.020795 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:59.025996 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:35:59.026810 [debug] [Thread-1 (]: finished collecting timing info
[0m12:35:59.026979 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m12:35:59.030054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:59.323797 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m12:35:59.324934 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m12:36:00.802105 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:588cc7be-8a60-45e3-af5d-dedbd8ff0c2d:europe-west1&page=queryresults
[0m12:36:00.805530 [debug] [Thread-2 (]: finished collecting timing info
[0m12:36:00.806555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fae7a0>]}
[0m12:36:00.807108 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 1.1 MB processed)[0m in 2.16s]
[0m12:36:00.807703 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m12:36:00.807957 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m12:36:00.808311 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m12:36:00.809069 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m12:36:00.809264 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m12:36:00.809436 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m12:36:00.813987 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m12:36:00.814924 [debug] [Thread-2 (]: finished collecting timing info
[0m12:36:00.815116 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m12:36:00.825856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:36:01.107588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:34db3dc2-2630-4fdf-9266-b1da6e9bea97:europe-west1&page=queryresults
[0m12:36:01.111030 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:01.112005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddf3a0>]}
[0m12:36:01.112530 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.9 KB processed)[0m in 2.09s]
[0m12:36:01.113093 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m12:36:01.113347 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:36:01.113702 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m12:36:01.114438 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:36:01.114625 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:36:01.114803 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:36:01.128792 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:36:01.146341 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m12:36:01.146679 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:01.146819 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:36:01.148878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:01.149080 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m12:36:01.500922 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m12:36:01.501939 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m12:36:04.029671 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dad0bf7e-152c-40ea-9da6-4428f365ecb6:europe-west1&page=queryresults
[0m12:36:04.033892 [debug] [Thread-2 (]: finished collecting timing info
[0m12:36:04.034897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee1f90>]}
[0m12:36:04.035442 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (351.0 rows, 45.9 KB processed)[0m in 3.23s]
[0m12:36:04.036049 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m12:36:05.049280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:be2f866f-59bb-45e8-a544-eeb836ac22e2:europe-west1&page=queryresults
[0m12:36:05.053170 [debug] [Thread-1 (]: finished collecting timing info
[0m12:36:05.054262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602f610>]}
[0m12:36:05.054777 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.7 MB processed)[0m in 3.94s]
[0m12:36:05.055263 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m12:36:05.056181 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m12:36:05.056633 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m12:36:05.057407 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m12:36:05.057609 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m12:36:05.057790 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m12:36:05.064115 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m12:36:05.064945 [debug] [Thread-2 (]: finished collecting timing info
[0m12:36:05.065120 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m12:36:05.067138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:36:05.366059 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m12:36:05.367508 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT * FROM all_events_with_article_id
    );
  
[0m12:36:08.109941 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ccf22c00-cc08-46a0-8aca-4a50634c30dd:europe-west1&page=queryresults
[0m12:36:08.114734 [debug] [Thread-2 (]: finished collecting timing info
[0m12:36:08.115548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45760abf-2483-47c8-b3ed-ad28f42c7333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2c310>]}
[0m12:36:08.115961 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (16.9k rows, 2.4 MB processed)[0m in 3.06s]
[0m12:36:08.116436 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m12:36:08.118202 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m12:36:08.118964 [info ] [MainThread]: 
[0m12:36:08.119245 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 13.98 seconds (13.98s).
[0m12:36:08.119475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:08.119581 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m12:36:08.119675 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m12:36:08.137359 [info ] [MainThread]: 
[0m12:36:08.137573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:08.137751 [info ] [MainThread]: 
[0m12:36:08.137876 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m12:36:08.138045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104725060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047256c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b38df0>]}
[0m12:36:08.138192 [debug] [MainThread]: Flushing usage events


============================== 2023-01-16 11:03:40.358883 | e219338b-731d-488d-9a57-de3e8e96bb68 ==============================
[0m11:03:40.358926 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:03:40.359580 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:03:40.359674 [debug] [MainThread]: Tracking: tracking
[0m11:03:40.369458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f1210>]}
[0m11:03:40.410680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:40.410944 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m11:03:40.418375 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m11:03:40.474159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m11:03:40.477442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd9cf0>]}
[0m11:03:40.484529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c873a0>]}
[0m11:03:40.484719 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m11:03:40.484844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1a650>]}
[0m11:03:40.485885 [info ] [MainThread]: 
[0m11:03:40.486279 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:03:40.487021 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:03:40.487187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:40.904821 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:03:40.905426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:41.147513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105878d90>]}
[0m11:03:41.148403 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:03:41.148722 [info ] [MainThread]: 
[0m11:03:41.155007 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:03:41.155209 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:03:41.155562 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:03:41.155780 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:03:41.156454 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:03:41.157318 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:03:41.157571 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:03:41.157794 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:03:41.157987 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:03:41.158133 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:03:41.160993 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:03:41.165103 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:41.165376 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:03:41.187064 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:03:41.190701 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:03:41.191083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:41.191999 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:03:41.192090 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:41.230513 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:03:41.232193 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:03:41.232467 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:03:41.233040 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:03:41.767857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23107b27-e348-40f5-b7ca-70cf875c83f1:europe-west1&page=queryresults
[0m11:03:41.788450 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:41.789216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c597e0>]}
[0m11:03:41.789577 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m11:03:41.789984 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:03:41.790158 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:03:41.790431 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:03:41.791010 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:03:41.791163 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:03:41.791289 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:03:41.793044 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:03:41.794813 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:41.794963 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:03:41.797391 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:03:41.797774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:41.798752 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:03:41.961083 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8b498fa0-9749-4e1c-a27d-a8a6b9f418e1:europe-west1&page=queryresults
[0m11:03:41.962440 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:41.962877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca1ff0>]}
[0m11:03:41.963124 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m11:03:41.963417 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:03:41.963548 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:03:41.963685 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:03:41.964309 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:03:41.964441 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:03:41.964547 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:03:41.965899 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:03:41.966342 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:41.966443 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:03:41.968600 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:03:41.969051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:41.969930 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:03:42.493283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:17bfde50-a58c-48fb-b429-aaaf51e7acf5:europe-west1&page=queryresults
[0m11:03:42.496066 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:42.496938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca3d30>]}
[0m11:03:42.497384 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m11:03:42.497883 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:03:42.498106 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:03:42.498454 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:03:42.499210 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:03:42.499398 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:03:42.499562 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:03:42.507163 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:03:42.509637 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:42.509799 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:03:42.512876 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:03:42.513296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:42.514563 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m11:03:42.715750 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a1959a49-36da-4c1c-853b-bc15336ba641:europe-west1&page=queryresults
[0m11:03:42.717260 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:42.717750 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcf2b0>]}
[0m11:03:42.718017 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m11:03:42.718328 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:03:42.718470 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m11:03:42.718876 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m11:03:42.719527 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m11:03:42.719653 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m11:03:42.719767 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m11:03:42.727356 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m11:03:42.728843 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:42.729050 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m11:03:42.749376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:43.022115 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m11:03:43.023923 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m11:03:43.260486 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:630e46af-9310-474e-b409-c0637da6e545:europe-west1&page=queryresults
[0m11:03:43.264409 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:43.265366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca37c0>]}
[0m11:03:43.265924 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m11:03:43.268021 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:03:43.268292 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:03:43.268516 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:03:43.269210 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:03:43.269435 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:03:43.269933 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:03:43.274476 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:03:43.275687 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:43.275897 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:03:43.282480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:43.512449 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:03:43.513350 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m11:03:45.317371 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6c21bee3-b554-47ae-9130-c30b09a74bf7:europe-west1&page=queryresults
[0m11:03:45.321772 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:45.323064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0e230>]}
[0m11:03:45.323844 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (342.0 rows, 1.1 MB processed)[0m in 2.60s]
[0m11:03:45.324663 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m11:03:45.324977 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m11:03:45.325249 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m11:03:45.326487 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m11:03:45.326801 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m11:03:45.327027 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m11:03:45.333780 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m11:03:45.335132 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:45.335376 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m11:03:45.338959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:45.588692 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m11:03:45.591942 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m11:03:46.444645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1833fdfd-78e1-475c-a9ff-c051c302cf99:europe-west1&page=queryresults
[0m11:03:46.446963 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:46.448482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca2770>]}
[0m11:03:46.449378 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (3.0 rows, 464.1 KB processed)[0m in 3.18s]
[0m11:03:46.450510 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:03:46.450875 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m11:03:46.451268 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m11:03:46.452865 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m11:03:46.453341 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m11:03:46.453635 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m11:03:46.461866 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m11:03:46.464433 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:46.464653 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m11:03:46.467393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:46.696865 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m11:03:46.697616 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m11:03:48.522520 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dcfbdcef-db67-4b47-8cfd-dcebc5247a31:europe-west1&page=queryresults
[0m11:03:48.524455 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:48.525127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e24580>]}
[0m11:03:48.525495 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (2.3k rows, 2.6 MB processed)[0m in 3.20s]
[0m11:03:48.525931 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m11:03:48.526128 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m11:03:48.526441 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m11:03:48.527126 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:03:48.527298 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m11:03:48.527447 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m11:03:48.531270 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:03:48.533421 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:48.533580 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m11:03:48.543350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:48.809771 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:03:48.810290 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:03:49.952230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:13304b40-d987-47d3-8996-606fc9635637:europe-west1&page=queryresults
[0m11:03:49.953586 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:49.954151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da2dd0>]}
[0m11:03:49.954466 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.9 KB processed)[0m in 3.50s]
[0m11:03:49.954831 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m11:03:49.955008 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:03:49.955357 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m11:03:49.956108 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:03:49.956262 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:03:49.956407 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:03:49.963356 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:03:49.965132 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:49.965309 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:03:49.967724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:50.215088 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:03:50.216559 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m11:03:51.800873 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:546a4811-a0cc-4b44-9f12-e080d6aa40fa:europe-west1&page=queryresults
[0m11:03:51.802855 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:51.803470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca31f0>]}
[0m11:03:51.803827 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (376.0 rows, 49.2 KB processed)[0m in 3.28s]
[0m11:03:51.804249 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m11:03:53.085488 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d57e4b49-4b5c-47ec-9887-4ed92765ce30:europe-west1&page=queryresults
[0m11:03:53.086428 [debug] [Thread-1 (]: finished collecting timing info
[0m11:03:53.086800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e74730>]}
[0m11:03:53.086998 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (9.0 rows, 42.8 MB processed)[0m in 3.13s]
[0m11:03:53.087229 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:03:53.087630 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m11:03:53.087905 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m11:03:53.088337 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:03:53.088442 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:03:53.088523 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m11:03:53.091353 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:03:53.091847 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:53.091942 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m11:03:53.093043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:03:53.334133 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m11:03:53.334683 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT * 
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m11:03:57.241620 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e63c7be0-79f0-4c17-b282-f4cec7e5437e:europe-west1&page=queryresults
[0m11:03:57.249684 [debug] [Thread-2 (]: finished collecting timing info
[0m11:03:57.251543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e219338b-731d-488d-9a57-de3e8e96bb68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da1540>]}
[0m11:03:57.252490 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.0k rows, 2.8 MB processed)[0m in 4.16s]
[0m11:03:57.253752 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m11:03:57.257165 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:03:57.258419 [info ] [MainThread]: 
[0m11:03:57.258923 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 16.77 seconds (16.77s).
[0m11:03:57.259250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:57.259426 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m11:03:57.259589 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:03:57.288558 [info ] [MainThread]: 
[0m11:03:57.288984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:57.289252 [info ] [MainThread]: 
[0m11:03:57.289443 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m11:03:57.289732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a00a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a006a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcfa00>]}
[0m11:03:57.289997 [debug] [MainThread]: Flushing usage events


============================== 2023-01-16 11:25:30.472939 | 5f2cbc38-01de-4f8a-b8c7-6fd175f943a5 ==============================
[0m11:25:30.472983 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:25:30.473912 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:25:30.474035 [debug] [MainThread]: Tracking: tracking
[0m11:25:30.488979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df5420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df5360>]}
[0m11:25:30.529884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:30.530158 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/articles_evidence.sql
[0m11:25:30.536644 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m11:25:30.591360 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m11:25:30.594615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd9ea0>]}
[0m11:25:30.601913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c66980>]}
[0m11:25:30.602109 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 8 sources, 0 exposures, 0 metrics
[0m11:25:30.602260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9ffd0>]}
[0m11:25:30.603177 [info ] [MainThread]: 
[0m11:25:30.603511 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:25:30.604197 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m11:25:30.604340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:31.012562 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m11:25:31.013143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:31.232725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a74d30>]}
[0m11:25:31.233398 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:25:31.233664 [info ] [MainThread]: 
[0m11:25:31.238464 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:31.238681 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m11:25:31.238900 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m11:25:31.239107 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m11:25:31.239678 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m11:25:31.240321 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m11:25:31.240497 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:31.240629 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m11:25:31.240775 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m11:25:31.240898 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m11:25:31.243491 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:25:31.247483 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:31.247593 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:31.267575 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m11:25:31.271440 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:25:31.272062 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:31.272200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:31.272346 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m11:25:31.274528 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m11:25:31.275320 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m11:25:31.314307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:25:31.315062 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m11:25:31.890903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:392e0889-ec5a-4b94-8dd9-427d5e7d18fb:europe-west1&page=queryresults
[0m11:25:31.910909 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:31.911765 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:22efb824-f02a-40b6-80ad-bd4c4b840abf:europe-west1&page=queryresults
[0m11:25:31.912434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cee7a0>]}
[0m11:25:31.913776 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:31.914146 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m11:25:31.914596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ced6f0>]}
[0m11:25:31.914979 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m11:25:31.915197 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m11:25:31.915377 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:31.915728 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m11:25:31.915925 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m11:25:31.916169 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:31.916660 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:25:31.916919 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m11:25:31.917085 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:31.917570 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:25:31.917710 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:31.917813 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:31.919543 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:25:31.919719 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:31.921039 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:25:31.921602 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:31.921715 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:31.921809 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:31.921913 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:31.924142 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m11:25:31.926150 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m11:25:31.926573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:31.926694 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:31.927701 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m11:25:31.928560 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m11:25:32.474938 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:095f4a63-2df9-48b9-a666-18a33812ee3a:europe-west1&page=queryresults
[0m11:25:32.477659 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:32.478581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111efa60>]}
[0m11:25:32.479101 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.56s]
[0m11:25:32.479701 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m11:25:32.479952 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:32.480427 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m11:25:32.481263 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:25:32.481559 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:32.481764 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:32.490085 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:25:32.492360 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:32.492566 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:32.495277 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m11:25:32.495742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:32.496868 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m11:25:32.906200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d870dce3-77f0-4a47-9695-4811626ead0c:europe-west1&page=queryresults
[0m11:25:32.909881 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:32.910669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cef7c0>]}
[0m11:25:32.911090 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m11:25:32.911544 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m11:25:32.911747 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m11:25:32.912054 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m11:25:32.912716 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m11:25:32.912888 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m11:25:32.913043 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m11:25:32.921918 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m11:25:32.924312 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:32.924492 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m11:25:32.944940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:33.210720 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m11:25:33.211448 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:30478fbc-6cc0-45b7-8474-e9d7322561b6:europe-west1&page=queryresults
[0m11:25:33.212674 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:33.213095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bc970>]}
[0m11:25:33.213344 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m11:25:33.213644 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m11:25:33.213821 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:33.214100 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m11:25:33.214230 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m11:25:33.214647 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:25:33.215237 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:33.215386 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:33.218197 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:25:33.218897 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:33.219029 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:33.223769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:33.470750 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m11:25:33.473044 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT slug, max(original_timestamp) as original_timestamp, reading_session, category, clinic_id, user_id, referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article`
WHERE slug is not null

-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

group by reading_session, slug, category, clinic_id, user_id, referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m11:25:35.293234 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cd3598ee-389e-409b-b640-394f7f360c2f:europe-west1&page=queryresults
[0m11:25:35.295644 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:35.296467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e8c0>]}
[0m11:25:35.296917 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.1 MB processed)[0m in 2.38s]
[0m11:25:35.297420 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m11:25:35.297633 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m11:25:35.297985 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m11:25:35.298747 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m11:25:35.298945 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m11:25:35.299120 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m11:25:35.304079 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m11:25:35.304974 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:35.305151 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m11:25:35.308090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:35.552278 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m11:25:35.553296 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m11:25:35.843971 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:28fc2940-65c5-4849-adcf-60b5ca7999ad:europe-west1&page=queryresults
[0m11:25:35.847024 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:35.848030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111267cd0>]}
[0m11:25:35.848550 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 464.1 KB processed)[0m in 2.63s]
[0m11:25:35.849137 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m11:25:35.849355 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m11:25:35.849727 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m11:25:35.850489 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m11:25:35.850693 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m11:25:35.850875 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m11:25:35.856202 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m11:25:35.858772 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:35.858980 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m11:25:35.861923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:36.110922 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m11:25:36.111966 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT slug, timestamp as original_timestamp, category, user_id, referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article`


-- this filter will only be applied on an incremental run
WHERE (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m11:25:38.058634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a282e1e7-c45f-40f8-af81-d714bc885c2a:europe-west1&page=queryresults
[0m11:25:38.059624 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:38.060025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11121dde0>]}
[0m11:25:38.060245 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 2.6 MB processed)[0m in 2.76s]
[0m11:25:38.060498 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m11:25:38.060615 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m11:25:38.060737 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m11:25:38.061209 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m11:25:38.061323 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m11:25:38.061419 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m11:25:38.063628 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m11:25:38.064950 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:38.065067 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m11:25:38.071617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:38.175846 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:310864e3-cb33-423c-850d-d6f24326c839:europe-west1&page=queryresults
[0m11:25:38.176672 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:38.176998 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca5c60>]}
[0m11:25:38.177183 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 1.9 KB processed)[0m in 2.33s]
[0m11:25:38.177395 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m11:25:38.177492 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:38.177595 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m11:25:38.177897 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:25:38.177986 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:38.178064 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:38.185408 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:25:38.187086 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:38.187180 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:38.191540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:25:38.319016 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m11:25:38.319408 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m11:25:38.439082 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m11:25:38.440948 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m11:25:40.670676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:54ce178d-2610-4eaa-9bf5-a17bdb75811c:europe-west1&page=queryresults
[0m11:25:40.674029 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:40.674921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f1660>]}
[0m11:25:40.675385 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (376.0 rows, 49.2 KB processed)[0m in 2.61s]
[0m11:25:40.675933 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m11:25:40.783406 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:75be51f1-468a-4694-88c6-53fe6a390d94:europe-west1&page=queryresults
[0m11:25:40.785457 [debug] [Thread-2 (]: finished collecting timing info
[0m11:25:40.786203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bd0f0>]}
[0m11:25:40.786640 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.8 MB processed)[0m in 2.61s]
[0m11:25:40.787121 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m11:25:40.787718 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m11:25:40.788218 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m11:25:40.789005 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m11:25:40.789181 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m11:25:40.789352 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m11:25:40.794904 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m11:25:40.796877 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:40.797072 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m11:25:40.798970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.033722 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m11:25:41.034720 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m11:25:43.207710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:943ce1aa-34e0-4585-816b-18823173fb2b:europe-west1&page=queryresults
[0m11:25:43.210954 [debug] [Thread-1 (]: finished collecting timing info
[0m11:25:43.211937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2cbc38-01de-4f8a-b8c7-6fd175f943a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111195c30>]}
[0m11:25:43.212451 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.0k rows, 2.8 MB processed)[0m in 2.42s]
[0m11:25:43.213065 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m11:25:43.214823 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m11:25:43.215543 [info ] [MainThread]: 
[0m11:25:43.215859 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 12.61 seconds (12.61s).
[0m11:25:43.216119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:43.216258 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m11:25:43.216451 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m11:25:43.238989 [info ] [MainThread]: 
[0m11:25:43.239254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:43.239462 [info ] [MainThread]: 
[0m11:25:43.239629 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m11:25:43.239857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd95d0>]}
[0m11:25:43.240032 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:38:08.846410 | f9914320-75b1-40de-a025-ea7898afcb38 ==============================
[0m08:38:08.846436 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:38:08.847071 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:38:08.847169 [debug] [MainThread]: Tracking: tracking
[0m08:38:08.875050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a092410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a093460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a091120>]}
[0m08:38:08.917461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m08:38:08.917813 [debug] [MainThread]: Partial parsing: deleted source source.my_new_project.raw_airbyte__wawa_production_database.community_article
[0m08:38:08.917892 [debug] [MainThread]: Partial parsing: update schema file: my_new_project://models/staging/wawa_production_database/sources.yml
[0m08:38:08.918013 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m08:38:08.918118 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m08:38:08.918224 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m08:38:08.925870 [debug] [MainThread]: 1699: static parser successfully parsed marts/articles_evidence.sql
[0m08:38:08.931484 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m08:38:08.935772 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__viewed_article.sql
[0m08:38:08.936523 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m08:38:08.939128 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__screens_article.sql
[0m08:38:08.939672 [debug] [MainThread]: 1603: static parser failed on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m08:38:08.942453 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_ios__production_events/stg_segment_ios__community_viewed_article.sql
[0m08:38:08.999890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m08:38:09.003188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d5c30>]}
[0m08:38:09.010216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8ba90>]}
[0m08:38:09.010414 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:38:09.010538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2bdf30>]}
[0m08:38:09.011453 [info ] [MainThread]: 
[0m08:38:09.011795 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:38:09.012489 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:38:09.012616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:09.789427 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:38:09.789985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:10.155611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f24f40>]}
[0m08:38:10.156897 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:38:10.157304 [info ] [MainThread]: 
[0m08:38:10.164890 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:38:10.165120 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:38:10.165537 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:38:10.165834 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:38:10.166797 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:38:10.167379 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:38:10.167541 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:38:10.167690 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:38:10.167857 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:38:10.168033 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:38:10.171308 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:38:10.173849 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:38:10.175527 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:10.175686 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:38:10.175810 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:10.197948 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:38:10.198124 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:38:10.201350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:10.202207 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:38:10.245398 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:38:10.245935 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:38:10.246562 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:38:11.097370 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:39904269-9a6c-45a8-8f7a-c94f7957a297:europe-west1&page=queryresults
[0m08:38:11.117327 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:11.117953 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106188310>]}
[0m08:38:11.118315 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m08:38:11.118715 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:38:11.118898 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:38:11.119214 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m08:38:11.119766 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:38:11.119904 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:38:11.120038 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:38:11.121792 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:38:11.123132 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:11.123269 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:38:11.125726 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:38:11.126121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:11.127128 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:38:11.172653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8c6b4b08-f4a3-4fb8-bf61-e28ad730a313:europe-west1&page=queryresults
[0m08:38:11.173577 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:11.173922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41c250>]}
[0m08:38:11.174305 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m08:38:11.174509 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:38:11.174597 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:38:11.174748 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m08:38:11.175149 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:38:11.175251 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:38:11.175340 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:38:11.176319 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:38:11.176678 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:11.176803 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:38:11.178341 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:38:11.178559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:11.179193 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m08:38:11.996574 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:12adbb5a-7d65-4c5e-8772-19fa48f8c699:europe-west1&page=queryresults
[0m08:38:11.997989 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:11.998444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41dd80>]}
[0m08:38:11.998711 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m08:38:11.999013 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:38:11.999153 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:38:11.999597 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:38:12.000678 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:38:12.000892 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:38:12.001084 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:38:12.004519 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:38:12.005537 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:12.005728 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:38:12.008794 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:38:12.009182 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:12.017204 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT slug, original_timestamp, category, user_id, referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article`;


[0m08:38:12.102185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1c3c2f4e-c79f-486e-836b-484bc93016eb:europe-west1&page=queryresults
[0m08:38:12.103083 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:12.103377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d6380>]}
[0m08:38:12.103554 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m08:38:12.103751 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:38:12.103839 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:38:12.103986 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:38:12.104322 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:38:12.104392 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:38:12.104461 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:38:12.110701 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:38:12.113147 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:12.113272 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:38:12.129276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:12.693393 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:38:12.694829 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT category, name, original_timestamp, user_id, referrer, article_id, slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article'



-- this filter will only be applied on an incremental run
AND (original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:38:12.919145 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5cb1559f-ce24-486f-b9e7-d26d14319537:europe-west1&page=queryresults
[0m08:38:12.921907 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:12.922771 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c71e70>]}
[0m08:38:12.923273 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m08:38:12.923874 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:38:12.924102 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:38:12.924338 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:38:12.925225 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:38:12.925447 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:38:12.925647 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:38:12.931298 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:38:12.932175 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:12.932342 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:38:12.935331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:13.463488 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:38:13.463997 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:38:15.023924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f8a1dd8c-8d21-47b4-857d-dc87016e9856:europe-west1&page=queryresults
[0m08:38:15.027911 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:15.028911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a376e00>]}
[0m08:38:15.029389 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (55.0 rows, 1.2 MB processed)[0m in 2.92s]
[0m08:38:15.029901 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:38:15.030118 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:38:15.030468 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:38:15.031262 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:38:15.031465 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:38:15.031637 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:38:15.036993 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:38:15.038583 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:15.038776 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:38:15.047810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:15.565929 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:38:15.567163 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:38:16.338247 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:25cc56ea-338d-45b4-a442-c49229ace1c8:europe-west1&page=queryresults
[0m08:38:16.340622 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:16.341408 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a529b10>]}
[0m08:38:16.341880 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.42s]
[0m08:38:16.342385 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:38:16.342603 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:38:16.342979 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:38:16.343752 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:38:16.343953 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:38:16.344130 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:38:16.349932 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:38:16.352730 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:16.352982 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:38:16.356119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:16.897426 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:38:16.900418 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m08:38:18.377709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:79181aaf-34d3-4aac-af07-76d916f1709b:europe-west1&page=queryresults
[0m08:38:18.380715 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:18.381939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5348b0>]}
[0m08:38:18.382520 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.35s]
[0m08:38:18.383095 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:38:18.383353 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m08:38:18.383765 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:38:18.384673 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:38:18.384889 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m08:38:18.385089 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m08:38:18.389596 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:38:18.390712 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:18.390903 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m08:38:18.401951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:18.953985 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:38:18.954640 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:38:19.223021 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:db2dba68-9800-4a28-8d26-0a65b494ad2f:europe-west1&page=queryresults
[0m08:38:19.225790 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:19.226735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41dea0>]}
[0m08:38:19.227262 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.88s]
[0m08:38:19.227831 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:38:19.228074 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:38:19.228306 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:38:19.229465 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:38:19.229769 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:38:19.229965 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:38:19.234992 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:38:19.236463 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:19.236754 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:38:19.246148 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:19.764497 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:38:19.767137 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:38:21.663471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8c5cd39f-3ab9-42b8-95f5-584d86bb7f33:europe-west1&page=queryresults
[0m08:38:21.666838 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:21.667251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54bf70>]}
[0m08:38:21.667445 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.28s]
[0m08:38:21.667669 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m08:38:22.522340 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1b95be58-88a9-4e8f-a650-923a43be4c83:europe-west1&page=queryresults
[0m08:38:22.524674 [debug] [Thread-2 (]: finished collecting timing info
[0m08:38:22.525542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a558d00>]}
[0m08:38:22.526033 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.8 MB processed)[0m in 3.30s]
[0m08:38:22.526613 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:38:22.527309 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m08:38:22.527867 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m08:38:22.528639 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:38:22.528810 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:38:22.528973 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m08:38:22.535043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:38:22.537377 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:22.537624 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m08:38:22.539734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:23.110853 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:38:23.112093 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m08:38:27.098121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0a056c47-b6ab-4c15-b863-80d96e151794:europe-west1&page=queryresults
[0m08:38:27.100524 [debug] [Thread-1 (]: finished collecting timing info
[0m08:38:27.101276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9914320-75b1-40de-a025-ea7898afcb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a568490>]}
[0m08:38:27.101736 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.1k rows, 2.9 MB processed)[0m in 4.57s]
[0m08:38:27.102263 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m08:38:27.103857 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:38:27.104559 [info ] [MainThread]: 
[0m08:38:27.104809 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 18.09 seconds (18.09s).
[0m08:38:27.104929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:27.104989 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m08:38:27.105044 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m08:38:27.115227 [info ] [MainThread]: 
[0m08:38:27.115481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:27.115697 [info ] [MainThread]: 
[0m08:38:27.115880 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:38:27.116113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2dbd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3748b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3768f0>]}
[0m08:38:27.116293 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:40:52.964604 | 2f8d7f5a-f721-4373-828e-8046459f6c72 ==============================
[0m08:40:52.964703 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:40:52.965527 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:40:52.965685 [debug] [MainThread]: Tracking: tracking
[0m08:40:52.976994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b07b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1bfd0>]}
[0m08:40:53.020592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:40:53.020889 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m08:40:53.021018 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:40:53.028853 [debug] [MainThread]: 1699: static parser successfully parsed staging/segment_android__production_events/stg_segment_android__community_viewed_article.sql
[0m08:40:53.034574 [debug] [MainThread]: 1603: static parser failed on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:40:53.038855 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:40:53.085613 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m08:40:53.089049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b313400>]}
[0m08:40:53.096006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2a62f0>]}
[0m08:40:53.096202 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:40:53.096345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1bfd0>]}
[0m08:40:53.097252 [info ] [MainThread]: 
[0m08:40:53.097582 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:40:53.098278 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:40:53.098406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:53.912512 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:40:53.912945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:54.308977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c5d780>]}
[0m08:40:54.310276 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:40:54.310715 [info ] [MainThread]: 
[0m08:40:54.316693 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:40:54.316998 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:40:54.317513 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:40:54.317858 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:40:54.318714 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:40:54.319398 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:40:54.319647 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:40:54.319878 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:40:54.320103 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:40:54.320296 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:40:54.323275 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:40:54.326194 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:40:54.327096 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:54.327218 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:54.327383 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:40:54.327558 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:40:54.354079 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:40:54.356690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:54.357665 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:40:54.358924 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:40:54.398286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:40:54.398990 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:40:55.191724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:93904bdd-8de2-4975-b799-446fa9670a78:europe-west1&page=queryresults
[0m08:40:55.210640 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:55.211290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b313af0>]}
[0m08:40:55.211656 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m08:40:55.212080 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:40:55.212291 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:40:55.212563 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m08:40:55.213136 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:40:55.213757 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:40:55.214547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4852a327-60ab-4e92-9cb9-79a6da7e635e:europe-west1&page=queryresults
[0m08:40:55.214712 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:40:55.216095 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:55.217902 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:40:55.218386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b313e50>]}
[0m08:40:55.218724 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m08:40:55.219416 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:40:55.219600 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:40:55.219773 [info ] [Thread-2 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m08:40:55.219932 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:55.220342 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:40:55.220626 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:40:55.220765 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:40:55.223133 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:40:55.223323 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:40:55.224623 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:40:55.224908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:55.225049 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:55.225969 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:40:55.226083 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:40:55.270391 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:40:55.270721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:40:55.271363 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m08:40:56.114527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:edc17dc1-2775-4a83-a27e-98be1d2579ad:europe-west1&page=queryresults
[0m08:40:56.117539 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:56.118462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b312b00>]}
[0m08:40:56.118957 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m08:40:56.119449 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:40:56.119753 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:40:56.120041 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:40:56.120918 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:40:56.121130 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:40:56.121303 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:40:56.125599 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:40:56.128007 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:56.128209 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:40:56.131459 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:40:56.132123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:56.133462 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m08:40:56.182638 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:df2f466d-968f-4e87-8b1e-974c97c2d88c:europe-west1&page=queryresults
[0m08:40:56.183749 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:56.184119 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b07a6e0>]}
[0m08:40:56.184313 [info ] [Thread-2 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m08:40:56.184517 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:40:56.184608 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:40:56.184801 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:40:56.185130 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:40:56.185203 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:40:56.185270 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:40:56.197781 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:40:56.198585 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:56.198676 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:40:56.213524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:40:56.706143 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:40:56.707865 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens`
WHERE name='Article' as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id


-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:40:57.057706 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword AS at [14:22]')
[0m08:40:57.169376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:82f40f8f-2918-41fe-90ba-500679b56abb:europe-west1&page=queryresults
[0m08:40:57.171262 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:57.171858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b617430>]}
[0m08:40:57.172146 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m08:40:57.172448 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:40:57.172597 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:40:57.172808 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:40:57.173288 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:40:57.173409 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:40:57.173517 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:40:57.177628 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:40:57.178483 [debug] [Thread-1 (]: finished collecting timing info
[0m08:40:57.178769 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:40:57.181170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:57.447867 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:a0b02a8f-b405-41cc-af26-e750520e5fb2&page=queryresults
[0m08:40:57.449346 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:57.450345 [debug] [Thread-2 (]: Database Error in model stg_segment_android__screens_article (models/staging/segment_android__production_events/stg_segment_android__screens_article.sql)
  Syntax error: Expected ")" but got keyword AS at [14:22]
  compiled Code at target/run/my_new_project/models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:40:57.450751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b63f4c0>]}
[0m08:40:57.451318 [error] [Thread-2 (]: 6 of 12 ERROR creating sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[31mERROR[0m in 1.27s]
[0m08:40:57.451876 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:40:57.452109 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:40:57.452532 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:40:57.453340 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:40:57.453543 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:40:57.453715 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:40:57.459719 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:40:57.460454 [debug] [Thread-2 (]: finished collecting timing info
[0m08:40:57.460631 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:40:57.463434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:40:57.625052 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:40:57.625565 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:40:57.873899 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:40:57.874682 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:41:00.202928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c9a3186b-b01b-4b54-a824-5bf771013587:europe-west1&page=queryresults
[0m08:41:00.205407 [debug] [Thread-1 (]: finished collecting timing info
[0m08:41:00.206335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3ffb20>]}
[0m08:41:00.206810 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.03s]
[0m08:41:00.207335 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:41:00.207577 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:41:00.207961 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:41:00.211358 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:41:00.211596 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:41:00.211759 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:41:00.216345 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:41:00.218389 [debug] [Thread-1 (]: finished collecting timing info
[0m08:41:00.218568 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:41:00.220401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:00.601993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a68464a7-868f-4134-b546-80a70a97234f:europe-west1&page=queryresults
[0m08:41:00.604442 [debug] [Thread-2 (]: finished collecting timing info
[0m08:41:00.605332 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b30b100>]}
[0m08:41:00.605830 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.15s]
[0m08:41:00.606407 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:41:00.606663 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:41:00.606945 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:41:00.608412 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:41:00.608646 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:41:00.610585 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:41:00.610774 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:41:00.615306 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:41:00.615991 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m08:41:00.617157 [debug] [Thread-2 (]: finished collecting timing info
[0m08:41:00.617461 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:41:00.627506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:41:01.063149 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:41:01.064127 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:41:03.469161 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:57531082-22c7-4e02-9fcb-2648a82ef493:europe-west1&page=queryresults
[0m08:41:03.472186 [debug] [Thread-1 (]: finished collecting timing info
[0m08:41:03.473164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b616f80>]}
[0m08:41:03.473708 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 3.26s]
[0m08:41:03.474320 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:41:03.474584 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:41:03.475006 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:41:03.475856 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:41:03.476059 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:41:03.476242 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:41:03.481584 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:41:03.483915 [debug] [Thread-1 (]: finished collecting timing info
[0m08:41:03.484132 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:41:03.487122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:03.995214 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:41:03.997684 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:41:04.393415 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a4156402-3301-4a76-b88f-c59b3ea91c26:europe-west1&page=queryresults
[0m08:41:04.395877 [debug] [Thread-2 (]: finished collecting timing info
[0m08:41:04.396536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b668eb0>]}
[0m08:41:04.396830 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.79s]
[0m08:41:04.397183 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:41:06.316424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9cbb2bb1-1e00-4cc4-80aa-181c2590e074:europe-west1&page=queryresults
[0m08:41:06.319587 [debug] [Thread-1 (]: finished collecting timing info
[0m08:41:06.320746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8d7f5a-f721-4373-828e-8046459f6c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b66b2e0>]}
[0m08:41:06.321276 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.8 MB processed)[0m in 2.85s]
[0m08:41:06.321834 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:41:06.322602 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m08:41:06.322774 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m08:41:06.322974 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m08:41:06.323811 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:41:06.324207 [info ] [MainThread]: 
[0m08:41:06.324360 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m08:41:06.324505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:06.324564 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m08:41:06.324621 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m08:41:06.333236 [info ] [MainThread]: 
[0m08:41:06.333432 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:41:06.333555 [info ] [MainThread]: 
[0m08:41:06.333655 [error] [MainThread]: [33mDatabase Error in model stg_segment_android__screens_article (models/staging/segment_android__production_events/stg_segment_android__screens_article.sql)[0m
[0m08:41:06.333757 [error] [MainThread]:   Syntax error: Expected ")" but got keyword AS at [14:22]
[0m08:41:06.333851 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:41:06.333958 [info ] [MainThread]: 
[0m08:41:06.334059 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m08:41:06.334209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2571f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b257370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b66ad70>]}
[0m08:41:06.334332 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:44:00.062900 | e500d067-6ce8-47a2-a0b9-e3192156a549 ==============================
[0m08:44:00.062938 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:44:00.063714 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:44:00.063818 [debug] [MainThread]: Tracking: tracking
[0m08:44:00.075123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddf010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102338df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10233b910>]}
[0m08:44:00.117961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:44:00.118239 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:44:00.124894 [debug] [MainThread]: 1603: static parser failed on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:44:00.132941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:44:00.174003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store

[0m08:44:00.177393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606add0>]}
[0m08:44:00.183977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602bf70>]}
[0m08:44:00.184160 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:44:00.184285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106028e80>]}
[0m08:44:00.185244 [info ] [MainThread]: 
[0m08:44:00.185610 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:44:00.186297 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:44:00.186413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:00.734733 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:44:00.735332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:01.194480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd8d60>]}
[0m08:44:01.195800 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:44:01.196190 [info ] [MainThread]: 
[0m08:44:01.202876 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:44:01.203151 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:44:01.203461 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:44:01.203727 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:44:01.204477 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:44:01.205164 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:44:01.205358 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:44:01.205525 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:44:01.205712 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:44:01.205873 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:44:01.209442 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:44:01.212094 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:44:01.213148 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:01.213338 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:44:01.219422 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:01.236139 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:44:01.236295 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:44:01.238572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:01.240484 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:44:01.281759 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:44:01.282300 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:44:01.282947 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:44:02.329012 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3b607e21-eacb-4c73-9f44-f6838264a3a4:europe-west1&page=queryresults
[0m08:44:02.349481 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:02.350254 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106162020>]}
[0m08:44:02.350616 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m08:44:02.351028 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:44:02.351195 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:44:02.351362 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m08:44:02.351967 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:44:02.352098 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:44:02.352223 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:44:02.353942 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:44:02.356461 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:02.356614 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:44:02.359056 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:44:02.359564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:44:02.360659 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:44:02.920378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b42cfe1c-6dac-4d76-a206-f2c1463c42be:europe-west1&page=queryresults
[0m08:44:02.923949 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:02.925010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160250>]}
[0m08:44:02.925531 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m08:44:02.926155 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:44:02.926415 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:44:02.926863 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m08:44:02.927834 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:44:02.928025 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:44:02.928198 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:44:02.930643 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:44:02.931464 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:02.931649 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:44:02.934894 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:44:02.936085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:02.937341 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m08:44:05.273098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bf7e5491-88bb-4572-873e-e945cb2845bf:europe-west1&page=queryresults
[0m08:44:05.276584 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:05.278517 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c81c5f95-a524-4a49-bb1e-a3ebdad6b606:europe-west1&page=queryresults
[0m08:44:05.279492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060738e0>]}
[0m08:44:05.281295 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:05.281757 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m08:44:05.282356 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060712a0>]}
[0m08:44:05.282828 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:44:05.283122 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 2.93s]
[0m08:44:05.283346 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:44:05.284001 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:44:05.284518 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:44:05.284767 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:44:05.285511 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:44:05.285785 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:44:05.285967 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:44:05.286494 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:44:05.286670 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:44:05.286797 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:44:05.290600 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:44:05.290848 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:44:05.296121 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:44:05.297095 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:05.297244 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:44:05.299788 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:05.301332 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:44:05.322470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:44:05.332031 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:44:05.389830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:05.390545 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m08:44:05.857057 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:44:05.859809 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
WHERE name='Article' 
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id


-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:44:06.096325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2e0ad3dd-0259-4746-b37b-70c60f953629:europe-west1&page=queryresults
[0m08:44:06.099155 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:06.099830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060703a0>]}
[0m08:44:06.100174 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m08:44:06.100569 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:44:06.100755 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:44:06.101053 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:44:06.101684 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:44:06.101841 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:44:06.101977 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:44:06.107008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:44:06.107618 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:06.107798 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:44:06.110841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:06.157885 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword LEFT at [15:1]')
[0m08:44:06.526902 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:44:06.529721 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:44:07.138576 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:712047af-75b4-4552-93fb-61a9edfc0ffd&page=queryresults
[0m08:44:07.140213 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:07.141437 [debug] [Thread-2 (]: Database Error in model stg_segment_android__screens_article (models/staging/segment_android__production_events/stg_segment_android__screens_article.sql)
  Syntax error: Expected ")" but got keyword LEFT at [15:1]
  compiled Code at target/run/my_new_project/models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:44:07.141865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607a6e0>]}
[0m08:44:07.142406 [error] [Thread-2 (]: 6 of 12 ERROR creating sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[31mERROR[0m in 1.86s]
[0m08:44:07.142978 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:44:07.143241 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:44:07.143738 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:44:07.144696 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:44:07.144926 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:44:07.145134 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:44:07.150799 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:44:07.151560 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:07.151755 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:44:07.154543 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:44:07.624769 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:44:07.626070 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:44:09.376534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:43105f8c-f4f1-49d2-8fb6-0aec4382d3d6:europe-west1&page=queryresults
[0m08:44:09.379873 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:09.380896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106073550>]}
[0m08:44:09.381386 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.28s]
[0m08:44:09.381897 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:44:09.382121 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:44:09.382660 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:44:09.383706 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:44:09.383924 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:44:09.384107 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:44:09.399506 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:44:09.400693 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:09.400873 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:44:09.406270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:09.808477 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:44:09.809787 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m08:44:10.420882 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:433da815-cea8-43fa-8f67-8980a14dc9ae:europe-west1&page=queryresults
[0m08:44:10.423942 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:10.424912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106073fa0>]}
[0m08:44:10.425432 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.28s]
[0m08:44:10.426015 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:44:10.426269 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:44:10.426670 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:44:10.427558 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:44:10.427748 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:44:10.427925 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:44:10.432429 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:44:10.434641 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:10.434812 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:44:10.445420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:44:10.851623 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:44:10.852655 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:44:12.343860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:caaf4664-c023-4ee8-8d1c-4c8f47c86146:europe-west1&page=queryresults
[0m08:44:12.346371 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:12.347286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106073df0>]}
[0m08:44:12.347825 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.96s]
[0m08:44:12.348430 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:44:12.348697 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:44:12.349100 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:44:12.349868 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:44:12.350068 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:44:12.350241 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:44:12.355413 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:44:12.357780 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:12.358006 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:44:12.361110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:12.905261 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:44:12.907874 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:44:14.033941 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dcd44157-9318-4c34-972c-931630a1bda5:europe-west1&page=queryresults
[0m08:44:14.037997 [debug] [Thread-2 (]: finished collecting timing info
[0m08:44:14.039041 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106073dc0>]}
[0m08:44:14.039573 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.61s]
[0m08:44:14.040183 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:44:15.385148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8fa2699f-a2dc-4fa9-8f20-7253d67ae493:europe-west1&page=queryresults
[0m08:44:15.387651 [debug] [Thread-1 (]: finished collecting timing info
[0m08:44:15.388581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e500d067-6ce8-47a2-a0b9-e3192156a549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106073cd0>]}
[0m08:44:15.389070 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.8 MB processed)[0m in 3.04s]
[0m08:44:15.389644 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:44:15.390488 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m08:44:15.390905 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m08:44:15.391408 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m08:44:15.392925 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:44:15.393626 [info ] [MainThread]: 
[0m08:44:15.393923 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 15.21 seconds (15.21s).
[0m08:44:15.394175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:15.394305 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m08:44:15.394433 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m08:44:15.418736 [info ] [MainThread]: 
[0m08:44:15.418982 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:44:15.419149 [info ] [MainThread]: 
[0m08:44:15.419292 [error] [MainThread]: [33mDatabase Error in model stg_segment_android__screens_article (models/staging/segment_android__production_events/stg_segment_android__screens_article.sql)[0m
[0m08:44:15.419430 [error] [MainThread]:   Syntax error: Expected ")" but got keyword LEFT at [15:1]
[0m08:44:15.419558 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:44:15.419700 [info ] [MainThread]: 
[0m08:44:15.419834 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m08:44:15.420036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0160>]}
[0m08:44:15.420194 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:45:03.682962 | e13f123b-7587-43b2-85da-749e39e45e63 ==============================
[0m08:45:03.682999 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:45:03.687557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:45:03.687806 [debug] [MainThread]: Tracking: tracking
[0m08:45:03.699850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cd1b0>]}
[0m08:45:03.742758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:45:03.743069 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:45:03.750070 [debug] [MainThread]: 1603: static parser failed on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:45:03.758263 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/segment_android__production_events/stg_segment_android__screens_article.sql
[0m08:45:03.804274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m08:45:03.807614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655b070>]}
[0m08:45:03.814154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bcbe0>]}
[0m08:45:03.814335 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:45:03.814459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106519120>]}
[0m08:45:03.815341 [info ] [MainThread]: 
[0m08:45:03.815682 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:45:03.816342 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:45:03.816469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:04.536959 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:45:04.537558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:04.959913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bcac0>]}
[0m08:45:04.961248 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:45:04.961663 [info ] [MainThread]: 
[0m08:45:04.968182 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:45:04.968450 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:45:04.968759 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:45:04.969041 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:45:04.969810 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:45:04.970456 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:45:04.970646 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:45:04.970792 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:45:04.970963 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:45:04.971084 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:45:04.974616 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:45:04.977212 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:45:04.977983 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:04.978137 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:45:04.978262 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:05.001504 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:45:05.001657 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:45:05.004041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:05.006119 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:45:05.047341 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:45:05.047999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:45:05.048637 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:45:05.820125 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b5b6f36a-2c11-49f0-9e87-4d5c8d353b99:europe-west1&page=queryresults
[0m08:45:05.841581 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:05.842289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655b5e0>]}
[0m08:45:05.842639 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m08:45:05.843046 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:45:05.843212 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:45:05.843486 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m08:45:05.844039 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:45:05.844180 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:45:05.844311 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:45:05.846038 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:45:05.848445 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:05.848595 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:45:05.851041 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:45:05.851912 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:05.852922 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:45:05.897851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:23569168-7dc8-4d4c-8f62-aa4bc5b2bdc3:europe-west1&page=queryresults
[0m08:45:05.898911 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:05.899248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106580d90>]}
[0m08:45:05.899413 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m08:45:05.899612 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:45:05.899703 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:45:05.899916 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m08:45:05.900414 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:45:05.900726 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:45:05.900818 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:45:05.901816 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:45:05.902135 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:05.902222 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:45:05.903748 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:45:05.904472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:05.905181 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m08:45:06.746222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:08fd0eb2-15ee-4c25-9ce3-72983ed85317:europe-west1&page=queryresults
[0m08:45:06.750655 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:06.751651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655b700>]}
[0m08:45:06.752116 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m08:45:06.752625 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:45:06.752842 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:45:06.753217 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:45:06.754175 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:45:06.754417 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:45:06.754608 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:45:06.758967 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:45:06.760914 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:06.761120 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:45:06.764268 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:45:06.764889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:06.766249 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m08:45:06.819505 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9a6ef611-f605-4ded-b430-d993743ff423:europe-west1&page=queryresults
[0m08:45:06.820485 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:06.820824 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106558730>]}
[0m08:45:06.821232 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m08:45:06.821443 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:45:06.821535 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:45:06.821688 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:45:06.822049 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:45:06.822152 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:45:06.822229 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:45:06.828708 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:45:06.829668 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:06.829766 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:45:06.844587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:07.323275 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:45:07.324615 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:45:07.687431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fd5c21f9-91f0-4b26-9ea4-1a9777a2f7e5:europe-west1&page=queryresults
[0m08:45:07.691390 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:07.693530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065598d0>]}
[0m08:45:07.694195 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m08:45:07.694714 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:45:07.694933 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:45:07.695374 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:45:07.696388 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:45:07.696867 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:45:07.697274 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:45:07.702636 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:45:07.703330 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:07.703504 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:45:07.706356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:08.078134 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:45:08.078706 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:45:09.601263 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9f4ea892-30e6-40fe-a781-ca4e15893b61:europe-west1&page=queryresults
[0m08:45:09.603760 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:09.604688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065583d0>]}
[0m08:45:09.605211 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.78s]
[0m08:45:09.605805 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:45:09.606061 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:45:09.606518 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:45:09.607314 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:45:09.607502 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:45:09.607670 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:45:09.613152 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:45:09.614007 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:09.614169 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:45:09.621165 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:10.177102 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:45:10.178401 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:45:10.337862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:af0608c8-19ab-48fb-9d4a-5b702a3900b2:europe-west1&page=queryresults
[0m08:45:10.341189 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:10.342191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655acb0>]}
[0m08:45:10.342706 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 2.65s]
[0m08:45:10.343269 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:45:10.343532 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:45:10.343943 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:45:10.344823 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:45:10.345047 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:45:10.345248 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:45:10.351157 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:45:10.354264 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:10.354568 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:45:10.357582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:10.859658 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:45:10.860855 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m08:45:12.930207 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d0a74c3c-d68e-443d-a0bb-614ec6d192b6:europe-west1&page=queryresults
[0m08:45:12.932683 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:12.933556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106559a50>]}
[0m08:45:12.934049 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.33s]
[0m08:45:12.934621 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:45:12.934880 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:45:12.935286 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:45:12.936129 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:45:12.936334 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:45:12.936503 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:45:12.940954 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:45:12.942999 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:12.943175 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:45:12.953556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:13.130577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9a7f480c-0528-4e81-a434-01754a7a181c:europe-west1&page=queryresults
[0m08:45:13.131869 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:13.132368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655ba90>]}
[0m08:45:13.132648 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.79s]
[0m08:45:13.132981 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:45:13.133133 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:45:13.133355 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:45:13.134020 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:45:13.134186 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:45:13.134313 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:45:13.137517 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:45:13.138508 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:13.138660 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:45:13.140936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:13.414861 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:45:13.415375 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:45:13.620049 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:45:13.622707 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:45:15.949758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:46d5dce2-a051-43ef-80f2-c04dbabe1aab:europe-west1&page=queryresults
[0m08:45:15.953939 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:15.954994 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655bcd0>]}
[0m08:45:15.955545 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.02s]
[0m08:45:15.956159 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:45:16.224052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c243ba83-364f-46af-a9b5-55770bb4387b:europe-west1&page=queryresults
[0m08:45:16.226841 [debug] [Thread-1 (]: finished collecting timing info
[0m08:45:16.227799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655bfd0>]}
[0m08:45:16.228310 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.8 MB processed)[0m in 3.09s]
[0m08:45:16.228892 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:45:16.229550 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m08:45:16.230141 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m08:45:16.230829 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:45:16.230997 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:45:16.231161 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m08:45:16.237257 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:45:16.239989 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:16.240195 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m08:45:16.242247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:45:16.631483 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:45:16.633515 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m08:45:18.971109 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:67ebc831-9c9f-4c12-828a-ce848e2b0153:europe-west1&page=queryresults
[0m08:45:18.975607 [debug] [Thread-2 (]: finished collecting timing info
[0m08:45:18.976704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e13f123b-7587-43b2-85da-749e39e45e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067741c0>]}
[0m08:45:18.977256 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.1k rows, 2.9 MB processed)[0m in 2.75s]
[0m08:45:18.977918 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m08:45:18.980039 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:45:18.980957 [info ] [MainThread]: 
[0m08:45:18.981292 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 15.17 seconds (15.17s).
[0m08:45:18.981555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:18.981695 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m08:45:18.981825 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m08:45:18.993624 [info ] [MainThread]: 
[0m08:45:18.993924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:18.994164 [info ] [MainThread]: 
[0m08:45:18.994376 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:45:18.994630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106529b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106562bf0>]}
[0m08:45:18.994829 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:53:26.921715 | 27b61610-043a-4a36-b574-7a409796d69f ==============================
[0m08:53:26.921762 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:53:26.922561 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:53:26.922648 [debug] [MainThread]: Tracking: tracking
[0m08:53:26.934177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d4e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10274bfd0>]}
[0m08:53:26.976286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:26.976435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:26.976774 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m08:53:26.980358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a2260>]}
[0m08:53:27.021439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd1540>]}
[0m08:53:27.021639 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:53:27.021775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10274bfd0>]}
[0m08:53:27.022739 [info ] [MainThread]: 
[0m08:53:27.023101 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:53:27.023799 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:53:27.023921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:27.836621 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:53:27.837221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:28.258035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b525c0>]}
[0m08:53:28.259139 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:53:28.259429 [info ] [MainThread]: 
[0m08:53:28.264498 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:53:28.264693 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:53:28.264935 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:53:28.265156 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:53:28.265751 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:53:28.266271 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:53:28.266434 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:53:28.266581 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:53:28.266865 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:53:28.266999 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:53:28.270151 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:53:28.272558 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:53:28.273869 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:28.274042 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:28.274264 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:53:28.274445 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:53:28.296421 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:53:28.300522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:28.301395 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:53:28.303514 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:53:28.342058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:53:28.342719 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:53:29.165547 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:59cf803f-aa10-4c79-a9e3-62bf6ce71bcd:europe-west1&page=queryresults
[0m08:53:29.185625 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:29.186311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2ffa0>]}
[0m08:53:29.187231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:802e6ea0-3c8e-43ab-867e-8fa60b560ab8:europe-west1&page=queryresults
[0m08:53:29.187616 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m08:53:29.188990 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:29.189438 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:53:29.189902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a26350>]}
[0m08:53:29.190125 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:53:29.190482 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m08:53:29.190687 [info ] [Thread-2 (]: 3 of 12 START sql view model dbt_rsdun.stg_mixpanel__community_viewed_article .. [RUN]
[0m08:53:29.190978 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:53:29.191439 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:53:29.191577 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:53:29.191744 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:53:29.191971 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_rsdun.stg_mixpanel__viewed_article ............ [RUN]
[0m08:53:29.192101 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:53:29.192517 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:53:29.194031 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:53:29.194199 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:53:29.194400 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:53:29.196754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:53:29.197421 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:29.197596 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:53:29.199874 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:53:29.200071 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:29.200175 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:53:29.201608 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:53:29.201784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:53:29.201934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:29.202587 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
  OPTIONS()
  as SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os;


[0m08:53:29.245620 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
  OPTIONS()
  as SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article');


[0m08:53:30.047493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ce58a90e-a546-4746-a639-440c76384ee8:europe-west1&page=queryresults
[0m08:53:30.050813 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:30.051711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84d90>]}
[0m08:53:30.053702 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dca1e8ec-0a4c-474f-a2ff-e26a3a97d4ea:europe-west1&page=queryresults
[0m08:53:30.054155 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__viewed_article ....... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m08:53:30.055790 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:30.056277 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:53:30.056959 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9a8f0>]}
[0m08:53:30.057233 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:53:30.057855 [info ] [Thread-2 (]: 3 of 12 OK created sql view model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m08:53:30.058131 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:53:30.058510 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:53:30.059177 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:53:30.059419 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:53:30.059653 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:53:30.059854 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:53:30.060019 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:53:30.060535 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:53:30.064376 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:53:30.064688 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:53:30.064935 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:53:30.073378 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:30.073591 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:53:30.075929 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:53:30.083153 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:53:30.083370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:30.084512 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m08:53:30.126644 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:30.126964 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:53:30.145598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:53:31.071929 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:53:31.073775 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:53:31.572357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2202715f-887d-4b48-aa95-ee4522b97e93:europe-west1&page=queryresults
[0m08:53:31.576506 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:31.577425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84ac0>]}
[0m08:53:31.577863 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m08:53:31.578494 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:53:31.579117 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:53:31.580183 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:53:31.581054 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:53:31.581253 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:53:31.581439 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:53:31.586669 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:53:31.587381 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:31.587562 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:53:31.590296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:32.097758 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:53:32.099095 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:53:33.601906 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2c4b6f6d-5da2-4200-8c54-c957237b253a:europe-west1&page=queryresults
[0m08:53:33.604014 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:33.604780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a99a80>]}
[0m08:53:33.605160 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 3.54s]
[0m08:53:33.605605 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:53:33.605815 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:53:33.606138 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:53:33.606880 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:53:33.607065 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:53:33.607228 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:53:33.612271 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:53:33.612839 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:33.612998 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:53:33.615812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:53:34.127387 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:53:34.128980 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:53:34.801473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:77267969-633a-4e84-b17a-76cf3d956d38:europe-west1&page=queryresults
[0m08:53:34.804787 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:34.805795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0f0d0>]}
[0m08:53:34.806329 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.23s]
[0m08:53:34.806896 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:53:34.807125 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:53:34.807475 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:53:34.808219 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:53:34.808412 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:53:34.808593 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:53:34.825117 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:53:34.826268 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:34.826422 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:53:34.828090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:35.422666 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:53:35.423958 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m08:53:36.859846 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e31c83dd-6673-4a27-aad2-62fc138c6fa9:europe-west1&page=queryresults
[0m08:53:36.862648 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:36.863651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b21c00>]}
[0m08:53:36.864169 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.26s]
[0m08:53:36.864734 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:53:36.864990 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:53:36.865383 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:53:36.866146 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:53:36.866321 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:53:36.866492 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:53:36.871111 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:53:36.872275 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:36.872440 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:53:36.882994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:53:37.478619 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:53:37.479685 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:53:38.321344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:57d1f1a6-7b2e-4236-8fd2-7b5de54bfa5d:europe-west1&page=queryresults
[0m08:53:38.323953 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:38.324736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107856860>]}
[0m08:53:38.325198 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 3.52s]
[0m08:53:38.325704 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:53:38.325939 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:53:38.326315 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:53:38.327112 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:53:38.327304 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:53:38.327476 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:53:38.332610 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:53:38.334804 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:38.334979 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:53:38.337982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:38.748475 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:53:38.750019 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:53:40.563030 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b6fb3b84-cee3-4e37-af48-2ecb4eb2e2ee:europe-west1&page=queryresults
[0m08:53:40.565737 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:40.566142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107854f10>]}
[0m08:53:40.566332 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.70s]
[0m08:53:40.566554 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:53:41.852858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:74fea3e3-9cd0-4beb-9483-e4e9d39c9e9e:europe-west1&page=queryresults
[0m08:53:41.856866 [debug] [Thread-1 (]: finished collecting timing info
[0m08:53:41.858372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae52d0>]}
[0m08:53:41.859200 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 42.8 MB processed)[0m in 3.53s]
[0m08:53:41.860437 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:53:41.862163 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m08:53:41.862728 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m08:53:41.863998 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:53:41.864363 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:53:41.864662 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m08:53:41.882218 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:53:41.883372 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:41.883548 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m08:53:41.889519 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:53:41.890032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:53:41.891204 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m08:53:44.882884 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9907ff13-dd51-4dc7-98e9-c8e34522d09f:europe-west1&page=queryresults
[0m08:53:44.886972 [debug] [Thread-2 (]: finished collecting timing info
[0m08:53:44.888652 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b61610-043a-4a36-b574-7a409796d69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7700>]}
[0m08:53:44.889552 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.1k rows, 2.9 MB processed)[0m in 3.03s]
[0m08:53:44.890670 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m08:53:44.894303 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:53:44.896309 [info ] [MainThread]: 
[0m08:53:44.896955 [info ] [MainThread]: Finished running 5 view models, 5 incremental models, 2 table models in 0 hours 0 minutes and 17.87 seconds (17.87s).
[0m08:53:44.897395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:44.897600 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m08:53:44.897795 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m08:53:44.915932 [info ] [MainThread]: 
[0m08:53:44.916230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:44.916442 [info ] [MainThread]: 
[0m08:53:44.916607 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:53:44.916836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060374f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ff040>]}
[0m08:53:44.917021 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:55:27.708437 | 7caf2305-fc46-4487-9625-c2c80c83731e ==============================
[0m08:55:27.708485 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:55:27.709315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:27.709428 [debug] [MainThread]: Tracking: tracking
[0m08:55:27.720591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f5360>]}
[0m08:55:27.764755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:55:27.765096 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m08:55:27.765216 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m08:55:27.772472 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m08:55:27.778365 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__community_viewed_article.sql
[0m08:55:27.822140 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m08:55:27.825515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067b580>]}
[0m08:55:27.832389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11061eb00>]}
[0m08:55:27.832574 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:55:27.832696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c7fd0>]}
[0m08:55:27.833638 [info ] [MainThread]: 
[0m08:55:27.834012 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:55:27.834694 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:55:27.834835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:28.420729 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:55:28.421274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:28.828639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106470d30>]}
[0m08:55:28.829385 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:55:28.829644 [info ] [MainThread]: 
[0m08:55:28.833787 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:55:28.833970 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:55:28.834175 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:55:28.834349 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:55:28.834824 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:55:28.835294 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:55:28.835448 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:55:28.835558 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:55:28.835679 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:55:28.835777 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:55:28.838584 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:55:28.840932 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:55:28.841922 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:28.842029 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:28.842175 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:55:28.842304 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:55:28.868339 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:55:28.870168 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:55:28.871046 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:55:28.914250 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:55:28.914771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:28.915411 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:55:29.686104 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ba475545-9c42-4438-b379-ca8a1013aefb:europe-west1&page=queryresults
[0m08:55:29.706182 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:29.707250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c1753180-7eaf-49de-9dbe-da6e286466e9:europe-west1&page=queryresults
[0m08:55:29.707841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067bfa0>]}
[0m08:55:29.709139 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:29.709535 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m08:55:29.709972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067b3a0>]}
[0m08:55:29.710384 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:55:29.710630 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m08:55:29.710847 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:55:29.711559 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:55:29.711741 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m08:55:29.711890 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:55:29.712438 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:55:29.712708 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m08:55:29.712850 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:55:29.713308 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:55:29.713465 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:55:29.713583 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:55:29.716254 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:55:29.716452 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:55:29.718598 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:55:29.718899 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:29.719037 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:55:29.725465 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:29.740357 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:55:29.740490 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:55:29.780574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:30.244512 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:55:30.245138 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
    );
  
[0m08:55:30.250501 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:55:30.250916 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
    );
  
[0m08:55:32.292380 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7ec07ac2-3641-4183-9769-7a8102a52a7b:europe-west1&page=queryresults
[0m08:55:32.297574 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:32.299272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b2fb0>]}
[0m08:55:32.300483 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE TABLE (28.0 rows, 26.5 MB processed)[0m in 2.59s]
[0m08:55:32.302870 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:55:32.304181 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:55:32.304963 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:55:32.306010 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:55:32.306346 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:55:32.306837 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:55:32.323392 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:55:32.324994 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:32.325152 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:55:32.331472 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:55:32.332082 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:55:32.333344 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m08:55:32.869620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dc972a7f-26f7-4e1c-a1a6-2ecd5e5f0144:europe-west1&page=queryresults
[0m08:55:32.874310 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:32.876273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067a080>]}
[0m08:55:32.877716 [info ] [Thread-1 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mCREATE TABLE (36.9k rows, 42.6 MB processed)[0m in 3.16s]
[0m08:55:32.878733 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:55:32.879293 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:55:32.880284 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:55:32.881719 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:55:32.882567 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:55:32.882863 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:55:32.896883 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:55:32.900152 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:32.900405 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:55:32.903854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:33.257596 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2804aecd-5447-4bd6-b69c-f6848bfcf0e4:europe-west1&page=queryresults
[0m08:55:33.263343 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:33.264326 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064c8e0>]}
[0m08:55:33.264825 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m08:55:33.265380 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:55:33.265626 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:55:33.265885 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:55:33.267301 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:55:33.267762 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:55:33.268246 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:55:33.279394 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:55:33.279886 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:33.279991 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:55:33.281860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:55:33.410109 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:55:33.410695 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:55:33.815912 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:55:33.817383 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m08:55:35.570606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a17afff6-0d30-4c78-9671-0c3130859eeb:europe-west1&page=queryresults
[0m08:55:35.577012 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:35.578833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f5c30>]}
[0m08:55:35.579769 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.70s]
[0m08:55:35.580538 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:55:35.580861 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:55:35.581248 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:55:35.582401 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:55:35.583545 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:55:35.584979 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:55:35.602314 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:55:35.603059 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:35.603254 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:55:35.609035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:36.038465 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1ce004f8-2bbd-4edf-a763-2110d238ab04:europe-west1&page=queryresults
[0m08:55:36.043262 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:36.044941 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117a8c0>]}
[0m08:55:36.045834 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 2.78s]
[0m08:55:36.046736 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:55:36.047326 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:55:36.047738 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:55:36.049251 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:55:36.049735 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:55:36.050067 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:55:36.061371 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:55:36.064193 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:36.064469 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:55:36.068170 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:55:36.142773 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:55:36.143234 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m08:55:36.515331 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:55:36.517636 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m08:55:38.365146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3fb53c8a-f45f-4c11-8028-c1c321aadffd:europe-west1&page=queryresults
[0m08:55:38.368358 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:38.369394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa7100>]}
[0m08:55:38.370043 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 2.79s]
[0m08:55:38.370859 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:55:38.371312 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m08:55:38.372194 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:55:38.373719 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:55:38.374081 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m08:55:38.374313 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m08:55:38.381193 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:55:38.383908 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:38.384138 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m08:55:38.393355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:38.714280 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a2ed4631-eca6-4335-bcc6-23ad21505064:europe-west1&page=queryresults
[0m08:55:38.720249 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:38.721937 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064d870>]}
[0m08:55:38.722768 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.67s]
[0m08:55:38.724415 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:55:38.724901 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:55:38.725422 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:55:38.726914 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:55:38.727579 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:55:38.727860 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:55:38.736947 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:55:38.739194 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:38.739459 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:55:38.746242 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:55:38.897807 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:55:38.898642 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:55:39.304471 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:55:39.307935 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:55:41.296178 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5f133338-21dc-4ce5-b4ac-11641b40de63:europe-west1&page=queryresults
[0m08:55:41.301751 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:41.303418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cb670>]}
[0m08:55:41.304312 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 5.9 MB processed)[0m in 2.58s]
[0m08:55:41.305587 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:55:41.306685 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m08:55:41.307118 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m08:55:41.308393 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:55:41.308741 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:55:41.309010 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m08:55:41.319089 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:55:41.322047 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:41.322326 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m08:55:41.324938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:55:41.533544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:07083357-a48e-4fb5-b697-bd25fe68d139:europe-west1&page=queryresults
[0m08:55:41.535349 [debug] [Thread-1 (]: finished collecting timing info
[0m08:55:41.535966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b2b00>]}
[0m08:55:41.536320 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.16s]
[0m08:55:41.536744 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m08:55:41.698869 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:55:41.701593 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m08:55:44.144765 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5da52445-ebe2-49e2-b3cb-fd025cf43bfa:europe-west1&page=queryresults
[0m08:55:44.148357 [debug] [Thread-2 (]: finished collecting timing info
[0m08:55:44.149154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf2305-fc46-4487-9625-c2c80c83731e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111b2c50>]}
[0m08:55:44.149565 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.1k rows, 2.9 MB processed)[0m in 2.84s]
[0m08:55:44.150106 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m08:55:44.151907 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:55:44.152741 [info ] [MainThread]: 
[0m08:55:44.153170 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 16.32 seconds (16.32s).
[0m08:55:44.153690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:44.153858 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m08:55:44.154030 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m08:55:44.173547 [info ] [MainThread]: 
[0m08:55:44.173886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:55:44.174159 [info ] [MainThread]: 
[0m08:55:44.174376 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:55:44.174679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11068b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111107760>]}
[0m08:55:44.174906 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 08:58:07.184888 | 5710ddd9-f378-4c7a-9626-b2be1d0cdeaf ==============================
[0m08:58:07.184925 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:58:07.185790 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:58:07.185900 [debug] [MainThread]: Tracking: tracking
[0m08:58:07.200892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b68df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6b910>]}
[0m08:58:07.243635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:58:07.243787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:58:07.244151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m08:58:07.247795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299e560>]}
[0m08:58:07.289466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc6dd0>]}
[0m08:58:07.289691 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m08:58:07.289819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10389bb80>]}
[0m08:58:07.290793 [info ] [MainThread]: 
[0m08:58:07.291157 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:58:07.291839 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m08:58:07.291938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:07.817646 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m08:58:07.817877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:08.206170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039525f0>]}
[0m08:58:08.206684 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:58:08.207046 [info ] [MainThread]: 
[0m08:58:08.211187 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m08:58:08.211328 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m08:58:08.211569 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m08:58:08.211732 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m08:58:08.212185 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m08:58:08.212580 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m08:58:08.212705 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m08:58:08.212823 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m08:58:08.212940 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m08:58:08.213044 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m08:58:08.215224 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:58:08.217082 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:58:08.218062 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:08.218167 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:08.218271 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m08:58:08.218404 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m08:58:08.238232 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m08:58:08.241814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:08.242866 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m08:58:08.244306 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m08:58:08.282011 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:58:08.282724 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m08:58:09.108398 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e92d72ba-b978-4c0a-a6d0-43be39f492a1:europe-west1&page=queryresults
[0m08:58:09.127420 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:09.128171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112997ee0>]}
[0m08:58:09.128564 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m08:58:09.128996 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m08:58:09.129161 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:58:09.129589 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m08:58:09.130415 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:58:09.130569 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:58:09.130714 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:58:09.133321 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:58:09.136203 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:09.136413 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:58:09.158966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:58:09.376214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:869e78e3-4b81-4f00-9c9d-47edc960e30a:europe-west1&page=queryresults
[0m08:58:09.377518 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:09.377923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a25ff0>]}
[0m08:58:09.378159 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m08:58:09.378419 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m08:58:09.378533 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:58:09.378799 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m08:58:09.379465 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:58:09.379590 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m08:58:09.379695 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m08:58:09.381883 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:58:09.382265 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:09.382368 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m08:58:09.384242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:09.694012 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m08:58:09.694519 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:58:09.906377 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m08:58:09.907555 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m08:58:11.624917 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:65697a7d-e741-47f4-8d0c-426342e3d990:europe-west1&page=queryresults
[0m08:58:11.632372 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:11.632881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ab3f40>]}
[0m08:58:11.633163 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 2.50s]
[0m08:58:11.633559 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m08:58:11.633899 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:58:11.634191 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m08:58:11.634642 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:58:11.634748 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:58:11.634848 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m08:58:11.640194 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:58:11.641764 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:11.641973 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:58:11.644106 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m08:58:11.644567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:58:11.645511 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m08:58:12.524366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f6e8ff44-67ca-447e-b18b-6e8bc0329280:europe-west1&page=queryresults
[0m08:58:12.527580 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:12.528765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfceb0>]}
[0m08:58:12.529385 [info ] [Thread-1 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 42.6 MB processed)[0m in 3.15s]
[0m08:58:12.530317 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m08:58:12.530709 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m08:58:12.531113 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m08:58:12.532291 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m08:58:12.533017 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m08:58:12.533504 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m08:58:12.549186 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:58:12.551140 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:12.551259 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m08:58:12.563063 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m08:58:12.564354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:12.565252 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`
    
    
    OPTIONS()
    as (
      

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

    );
  
[0m08:58:12.730412 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a816e320-12c1-49ee-8a0a-29fff38b96b0:europe-west1&page=queryresults
[0m08:58:12.731322 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:12.731675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a37b80>]}
[0m08:58:12.731881 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m08:58:12.732116 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m08:58:12.732224 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:58:12.732337 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m08:58:12.732774 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:58:12.732887 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:58:12.732990 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:58:12.735596 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:58:12.735988 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:12.736092 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:58:12.738323 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m08:58:12.738670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:58:12.739498 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
    );
  
[0m08:58:15.343318 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:22cbbbf3-d11d-4adb-8aec-ae787eebf4a6:europe-west1&page=queryresults
[0m08:58:15.344372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f91d8a5c-f733-485a-b77c-a681a2595911:europe-west1&page=queryresults
[0m08:58:15.349081 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:15.352040 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:15.353777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfd330>]}
[0m08:58:15.354795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129945b0>]}
[0m08:58:15.355694 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mCREATE TABLE (1.5k rows, 609.0 KB processed)[0m in 2.62s]
[0m08:58:15.356370 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mCREATE TABLE (607.0 rows, 1.4 MB processed)[0m in 2.82s]
[0m08:58:15.357418 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m08:58:15.357753 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m08:58:15.358094 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m08:58:15.359513 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m08:58:15.360335 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:58:15.360941 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m08:58:15.363390 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m08:58:15.364052 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m08:58:15.364925 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:58:15.365210 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m08:58:15.365382 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m08:58:15.368105 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m08:58:15.373474 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:58:15.377634 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:15.377900 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m08:58:15.381057 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m08:58:15.384774 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:58:15.385586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:15.385708 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:15.385916 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m08:58:15.386935 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`
    
    
    OPTIONS()
    as (
      

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

    );
  
[0m08:58:15.394461 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m08:58:15.440018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:58:15.440717 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`
    
    
    OPTIONS()
    as (
      

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

    );
  
[0m08:58:17.962721 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e4022cfa-6c6a-41aa-b66b-d5e0c230f625:europe-west1&page=queryresults
[0m08:58:17.968075 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:17.969662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b7d990>]}
[0m08:58:17.970560 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mCREATE TABLE (3.4k rows, 3.0 MB processed)[0m in 2.61s]
[0m08:58:17.971513 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m08:58:17.971937 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m08:58:17.972347 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m08:58:17.973387 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m08:58:17.973808 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m08:58:17.974074 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m08:58:17.989091 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m08:58:17.990685 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:17.990913 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m08:58:18.003112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:58:18.004045 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a3f5d62f-2ba9-44b3-be9f-a5c9cc7d5673:europe-west1&page=queryresults
[0m08:58:18.005366 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:18.005956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b8fa30>]}
[0m08:58:18.006289 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mCREATE TABLE (14.0 rows, 158.2 KB processed)[0m in 2.64s]
[0m08:58:18.055566 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m08:58:18.056049 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:58:18.056233 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m08:58:18.056615 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:58:18.056691 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:58:18.056764 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:58:18.058917 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:58:18.060408 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:18.060573 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:58:18.062073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:18.688075 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m08:58:18.692048 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m08:58:18.693283 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m08:58:18.697027 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m08:58:20.917512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:48688a3f-d25e-43ea-945d-7b0f0b540885:europe-west1&page=queryresults
[0m08:58:20.922658 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:20.924137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a3bac0>]}
[0m08:58:20.925419 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 11.6 MB processed)[0m in 2.87s]
[0m08:58:20.927013 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m08:58:20.929573 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m08:58:20.930031 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m08:58:20.930867 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m08:58:20.931147 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m08:58:20.931348 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m08:58:20.945855 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m08:58:20.947736 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:20.947963 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m08:58:20.974561 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m08:58:20.975005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:20.975845 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m08:58:21.444884 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3e119f02-e433-4a8b-8f08-ab2b0eb519fd:europe-west1&page=queryresults
[0m08:58:21.457282 [debug] [Thread-2 (]: finished collecting timing info
[0m08:58:21.458607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a3a680>]}
[0m08:58:21.459338 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.49s]
[0m08:58:21.460159 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m08:58:23.829688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e99f9253-3dd9-45cb-ab4e-d7a2a2844789:europe-west1&page=queryresults
[0m08:58:23.833220 [debug] [Thread-1 (]: finished collecting timing info
[0m08:58:23.834418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710ddd9-f378-4c7a-9626-b2be1d0cdeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ab5ae0>]}
[0m08:58:23.835053 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.4k rows, 2.9 MB processed)[0m in 2.90s]
[0m08:58:23.835862 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m08:58:23.843459 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:58:23.845414 [info ] [MainThread]: 
[0m08:58:23.845901 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 16.55 seconds (16.55s).
[0m08:58:23.846229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:23.846399 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m08:58:23.846748 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m08:58:23.862080 [info ] [MainThread]: 
[0m08:58:23.862336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:58:23.862511 [info ] [MainThread]: 
[0m08:58:23.862648 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m08:58:23.862843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103328c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110331870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106175690>]}
[0m08:58:23.863014 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:08:00.443345 | e8708ec2-9442-4021-b7c8-bcc75b58630b ==============================
[0m09:08:00.443386 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:08:00.444226 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:08:00.444395 [debug] [MainThread]: Tracking: tracking
[0m09:08:00.456599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9db130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f34df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f37910>]}
[0m09:08:00.498762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:08:00.499067 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:08:00.505269 [debug] [MainThread]: 1603: static parser failed on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:08:00.513548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:08:00.556018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m09:08:00.559269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac67100>]}
[0m09:08:00.571199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abc7190>]}
[0m09:08:00.571426 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:08:00.571560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac02740>]}
[0m09:08:00.572494 [info ] [MainThread]: 
[0m09:08:00.572818 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:08:00.573500 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:08:00.573619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:01.129932 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:08:01.130526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:02.205646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abc5930>]}
[0m09:08:02.207091 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:08:02.207435 [info ] [MainThread]: 
[0m09:08:02.213426 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:08:02.213637 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:08:02.214049 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:08:02.214342 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:08:02.215094 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:08:02.215906 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:08:02.216111 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:08:02.216307 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:08:02.216503 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:08:02.216674 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:08:02.219997 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:08:02.222995 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:08:02.224060 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:02.224218 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:02.224356 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:08:02.224513 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:08:02.248197 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:08:02.251801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:08:02.252787 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:08:02.254511 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:08:02.294359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:02.297175 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:08:05.205141 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:67fdb1c4-9081-4538-b4d0-1b35f5e95b15:europe-west1&page=queryresults
[0m09:08:05.214488 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:05.214915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac67f10>]}
[0m09:08:05.215097 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 3.00s]
[0m09:08:05.215317 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:08:05.215421 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:08:05.215572 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:08:05.215894 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:08:05.215976 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:08:05.216048 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:08:05.217528 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:08:05.217850 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:05.217932 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:08:05.234145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:08:05.393111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f695a0ea-044b-4eda-9480-5ba20f22c12a:europe-west1&page=queryresults
[0m09:08:05.394300 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:05.394678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac755a0>]}
[0m09:08:05.394896 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 3.18s]
[0m09:08:05.395168 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:08:05.395288 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:08:05.395412 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:08:05.395767 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:08:05.396070 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:08:05.396220 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:08:05.398332 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:08:05.398715 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:05.398817 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:08:05.400601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:05.657484 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:08:05.657955 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:08:05.783852 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:08:05.784866 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m09:08:08.378696 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d938dca6-7798-461e-a0c1-41035830b1e3:europe-west1&page=queryresults
[0m09:08:08.379738 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:08.380145 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcc760>]}
[0m09:08:08.380340 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 3.16s]
[0m09:08:08.380573 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:08:08.380693 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:08:08.380895 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:08:08.381203 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:08:08.381288 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:08:08.381362 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:08:08.386109 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:08:08.389508 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:08.389747 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:08:08.392059 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:08:08.392473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:08:08.393223 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:08:08.658929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:995e44f6-482d-457d-b4b4-106010eb8de7:europe-west1&page=queryresults
[0m09:08:08.659812 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:08.660150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ada5b70>]}
[0m09:08:08.660341 [info ] [Thread-1 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 42.6 MB processed)[0m in 3.26s]
[0m09:08:08.660558 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:08:08.660654 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:08:08.660755 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:08:08.661052 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:08:08.661246 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:08:08.661360 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:08:08.663846 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:08:08.664983 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:08.665072 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:08:08.666677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:09.061590 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:08:09.063493 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:08:09.393484 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8b319546-9699-461e-9970-37f151c35d24:europe-west1&page=queryresults
[0m09:08:09.395956 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:09.396410 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcd810>]}
[0m09:08:09.396657 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m09:08:09.396999 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:08:09.397599 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:08:09.397801 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:08:09.398235 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:08:09.398449 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:08:09.398542 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:08:09.401435 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:08:09.401826 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:09.401928 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:08:09.403648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:08:09.786251 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:08:09.786695 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:08:11.242119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:40e16e71-b40b-4583-b891-08f9b4ce620b:europe-west1&page=queryresults
[0m09:08:11.244210 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:11.244984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adde1a0>]}
[0m09:08:11.245405 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.58s]
[0m09:08:11.245908 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:08:11.246177 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:08:11.246449 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:08:11.247291 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:08:11.248557 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:08:11.248782 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:08:11.268607 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:08:11.269242 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:11.269359 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:08:11.273084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:11.735148 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:08:11.736446 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:08:12.314264 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2ff3fe53-fe0a-4d50-80c5-0bdb1825a036:europe-west1&page=queryresults
[0m09:08:12.316308 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:12.317106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba55300>]}
[0m09:08:12.317544 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 2.92s]
[0m09:08:12.318052 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:08:12.318295 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:08:12.318544 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:08:12.319441 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:08:12.319769 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:08:12.320074 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:08:12.327035 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:08:12.329645 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:12.330070 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:08:12.336766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:08:12.755407 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:08:12.759672 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:08:14.018530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6b9bf0ae-fe31-4446-9b64-eb5325d5743b:europe-west1&page=queryresults
[0m09:08:14.021853 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:14.023736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba559f0>]}
[0m09:08:14.024973 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 2.78s]
[0m09:08:14.025862 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:08:14.026233 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m09:08:14.026635 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:08:14.028005 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:08:14.047089 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m09:08:14.047383 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m09:08:14.051011 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:08:14.051520 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:14.051628 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m09:08:14.058698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:14.471330 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:08:14.472591 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:08:14.925684 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e83336d5-48e4-42ba-927c-3288481bf709:europe-west1&page=queryresults
[0m09:08:14.927830 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:14.928832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba31630>]}
[0m09:08:14.931058 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.61s]
[0m09:08:14.931937 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:08:14.932188 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:08:14.932470 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:08:14.933422 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:08:14.933749 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:08:14.934072 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:08:14.937410 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:08:14.938900 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:14.939037 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:08:14.946328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:08:15.291726 [debug] [Thread-2 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/wawa-83630/datasets/dbt_rsdun/tables/stg_mixpanel__agg_viewed_article?prettyPrint=false: Not found: Table wawa-83630:dbt_rsdun.stg_mixpanel__agg_viewed_article
[0m09:08:15.294781 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:08:15.296842 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  a.referrer, a.slug, u.id as user_id, a.category, a.os, max(a.original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        ()
    values
        ()


    
[0m09:08:15.617827 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [28:10]')
[0m09:08:16.177833 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:US:d5e49be8-814e-4141-93ca-1a68b676b300&page=queryresults
[0m09:08:16.178533 [debug] [Thread-2 (]: finished collecting timing info
[0m09:08:16.179325 [debug] [Thread-2 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  Syntax error: Unexpected ")" at [28:10]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:08:16.179687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac33790>]}
[0m09:08:16.180121 [error] [Thread-2 (]: 11 of 12 ERROR creating sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 1.25s]
[0m09:08:16.180607 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:08:16.181549 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:08:16.181917 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m09:08:16.183018 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:08:17.093454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c08dbaaf-c72b-4522-8468-92a57b5d64af:europe-west1&page=queryresults
[0m09:08:17.097125 [debug] [Thread-1 (]: finished collecting timing info
[0m09:08:17.098323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8708ec2-9442-4021-b7c8-bcc75b58630b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac652d0>]}
[0m09:08:17.099003 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.07s]
[0m09:08:17.099802 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m09:08:17.102280 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:08:17.103444 [info ] [MainThread]: 
[0m09:08:17.104056 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 16.53 seconds (16.53s).
[0m09:08:17.104690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:17.110548 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:08:17.110867 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:08:17.120992 [info ] [MainThread]: 
[0m09:08:17.121211 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:08:17.121354 [info ] [MainThread]: 
[0m09:08:17.121468 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m09:08:17.121580 [error] [MainThread]:   Syntax error: Unexpected ")" at [28:10]
[0m09:08:17.121687 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:08:17.121804 [info ] [MainThread]: 
[0m09:08:17.121915 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m09:08:17.122077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095babf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac640d0>]}
[0m09:08:17.122210 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:10:47.799764 | ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da ==============================
[0m09:10:47.799836 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:10:47.803440 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:10:47.803771 [debug] [MainThread]: Tracking: tracking
[0m09:10:47.816260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c68220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481a470>]}
[0m09:10:47.857783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:10:47.858046 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:10:47.864977 [debug] [MainThread]: 1603: static parser failed on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:10:47.872985 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:10:47.913885 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m09:10:47.917225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c83220>]}
[0m09:10:47.925359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae4a60>]}
[0m09:10:47.925584 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:10:47.925712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481a470>]}
[0m09:10:47.926631 [info ] [MainThread]: 
[0m09:10:47.926969 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:10:47.927643 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:10:47.927768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:48.458804 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:10:48.459319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:48.831328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107fc340>]}
[0m09:10:48.832200 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:10:48.832488 [info ] [MainThread]: 
[0m09:10:48.837885 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:10:48.838103 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:10:48.838493 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:10:48.838768 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:10:48.840008 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:10:48.840900 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:10:48.841153 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:10:48.841357 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:10:48.841535 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:10:48.841683 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:10:48.845132 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:10:48.847829 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:10:48.848565 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:48.848704 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:48.848852 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:10:48.849012 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:10:48.872916 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:10:48.876835 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:10:48.878983 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:10:48.879758 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:10:48.920906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:48.921647 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:10:49.630978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1e6a319a-1e91-4f68-a263-0dd45f09c46d:europe-west1&page=queryresults
[0m09:10:49.651040 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:49.651629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c90b50>]}
[0m09:10:49.651918 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m09:10:49.652258 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:10:49.652411 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:10:49.652746 [info ] [Thread-1 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:10:49.653290 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:10:49.653425 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:10:49.653545 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:10:49.656006 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:10:49.657266 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:49.657538 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:10:49.658331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:11d0b75a-8d6f-49ac-bac5-81292994d740:europe-west1&page=queryresults
[0m09:10:49.679768 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:49.686837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ca99f0>]}
[0m09:10:49.691615 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:10:49.691973 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m09:10:49.692375 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:10:49.692513 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:10:49.692811 [info ] [Thread-2 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:10:49.693333 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:10:49.693534 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:10:49.693834 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:10:49.695943 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:10:49.696102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:49.697043 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
    );
  
[0m09:10:49.697144 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:49.750721 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:10:49.755186 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:10:49.756711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:10:49.758037 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
    );
  
[0m09:10:52.331995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:36c126e3-54a4-49b7-8e57-969feba5d0f0:europe-west1&page=queryresults
[0m09:10:52.335134 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:52.336055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c811e0>]}
[0m09:10:52.336599 [info ] [Thread-1 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE TABLE (28.0 rows, 26.5 MB processed)[0m in 2.68s]
[0m09:10:52.337759 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:10:52.338120 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:10:52.338294 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:10:52.338807 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:10:52.338910 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:10:52.339005 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:10:52.354793 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:10:52.355638 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:52.355750 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:10:52.357277 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:10:52.357507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:52.358211 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:10:52.691248 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:15f39d45-5006-4aa4-852d-09d9060b41d1:europe-west1&page=queryresults
[0m09:10:52.693405 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:52.694854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c83a00>]}
[0m09:10:52.695719 [info ] [Thread-2 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mCREATE TABLE (36.9k rows, 42.6 MB processed)[0m in 3.00s]
[0m09:10:52.697163 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:10:52.697576 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:10:52.697894 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:10:52.699495 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:10:52.700045 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:10:52.700255 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:10:52.714699 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:10:52.717149 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:52.717316 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:10:52.719118 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:10:53.131657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d82ce2d8-dd5e-49dd-916d-3045f3667ace:europe-west1&page=queryresults
[0m09:10:53.147496 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:53.154576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c82ce0>]}
[0m09:10:53.157493 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:10:53.157829 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m09:10:53.158273 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:10:53.158403 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:10:53.158637 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:10:53.159118 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:10:53.159317 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:10:53.159470 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:10:53.162339 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:10:53.162513 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:10:53.163414 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:53.163546 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:10:53.165254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:53.538857 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:10:53.540587 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:10:55.803438 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a8874421-308a-4ff8-a8ff-33ab578ee88b:europe-west1&page=queryresults
[0m09:10:55.807812 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:55.810523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c88dc0>]}
[0m09:10:55.811835 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 3.11s]
[0m09:10:55.812958 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:10:55.813318 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:10:55.813683 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:10:55.815441 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:10:55.815890 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:10:55.816797 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:10:55.835529 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:10:55.836331 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:55.836531 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:10:55.841685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:10:56.121096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6b68afba-b5e3-4b24-bb9d-9aa21dcecca2:europe-west1&page=queryresults
[0m09:10:56.122214 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:56.122581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e65540>]}
[0m09:10:56.122815 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 2.96s]
[0m09:10:56.123064 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:10:56.123169 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:10:56.123370 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:10:56.123735 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:10:56.123818 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:10:56.123893 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:10:56.126442 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:10:56.127344 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:56.127575 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:10:56.129757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:56.223939 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:10:56.224372 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:10:56.517417 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:10:56.522585 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:10:58.740048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:610140ae-d445-44f1-9d20-a4e0c210fff8:europe-west1&page=queryresults
[0m09:10:58.743217 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:58.744708 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e66050>]}
[0m09:10:58.745519 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 2.93s]
[0m09:10:58.746048 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:10:58.746348 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:10:58.746628 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:10:58.747466 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:10:58.747742 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:10:58.747939 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:10:58.755969 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:10:58.758422 [debug] [Thread-2 (]: finished collecting timing info
[0m09:10:58.758782 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:10:58.765988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:10:59.149657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3746c54e-5332-48b8-b683-79dbe8b51013:europe-west1&page=queryresults
[0m09:10:59.154719 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:59.156404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e53130>]}
[0m09:10:59.157349 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 3.03s]
[0m09:10:59.158674 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:10:59.159136 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:10:59.159529 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:10:59.161081 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:10:59.161425 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:10:59.161697 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:10:59.173278 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:10:59.175401 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:10:59.178184 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:10:59.178413 [debug] [Thread-1 (]: finished collecting timing info
[0m09:10:59.179711 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:10:59.189614 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:10:59.192893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:59.193841 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
  FROM (
    SELECT a.referrer, a.slug, u.id as user_id, a.category, a.os, a.original_timestamp
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as a
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
  )

GROUP BY reading_session, referrer, slug, user_id, category, os
    );
  
[0m09:11:02.054922 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: reading_session at [21:10]')
[0m09:11:02.555809 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7b4faac8-6353-41c0-9ca4-42017170666a:europe-west1&page=queryresults
[0m09:11:02.561177 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:02.562536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea9a20>]}
[0m09:11:02.563315 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.82s]
[0m09:11:02.564283 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:11:03.675211 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:add20b98-9062-4f78-91eb-97e8df39e7df&page=queryresults
[0m09:11:03.677324 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:03.678849 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)
  Unrecognized name: reading_session at [21:10]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:11:03.679783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebc4cf80-36dc-4bb1-bfc5-8f8ca28861da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb0fd0>]}
[0m09:11:03.681088 [error] [Thread-1 (]: 11 of 12 ERROR creating sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[31mERROR[0m in 4.52s]
[0m09:11:03.682307 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:11:03.684901 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:11:03.685504 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m09:11:03.686433 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:11:03.690090 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:11:03.691817 [info ] [MainThread]: 
[0m09:11:03.692091 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 15.76 seconds (15.76s).
[0m09:11:03.692231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:03.692302 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:11:03.692367 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:11:03.700242 [info ] [MainThread]: 
[0m09:11:03.700538 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:11:03.700751 [info ] [MainThread]: 
[0m09:11:03.700928 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__agg_viewed_article (models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql)[0m
[0m09:11:03.701103 [error] [MainThread]:   Unrecognized name: reading_session at [21:10]
[0m09:11:03.701267 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:11:03.701447 [info ] [MainThread]: 
[0m09:11:03.701616 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
[0m09:11:03.701858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f58c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eaba90>]}
[0m09:11:03.702065 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:11:39.210127 | 1aa98298-ee8f-440d-a2f8-a90b99715523 ==============================
[0m09:11:39.210175 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:11:39.210847 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:11:39.210941 [debug] [MainThread]: Tracking: tracking
[0m09:11:39.226781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f4c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3a470>]}
[0m09:11:39.268485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:11:39.268767 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:11:39.275005 [debug] [MainThread]: 1603: static parser failed on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:11:39.283216 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:11:39.325073 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m09:11:39.328513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7b1f0>]}
[0m09:11:39.337349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdca60>]}
[0m09:11:39.337612 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:11:39.337760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3a470>]}
[0m09:11:39.338759 [info ] [MainThread]: 
[0m09:11:39.339126 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:11:39.339805 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:11:39.339941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:11:40.058207 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:11:40.058848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:11:40.589317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f4400>]}
[0m09:11:40.590640 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:11:40.591042 [info ] [MainThread]: 
[0m09:11:40.597521 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:11:40.597786 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:11:40.598235 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:11:40.598495 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:11:40.599369 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:11:40.600086 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:11:40.600296 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:11:40.600485 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:11:40.600665 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:11:40.600805 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:11:40.604372 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:11:40.607183 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:11:40.608256 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:40.608446 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:40.608620 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:11:40.608742 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:11:40.630526 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:11:40.634383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:40.636400 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:11:40.637226 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:11:40.676982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:11:40.680005 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:11:41.775555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d474dd22-2b99-4ca7-944e-cda8ea971224:europe-west1&page=queryresults
[0m09:11:41.793738 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:41.794696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7ba60>]}
[0m09:11:41.795170 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m09:11:41.795620 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:11:41.795772 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:11:41.796016 [info ] [Thread-1 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:11:41.796489 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:11:41.796615 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:11:41.796772 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:11:41.798996 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:11:41.800632 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:41.800757 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:11:41.822050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:41.901400 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bbbf5f75-5042-496e-956e-e16711e085fc:europe-west1&page=queryresults
[0m09:11:41.902407 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:41.902730 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7bc40>]}
[0m09:11:41.902912 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m09:11:41.903137 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:11:41.903231 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:11:41.903335 [info ] [Thread-2 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:11:41.903733 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:11:41.903882 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:11:41.903968 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:11:41.905675 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:11:41.906029 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:41.906119 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:11:41.907613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:11:42.487630 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:11:42.488611 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:11:42.695694 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:11:42.696664 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m09:11:44.446116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1f21b941-906a-460d-9668-7a9bc65a6d79:europe-west1&page=queryresults
[0m09:11:44.448928 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:44.449887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df3400>]}
[0m09:11:44.450428 [info ] [Thread-1 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 2.65s]
[0m09:11:44.451021 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:11:44.451343 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:11:44.451712 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:11:44.452665 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:11:44.452845 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:11:44.453012 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:11:44.461486 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:11:44.463473 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:44.463677 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:11:44.466378 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:11:44.466798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:44.468091 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:11:45.458767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:aed8a892-db85-4a04-bb99-895d46983518:europe-west1&page=queryresults
[0m09:11:45.461052 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:45.461806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d82e30>]}
[0m09:11:45.462267 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m09:11:45.462760 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:11:45.462982 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:11:45.463336 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:11:45.464098 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:11:45.464292 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:11:45.464478 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:11:45.472680 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:11:45.475805 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:45.476036 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:11:45.480188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:45.831045 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8c8139d8-4b6d-411c-a76f-ab90158bdf9d:europe-west1&page=queryresults
[0m09:11:45.833464 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:45.834323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db8700>]}
[0m09:11:45.834815 [info ] [Thread-2 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 42.6 MB processed)[0m in 3.93s]
[0m09:11:45.835298 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:11:45.835507 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:11:45.835847 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:11:45.836504 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:11:45.836797 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:11:45.836992 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:11:45.842378 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:11:45.843392 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:45.843575 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:11:45.846435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:11:46.113505 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:11:46.115755 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:11:46.256081 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:11:46.256750 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:11:48.317650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:08909e2e-ed80-4bc0-ad83-254709da6115:europe-west1&page=queryresults
[0m09:11:48.320071 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:48.320985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7af20>]}
[0m09:11:48.321507 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.86s]
[0m09:11:48.322092 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:11:48.322355 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:11:48.322783 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:11:48.323598 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:11:48.323795 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:11:48.323969 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:11:48.329664 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:11:48.330522 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:48.330692 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:11:48.337892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:48.726406 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:11:48.726976 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:11:48.970295 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ed925c5d-22e7-458b-a7c6-5dfcc468faba:europe-west1&page=queryresults
[0m09:11:48.972898 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:48.973717 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e55ab0>]}
[0m09:11:48.974196 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.14s]
[0m09:11:48.974730 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:11:48.974981 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:11:48.975509 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:11:48.976317 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:11:48.976515 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:11:48.976694 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:11:48.982050 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:11:48.984979 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:48.985240 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:11:48.988628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:11:49.459548 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:11:49.460389 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:11:51.262689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bfa66b5e-a438-4b4f-9bb7-6e2bb6b70dd2:europe-west1&page=queryresults
[0m09:11:51.264485 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:51.265120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e68cd0>]}
[0m09:11:51.265470 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 2.94s]
[0m09:11:51.265883 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:11:51.266078 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m09:11:51.266486 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:11:51.267297 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:11:51.267452 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m09:11:51.267589 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m09:11:51.271015 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:11:51.271920 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:51.272192 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m09:11:51.280092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:51.801239 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:11:51.802296 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:11:51.939861 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:be21cbc2-96bc-45c7-9e00-12d13ddc897b:europe-west1&page=queryresults
[0m09:11:51.942810 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:51.943677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c44a30>]}
[0m09:11:51.944107 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.97s]
[0m09:11:51.944610 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:11:51.944834 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:11:51.945170 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:11:51.945827 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:11:51.946006 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:11:51.946160 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:11:51.951121 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:11:51.953755 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:51.953981 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:11:51.962950 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:11:51.963620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:11:51.964770 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
  FROM (
    SELECT a.referrer, a.slug, u.id as user_id, a.category, a.os, a.original_timestamp, a.reading_session
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as a
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
  )

GROUP BY reading_session, referrer, slug, user_id, category, os
    );
  
[0m09:11:54.602172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:915b66cc-955b-4865-a156-6dbc5acd6c92:europe-west1&page=queryresults
[0m09:11:54.606624 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:54.607525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec40a0>]}
[0m09:11:54.607983 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.34s]
[0m09:11:54.608507 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m09:11:55.274246 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2f62cad6-b785-40fd-9bff-d1e1403ed2fb:europe-west1&page=queryresults
[0m09:11:55.278511 [debug] [Thread-2 (]: finished collecting timing info
[0m09:11:55.279761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed4d60>]}
[0m09:11:55.280475 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mCREATE TABLE (13.2k rows, 11.7 MB processed)[0m in 3.33s]
[0m09:11:55.281090 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:11:55.281944 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m09:11:55.282451 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m09:11:55.283205 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:11:55.283385 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:11:55.283558 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m09:11:55.289601 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:11:55.292521 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:55.292775 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m09:11:55.294960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:11:55.697172 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m09:11:55.698738 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m09:11:58.403926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6449d4b6-f730-4f4b-aaf2-f1e3808c0d99:europe-west1&page=queryresults
[0m09:11:58.408313 [debug] [Thread-1 (]: finished collecting timing info
[0m09:11:58.409303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa98298-ee8f-440d-a2f8-a90b99715523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e40670>]}
[0m09:11:58.409828 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (17.7k rows, 2.3 MB processed)[0m in 3.13s]
[0m09:11:58.410434 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m09:11:58.412186 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:11:58.412910 [info ] [MainThread]: 
[0m09:11:58.413224 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 19.07 seconds (19.07s).
[0m09:11:58.413477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:11:58.413613 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:11:58.413741 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:11:58.429442 [info ] [MainThread]: 
[0m09:11:58.429743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:11:58.430143 [info ] [MainThread]: 
[0m09:11:58.430330 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:11:58.430493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c46d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dba110>]}
[0m09:11:58.430628 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:13:56.499833 | 219ca588-5386-42d7-bb2b-30fdd2408c9d ==============================
[0m09:13:56.499870 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:13:56.500631 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:13:56.500728 [debug] [MainThread]: Tracking: tracking
[0m09:13:56.519938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2d480>]}
[0m09:13:56.560906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:13:56.561064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:13:56.561396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m09:13:56.564890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd2800>]}
[0m09:13:56.605936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a6d660>]}
[0m09:13:56.606172 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:13:56.606303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f45e0>]}
[0m09:13:56.607262 [info ] [MainThread]: 
[0m09:13:56.607601 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:13:56.608295 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:13:56.608425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:13:57.425141 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:13:57.425712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:13:57.801891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf3f10>]}
[0m09:13:57.802525 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:13:57.802749 [info ] [MainThread]: 
[0m09:13:57.806627 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:13:57.806818 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:13:57.807023 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:13:57.807209 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:13:57.807700 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:13:57.808110 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:13:57.808216 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:13:57.808312 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:13:57.808424 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:13:57.808517 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:13:57.810988 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:13:57.812864 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:13:57.813919 [debug] [Thread-1 (]: finished collecting timing info
[0m09:13:57.814025 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:13:57.820092 [debug] [Thread-2 (]: finished collecting timing info
[0m09:13:57.833079 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:13:57.833203 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:13:57.835821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:57.837838 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:13:57.876852 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:13:57.877219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:13:57.877844 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:13:58.781236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:88e015cd-abb0-4126-b89a-b29226c53030:europe-west1&page=queryresults
[0m09:13:58.793649 [debug] [Thread-1 (]: finished collecting timing info
[0m09:13:58.794161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7c280>]}
[0m09:13:58.794428 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m09:13:58.794823 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:13:58.794982 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:13:58.795305 [info ] [Thread-1 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:13:58.796071 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:13:58.796239 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:13:58.796388 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:13:58.799173 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:13:58.801378 [debug] [Thread-1 (]: finished collecting timing info
[0m09:13:58.801641 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:13:58.834333 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:13:58.834849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:13:58.835685 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
    );
  
[0m09:13:58.894853 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b414c984-6584-438c-b2ac-a7337e4a6ddb:europe-west1&page=queryresults
[0m09:13:58.895920 [debug] [Thread-2 (]: finished collecting timing info
[0m09:13:58.896234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7ebf0>]}
[0m09:13:58.896417 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m09:13:58.896642 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:13:58.896740 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:13:58.896894 [info ] [Thread-2 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:13:58.897262 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:13:58.897362 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:13:58.897435 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:13:58.898985 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:13:58.899284 [debug] [Thread-2 (]: finished collecting timing info
[0m09:13:58.899362 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:13:58.901219 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:13:58.901470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:13:58.902149 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
    );
  
[0m09:14:01.653552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2088b6be-2865-4db6-af86-1a4772980c30:europe-west1&page=queryresults
[0m09:14:01.656288 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:01.657217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1fac0>]}
[0m09:14:01.657736 [info ] [Thread-1 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE TABLE (28.0 rows, 26.5 MB processed)[0m in 2.86s]
[0m09:14:01.658282 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:14:01.658502 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:14:01.658838 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:14:01.659596 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:14:01.659778 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:14:01.659944 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:14:01.672169 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:14:01.673718 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:01.673818 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:14:01.679174 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:14:01.679553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:01.680252 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:14:02.243267 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:10ebc7d0-905c-42d6-81ca-9139f132a908:europe-west1&page=queryresults
[0m09:14:02.247435 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:02.248418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d86ad0>]}
[0m09:14:02.248950 [info ] [Thread-2 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mCREATE TABLE (36.9k rows, 42.6 MB processed)[0m in 3.35s]
[0m09:14:02.249913 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:14:02.250441 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:14:02.251039 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:14:02.251874 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:14:02.252166 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:14:02.252390 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:14:02.261087 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:14:02.263056 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:02.263218 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:14:02.265574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:14:02.626858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:eab2948a-6c6a-41a9-a450-8cdce76309e5:europe-west1&page=queryresults
[0m09:14:02.630525 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:02.631413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb8df0>]}
[0m09:14:02.631864 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m09:14:02.632362 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:14:02.632593 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:14:02.632948 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:14:02.633714 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:14:02.633904 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:14:02.634081 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:14:02.639283 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:14:02.640094 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:02.640260 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:14:02.643255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:02.704620 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:14:02.705914 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:14:03.045737 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:14:03.046844 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:14:05.386369 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ac2cbc32-808c-4d39-b914-c89a0fe7afdd:europe-west1&page=queryresults
[0m09:14:05.388895 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:05.389777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc80d0>]}
[0m09:14:05.390710 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 3.14s]
[0m09:14:05.391429 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:14:05.391667 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:14:05.391988 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:14:05.392885 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:14:05.393113 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:14:05.393297 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:14:05.404747 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:14:05.405259 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:05.405400 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:14:05.411156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:14:05.506830 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7b1843f7-8c2d-4032-9c5e-8dcefc8897b4:europe-west1&page=queryresults
[0m09:14:05.507771 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:05.508136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01b820>]}
[0m09:14:05.508349 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 2.87s]
[0m09:14:05.508574 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:14:05.508694 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:14:05.508880 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:14:05.509256 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:14:05.509353 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:14:05.509439 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:14:05.512036 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:14:05.513917 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:05.514041 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:14:05.515749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:05.774327 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:14:05.774729 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:14:06.042822 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:14:06.044078 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:14:08.226164 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1f82f2e3-7b80-473c-90d8-286beb9e4b4e:europe-west1&page=queryresults
[0m09:14:08.229781 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:08.230818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b01bcd0>]}
[0m09:14:08.231338 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 2.84s]
[0m09:14:08.231937 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:14:08.232189 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:14:08.232545 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:14:08.233327 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:14:08.233516 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:14:08.233690 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:14:08.238289 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:14:08.240399 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:08.240578 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:14:08.251336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:14:08.339095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6a9bf3db-266a-4dde-b6b0-3ade90409aed:europe-west1&page=queryresults
[0m09:14:08.339988 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:08.340334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f266e0>]}
[0m09:14:08.340534 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.83s]
[0m09:14:08.340763 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:14:08.340872 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:14:08.340983 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:14:08.341528 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:14:08.341675 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:14:08.341771 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:14:08.344314 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:14:08.345823 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:08.345978 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:14:08.351587 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:14:08.352120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:08.352894 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
  FROM (
    SELECT a.referrer, a.slug, u.id as user_id, a.category, a.os, a.original_timestamp, a.reading_session
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as a
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
  )

GROUP BY reading_session, referrer, slug, user_id, category, os
    );
  
[0m09:14:08.919484 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:14:08.920687 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:14:11.040095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ea0a0d96-b561-4e76-8114-ad97bf544fb1:europe-west1&page=queryresults
[0m09:14:11.043797 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:11.044643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b082950>]}
[0m09:14:11.045112 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mCREATE TABLE (13.2k rows, 5.9 MB processed)[0m in 2.70s]
[0m09:14:11.045631 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:14:11.046141 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m09:14:11.046392 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m09:14:11.047034 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:14:11.047212 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:14:11.047388 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m09:14:11.053578 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:14:11.056792 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:11.057046 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m09:14:11.059333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:14:11.498244 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m09:14:11.499277 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m09:14:11.672592 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:00823264-a4a2-4c5f-8469-113e004ff4fc:europe-west1&page=queryresults
[0m09:14:11.676395 [debug] [Thread-2 (]: finished collecting timing info
[0m09:14:11.677324 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8e1a0>]}
[0m09:14:11.677847 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.44s]
[0m09:14:11.678468 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:14:13.928637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1d94a73b-421a-44fc-a77f-da27808c18d7:europe-west1&page=queryresults
[0m09:14:13.932205 [debug] [Thread-1 (]: finished collecting timing info
[0m09:14:13.933103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '219ca588-5386-42d7-bb2b-30fdd2408c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e6dd0>]}
[0m09:14:13.933518 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (17.7k rows, 2.3 MB processed)[0m in 2.89s]
[0m09:14:13.934019 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m09:14:13.935667 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:14:13.936310 [info ] [MainThread]: 
[0m09:14:13.936582 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 17.33 seconds (17.33s).
[0m09:14:13.936804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:13.936920 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:14:13.937032 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:14:13.949315 [info ] [MainThread]: 
[0m09:14:13.949587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:14:13.949806 [info ] [MainThread]: 
[0m09:14:13.949983 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:14:13.950223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e6dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acaf50>]}
[0m09:14:13.950421 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:18:20.404845 | ca8876da-d99b-482f-90dc-d9a3a7409158 ==============================
[0m09:18:20.405067 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:18:20.406263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:18:20.406370 [debug] [MainThread]: Tracking: tracking
[0m09:18:20.417717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d1bfd0>]}
[0m09:18:20.460120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:18:20.460393 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:18:20.460512 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:18:20.468147 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:18:20.473685 [debug] [MainThread]: 1603: static parser failed on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:18:20.477545 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/mixpanel/stg_mixpanel__agg_viewed_article.sql
[0m09:18:20.519181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.downloads
- models.my_new_project.google_play_store

[0m09:18:20.522573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8b640>]}
[0m09:18:20.532546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1e740>]}
[0m09:18:20.532780 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:18:20.532930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d1bfd0>]}
[0m09:18:20.533859 [info ] [MainThread]: 
[0m09:18:20.534204 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:18:20.534878 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:18:20.535000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:21.335207 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:18:21.335729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:21.967190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645db70>]}
[0m09:18:21.968412 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:18:21.968754 [info ] [MainThread]: 
[0m09:18:21.974416 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:18:21.974630 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:18:21.975029 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:18:21.975324 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:18:21.976220 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:18:21.977414 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:18:21.977664 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:18:21.977859 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:18:21.978059 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:18:21.978221 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:18:21.981826 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:18:21.984767 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:18:21.985783 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:21.985915 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:21.986048 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:18:21.986171 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:18:22.014843 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:18:22.015261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:18:22.016112 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:18:22.018500 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:18:22.057578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:22.058232 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:18:23.049553 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d6264dd1-31b3-45c8-b122-05282d929b82:europe-west1&page=queryresults
[0m09:18:23.086929 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:23.088049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7e2bb2c9-4295-4a24-a01e-17d4a09678ac:europe-west1&page=queryresults
[0m09:18:23.088704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb1810>]}
[0m09:18:23.090016 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:23.090396 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m09:18:23.090885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc82b0>]}
[0m09:18:23.091310 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:18:23.091548 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m09:18:23.091742 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:18:23.092188 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:18:23.092414 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:18:23.092587 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:18:23.093266 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:18:23.093488 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:18:23.093656 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:18:23.094133 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:18:23.094272 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:18:23.094386 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:18:23.096904 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:18:23.097086 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:18:23.099491 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:18:23.099820 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:23.099995 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:18:23.100093 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:23.122069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:23.122272 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:18:23.163470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:23.806573 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:18:23.807823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:18:23.808716 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:18:23.808857 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          

WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
)

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u 
  ON e.user_id=u.firebase_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m09:18:24.548235 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event_id at [47:30]')
[0m09:18:26.027845 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:46e261b7-c964-430c-acb2-d8f36d200e84&page=queryresults
[0m09:18:26.029535 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:26.030659 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)
  Unrecognized name: event_id at [47:30]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:18:26.031083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca5150>]}
[0m09:18:26.031644 [error] [Thread-1 (]: 4 of 12 ERROR creating sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[31mERROR[0m in 2.94s]
[0m09:18:26.032222 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:18:26.032503 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:18:26.033194 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:18:26.034188 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:18:26.034429 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:18:26.034645 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:18:26.043257 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:18:26.045005 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:26.045195 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:18:26.048076 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:18:26.048538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:26.049653 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:18:26.511606 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0fc6cd20-9b1b-4a1d-9bef-634de6fb2749:europe-west1&page=queryresults
[0m09:18:26.514042 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:26.514944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8f910>]}
[0m09:18:26.515486 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 3.42s]
[0m09:18:26.516071 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:18:26.516327 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:18:26.516690 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:18:26.517445 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:18:26.517640 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:18:26.517810 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:18:26.523449 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:18:26.526285 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:26.526489 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:18:26.529636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:26.901893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dbf455fa-0ba9-4e6c-b9e7-0306dc43cf4b:europe-west1&page=queryresults
[0m09:18:26.903382 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:26.903843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efec80>]}
[0m09:18:26.904196 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m09:18:26.904624 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:18:26.904816 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:18:26.905168 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:18:26.905926 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:18:26.906110 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:18:26.906268 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:18:26.911053 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:18:26.911611 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:26.911768 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:18:26.914313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:26.972849 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:18:26.973517 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:18:27.366425 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:18:27.367655 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:18:29.239901 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:97e20e01-92bd-454f-ac4a-7c3f15aa89fd:europe-west1&page=queryresults
[0m09:18:29.242640 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:29.243563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8b040>]}
[0m09:18:29.244074 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.73s]
[0m09:18:29.244684 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:18:29.244948 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:18:29.245382 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:18:29.246291 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:18:29.246496 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:18:29.246667 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:18:29.259305 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:18:29.259837 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:29.259974 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:18:29.265968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:29.784792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3c8b10a4-05fe-4e21-8473-4b16dc9a8be4:europe-west1&page=queryresults
[0m09:18:29.785768 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:29.786141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8b100>]}
[0m09:18:29.786352 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 2.88s]
[0m09:18:29.786599 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:18:29.786715 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:18:29.786835 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:18:29.787185 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:18:29.787283 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:18:29.787424 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:18:29.790328 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:18:29.792124 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:29.792265 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:18:29.794001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:29.834888 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:18:29.835404 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:18:30.306116 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:18:30.307241 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:18:32.382085 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9bfc21fa-80e3-4514-b819-04f60e008819:europe-west1&page=queryresults
[0m09:18:32.385820 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:32.386818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8ae00>]}
[0m09:18:32.387329 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.14s]
[0m09:18:32.387914 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:18:32.388171 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:18:32.388444 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:18:32.389255 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:18:32.389766 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:18:32.390110 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:18:32.394896 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:18:32.397074 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:32.397352 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:18:32.408149 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:32.927518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:eb908967-f690-4db0-8fe9-c8a5648d951e:europe-west1&page=queryresults
[0m09:18:32.930972 [debug] [Thread-1 (]: finished collecting timing info
[0m09:18:32.931920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f64cd0>]}
[0m09:18:32.932403 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 3.14s]
[0m09:18:32.932941 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:18:32.933158 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:18:32.933449 [info ] [Thread-1 (]: 11 of 12 SKIP relation dbt_rsdun.stg_mixpanel__agg_viewed_article .............. [[33mSKIP[0m]
[0m09:18:32.933913 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:18:32.934327 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m09:18:32.934495 [info ] [Thread-1 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m09:18:32.934868 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m09:18:32.999506 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:18:33.000192 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:18:35.708333 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1dd08667-78f3-44b1-8702-5b1cc07fb3c4:europe-west1&page=queryresults
[0m09:18:35.712596 [debug] [Thread-2 (]: finished collecting timing info
[0m09:18:35.713653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca8876da-d99b-482f-90dc-d9a3a7409158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3cc40>]}
[0m09:18:35.714167 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.32s]
[0m09:18:35.714784 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:18:35.716694 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:18:35.717463 [info ] [MainThread]: 
[0m09:18:35.717782 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 15.18 seconds (15.18s).
[0m09:18:35.718042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:35.718175 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__viewed_article' was properly closed.
[0m09:18:35.718307 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:18:35.740015 [info ] [MainThread]: 
[0m09:18:35.740357 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:18:35.740572 [info ] [MainThread]: 
[0m09:18:35.740732 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)[0m
[0m09:18:35.740869 [error] [MainThread]:   Unrecognized name: event_id at [47:30]
[0m09:18:35.740967 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:18:35.741074 [info ] [MainThread]: 
[0m09:18:35.741174 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=2 TOTAL=12
[0m09:18:35.741326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb1630>]}
[0m09:18:35.741455 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:20:57.625428 | 778b8643-1fcc-4249-b839-12bc1af497a0 ==============================
[0m09:20:57.625488 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:20:57.626224 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:20:57.626328 [debug] [MainThread]: Tracking: tracking
[0m09:20:57.636558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef5450>]}
[0m09:20:57.679735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:57.680030 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:20:57.687586 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:20:57.734049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m09:20:57.737392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a75b0>]}
[0m09:20:57.744164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e4c70>]}
[0m09:20:57.744356 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:20:57.744482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11ec20>]}
[0m09:20:57.745385 [info ] [MainThread]: 
[0m09:20:57.745721 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:20:57.746416 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:20:57.746541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:58.357568 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:20:58.358185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:58.968351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f0d60>]}
[0m09:20:58.969363 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:20:58.969658 [info ] [MainThread]: 
[0m09:20:58.974674 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:20:58.974864 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:20:58.975282 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:20:58.975594 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:20:58.976608 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:20:58.977555 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:20:58.977841 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:20:58.978052 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:20:58.978271 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:20:58.978438 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:20:58.982182 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:20:58.985000 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:20:58.985889 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:58.985993 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:20:58.992392 [debug] [Thread-1 (]: finished collecting timing info
[0m09:20:59.009732 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:20:59.009880 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:20:59.012156 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:20:59.014129 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:20:59.055329 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:20:59.055979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:59.056610 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:20:59.907734 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7bb71aba-9b30-465f-9b01-5cfc2d62c716:europe-west1&page=queryresults
[0m09:20:59.924774 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:59.926184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2334c199-3cef-4851-8411-45aae672122c:europe-west1&page=queryresults
[0m09:20:59.926668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25c7c0>]}
[0m09:20:59.927973 [debug] [Thread-1 (]: finished collecting timing info
[0m09:20:59.928273 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m09:20:59.928700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25e980>]}
[0m09:20:59.929053 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:20:59.929293 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m09:20:59.929454 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:20:59.929813 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:20:59.930087 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:20:59.930274 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:20:59.930882 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:20:59.931078 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:20:59.931209 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:20:59.931740 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:20:59.931885 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:20:59.931999 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:20:59.934451 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:20:59.934619 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:20:59.936774 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:20:59.937136 [debug] [Thread-2 (]: finished collecting timing info
[0m09:20:59.937302 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:20:59.959194 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:20:59.959523 [debug] [Thread-1 (]: finished collecting timing info
[0m09:20:59.959682 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:20:59.961475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:00.410135 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:21:00.416677 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:21:00.416975 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:21:00.417694 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          


  SELECT
  DISTINCT
    CASE
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
    WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
    ELSE JSON_VALUE(properties,'$.Referrer')
  END as referrer,
  JSON_VALUE(properties,'$.Slug') as slug,
  JSON_VALUE(properties,'$."$insert_id"') as event_id,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.Category') as category,
  JSON_VALUE(properties,'$.os') as os,
  JSON_VALUE(properties,'$.Reading session') as reading_session,
  TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
where (event = 'Viewed article')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m09:21:02.927725 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1dcdba3f-23b8-4dc6-b675-a5b231ed52a2:europe-west1&page=queryresults
[0m09:21:02.930088 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:02.930879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3199f0>]}
[0m09:21:02.931332 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 3.00s]
[0m09:21:02.931849 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:21:02.932092 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:21:02.932486 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:21:02.933278 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:21:02.933472 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:21:02.933658 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:21:02.941892 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:21:02.943784 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:02.943990 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:21:02.946968 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:21:02.947568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:21:02.948728 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:21:03.160345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2ae76d93-840c-426f-b38b-625410802916:europe-west1&page=queryresults
[0m09:21:03.162223 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:03.163018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ec7c0>]}
[0m09:21:03.163663 [info ] [Thread-1 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 42.6 MB processed)[0m in 3.23s]
[0m09:21:03.164264 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:21:03.164453 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:21:03.164830 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:21:03.165402 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:21:03.165628 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:21:03.165873 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:21:03.173707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:21:03.176148 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:03.176396 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:21:03.178690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:03.595508 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:21:03.598162 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:21:04.078301 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:41d872f2-5f60-4385-9875-be6f1d7e265d:europe-west1&page=queryresults
[0m09:21:04.082113 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:04.083138 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a299ae0>]}
[0m09:21:04.083630 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m09:21:04.084206 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:21:04.084470 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:21:04.084879 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:21:04.085798 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:21:04.085997 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:21:04.086168 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:21:04.091739 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:21:04.092561 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:04.092725 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:21:04.095708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:21:04.589161 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:21:04.590245 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:21:05.918476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0e51e79a-c9b6-477b-a57d-7305f0698bbc:europe-west1&page=queryresults
[0m09:21:05.920770 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:05.921567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a315c60>]}
[0m09:21:05.922008 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.76s]
[0m09:21:05.922526 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:21:05.922756 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:21:05.923119 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:21:05.923881 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:21:05.924075 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:21:05.924254 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:21:05.936924 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:21:05.937366 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:05.937444 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:21:05.942743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:06.369223 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:21:06.370394 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:21:07.104797 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b5661ab8-09da-453d-ad81-96a8c925bb69:europe-west1&page=queryresults
[0m09:21:07.105709 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:07.106054 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a370820>]}
[0m09:21:07.106244 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.02s]
[0m09:21:07.106470 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:21:07.106575 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:21:07.106686 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:21:07.107008 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:21:07.107147 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:21:07.107268 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:21:07.109959 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:21:07.111832 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:07.111970 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:21:07.113657 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:21:07.561890 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:21:07.563111 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:21:09.070673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bac7a71f-04db-49bb-9a09-468f0c58bc13:europe-west1&page=queryresults
[0m09:21:09.073105 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:09.074010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b4490>]}
[0m09:21:09.074531 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.15s]
[0m09:21:09.075113 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:21:09.075380 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m09:21:09.075793 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:21:09.076625 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:21:09.076818 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m09:21:09.076989 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m09:21:09.081406 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:21:09.083445 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:09.083617 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m09:21:09.092513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:09.502020 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:21:09.503640 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:21:09.907960 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:af6424de-946d-4dc5-a3cd-93f7ce0769f3:europe-west1&page=queryresults
[0m09:21:09.910270 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:09.911048 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14ccd0>]}
[0m09:21:09.911490 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.80s]
[0m09:21:09.911952 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:21:09.912152 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:21:09.912468 [info ] [Thread-2 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:21:09.913129 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:21:09.913306 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:21:09.913465 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:21:09.918686 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:21:09.921144 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:09.921357 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:21:09.934770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:21:10.502672 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:21:10.505305 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:21:12.210628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:206a6bc7-c126-4414-80a4-4e381f6172e2:europe-west1&page=queryresults
[0m09:21:12.212842 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:12.213465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35b040>]}
[0m09:21:12.213813 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.14s]
[0m09:21:12.214250 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m09:21:13.066108 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:722a19a8-1761-4606-b1c9-a54fcae8c980:europe-west1&page=queryresults
[0m09:21:13.069114 [debug] [Thread-2 (]: finished collecting timing info
[0m09:21:13.070130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35b700>]}
[0m09:21:13.070636 [info ] [Thread-2 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 11.6 MB processed)[0m in 3.16s]
[0m09:21:13.071203 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:21:13.072170 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m09:21:13.072616 [info ] [Thread-1 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m09:21:13.073376 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:21:13.073544 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:21:13.073710 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m09:21:13.079687 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:21:13.081890 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:13.082111 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m09:21:13.084268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:13.651251 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m09:21:13.652680 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m09:21:16.084189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1f4d121c-e717-4e37-aeec-312ee02461db:europe-west1&page=queryresults
[0m09:21:16.087259 [debug] [Thread-1 (]: finished collecting timing info
[0m09:21:16.088077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778b8643-1fcc-4249-b839-12bc1af497a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33fa30>]}
[0m09:21:16.088437 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (17.7k rows, 2.3 MB processed)[0m in 3.01s]
[0m09:21:16.088869 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m09:21:16.090448 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:21:16.091136 [info ] [MainThread]: 
[0m09:21:16.091415 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 18.35 seconds (18.35s).
[0m09:21:16.091615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:16.091718 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:21:16.091826 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:21:16.104788 [info ] [MainThread]: 
[0m09:21:16.105160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:21:16.105402 [info ] [MainThread]: 
[0m09:21:16.105596 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:21:16.105975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a179c00>]}
[0m09:21:16.106381 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:22:58.585003 | f8e3915c-2bc2-48f9-90e4-d14cfde0213b ==============================
[0m09:22:58.585184 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:22:58.586255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:22:58.586366 [debug] [MainThread]: Tracking: tracking
[0m09:22:58.597107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b97d360>]}
[0m09:22:58.638317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:22:58.638583 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:22:58.646066 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:22:58.691772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store
- models.my_new_project.downloads

[0m09:22:58.695086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5fb80>]}
[0m09:22:58.703609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce4af0>]}
[0m09:22:58.703829 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:22:58.703972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd1eaa0>]}
[0m09:22:58.704930 [info ] [MainThread]: 
[0m09:22:58.705316 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:22:58.706059 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:22:58.706196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:59.254790 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:22:59.255360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:22:59.644936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a78d60>]}
[0m09:22:59.646021 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:22:59.646333 [info ] [MainThread]: 
[0m09:22:59.652460 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:22:59.652719 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:22:59.652995 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:22:59.653224 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:22:59.653891 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:22:59.654435 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:22:59.654594 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:22:59.654756 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:22:59.654940 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:22:59.655069 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:22:59.658104 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:22:59.661097 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:22:59.662191 [debug] [Thread-1 (]: finished collecting timing info
[0m09:22:59.662352 [debug] [Thread-2 (]: finished collecting timing info
[0m09:22:59.662512 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:22:59.662643 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:22:59.686646 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:22:59.690437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:22:59.692467 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:22:59.693279 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:22:59.735127 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:22:59.735878 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:23:00.510761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8adde064-5d69-4f8e-a1d1-3528b181d10c:europe-west1&page=queryresults
[0m09:23:00.531372 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:00.532265 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:0a2fa803-152e-4f1d-9192-3f8846d89cc9:europe-west1&page=queryresults
[0m09:23:00.532830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf606a0>]}
[0m09:23:00.534131 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:00.534498 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m09:23:00.534950 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf63ac0>]}
[0m09:23:00.535367 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:23:00.535608 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m09:23:00.535828 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:23:00.536310 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:23:00.536523 [info ] [Thread-1 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:23:00.536674 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:23:00.537254 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:23:00.537464 [info ] [Thread-2 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:23:00.537601 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:23:00.538038 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:23:00.538178 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:23:00.538287 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:23:00.540819 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:23:00.541006 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:23:00.543453 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:23:00.543785 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:00.543931 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:23:00.549901 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:00.556901 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:23:00.565638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:00.567463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:01.360183 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:23:01.360682 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:23:01.397346 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:23:01.397659 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          


WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
),

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u 
  ON e.user_id=u.firebase_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m09:23:01.604737 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [36:1]')
[0m09:23:02.540856 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:7207ad34-2369-4834-a385-c4a8c2be15f4&page=queryresults
[0m09:23:02.542386 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:02.543344 [debug] [Thread-2 (]: Database Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)
  Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [36:1]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:23:02.543718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb08b0>]}
[0m09:23:02.544269 [error] [Thread-2 (]: 4 of 12 ERROR creating sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[31mERROR[0m in 2.01s]
[0m09:23:02.544816 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:23:02.545083 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:23:02.545756 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:23:02.546737 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:23:02.546985 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:23:02.547195 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:23:02.555577 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:23:02.557867 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:02.558090 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:23:02.561087 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:23:02.561576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:02.562780 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:23:03.548074 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5a1b80a1-7286-42db-9d30-f6be228a09bf:europe-west1&page=queryresults
[0m09:23:03.551047 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:03.551934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb20b0>]}
[0m09:23:03.552457 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m09:23:03.553043 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:23:03.553311 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:23:03.553580 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:23:03.554345 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:23:03.554667 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:23:03.554885 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:23:03.567702 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:23:03.570117 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:03.570269 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:23:03.572587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:04.042125 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:23:04.045601 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:23:04.740505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:f7f74798-8199-4e4a-b718-0518a0975ca7:europe-west1&page=queryresults
[0m09:23:04.743112 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:04.744007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4c8e0>]}
[0m09:23:04.744523 [info ] [Thread-1 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 4.21s]
[0m09:23:04.745113 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:23:04.745374 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:23:04.745788 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:23:04.746697 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:23:04.746894 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:23:04.747072 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:23:04.752650 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:23:04.753327 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:04.753478 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:23:04.756148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:05.612231 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:23:05.614091 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:23:06.661069 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:bd02da21-edbd-48ff-8451-fed601c9a902:europe-west1&page=queryresults
[0m09:23:06.664073 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:06.665025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5fbb0>]}
[0m09:23:06.665523 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 3.11s]
[0m09:23:06.666103 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:23:06.666369 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:23:06.666770 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:23:06.667656 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:23:06.667847 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:23:06.668015 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:23:06.679524 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:23:06.680109 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:06.680253 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:23:06.683903 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:07.125819 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:23:07.127024 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:23:07.746129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:dfaf59d2-07a7-4113-bf47-e7d268a42bcb:europe-west1&page=queryresults
[0m09:23:07.748713 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:07.749634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5f520>]}
[0m09:23:07.750156 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.00s]
[0m09:23:07.750763 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:23:07.751036 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:23:07.751472 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:23:07.752312 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:23:07.752502 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:23:07.752680 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:23:07.758298 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:23:07.760930 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:07.761105 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:23:07.764160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:08.697837 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:23:08.699004 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:23:09.840250 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:27984db5-778b-425a-8b15-a475cc68bbce:europe-west1&page=queryresults
[0m09:23:09.841583 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:09.842113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5fe50>]}
[0m09:23:09.842413 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.17s]
[0m09:23:09.842767 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:23:09.842918 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:23:09.843077 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:23:09.843826 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:23:09.843987 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:23:09.844113 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:23:09.847338 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:23:09.848125 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:09.848294 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:23:09.857152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:23:10.442019 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:23:10.443786 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:23:10.888331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1cc0802f-0753-48cd-9a8a-74fb7897a3b6:europe-west1&page=queryresults
[0m09:23:10.889646 [debug] [Thread-1 (]: finished collecting timing info
[0m09:23:10.890081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5ffd0>]}
[0m09:23:10.890335 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 3.14s]
[0m09:23:10.890627 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:23:10.890758 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:23:10.890933 [info ] [Thread-1 (]: 11 of 12 SKIP relation dbt_rsdun.stg_mixpanel__agg_viewed_article .............. [[33mSKIP[0m]
[0m09:23:10.891233 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:23:10.891535 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m09:23:10.891654 [info ] [Thread-1 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m09:23:10.891903 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m09:23:12.891408 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c082bd67-242a-4d6e-b2c2-716dfefc3dbb:europe-west1&page=queryresults
[0m09:23:12.895419 [debug] [Thread-2 (]: finished collecting timing info
[0m09:23:12.896474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8e3915c-2bc2-48f9-90e4-d14cfde0213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b94f340>]}
[0m09:23:12.896988 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.05s]
[0m09:23:12.897599 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:23:12.899452 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:23:12.900103 [info ] [MainThread]: 
[0m09:23:12.900392 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m09:23:12.900643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:12.900773 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__viewed_article' was properly closed.
[0m09:23:12.900899 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:23:12.922202 [info ] [MainThread]: 
[0m09:23:12.922377 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:23:12.922490 [info ] [MainThread]: 
[0m09:23:12.922589 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)[0m
[0m09:23:12.922687 [error] [MainThread]:   Syntax error: Trailing comma after the WITH clause before the SELECT clause is not allowed at [36:1]
[0m09:23:12.922781 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:23:12.922886 [info ] [MainThread]: 
[0m09:23:12.923013 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=2 TOTAL=12
[0m09:23:12.923227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04d300>]}
[0m09:23:12.923396 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:24:12.562193 | c4439573-f385-4c28-b544-c101e0c0c634 ==============================
[0m09:24:12.562232 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:24:12.564378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:24:12.564515 [debug] [MainThread]: Tracking: tracking
[0m09:24:12.580492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e5450>]}
[0m09:24:12.622522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:24:12.622785 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:24:12.630369 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:24:12.676281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.apple_app_store
- models.my_new_project.downloads

[0m09:24:12.679586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834fb50>]}
[0m09:24:12.686170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d4a60>]}
[0m09:24:12.686349 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:24:12.686474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830eaa0>]}
[0m09:24:12.687406 [info ] [MainThread]: 
[0m09:24:12.687764 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:24:12.688429 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:24:12.688551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:13.315814 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:24:13.316356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:13.868725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e0d90>]}
[0m09:24:13.869883 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:24:13.870280 [info ] [MainThread]: 
[0m09:24:13.875987 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:24:13.876233 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:24:13.876669 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:24:13.876921 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:24:13.877655 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:24:13.878263 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:24:13.878461 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:24:13.878617 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:24:13.878787 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:24:13.878920 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:24:13.882548 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:24:13.885393 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:24:13.886481 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:13.886674 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:24:13.886793 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:13.909767 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:24:13.909949 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:24:13.912119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:24:13.914154 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:24:13.955413 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:24:13.955916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:13.956550 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:24:14.795847 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d798f3a6-9a08-47fc-a79a-a77f78090d3c:europe-west1&page=queryresults
[0m09:24:14.814826 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:14.815436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108450760>]}
[0m09:24:14.815814 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m09:24:14.816236 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:24:14.816413 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:24:14.816681 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:24:14.817241 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:24:14.817387 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:24:14.817516 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:24:14.820168 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:24:14.822341 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:14.822499 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:24:14.843643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:24:14.986689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b67bfe89-0cf3-4288-9291-24da94cd56f8:europe-west1&page=queryresults
[0m09:24:14.987897 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:14.988279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848f6a0>]}
[0m09:24:14.988501 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m09:24:14.988770 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:24:14.988890 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:24:14.989100 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:24:14.989862 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:24:14.990000 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:24:14.990102 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:24:14.992444 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:24:14.992813 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:14.992924 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:24:14.994689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:15.330127 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:24:15.330676 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m09:24:15.389818 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:24:15.390421 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          


WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
)

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u 
  ON e.user_id=u.firebase_id
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)
    values
        (`referrer`, `slug`, `event_id`, `user_id`, `category`, `os`, `reading_session`, `original_timestamp`)


    
[0m09:24:16.231717 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: event_id at [48:30]')
[0m09:24:17.381344 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1a948077-46d4-45c7-b4c5-f441f33ee16b:europe-west1&page=queryresults
[0m09:24:17.384222 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:17.385206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834c9d0>]}
[0m09:24:17.385744 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 2.57s]
[0m09:24:17.386353 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:24:17.386629 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:24:17.387049 [info ] [Thread-2 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:24:17.387964 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:24:17.388155 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:24:17.388334 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:24:17.396720 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:24:17.399246 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:17.399410 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:24:17.402486 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:24:17.403059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:24:17.404362 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:24:17.453100 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:europe-west1:0e1d6b35-5746-4cea-ac80-6ace06f0fa11&page=queryresults
[0m09:24:17.453419 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:17.453722 [debug] [Thread-1 (]: Database Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)
  Unrecognized name: event_id at [48:30]
  compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:24:17.453846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d0ee0>]}
[0m09:24:17.454062 [error] [Thread-1 (]: 4 of 12 ERROR creating sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[31mERROR[0m in 2.46s]
[0m09:24:17.454400 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:24:17.454598 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:24:17.454760 [info ] [Thread-1 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:24:17.455053 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:24:17.455197 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:24:17.455327 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:24:17.459364 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:24:17.461466 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:17.461550 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:24:17.462879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:18.076617 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:24:18.079272 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:24:18.466470 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:9e75d3a3-2a49-4157-9496-ce4550a73241:europe-west1&page=queryresults
[0m09:24:18.469136 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:18.469980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834fb50>]}
[0m09:24:18.470468 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m09:24:18.471060 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:24:18.471326 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:24:18.471587 [info ] [Thread-2 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:24:18.472456 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:24:18.472716 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:24:18.472904 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:24:18.478413 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:24:18.479183 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:18.479343 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:24:18.482228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:24:18.916423 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:24:18.917575 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:24:20.510438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:82ebd60b-1c89-4bae-9e15-24b659a20f89:europe-west1&page=queryresults
[0m09:24:20.513959 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:20.514850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834f880>]}
[0m09:24:20.515356 [info ] [Thread-1 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 3.06s]
[0m09:24:20.515942 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:24:20.516208 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:24:20.516616 [info ] [Thread-1 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:24:20.517374 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:24:20.517567 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:24:20.517741 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:24:20.530077 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:24:20.530849 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:20.531000 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:24:20.536990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:20.987476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:24:20.988850 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:24:21.520625 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:57038a90-f143-4a91-a50e-d7ca17796645:europe-west1&page=queryresults
[0m09:24:21.522990 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:21.523853 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834fb20>]}
[0m09:24:21.524357 [info ] [Thread-2 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.05s]
[0m09:24:21.524923 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:24:21.525145 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:24:21.525379 [info ] [Thread-2 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:24:21.526155 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:24:21.526318 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:24:21.526492 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:24:21.532011 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:24:21.534558 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:21.534738 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:24:21.537680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:24:22.029630 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:24:22.030253 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:24:23.597926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:88654deb-c8ce-4062-ae8a-c0ca027f5ac0:europe-west1&page=queryresults
[0m09:24:23.600162 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:23.600976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834ffd0>]}
[0m09:24:23.601524 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.08s]
[0m09:24:23.602122 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:24:23.602364 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m09:24:23.602763 [info ] [Thread-1 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:24:23.603623 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:24:23.603812 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m09:24:23.603979 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m09:24:23.608069 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:24:23.609805 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:23.609969 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m09:24:23.620886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:24.153215 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:24:24.154127 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:24:24.299808 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:575e3076-2274-4899-8471-77aea5d4cf15:europe-west1&page=queryresults
[0m09:24:24.302519 [debug] [Thread-2 (]: finished collecting timing info
[0m09:24:24.303363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ab190>]}
[0m09:24:24.303834 [info ] [Thread-2 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 2.78s]
[0m09:24:24.304391 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:24:24.304647 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:24:24.304985 [info ] [Thread-2 (]: 11 of 12 SKIP relation dbt_rsdun.stg_mixpanel__agg_viewed_article .............. [[33mSKIP[0m]
[0m09:24:24.305445 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:24:24.305894 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:24:24.306086 [info ] [Thread-2 (]: 12 of 12 SKIP relation dbt_rsdun.articles_evidence ............................. [[33mSKIP[0m]
[0m09:24:24.306481 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:24:27.081440 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6782a940-b489-42f8-9c76-c886012c1eb1:europe-west1&page=queryresults
[0m09:24:27.083558 [debug] [Thread-1 (]: finished collecting timing info
[0m09:24:27.084263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4439573-f385-4c28-b544-c101e0c0c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834f820>]}
[0m09:24:27.084667 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.48s]
[0m09:24:27.085144 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m09:24:27.086609 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:24:27.087233 [info ] [MainThread]: 
[0m09:24:27.087489 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 14.40 seconds (14.40s).
[0m09:24:27.087703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:27.087814 [debug] [MainThread]: Connection 'model.my_new_project.downloads' was properly closed.
[0m09:24:27.087921 [debug] [MainThread]: Connection 'model.my_new_project.stg_segment_ios__viewed_article' was properly closed.
[0m09:24:27.107258 [info ] [MainThread]: 
[0m09:24:27.107501 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:24:27.107684 [info ] [MainThread]: 
[0m09:24:27.107840 [error] [MainThread]: [33mDatabase Error in model stg_mixpanel__viewed_article (models/staging/mixpanel/stg_mixpanel__viewed_article.sql)[0m
[0m09:24:27.107994 [error] [MainThread]:   Unrecognized name: event_id at [48:30]
[0m09:24:27.108138 [error] [MainThread]:   compiled Code at target/run/my_new_project/models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:24:27.108299 [info ] [MainThread]: 
[0m09:24:27.108453 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=2 TOTAL=12
[0m09:24:27.108662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859bc40>]}
[0m09:24:27.108819 [debug] [MainThread]: Flushing usage events


============================== 2023-01-20 09:40:24.211219 | d2505633-62bb-4c24-8c04-d63794263d85 ==============================
[0m09:40:24.211273 [info ] [MainThread]: Running with dbt=1.3.1
[0m09:40:24.212056 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:40:24.212159 [debug] [MainThread]: Tracking: tracking
[0m09:40:24.223425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad6470>]}
[0m09:40:24.266153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:40:24.266455 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:40:24.273947 [debug] [MainThread]: 1699: static parser successfully parsed staging/mixpanel/stg_mixpanel__viewed_article.sql
[0m09:40:24.322886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m09:40:24.326305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4c0d0>]}
[0m09:40:24.333095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6ca90>]}
[0m09:40:24.333276 [info ] [MainThread]: Found 12 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m09:40:24.333400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad6470>]}
[0m09:40:24.334353 [info ] [MainThread]: 
[0m09:40:24.334734 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:40:24.335429 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m09:40:24.335565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:24.895045 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m09:40:24.895474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:25.459715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112884460>]}
[0m09:40:25.460724 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:40:25.461073 [info ] [MainThread]: 
[0m09:40:25.475510 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m09:40:25.475769 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m09:40:25.476016 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m09:40:25.476159 [info ] [Thread-2 (]: 2 of 12 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m09:40:25.476574 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m09:40:25.476933 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m09:40:25.477028 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m09:40:25.477107 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m09:40:25.477201 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m09:40:25.477281 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m09:40:25.479473 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:40:25.481586 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:40:25.482264 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:25.482363 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:25.482518 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m09:40:25.482629 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m09:40:25.502204 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m09:40:25.505466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:25.506294 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m09:40:25.547056 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m09:40:25.547908 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:40:25.548665 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m09:40:26.332923 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:382795c3-a48a-4ee9-ab83-a7127b59e49b:europe-west1&page=queryresults
[0m09:40:26.357237 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:26.357703 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112be47f0>]}
[0m09:40:26.357911 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m09:40:26.358160 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m09:40:26.358272 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:40:26.358384 [info ] [Thread-2 (]: 3 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m09:40:26.358831 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:40:26.358947 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:40:26.359039 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:40:26.360776 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:40:26.362454 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:26.362573 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:40:26.392403 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m09:40:26.392906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:40:26.393813 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
    );
  
[0m09:40:26.436274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2c5a3510-656b-4be4-a633-49774cc2e745:europe-west1&page=queryresults
[0m09:40:26.437218 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:26.437574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b17c10>]}
[0m09:40:26.437905 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m09:40:26.438236 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m09:40:26.438332 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:40:26.438555 [info ] [Thread-1 (]: 4 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m09:40:26.438962 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:40:26.439417 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m09:40:26.439543 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m09:40:26.441174 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:40:26.441526 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:26.441622 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m09:40:26.443382 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m09:40:26.443696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:26.444395 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`
    
    
    OPTIONS()
    as (
      


WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
)

SELECT e.referrer, e.slug, e.user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
WHERE REGEXP_CONTAINS(e.user_id, r'-')

UNION ALL

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.wawa_user` as u ON e.user_id=u.firebase_id
WHERE NOT REGEXP_CONTAINS(e.user_id, r'-')
    );
  
[0m09:40:29.256593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b0af16a3-3b1c-4f6d-82b9-fdbbb39921c2:europe-west1&page=queryresults
[0m09:40:29.260672 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:29.262248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4dae0>]}
[0m09:40:29.262774 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:48be4d2f-4508-49f5-bd75-4bed556d7131:europe-west1&page=queryresults
[0m09:40:29.263698 [info ] [Thread-1 (]: 4 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mCREATE TABLE (36.9k rows, 77.3 MB processed)[0m in 2.82s]
[0m09:40:29.266720 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:29.268457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c039a0>]}
[0m09:40:29.269065 [info ] [Thread-2 (]: 3 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mCREATE TABLE (28.0 rows, 26.5 MB processed)[0m in 2.91s]
[0m09:40:29.269860 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m09:40:29.270229 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:40:29.270572 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m09:40:29.271244 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m09:40:29.271549 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m09:40:29.272004 [info ] [Thread-2 (]: 6 of 12 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m09:40:29.273357 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:40:29.273890 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:40:29.274155 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m09:40:29.278912 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m09:40:29.284976 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m09:40:29.285349 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m09:40:29.295655 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:40:29.300206 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:40:29.300778 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:29.300927 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m09:40:29.306671 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:29.307037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:40:29.307203 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:40:29.309502 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m09:40:29.355358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:29.356199 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m09:40:29.779541 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m09:40:29.781976 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:40:30.410432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fb92feb6-84a8-4a29-8e06-56edbd8c77d3:europe-west1&page=queryresults
[0m09:40:30.416743 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:30.418767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c452a0>]}
[0m09:40:30.420134 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m09:40:30.421380 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m09:40:30.421875 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:40:30.422309 [info ] [Thread-1 (]: 7 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m09:40:30.425188 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:40:30.425930 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:40:30.426321 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:40:30.436610 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:40:30.437477 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:30.437614 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:40:30.439654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:30.956587 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m09:40:30.958862 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m09:40:32.134384 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:965ec747-6732-4d49-8395-aeee8f0f3062:europe-west1&page=queryresults
[0m09:40:32.139519 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:32.141318 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c99ea0>]}
[0m09:40:32.142426 [info ] [Thread-2 (]: 6 of 12 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.4 MB processed)[0m in 2.86s]
[0m09:40:32.143521 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m09:40:32.143966 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m09:40:32.144376 [info ] [Thread-2 (]: 8 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m09:40:32.146352 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m09:40:32.146991 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m09:40:32.147270 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m09:40:32.157225 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:40:32.158298 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:32.158560 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m09:40:32.171421 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:40:32.988101 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m09:40:32.988643 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m09:40:33.624201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2e5160e9-5d84-4184-a7ea-4e16e056544f:europe-west1&page=queryresults
[0m09:40:33.628176 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:33.629603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b00580>]}
[0m09:40:33.630446 [info ] [Thread-1 (]: 7 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.0 KB processed)[0m in 3.21s]
[0m09:40:33.631264 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m09:40:33.631707 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:40:33.632105 [info ] [Thread-1 (]: 9 of 12 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m09:40:33.633649 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:40:33.634085 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m09:40:33.634381 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m09:40:33.648638 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:40:33.650931 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:33.651255 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m09:40:33.654715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:34.570107 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m09:40:34.572402 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m09:40:35.666752 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8f09ea0d-d11b-4458-b25f-796211a599e8:europe-west1&page=queryresults
[0m09:40:35.670827 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:35.672231 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11284c5e0>]}
[0m09:40:35.672829 [info ] [Thread-2 (]: 8 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.0 MB processed)[0m in 3.53s]
[0m09:40:35.673457 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m09:40:35.673778 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m09:40:35.674097 [info ] [Thread-2 (]: 10 of 12 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m09:40:35.675028 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m09:40:35.675334 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m09:40:35.675586 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m09:40:35.680115 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m09:40:35.680603 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:35.680726 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m09:40:35.689765 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:40:36.264595 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m09:40:36.267944 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m09:40:37.472953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:34816915-d5c3-4749-b100-59adf63e4a5c:europe-west1&page=queryresults
[0m09:40:37.475208 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:37.475891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c463e0>]}
[0m09:40:37.476228 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.3 KB processed)[0m in 3.84s]
[0m09:40:37.476579 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m09:40:37.476733 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:40:37.476978 [info ] [Thread-1 (]: 11 of 12 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m09:40:37.477386 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:40:37.477494 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:40:37.477600 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:40:37.480574 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:40:37.481771 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:37.481914 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:40:37.484655 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m09:40:37.485350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:37.486259 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`
    
    
    OPTIONS()
    as (
      

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

GROUP BY reading_session, referrer, slug, user_id, category, os
    );
  
[0m09:40:38.905858 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:30d0bba0-cabb-4dd2-82bf-09c22525284e:europe-west1&page=queryresults
[0m09:40:38.909296 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:38.910340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b02a40>]}
[0m09:40:38.910880 [info ] [Thread-2 (]: 10 of 12 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (381.0 rows, 49.6 KB processed)[0m in 3.24s]
[0m09:40:38.911508 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m09:40:40.393779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a1647650-bfb1-43cc-9ec8-7c4b602332f3:europe-west1&page=queryresults
[0m09:40:40.396511 [debug] [Thread-1 (]: finished collecting timing info
[0m09:40:40.397416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11284fa90>]}
[0m09:40:40.397923 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mCREATE TABLE (15.0k rows, 5.8 MB processed)[0m in 2.92s]
[0m09:40:40.398495 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m09:40:40.399295 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m09:40:40.399686 [info ] [Thread-2 (]: 12 of 12 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m09:40:40.400366 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m09:40:40.400534 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m09:40:40.400701 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m09:40:40.421332 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m09:40:40.422360 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:40.422487 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m09:40:40.424040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:40:40.945917 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m09:40:40.947134 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m09:40:43.538365 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ab216f04-a8d6-465b-9058-cecd81cc9afb:europe-west1&page=queryresults
[0m09:40:43.542672 [debug] [Thread-2 (]: finished collecting timing info
[0m09:40:43.543765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2505633-62bb-4c24-8c04-d63794263d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d4b1c0>]}
[0m09:40:43.544249 [info ] [Thread-2 (]: 12 of 12 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.4k rows, 3.0 MB processed)[0m in 3.14s]
[0m09:40:43.544807 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m09:40:43.546502 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:40:43.547246 [info ] [MainThread]: 
[0m09:40:43.547565 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 2 table models in 0 hours 0 minutes and 19.21 seconds (19.21s).
[0m09:40:43.547828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:43.547963 [debug] [MainThread]: Connection 'model.my_new_project.stg_mixpanel__agg_viewed_article' was properly closed.
[0m09:40:43.548093 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m09:40:43.559325 [info ] [MainThread]: 
[0m09:40:43.559624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:40:43.559854 [info ] [MainThread]: 
[0m09:40:43.560033 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:40:43.560285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111458c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d43fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfea70>]}
[0m09:40:43.560491 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 10:10:52.927499 | c59a144c-a6ae-458f-99e9-54727b9c6212 ==============================
[0m10:10:52.927541 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:10:52.928196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:10:52.928294 [debug] [MainThread]: Tracking: tracking
[0m10:10:52.938927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb12a0>]}
[0m10:10:52.986198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:10:52.986464 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/reduced_articles_evidence.sql
[0m10:10:52.994261 [debug] [MainThread]: 1699: static parser successfully parsed marts/reduced_articles_evidence.sql
[0m10:10:53.049335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m10:10:53.054215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e800d0>]}
[0m10:10:53.062500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108791b70>]}
[0m10:10:53.062744 [info ] [MainThread]: Found 13 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m10:10:53.062886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da1960>]}
[0m10:10:53.063883 [info ] [MainThread]: 
[0m10:10:53.064264 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:10:53.065242 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:10:53.065505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:53.766882 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:10:53.767245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:54.321458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dacd90>]}
[0m10:10:54.322599 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:10:54.322905 [info ] [MainThread]: 
[0m10:10:54.333783 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:10:54.333903 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:10:54.334119 [info ] [Thread-1 (]: 1 of 13 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:10:54.334247 [info ] [Thread-2 (]: 2 of 13 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:10:54.334706 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:10:54.335013 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:10:54.335109 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:10:54.335206 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:10:54.335491 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:10:54.335700 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:10:54.337639 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:10:54.339061 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:10:54.342244 [debug] [Thread-1 (]: finished collecting timing info
[0m10:10:54.342338 [debug] [Thread-2 (]: finished collecting timing info
[0m10:10:54.342466 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:10:54.342582 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:10:54.365464 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:10:54.369398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:54.370458 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:10:54.372757 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:10:54.414841 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:10:54.415580 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:10:55.366923 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c4b8c6db-c08c-48a6-a28b-49ae01fcfb2f:europe-west1&page=queryresults
[0m10:10:55.386246 [debug] [Thread-2 (]: finished collecting timing info
[0m10:10:55.387222 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f1fb20>]}
[0m10:10:55.387742 [info ] [Thread-2 (]: 2 of 13 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m10:10:55.388304 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:10:55.388504 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:10:55.388774 [info ] [Thread-2 (]: 3 of 13 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m10:10:55.389319 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:10:55.389457 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:10:55.389584 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:10:55.392404 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:10:55.401385 [debug] [Thread-2 (]: finished collecting timing info
[0m10:10:55.401574 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:10:55.422581 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:55.496732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:510763c4-1380-493c-a452-24aa73b267b4:europe-west1&page=queryresults
[0m10:10:55.497686 [debug] [Thread-1 (]: finished collecting timing info
[0m10:10:55.498010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f24250>]}
[0m10:10:55.498188 [info ] [Thread-1 (]: 1 of 13 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m10:10:55.498396 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:10:55.498489 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:10:55.498587 [info ] [Thread-1 (]: 4 of 13 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m10:10:55.498871 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:10:55.499024 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:10:55.499129 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:10:55.500771 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:10:55.501196 [debug] [Thread-1 (]: finished collecting timing info
[0m10:10:55.501283 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:10:55.502683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:55.891913 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:10:55.892838 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m10:10:56.004924 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:10:56.005912 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          


WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
)

SELECT e.referrer, e.slug, e.user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
WHERE REGEXP_CONTAINS(e.user_id, r'-')

UNION ALL

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.wawa_user` as u ON e.user_id=u.firebase_id
WHERE NOT REGEXP_CONTAINS(e.user_id, r'-')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`, `reading_session`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`, `reading_session`)


    
[0m10:10:58.908379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6b7423cf-9d9c-432f-83ee-10047b449888:europe-west1&page=queryresults
[0m10:10:58.912589 [debug] [Thread-1 (]: finished collecting timing info
[0m10:10:58.914009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb0610>]}
[0m10:10:58.914735 [info ] [Thread-1 (]: 4 of 13 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 77.3 MB processed)[0m in 3.42s]
[0m10:10:58.915701 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:10:58.916370 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:10:58.916832 [info ] [Thread-1 (]: 5 of 13 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:10:58.918153 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:10:58.918578 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:10:58.918905 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:10:58.930371 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:10:58.932061 [debug] [Thread-1 (]: finished collecting timing info
[0m10:10:58.932324 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:10:58.936854 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:10:58.937550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:58.939106 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m10:11:00.154985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:413323c3-0110-474e-a584-02bd4b14bace:europe-west1&page=queryresults
[0m10:11:00.161134 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:00.162911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb0070>]}
[0m10:11:00.164166 [info ] [Thread-1 (]: 5 of 13 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m10:11:00.165580 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:11:00.166150 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m10:11:00.166557 [info ] [Thread-1 (]: 6 of 13 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m10:11:00.167684 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m10:11:00.168090 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m10:11:00.168354 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m10:11:00.187901 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:11:00.189426 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:00.189631 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m10:11:00.192657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:00.675770 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:11:00.678192 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m10:11:02.303582 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2aeca30a-1494-4408-86b8-d877fd313f4a:europe-west1&page=queryresults
[0m10:11:02.306059 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:02.307169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e81d80>]}
[0m10:11:02.307793 [info ] [Thread-2 (]: 3 of 13 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 6.92s]
[0m10:11:02.308573 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:11:02.308886 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:11:02.309206 [info ] [Thread-2 (]: 7 of 13 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:11:02.310305 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:11:02.312842 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:11:02.313218 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:11:02.327047 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:11:02.329689 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:02.329986 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:11:02.332619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:02.919243 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:11:02.921909 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:11:03.233053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:5303c391-32e8-43ac-9f06-1d4fe608c150:europe-west1&page=queryresults
[0m10:11:03.238547 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:03.240503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fec220>]}
[0m10:11:03.241435 [info ] [Thread-1 (]: 6 of 13 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.6 MB processed)[0m in 3.07s]
[0m10:11:03.242482 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m10:11:03.242945 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m10:11:03.243371 [info ] [Thread-1 (]: 8 of 13 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m10:11:03.244780 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m10:11:03.245166 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m10:11:03.245446 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m10:11:03.261009 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:11:03.262657 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:03.262963 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m10:11:03.268711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:03.760851 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:11:03.763933 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m10:11:06.515133 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e48f4ff6-8289-483c-abb4-9c0ad86a6cb0:europe-west1&page=queryresults
[0m10:11:06.521358 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:06.523070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a027a00>]}
[0m10:11:06.523955 [info ] [Thread-2 (]: 7 of 13 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.4 KB processed)[0m in 4.21s]
[0m10:11:06.527043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:1b2c382d-4b4c-4f32-8d85-8ee9daff9d7f:europe-west1&page=queryresults
[0m10:11:06.529689 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:06.530975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a007820>]}
[0m10:11:06.531913 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:11:06.532680 [info ] [Thread-1 (]: 8 of 13 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.8 MB processed)[0m in 3.29s]
[0m10:11:06.533068 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:11:06.533599 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m10:11:06.534129 [info ] [Thread-2 (]: 9 of 13 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m10:11:06.534470 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m10:11:06.535394 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:11:06.535850 [info ] [Thread-1 (]: 10 of 13 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m10:11:06.536174 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m10:11:06.537030 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:11:06.537288 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m10:11:06.537520 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m10:11:06.543639 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:11:06.543922 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m10:11:06.547840 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:11:06.548202 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:06.548416 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m10:11:06.552820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:06.553075 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:06.553241 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m10:11:06.561884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:07.134856 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:11:07.137221 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m10:11:07.208921 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:11:07.211516 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:11:09.533226 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:12f4142f-1bc5-45e9-ab55-f02e59fc50a7:europe-west1&page=queryresults
[0m10:11:09.537888 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:09.539523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe8b20>]}
[0m10:11:09.540658 [info ] [Thread-2 (]: 9 of 13 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.7 KB processed)[0m in 3.00s]
[0m10:11:09.542020 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:11:09.542435 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:11:09.542791 [info ] [Thread-2 (]: 11 of 13 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m10:11:09.543837 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:11:09.544112 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:11:09.544330 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:11:09.552076 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:11:09.555550 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:09.555842 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:11:09.566404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:09.883254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a58037ed-4946-47ed-8efc-31cdbc02bd44:europe-west1&page=queryresults
[0m10:11:09.884653 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:09.885128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff83a0>]}
[0m10:11:09.885424 [info ] [Thread-1 (]: 10 of 13 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (392.0 rows, 51.0 KB processed)[0m in 3.35s]
[0m10:11:09.885760 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m10:11:10.054144 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:11:10.057097 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m10:11:12.692679 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:cfd33778-bd5c-4e96-bb3b-654b1a633f6b:europe-west1&page=queryresults
[0m10:11:12.697092 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:12.698606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f83a00>]}
[0m10:11:12.699622 [info ] [Thread-2 (]: 11 of 13 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 11.6 MB processed)[0m in 3.16s]
[0m10:11:12.700707 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:11:12.703099 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:11:12.703796 [info ] [Thread-1 (]: 12 of 13 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m10:11:12.704931 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:11:12.705258 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:11:12.705528 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:11:12.715170 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:11:12.718187 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:12.718507 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:11:12.721237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:13.201533 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:11:13.204412 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m10:11:15.902274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d444edc1-d57a-4eeb-a503-54709005e953:europe-west1&page=queryresults
[0m10:11:15.910340 [debug] [Thread-1 (]: finished collecting timing info
[0m10:11:15.912290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0bca0>]}
[0m10:11:15.913391 [info ] [Thread-1 (]: 12 of 13 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.4k rows, 3.0 MB processed)[0m in 3.21s]
[0m10:11:15.914746 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:11:15.916452 [debug] [Thread-2 (]: Began running node model.my_new_project.reduced_articles_evidence
[0m10:11:15.917052 [info ] [Thread-2 (]: 13 of 13 START sql table model dbt_rsdun.reduced_articles_evidence ............. [RUN]
[0m10:11:15.918346 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.reduced_articles_evidence"
[0m10:11:15.918795 [debug] [Thread-2 (]: Began compiling node model.my_new_project.reduced_articles_evidence
[0m10:11:15.919119 [debug] [Thread-2 (]: Compiling model.my_new_project.reduced_articles_evidence
[0m10:11:15.926458 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.reduced_articles_evidence"
[0m10:11:15.927858 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:15.928252 [debug] [Thread-2 (]: Began executing node model.my_new_project.reduced_articles_evidence
[0m10:11:15.932646 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.reduced_articles_evidence"
[0m10:11:15.933494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:15.935598 [debug] [Thread-2 (]: On model.my_new_project.reduced_articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.reduced_articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`reduced_articles_evidence`
    
    
    OPTIONS()
    as (
      

SELECT base_article_id, user_id, original_timestamp
FROM (
    SELECT ROW_NUMBER() OVER (PARTITION BY base_article_id ORDER BY original_timestamp, user_id DESC) row_num, base_article_id, original_timestamp, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`articles_evidence`
)
WHERE row_num=1
    );
  
[0m10:11:18.824565 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:aeb28df9-8ad0-4684-958a-dd8cb5437a30:europe-west1&page=queryresults
[0m10:11:18.829825 [debug] [Thread-2 (]: finished collecting timing info
[0m10:11:18.831379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c59a144c-a6ae-458f-99e9-54727b9c6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e630d0>]}
[0m10:11:18.832311 [info ] [Thread-2 (]: 13 of 13 OK created sql table model dbt_rsdun.reduced_articles_evidence ........ [[32mCREATE TABLE (642.0 rows, 1.6 MB processed)[0m in 2.91s]
[0m10:11:18.833283 [debug] [Thread-2 (]: Finished running node model.my_new_project.reduced_articles_evidence
[0m10:11:18.837664 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:11:18.838751 [info ] [MainThread]: 
[0m10:11:18.839931 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 3 table models in 0 hours 0 minutes and 25.77 seconds (25.77s).
[0m10:11:18.840421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:18.841386 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:11:18.841634 [debug] [MainThread]: Connection 'model.my_new_project.reduced_articles_evidence' was properly closed.
[0m10:11:18.868315 [info ] [MainThread]: 
[0m10:11:18.868658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:18.868902 [info ] [MainThread]: 
[0m10:11:18.869092 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m10:11:18.869392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a005750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a004b80>]}
[0m10:11:18.869639 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 10:31:20.389522 | 5a65d6b1-1902-4a7d-9c10-8836492d95da ==============================
[0m10:31:20.389724 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:31:20.392502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:31:20.392653 [debug] [MainThread]: Tracking: tracking
[0m10:31:20.403691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff5390>]}
[0m10:31:20.455257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:31:20.455609 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/reduced_articles_evidence.sql
[0m10:31:20.463509 [debug] [MainThread]: 1699: static parser successfully parsed marts/reduced_articles_evidence.sql
[0m10:31:20.520102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.downloads
- models.my_new_project.apple_app_store
- models.my_new_project.google_play_store

[0m10:31:20.523651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acab580>]}
[0m10:31:20.531202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aae4a30>]}
[0m10:31:20.531426 [info ] [MainThread]: Found 13 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m10:31:20.531566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c8bbe0>]}
[0m10:31:20.532521 [info ] [MainThread]: 
[0m10:31:20.532866 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:31:20.533679 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:31:20.533865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:21.174917 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:31:21.175454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:21.761328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74df0>]}
[0m10:31:21.762188 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:31:21.762503 [info ] [MainThread]: 
[0m10:31:21.766399 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:31:21.766587 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:31:21.766923 [info ] [Thread-1 (]: 1 of 13 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:31:21.767149 [info ] [Thread-2 (]: 2 of 13 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:31:21.767777 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:31:21.768449 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:31:21.768623 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:31:21.768778 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:31:21.768942 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:31:21.769078 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:31:21.771956 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:31:21.774158 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:31:21.775027 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:21.775117 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:31:21.781474 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:21.795824 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:31:21.796004 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:31:21.798315 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:31:21.800242 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:31:21.802531 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:31:21.841275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:21.841945 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:31:22.876290 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7d0ae9e3-ecdc-4d2a-a868-a630506b7464:europe-west1&page=queryresults
[0m10:31:22.877013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:295ee3d5-4552-4c21-ba2b-e4cea4560383:europe-west1&page=queryresults
[0m10:31:22.890902 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:22.892025 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:22.892438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a804be0>]}
[0m10:31:22.892722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad62c50>]}
[0m10:31:22.892952 [info ] [Thread-2 (]: 2 of 13 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m10:31:22.893125 [info ] [Thread-1 (]: 1 of 13 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m10:31:22.893547 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:31:22.893769 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:31:22.893960 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:22.894196 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:22.894415 [info ] [Thread-2 (]: 3 of 13 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m10:31:22.894714 [info ] [Thread-1 (]: 4 of 13 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m10:31:22.895172 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:31:22.895630 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:31:22.895759 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:22.895862 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:22.896017 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:22.896138 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:22.898147 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:31:22.899776 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:31:22.901534 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:22.901675 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:22.901790 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:22.901908 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:22.921397 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:22.923202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:23.435644 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:31:23.437930 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          


WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
)

SELECT e.referrer, e.slug, e.user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
WHERE REGEXP_CONTAINS(e.user_id, r'-')

UNION ALL

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.wawa_user` as u ON e.user_id=u.firebase_id
WHERE NOT REGEXP_CONTAINS(e.user_id, r'-')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`, `reading_session`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`, `reading_session`)


    
[0m10:31:23.506896 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:31:23.509385 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m10:31:25.698843 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:8f3592eb-39fa-41c4-8e45-31794ddfdcfe:europe-west1&page=queryresults
[0m10:31:25.700478 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:25.701054 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc5570>]}
[0m10:31:25.701385 [info ] [Thread-2 (]: 3 of 13 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 2.81s]
[0m10:31:25.701763 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:31:25.701936 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:25.702217 [info ] [Thread-2 (]: 5 of 13 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:31:25.702800 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:31:25.702940 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:25.703059 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:25.708735 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:31:25.711388 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:25.711521 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:25.713577 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:31:25.713884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:25.714770 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m10:31:26.496980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3acd20a2-b4cf-42f2-84de-8fe10f05fde0:europe-west1&page=queryresults
[0m10:31:26.498196 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:26.498680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb9720>]}
[0m10:31:26.498954 [info ] [Thread-1 (]: 4 of 13 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 77.3 MB processed)[0m in 3.60s]
[0m10:31:26.499270 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:31:26.499415 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m10:31:26.499673 [info ] [Thread-1 (]: 6 of 13 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m10:31:26.500337 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m10:31:26.500448 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m10:31:26.500550 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m10:31:26.506839 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:31:26.508377 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:26.508513 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m10:31:26.510395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:26.554438 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fe86c46e-668d-44c6-ae1c-ef153b6b04c3:europe-west1&page=queryresults
[0m10:31:26.555563 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:26.555919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac931c0>]}
[0m10:31:26.556089 [info ] [Thread-2 (]: 5 of 13 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m10:31:26.556283 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:31:26.556377 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:26.556475 [info ] [Thread-2 (]: 7 of 13 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:31:26.556849 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:31:26.557136 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:26.557206 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:26.559439 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:31:26.560399 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:26.560489 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:26.561906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:27.256661 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:31:27.259235 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m10:31:27.276403 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:31:27.289669 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:31:29.647161 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:916b962f-4dea-451a-9e4f-d2e449bb1dfd:europe-west1&page=queryresults
[0m10:31:29.651116 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:29.654041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb84f0>]}
[0m10:31:29.659547 [info ] [Thread-1 (]: 6 of 13 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.6 MB processed)[0m in 3.15s]
[0m10:31:29.663306 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m10:31:29.663719 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m10:31:29.664143 [info ] [Thread-1 (]: 8 of 13 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m10:31:29.664991 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m10:31:29.665191 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m10:31:29.665370 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m10:31:29.679648 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:31:29.680391 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:29.680597 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m10:31:29.688188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:30.380356 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:31:30.382154 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m10:31:30.808775 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:2d24cbe3-f7e3-42a5-b98d-b733a915e846:europe-west1&page=queryresults
[0m10:31:30.812795 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:30.814012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6f8e0>]}
[0m10:31:30.814641 [info ] [Thread-2 (]: 7 of 13 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.4 KB processed)[0m in 4.26s]
[0m10:31:30.815554 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:31:30.815945 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:31:30.816346 [info ] [Thread-2 (]: 9 of 13 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m10:31:30.817866 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:31:30.818456 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m10:31:30.818713 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m10:31:30.823040 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:31:30.824971 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:30.825102 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m10:31:30.827056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:31.489312 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:31:31.491016 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m10:31:33.264409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:c0dfd92b-d985-4abb-ba21-91dc6c2b59b5:europe-west1&page=queryresults
[0m10:31:33.272234 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:33.274232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6ff70>]}
[0m10:31:33.275309 [info ] [Thread-1 (]: 8 of 13 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.8 MB processed)[0m in 3.61s]
[0m10:31:33.276276 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m10:31:33.276698 [debug] [Thread-1 (]: Began running node model.my_new_project.downloads
[0m10:31:33.277186 [info ] [Thread-1 (]: 10 of 13 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m10:31:33.278469 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:31:33.279741 [debug] [Thread-1 (]: Began compiling node model.my_new_project.downloads
[0m10:31:33.280651 [debug] [Thread-1 (]: Compiling model.my_new_project.downloads
[0m10:31:33.288700 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:31:33.290008 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:33.290220 [debug] [Thread-1 (]: Began executing node model.my_new_project.downloads
[0m10:31:33.301605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:33.730938 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:47122cdd-75bc-4189-ad29-835507c12278:europe-west1&page=queryresults
[0m10:31:33.734764 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:33.735924 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac51120>]}
[0m10:31:33.736630 [info ] [Thread-2 (]: 9 of 13 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.7 KB processed)[0m in 2.92s]
[0m10:31:33.737417 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:31:33.737809 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:33.738214 [info ] [Thread-2 (]: 11 of 13 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m10:31:33.739355 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:31:33.740106 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:33.740433 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:33.749333 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:31:33.751660 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:33.751894 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:33.759676 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:33.882067 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:31:33.882977 [debug] [Thread-1 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:31:34.401634 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:31:34.403835 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m10:31:36.692381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:4940dbbe-1eab-453d-b948-18e5c560743a:europe-west1&page=queryresults
[0m10:31:36.700360 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:36.701545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac516c0>]}
[0m10:31:36.702164 [info ] [Thread-1 (]: 10 of 13 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (392.0 rows, 51.0 KB processed)[0m in 3.42s]
[0m10:31:36.703110 [debug] [Thread-1 (]: Finished running node model.my_new_project.downloads
[0m10:31:36.854281 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:080a5b38-0eff-403e-999d-8387a3c7e11d:europe-west1&page=queryresults
[0m10:31:36.860038 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:36.861347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeebbb0>]}
[0m10:31:36.862615 [info ] [Thread-2 (]: 11 of 13 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 17.4 MB processed)[0m in 3.12s]
[0m10:31:36.863466 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:31:36.865432 [debug] [Thread-1 (]: Began running node model.my_new_project.articles_evidence
[0m10:31:36.866428 [info ] [Thread-1 (]: 12 of 13 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m10:31:36.868302 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:31:36.868653 [debug] [Thread-1 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:31:36.868912 [debug] [Thread-1 (]: Compiling model.my_new_project.articles_evidence
[0m10:31:36.878997 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:31:36.881416 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:36.881581 [debug] [Thread-1 (]: Began executing node model.my_new_project.articles_evidence
[0m10:31:36.883371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:37.509547 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:31:37.510482 [debug] [Thread-1 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m10:31:39.935452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:fc7002bc-462b-4e99-90af-5b4cb7d841f4:europe-west1&page=queryresults
[0m10:31:39.939379 [debug] [Thread-1 (]: finished collecting timing info
[0m10:31:39.940515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff7a30>]}
[0m10:31:39.941146 [info ] [Thread-1 (]: 12 of 13 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.4k rows, 3.0 MB processed)[0m in 3.07s]
[0m10:31:39.942129 [debug] [Thread-1 (]: Finished running node model.my_new_project.articles_evidence
[0m10:31:39.943483 [debug] [Thread-2 (]: Began running node model.my_new_project.reduced_articles_evidence
[0m10:31:39.943904 [info ] [Thread-2 (]: 13 of 13 START sql table model dbt_rsdun.reduced_articles_evidence ............. [RUN]
[0m10:31:39.944874 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.reduced_articles_evidence"
[0m10:31:39.945150 [debug] [Thread-2 (]: Began compiling node model.my_new_project.reduced_articles_evidence
[0m10:31:39.945437 [debug] [Thread-2 (]: Compiling model.my_new_project.reduced_articles_evidence
[0m10:31:39.955165 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.reduced_articles_evidence"
[0m10:31:39.956669 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:39.956915 [debug] [Thread-2 (]: Began executing node model.my_new_project.reduced_articles_evidence
[0m10:31:39.960372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:40.685503 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.reduced_articles_evidence"
[0m10:31:40.687038 [debug] [Thread-2 (]: On model.my_new_project.reduced_articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.reduced_articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`reduced_articles_evidence`
    
    
    OPTIONS()
    as (
      

-- Reduce articles_evidence such that an article can only appear for a user once

SELECT base_article_id, user_id, original_timestamp
FROM (
    SELECT ROW_NUMBER() OVER (PARTITION BY article_id ORDER BY original_timestamp, user_id DESC) row_num, base_article_id, original_timestamp, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`articles_evidence`
)
WHERE row_num=1
    );
  
[0m10:31:42.956463 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:73bd6c42-d5da-4448-bf23-a16adbb53971:europe-west1&page=queryresults
[0m10:31:42.961283 [debug] [Thread-2 (]: finished collecting timing info
[0m10:31:42.962547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a65d6b1-1902-4a7d-9c10-8836492d95da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae17880>]}
[0m10:31:42.963259 [info ] [Thread-2 (]: 13 of 13 OK created sql table model dbt_rsdun.reduced_articles_evidence ........ [[32mCREATE TABLE (823.0 rows, 2.5 MB processed)[0m in 3.02s]
[0m10:31:42.964070 [debug] [Thread-2 (]: Finished running node model.my_new_project.reduced_articles_evidence
[0m10:31:42.967383 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:31:42.972749 [info ] [MainThread]: 
[0m10:31:42.973652 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 3 table models in 0 hours 0 minutes and 22.44 seconds (22.44s).
[0m10:31:42.974043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:42.974248 [debug] [MainThread]: Connection 'model.my_new_project.articles_evidence' was properly closed.
[0m10:31:42.974450 [debug] [MainThread]: Connection 'model.my_new_project.reduced_articles_evidence' was properly closed.
[0m10:31:42.996451 [info ] [MainThread]: 
[0m10:31:42.996799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:42.997108 [info ] [MainThread]: 
[0m10:31:42.997360 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m10:31:42.997671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104576aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6fb80>]}
[0m10:31:42.997824 [debug] [MainThread]: Flushing usage events


============================== 2023-01-31 10:34:43.264402 | d1c10d70-518b-4b10-b64a-13327753eb78 ==============================
[0m10:34:43.264437 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:34:43.265297 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/regitzesdun/Repos_wawa/wawa-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:34:43.265413 [debug] [MainThread]: Tracking: tracking
[0m10:34:43.279590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a395660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a395540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a395480>]}
[0m10:34:43.324652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:34:43.324919 [debug] [MainThread]: Partial parsing: added file: my_new_project://models/marts/reduced_base_articles_evidence.sql
[0m10:34:43.325049 [debug] [MainThread]: Partial parsing: updated file: my_new_project://models/marts/reduced_articles_evidence.sql
[0m10:34:43.332652 [debug] [MainThread]: 1699: static parser successfully parsed marts/reduced_base_articles_evidence.sql
[0m10:34:43.338284 [debug] [MainThread]: 1699: static parser successfully parsed marts/reduced_articles_evidence.sql
[0m10:34:43.381789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.my_new_project.google_play_store
- models.my_new_project.downloads
- models.my_new_project.apple_app_store

[0m10:34:43.385168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a603ca0>]}
[0m10:34:43.392569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5848e0>]}
[0m10:34:43.392782 [info ] [MainThread]: Found 14 models, 8 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
[0m10:34:43.392914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106938970>]}
[0m10:34:43.393903 [info ] [MainThread]: 
[0m10:34:43.394273 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:34:43.396098 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630"
[0m10:34:43.396299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:44.253795 [debug] [ThreadPool]: Acquiring new bigquery connection "list_wawa-83630_dbt_rsdun"
[0m10:34:44.254075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:44.682274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858cd30>]}
[0m10:34:44.683095 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:34:44.683313 [info ] [MainThread]: 
[0m10:34:44.687980 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_apple_app_store__downloads
[0m10:34:44.688126 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_google_play_store__downloads
[0m10:34:44.688379 [info ] [Thread-1 (]: 1 of 14 START sql view model dbt_rsdun.stg_apple_app_store__downloads .......... [RUN]
[0m10:34:44.688537 [info ] [Thread-2 (]: 2 of 14 START sql view model dbt_rsdun.stg_google_play_store__downloads ........ [RUN]
[0m10:34:44.690636 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_apple_app_store__downloads"
[0m10:34:44.691400 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_google_play_store__downloads"
[0m10:34:44.691832 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_google_play_store__downloads
[0m10:34:44.691961 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_google_play_store__downloads
[0m10:34:44.691652 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_apple_app_store__downloads
[0m10:34:44.694880 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:34:44.695150 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_apple_app_store__downloads
[0m10:34:44.698121 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:34:44.698589 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:44.698842 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_google_play_store__downloads
[0m10:34:44.705336 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:44.717339 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_google_play_store__downloads"
[0m10:34:44.727572 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_apple_app_store__downloads
[0m10:34:44.731942 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:34:44.732873 [debug] [Thread-2 (]: On model.my_new_project.stg_google_play_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_google_play_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads`
  OPTIONS()
  as SELECT Date as date, SUM(Store_listing_acquisitions) as downloads
FROM `wawa-83630`.`raw_google_play__reports`.`p_Store_Performance_traffic_source_raw`
WHERE Date >= "2022-08-29"
GROUP BY Date
ORDER BY Date DESC;


[0m10:34:44.734613 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_apple_app_store__downloads"
[0m10:34:44.772523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:44.775271 [debug] [Thread-1 (]: On model.my_new_project.stg_apple_app_store__downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_apple_app_store__downloads"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads`
  OPTIONS()
  as SELECT Begin_Date as date, SUM(Units) as downloads
FROM `wawa-83630`.`raw_apple_app_store_connect__reports`.`sales_and_trends_reports`
WHERE Product_Type_Identifier="1"
GROUP BY Begin_Date
ORDER BY Begin_Date DESC;


[0m10:34:45.669729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:34de8d36-c677-444c-9fc8-7f0c560d7a9b:europe-west1&page=queryresults
[0m10:34:45.690509 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:45.691167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7031f0>]}
[0m10:34:45.691488 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dbt_rsdun.stg_apple_app_store__downloads ..... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m10:34:45.691894 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_apple_app_store__downloads
[0m10:34:45.692067 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:34:45.692270 [info ] [Thread-1 (]: 3 of 14 START sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [RUN]
[0m10:34:45.693012 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:34:45.693186 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:34:45.693327 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:34:45.696309 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:34:45.697615 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:45.697773 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:34:45.722284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:45.974963 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:3a9433d8-ae56-4deb-8582-da3d3075bed4:europe-west1&page=queryresults
[0m10:34:45.976158 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:45.976468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a701030>]}
[0m10:34:45.976660 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dbt_rsdun.stg_google_play_store__downloads ... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m10:34:45.976880 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_google_play_store__downloads
[0m10:34:45.976982 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:34:45.977149 [info ] [Thread-2 (]: 4 of 14 START sql incremental model dbt_rsdun.stg_mixpanel__viewed_article ..... [RUN]
[0m10:34:45.977670 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:34:45.977759 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_mixpanel__viewed_article
[0m10:34:45.977829 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_mixpanel__viewed_article
[0m10:34:45.979514 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:34:45.981754 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:45.982052 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_mixpanel__viewed_article
[0m10:34:45.985262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:34:46.396939 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__community_viewed_article"
[0m10:34:46.398017 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  CASE
    WHEN JSON_VALUE(properties,'$.referrer') = 'Community' THEN 'community'
    WHEN JSON_VALUE(properties,'$.referrer') = 'Personal assistant' THEN 'home'
    ELSE JSON_VALUE(properties,'$.referrer')
  END as referrer,
  JSON_VALUE(properties,'$.slug') as slug,
  JSON_VALUE(properties,'$.distinct_id') as user_id,
  JSON_VALUE(properties,'$.category') as category,
  JSON_VALUE(properties,'$.os') as os,
  max(TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64))) as original_timestamp,
FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
WHERE (event = 'Community | Viewed article')
GROUP BY JSON_VALUE(properties,'$.reading_session'), referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m10:34:46.538125 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__viewed_article"
[0m10:34:46.540840 [debug] [Thread-2 (]: On model.my_new_project.stg_mixpanel__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article` as DBT_INTERNAL_DEST
        using (
          


WITH extracted_events AS (
    SELECT
    DISTINCT
      CASE
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Community' THEN 'community'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Personal assistant' THEN 'home'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Content' THEN 'content'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Health' THEN 'health'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Treatment' THEN 'treatment'
      WHEN JSON_VALUE(properties,'$.Referrer') = 'Journal' THEN 'journal'    
      ELSE JSON_VALUE(properties,'$.Referrer')
    END as referrer,
    JSON_VALUE(properties,'$.Slug') as slug,
    JSON_VALUE(properties,'$."$insert_id"') as event_id,
    JSON_VALUE(properties,'$.distinct_id') as user_id,
    JSON_VALUE(properties,'$.Category') as category,
    JSON_VALUE(properties,'$.os') as os,
    JSON_VALUE(properties,'$.Reading session') as reading_session,
    TIMESTAMP_SECONDS(CAST(JSON_VALUE(properties,'$.time') AS INT64)) as original_timestamp,
  FROM `wawa-83630.raw_mixpanel__events.raw_mixpanel__events`
  where (event = 'Viewed article')
)

SELECT e.referrer, e.slug, e.user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
WHERE REGEXP_CONTAINS(e.user_id, r'-')

UNION ALL

SELECT e.referrer, e.slug, u.id as user_id, e.category, e.os, e.original_timestamp, e.reading_session
FROM extracted_events as e
LEFT JOIN `wawa-83630.raw_airbyte__wawa_production_database.wawa_user` as u ON e.user_id=u.firebase_id
WHERE NOT REGEXP_CONTAINS(e.user_id, r'-')
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`, `reading_session`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`, `reading_session`)


    
[0m10:34:48.571892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:6c5c6746-687d-4141-a52c-7f2d22b3b724:europe-west1&page=queryresults
[0m10:34:48.574242 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:48.575882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a601180>]}
[0m10:34:48.576780 [info ] [Thread-1 (]: 3 of 14 OK created sql incremental model dbt_rsdun.stg_mixpanel__community_viewed_article  [[32mMERGE (28.0 rows, 26.5 MB processed)[0m in 2.88s]
[0m10:34:48.577935 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__community_viewed_article
[0m10:34:48.578653 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:34:48.580146 [info ] [Thread-1 (]: 5 of 14 START sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [RUN]
[0m10:34:48.582179 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:34:48.582534 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:34:48.582743 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_android__community_viewed_article
[0m10:34:48.591054 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:34:48.592324 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:48.592488 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:34:48.594687 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__community_viewed_article"
[0m10:34:48.595076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:48.595803 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_android__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__community_viewed_article"} */


  create or replace view `wawa-83630`.`dbt_rsdun`.`stg_segment_android__community_viewed_article`
  OPTIONS()
  as SELECT a.slug, a.original_timestamp, a.category, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_android__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id;


[0m10:34:49.259444 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:a2027f1e-ab7c-4dc0-ada7-f350a73a8182:europe-west1&page=queryresults
[0m10:34:49.263195 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:49.264127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6010c0>]}
[0m10:34:49.264870 [info ] [Thread-2 (]: 4 of 14 OK created sql incremental model dbt_rsdun.stg_mixpanel__viewed_article  [[32mMERGE (36.9k rows, 77.3 MB processed)[0m in 3.29s]
[0m10:34:49.267357 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_mixpanel__viewed_article
[0m10:34:49.270143 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_android__screens_article
[0m10:34:49.271613 [info ] [Thread-2 (]: 6 of 14 START sql incremental model dbt_rsdun.stg_segment_android__screens_article  [RUN]
[0m10:34:49.273326 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_android__screens_article"
[0m10:34:49.273805 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_android__screens_article
[0m10:34:49.274083 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_android__screens_article
[0m10:34:49.283204 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:34:49.283702 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:49.283988 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_android__screens_article
[0m10:34:49.286064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:34:49.721905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d616df99-bd97-4fcd-8bde-b8940d125b3f:europe-west1&page=queryresults
[0m10:34:49.726546 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:49.728289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a78a0b0>]}
[0m10:34:49.729078 [info ] [Thread-1 (]: 5 of 14 OK created sql view model dbt_rsdun.stg_segment_android__community_viewed_article  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m10:34:49.730373 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_android__community_viewed_article
[0m10:34:49.730769 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:34:49.731091 [info ] [Thread-1 (]: 7 of 14 START sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [RUN]
[0m10:34:49.732710 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:34:49.734250 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:34:49.734502 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:34:49.746534 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:34:49.750263 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:49.750445 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:34:49.752306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:49.911561 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_android__screens_article"
[0m10:34:49.913262 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_android__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_android__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug
FROM `wawa-83630`.`raw_segment_android__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article' 

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m10:34:50.389552 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__community_viewed_article"
[0m10:34:50.393724 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__community_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__community_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.slug, max(a.original_timestamp) as original_timestamp, a.reading_session, a.category, a.clinic_id, u.id as user_id, a.referrer 
FROM `wawa-83630`.`raw_segment_ios__production_events`.`community_viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.slug is not null

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article`))

GROUP BY a.reading_session, a.slug, a.category, a.clinic_id, user_id, a.referrer
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `reading_session`, `category`, `clinic_id`, `user_id`, `referrer`)


    
[0m10:34:52.099559 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e98a0808-722f-4d3e-96a9-235280b04cdd:europe-west1&page=queryresults
[0m10:34:52.101943 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:52.102516 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e9fc0>]}
[0m10:34:52.102837 [info ] [Thread-2 (]: 6 of 14 OK created sql incremental model dbt_rsdun.stg_segment_android__screens_article  [[32mMERGE (0.0 rows, 1.6 MB processed)[0m in 2.83s]
[0m10:34:52.103495 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_android__screens_article
[0m10:34:52.103652 [debug] [Thread-2 (]: Began running node model.my_new_project.stg_segment_ios__screens_article
[0m10:34:52.103812 [info ] [Thread-2 (]: 8 of 14 START sql incremental model dbt_rsdun.stg_segment_ios__screens_article . [RUN]
[0m10:34:52.127679 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__screens_article"
[0m10:34:52.128935 [debug] [Thread-2 (]: Began compiling node model.my_new_project.stg_segment_ios__screens_article
[0m10:34:52.129295 [debug] [Thread-2 (]: Compiling model.my_new_project.stg_segment_ios__screens_article
[0m10:34:52.140967 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:34:52.141741 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:52.141871 [debug] [Thread-2 (]: Began executing node model.my_new_project.stg_segment_ios__screens_article
[0m10:34:52.145345 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:34:52.660195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:41ac41db-f2bd-4c28-aefb-ac05d2b0f281:europe-west1&page=queryresults
[0m10:34:52.665144 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:52.670995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8185e0>]}
[0m10:34:52.674280 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__screens_article"
[0m10:34:52.675116 [info ] [Thread-1 (]: 7 of 14 OK created sql incremental model dbt_rsdun.stg_segment_ios__community_viewed_article  [[32mMERGE (0.0 rows, 609.4 KB processed)[0m in 2.94s]
[0m10:34:52.676202 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__community_viewed_article
[0m10:34:52.676588 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:34:52.676965 [info ] [Thread-1 (]: 9 of 14 START sql incremental model dbt_rsdun.stg_segment_ios__viewed_article .. [RUN]
[0m10:34:52.678847 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:34:52.679237 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_segment_ios__viewed_article
[0m10:34:52.679529 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_segment_ios__viewed_article
[0m10:34:52.684496 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:34:52.684812 [debug] [Thread-2 (]: On model.my_new_project.stg_segment_ios__screens_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__screens_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` as DBT_INTERNAL_DEST
        using (
          

SELECT a.category, a.name, a.original_timestamp, u.id as user_id, a.referrer, a.article_id, a.slug  
FROM `wawa-83630`.`raw_segment_ios__production_events`.`screens` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id
WHERE a.name='Article'

-- this filter will only be applied on an incremental run
AND (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)
    values
        (`category`, `name`, `original_timestamp`, `user_id`, `referrer`, `article_id`, `slug`)


    
[0m10:34:52.687080 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:52.687451 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_segment_ios__viewed_article
[0m10:34:52.690812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:53.200221 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_segment_ios__viewed_article"
[0m10:34:53.202197 [debug] [Thread-1 (]: On model.my_new_project.stg_segment_ios__viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_segment_ios__viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` as DBT_INTERNAL_DEST
        using (
          

-- only 14 events
SELECT a.slug, a.timestamp as original_timestamp, a.category, u.id as user_id, a.referrer
FROM `wawa-83630`.`raw_segment_ios__production_events`.`viewed_article` as a
LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`wawa_user` as u ON a.user_id=u.firebase_id

-- this filter will only be applied on an incremental run
WHERE (a.original_timestamp > (select max(a.original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article`))

        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)
    values
        (`slug`, `original_timestamp`, `category`, `user_id`, `referrer`)


    
[0m10:34:55.190482 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:7c333f59-1c0e-4977-b32e-2282248b5461:europe-west1&page=queryresults
[0m10:34:55.196265 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:55.197901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e9480>]}
[0m10:34:55.198826 [info ] [Thread-2 (]: 8 of 14 OK created sql incremental model dbt_rsdun.stg_segment_ios__screens_article  [[32mMERGE (0.0 rows, 3.8 MB processed)[0m in 3.07s]
[0m10:34:55.199811 [debug] [Thread-2 (]: Finished running node model.my_new_project.stg_segment_ios__screens_article
[0m10:34:55.200441 [debug] [Thread-2 (]: Began running node model.my_new_project.downloads
[0m10:34:55.200779 [info ] [Thread-2 (]: 10 of 14 START sql table model dbt_rsdun.downloads ............................. [RUN]
[0m10:34:55.202285 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.downloads"
[0m10:34:55.203133 [debug] [Thread-2 (]: Began compiling node model.my_new_project.downloads
[0m10:34:55.203461 [debug] [Thread-2 (]: Compiling model.my_new_project.downloads
[0m10:34:55.222850 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.downloads"
[0m10:34:55.224164 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:55.224300 [debug] [Thread-2 (]: Began executing node model.my_new_project.downloads
[0m10:34:55.230793 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:34:55.743387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:52d95335-c38d-4f1f-820e-cf3c49ed848b:europe-west1&page=queryresults
[0m10:34:55.749271 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:55.751077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cf490>]}
[0m10:34:55.752052 [info ] [Thread-1 (]: 9 of 14 OK created sql incremental model dbt_rsdun.stg_segment_ios__viewed_article  [[32mMERGE (0.0 rows, 158.7 KB processed)[0m in 3.07s]
[0m10:34:55.753977 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_segment_ios__viewed_article
[0m10:34:55.754666 [debug] [Thread-1 (]: Began running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:34:55.755078 [info ] [Thread-1 (]: 11 of 14 START sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [RUN]
[0m10:34:55.756532 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:34:55.757451 [debug] [Thread-1 (]: Began compiling node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:34:55.757763 [debug] [Thread-1 (]: Compiling model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:34:55.764074 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:34:55.765855 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:55.766058 [debug] [Thread-1 (]: Began executing node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:34:55.771811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:55.825400 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.downloads"
[0m10:34:55.826261 [debug] [Thread-2 (]: On model.my_new_project.downloads: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.downloads"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`downloads`
    
    
    OPTIONS()
    as (
      

SELECT 
  CASE WHEN g.date IS NULL THEN a.date ELSE g.date END AS download_date, 
  a.downloads as apple_downloads, 
  g.downloads as google_downloads, 
  IFNULL(a.downloads,0)+IFNULL(g.downloads,0) as total_downloads
FROM `wawa-83630`.`dbt_rsdun`.`stg_google_play_store__downloads` as g
      FULL OUTER JOIN `wawa-83630`.`dbt_rsdun`.`stg_apple_app_store__downloads` AS a ON a.date=g.date
ORDER BY download_date DESC
    );
  
[0m10:34:56.275006 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.stg_mixpanel__agg_viewed_article"
[0m10:34:56.278891 [debug] [Thread-1 (]: On model.my_new_project.stg_mixpanel__agg_viewed_article: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.stg_mixpanel__agg_viewed_article"} */

        
    

    

    merge into `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` as DBT_INTERNAL_DEST
        using (
          

SELECT
  DISTINCT
  referrer, slug, user_id, category, os, max(original_timestamp) as original_timestamp
FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__viewed_article`

-- this filter will only be applied on an incremental run
WHERE original_timestamp > (select max(original_timestamp) from `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article`)

GROUP BY reading_session, referrer, slug, user_id, category, os
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)
    values
        (`referrer`, `slug`, `user_id`, `category`, `os`, `original_timestamp`)


    
[0m10:34:58.200340 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:ed7c7251-3f02-48eb-a74c-f87b7c43ad75:europe-west1&page=queryresults
[0m10:34:58.224560 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:58.226529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a888280>]}
[0m10:34:58.227629 [info ] [Thread-2 (]: 10 of 14 OK created sql table model dbt_rsdun.downloads ........................ [[32mCREATE TABLE (392.0 rows, 51.0 KB processed)[0m in 3.02s]
[0m10:34:58.229040 [debug] [Thread-2 (]: Finished running node model.my_new_project.downloads
[0m10:34:58.753629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b32d252f-c269-415a-8b19-1377e2ceb100:europe-west1&page=queryresults
[0m10:34:58.755961 [debug] [Thread-1 (]: finished collecting timing info
[0m10:34:58.756546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a700b80>]}
[0m10:34:58.756881 [info ] [Thread-1 (]: 11 of 14 OK created sql incremental model dbt_rsdun.stg_mixpanel__agg_viewed_article  [[32mMERGE (0.0 rows, 23.2 MB processed)[0m in 3.00s]
[0m10:34:58.757247 [debug] [Thread-1 (]: Finished running node model.my_new_project.stg_mixpanel__agg_viewed_article
[0m10:34:58.758418 [debug] [Thread-2 (]: Began running node model.my_new_project.articles_evidence
[0m10:34:58.758928 [info ] [Thread-2 (]: 12 of 14 START sql table model dbt_rsdun.articles_evidence ..................... [RUN]
[0m10:34:58.759608 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.articles_evidence"
[0m10:34:58.759761 [debug] [Thread-2 (]: Began compiling node model.my_new_project.articles_evidence
[0m10:34:58.760010 [debug] [Thread-2 (]: Compiling model.my_new_project.articles_evidence
[0m10:34:58.765670 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.articles_evidence"
[0m10:34:58.767437 [debug] [Thread-2 (]: finished collecting timing info
[0m10:34:58.767582 [debug] [Thread-2 (]: Began executing node model.my_new_project.articles_evidence
[0m10:34:58.769247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:34:59.246749 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.articles_evidence"
[0m10:34:59.248025 [debug] [Thread-2 (]: On model.my_new_project.articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`articles_evidence`
    
    
    OPTIONS()
    as (
      

with StartDate AS (
 SELECT min(segment.original_timestamp) as start_date
 FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
),

-- merge all historical events from segment and mixpanel
historical_events AS (
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__community_viewed_article` AS segment
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__viewed_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_mixpanel__agg_viewed_article` AS mixpanel
    WHERE (mixpanel.original_timestamp < (select start_date From StartDate))
),

-- add article_id to the historical events
historical_events_with_article_id AS (
    SELECT he.slug, original_timestamp, he.category, user_id, referrer, metadata.sanity_id AS article_id
    FROM historical_events AS he
    LEFT JOIN `wawa-83630`.`raw_airbyte__wawa_production_database`.`community_article` AS metadata ON he.slug = metadata.slug
),

-- merge all current events from segment
current_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_ios__screens_article` AS segment
    UNION ALL
    SELECT slug, original_timestamp, category, user_id, referrer, article_id 
    FROM `wawa-83630`.`dbt_rsdun`.`stg_segment_android__screens_article` AS segment
),

-- merge all events
all_events_with_article_id AS (
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM historical_events_with_article_id
    UNION ALL 
    SELECT slug, original_timestamp, category, user_id, referrer, article_id
    FROM current_events_with_article_id
)

SELECT slug, original_timestamp, category, user_id, referrer, article_id,
CASE
WHEN STARTS_WITH(article_id, 'i18') THEN SPLIT(article_id,'.')[offset(1)]
ELSE article_id
END as base_article_id
FROM all_events_with_article_id 
WHERE article_id IS NOT NULL
    );
  
[0m10:35:01.930003 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:b107d7b9-d676-4b57-b303-e3e12cd9d4cc:europe-west1&page=queryresults
[0m10:35:01.931236 [debug] [Thread-2 (]: finished collecting timing info
[0m10:35:01.931576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a882350>]}
[0m10:35:01.931752 [info ] [Thread-2 (]: 12 of 14 OK created sql table model dbt_rsdun.articles_evidence ................ [[32mCREATE TABLE (19.4k rows, 3.0 MB processed)[0m in 3.17s]
[0m10:35:01.931982 [debug] [Thread-2 (]: Finished running node model.my_new_project.articles_evidence
[0m10:35:01.932263 [debug] [Thread-1 (]: Began running node model.my_new_project.reduced_articles_evidence
[0m10:35:01.932399 [debug] [Thread-2 (]: Began running node model.my_new_project.reduced_base_articles_evidence
[0m10:35:01.932512 [info ] [Thread-1 (]: 13 of 14 START sql table model dbt_rsdun.reduced_articles_evidence ............. [RUN]
[0m10:35:01.932700 [info ] [Thread-2 (]: 14 of 14 START sql table model dbt_rsdun.reduced_base_articles_evidence ........ [RUN]
[0m10:35:01.933058 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.my_new_project.reduced_articles_evidence"
[0m10:35:01.933326 [debug] [Thread-2 (]: Acquiring new bigquery connection "model.my_new_project.reduced_base_articles_evidence"
[0m10:35:01.933421 [debug] [Thread-1 (]: Began compiling node model.my_new_project.reduced_articles_evidence
[0m10:35:01.933496 [debug] [Thread-2 (]: Began compiling node model.my_new_project.reduced_base_articles_evidence
[0m10:35:01.933581 [debug] [Thread-1 (]: Compiling model.my_new_project.reduced_articles_evidence
[0m10:35:01.933656 [debug] [Thread-2 (]: Compiling model.my_new_project.reduced_base_articles_evidence
[0m10:35:01.935356 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_new_project.reduced_articles_evidence"
[0m10:35:01.936600 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_new_project.reduced_base_articles_evidence"
[0m10:35:01.937117 [debug] [Thread-2 (]: finished collecting timing info
[0m10:35:01.937202 [debug] [Thread-2 (]: Began executing node model.my_new_project.reduced_base_articles_evidence
[0m10:35:01.938514 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_new_project.reduced_base_articles_evidence"
[0m10:35:01.938728 [debug] [Thread-1 (]: finished collecting timing info
[0m10:35:01.938801 [debug] [Thread-1 (]: Began executing node model.my_new_project.reduced_articles_evidence
[0m10:35:01.939699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:01.939798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:35:01.976786 [debug] [Thread-2 (]: On model.my_new_project.reduced_base_articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.reduced_base_articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`reduced_base_articles_evidence`
    
    
    OPTIONS()
    as (
      

-- Reduce articles_evidence such that an article can only appear for a user once based on base_article_id

SELECT base_article_id, user_id, original_timestamp
FROM (
    SELECT ROW_NUMBER() OVER (PARTITION BY base_article_id ORDER BY original_timestamp, user_id DESC) row_num, base_article_id, original_timestamp, user_id
    FROM `wawa-83630`.`dbt_rsdun`.`articles_evidence`
)
WHERE row_num=1
    );
  
[0m10:35:02.515161 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_new_project.reduced_articles_evidence"
[0m10:35:02.515609 [debug] [Thread-1 (]: On model.my_new_project.reduced_articles_evidence: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "local_playground", "target_name": "dev", "node_id": "model.my_new_project.reduced_articles_evidence"} */

  
    

    create or replace table `wawa-83630`.`dbt_rsdun`.`reduced_articles_evidence`
    
    
    OPTIONS()
    as (
      

-- Reduce articles_evidence such that an article can only appear for a user once

SELECT base_article_id, user_id, original_timestamp, article_id
FROM (
    SELECT ROW_NUMBER() OVER (PARTITION BY article_id ORDER BY original_timestamp, user_id DESC) row_num, base_article_id, original_timestamp, user_id, article_id
    FROM `wawa-83630`.`dbt_rsdun`.`articles_evidence`
)
WHERE row_num=1
    );
  
[0m10:35:04.482963 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:e51c4720-887e-4612-9cd1-1ba2650f64d4:europe-west1&page=queryresults
[0m10:35:04.486998 [debug] [Thread-2 (]: finished collecting timing info
[0m10:35:04.488744 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89abf0>]}
[0m10:35:04.489646 [info ] [Thread-2 (]: 14 of 14 OK created sql table model dbt_rsdun.reduced_base_articles_evidence ... [[32mCREATE TABLE (642.0 rows, 1.6 MB processed)[0m in 2.56s]
[0m10:35:04.490647 [debug] [Thread-2 (]: Finished running node model.my_new_project.reduced_base_articles_evidence
[0m10:35:04.496224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=wawa-83630&j=bq:d9a57393-d141-40b9-bbf9-ccbe92168a29:europe-west1&page=queryresults
[0m10:35:04.500729 [debug] [Thread-1 (]: finished collecting timing info
[0m10:35:04.503070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c10d70-518b-4b10-b64a-13327753eb78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61f670>]}
[0m10:35:04.504049 [info ] [Thread-1 (]: 13 of 14 OK created sql table model dbt_rsdun.reduced_articles_evidence ........ [[32mCREATE TABLE (823.0 rows, 2.5 MB processed)[0m in 2.57s]
[0m10:35:04.504889 [debug] [Thread-1 (]: Finished running node model.my_new_project.reduced_articles_evidence
[0m10:35:04.507295 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m10:35:04.508145 [info ] [MainThread]: 
[0m10:35:04.508460 [info ] [MainThread]: Finished running 3 view models, 7 incremental models, 4 table models in 0 hours 0 minutes and 21.11 seconds (21.11s).
[0m10:35:04.508688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:04.508829 [debug] [MainThread]: Connection 'model.my_new_project.reduced_articles_evidence' was properly closed.
[0m10:35:04.508945 [debug] [MainThread]: Connection 'model.my_new_project.reduced_base_articles_evidence' was properly closed.
[0m10:35:04.528053 [info ] [MainThread]: 
[0m10:35:04.528610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:04.528872 [info ] [MainThread]: 
[0m10:35:04.529069 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m10:35:04.529491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a89af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61d180>]}
[0m10:35:04.529784 [debug] [MainThread]: Flushing usage events
